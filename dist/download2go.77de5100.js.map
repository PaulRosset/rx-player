{"version":3,"sources":["../../../../node_modules/core-js/modules/_global.js","../../../../node_modules/core-js/modules/_core.js","../../../../node_modules/core-js/modules/_is-object.js","../../../../node_modules/core-js/modules/_an-object.js","../../../../node_modules/core-js/modules/_fails.js","../../../../node_modules/core-js/modules/_descriptors.js","../../../../node_modules/core-js/modules/_dom-create.js","../../../../node_modules/core-js/modules/_ie8-dom-define.js","../../../../node_modules/core-js/modules/_to-primitive.js","../../../../node_modules/core-js/modules/_object-dp.js","../../../../node_modules/core-js/modules/_property-desc.js","../../../../node_modules/core-js/modules/_hide.js","../../../../node_modules/core-js/modules/_has.js","../../../../node_modules/core-js/modules/_uid.js","../../../../node_modules/core-js/modules/_library.js","../../../../node_modules/core-js/modules/_shared.js","../../../../node_modules/core-js/modules/_function-to-string.js","../../../../node_modules/core-js/modules/_redefine.js","../../../../node_modules/core-js/modules/_a-function.js","../../../../node_modules/core-js/modules/_ctx.js","../../../../node_modules/core-js/modules/_export.js","../../../../node_modules/core-js/modules/_defined.js","../../../../node_modules/core-js/modules/_to-object.js","../../../../node_modules/core-js/modules/_to-integer.js","../../../../node_modules/core-js/modules/_to-absolute-index.js","../../../../node_modules/core-js/modules/_to-length.js","../../../../node_modules/core-js/modules/_array-copy-within.js","../../../../node_modules/core-js/modules/_wks.js","../../../../node_modules/core-js/modules/_add-to-unscopables.js","../../../../node_modules/core-js/modules/es6.array.copy-within.js","../../../../node_modules/core-js/modules/_array-fill.js","../../../../node_modules/core-js/modules/es6.array.fill.js","../../../../node_modules/core-js/modules/_cof.js","../../../../node_modules/core-js/modules/_iobject.js","../../../../node_modules/core-js/modules/_is-array.js","../../../../node_modules/core-js/modules/_array-species-constructor.js","../../../../node_modules/core-js/modules/_array-species-create.js","../../../../node_modules/core-js/modules/_array-methods.js","../../../../node_modules/core-js/modules/es6.array.find.js","../../../../node_modules/core-js/modules/es6.array.find-index.js","../../../../node_modules/core-js/modules/_iter-call.js","../../../../node_modules/core-js/modules/_iterators.js","../../../../node_modules/core-js/modules/_is-array-iter.js","../../../../node_modules/core-js/modules/_create-property.js","../../../../node_modules/core-js/modules/_classof.js","../../../../node_modules/core-js/modules/core.get-iterator-method.js","../../../../node_modules/core-js/modules/_iter-detect.js","../../../../node_modules/core-js/modules/es6.array.from.js","../../../../node_modules/core-js/modules/_to-iobject.js","../../../../node_modules/core-js/modules/_array-includes.js","../../../../node_modules/core-js/modules/es7.array.includes.js","../../../../node_modules/core-js/modules/_iter-step.js","../../../../node_modules/core-js/modules/_shared-key.js","../../../../node_modules/core-js/modules/_object-keys-internal.js","../../../../node_modules/core-js/modules/_enum-bug-keys.js","../../../../node_modules/core-js/modules/_object-keys.js","../../../../node_modules/core-js/modules/_object-dps.js","../../../../node_modules/core-js/modules/_html.js","../../../../node_modules/core-js/modules/_object-create.js","../../../../node_modules/core-js/modules/_set-to-string-tag.js","../../../../node_modules/core-js/modules/_iter-create.js","../../../../node_modules/core-js/modules/_object-gpo.js","../../../../node_modules/core-js/modules/_iter-define.js","../../../../node_modules/core-js/modules/es6.array.iterator.js","../../../../node_modules/core-js/modules/es6.array.of.js","../../../../node_modules/core-js/modules/_strict-method.js","../../../../node_modules/core-js/modules/es6.array.sort.js","../../../../node_modules/core-js/modules/_set-species.js","../../../../node_modules/core-js/modules/es6.array.species.js","../../../../node_modules/core-js/modules/es6.date.to-json.js","../../../../node_modules/core-js/modules/_date-to-primitive.js","../../../../node_modules/core-js/modules/es6.date.to-primitive.js","../../../../node_modules/core-js/modules/es6.function.has-instance.js","../../../../node_modules/core-js/modules/es6.function.name.js","../../../../node_modules/core-js/modules/_redefine-all.js","../../../../node_modules/core-js/modules/_an-instance.js","../../../../node_modules/core-js/modules/_for-of.js","../../../../node_modules/core-js/modules/_meta.js","../../../../node_modules/core-js/modules/_validate-collection.js","../../../../node_modules/core-js/modules/_collection-strong.js","../../../../node_modules/core-js/modules/_object-pie.js","../../../../node_modules/core-js/modules/_object-gopd.js","../../../../node_modules/core-js/modules/_set-proto.js","../../../../node_modules/core-js/modules/_inherit-if-required.js","../../../../node_modules/core-js/modules/_collection.js","../../../../node_modules/core-js/modules/es6.map.js","../../../../node_modules/core-js/modules/_math-log1p.js","../../../../node_modules/core-js/modules/es6.math.acosh.js","../../../../node_modules/core-js/modules/es6.math.asinh.js","../../../../node_modules/core-js/modules/es6.math.atanh.js","../../../../node_modules/core-js/modules/_math-sign.js","../../../../node_modules/core-js/modules/es6.math.cbrt.js","../../../../node_modules/core-js/modules/es6.math.clz32.js","../../../../node_modules/core-js/modules/es6.math.cosh.js","../../../../node_modules/core-js/modules/_math-expm1.js","../../../../node_modules/core-js/modules/es6.math.expm1.js","../../../../node_modules/core-js/modules/_math-fround.js","../../../../node_modules/core-js/modules/es6.math.fround.js","../../../../node_modules/core-js/modules/es6.math.hypot.js","../../../../node_modules/core-js/modules/es6.math.imul.js","../../../../node_modules/core-js/modules/es6.math.log1p.js","../../../../node_modules/core-js/modules/es6.math.log10.js","../../../../node_modules/core-js/modules/es6.math.log2.js","../../../../node_modules/core-js/modules/es6.math.sign.js","../../../../node_modules/core-js/modules/es6.math.sinh.js","../../../../node_modules/core-js/modules/es6.math.tanh.js","../../../../node_modules/core-js/modules/es6.math.trunc.js","../../../../node_modules/core-js/modules/_object-gopn.js","../../../../node_modules/core-js/modules/_string-ws.js","../../../../node_modules/core-js/modules/_string-trim.js","../../../../node_modules/core-js/modules/es6.number.constructor.js","../../../../node_modules/core-js/modules/es6.number.epsilon.js","../../../../node_modules/core-js/modules/es6.number.is-finite.js","../../../../node_modules/core-js/modules/_is-integer.js","../../../../node_modules/core-js/modules/es6.number.is-integer.js","../../../../node_modules/core-js/modules/es6.number.is-nan.js","../../../../node_modules/core-js/modules/es6.number.is-safe-integer.js","../../../../node_modules/core-js/modules/es6.number.max-safe-integer.js","../../../../node_modules/core-js/modules/es6.number.min-safe-integer.js","../../../../node_modules/core-js/modules/_parse-float.js","../../../../node_modules/core-js/modules/es6.number.parse-float.js","../../../../node_modules/core-js/modules/_parse-int.js","../../../../node_modules/core-js/modules/es6.number.parse-int.js","../../../../node_modules/core-js/modules/_object-gops.js","../../../../node_modules/core-js/modules/_object-assign.js","../../../../node_modules/core-js/modules/es6.object.assign.js","../../../../node_modules/core-js/modules/_object-forced-pam.js","../../../../node_modules/core-js/modules/es7.object.define-getter.js","../../../../node_modules/core-js/modules/es7.object.define-setter.js","../../../../node_modules/core-js/modules/_object-to-array.js","../../../../node_modules/core-js/modules/es7.object.entries.js","../../../../node_modules/core-js/modules/_object-sap.js","../../../../node_modules/core-js/modules/es6.object.freeze.js","../../../../node_modules/core-js/modules/es6.object.get-own-property-descriptor.js","../../../../node_modules/core-js/modules/_own-keys.js","../../../../node_modules/core-js/modules/es7.object.get-own-property-descriptors.js","../../../../node_modules/core-js/modules/_object-gopn-ext.js","../../../../node_modules/core-js/modules/es6.object.get-own-property-names.js","../../../../node_modules/core-js/modules/es6.object.get-prototype-of.js","../../../../node_modules/core-js/modules/es7.object.lookup-getter.js","../../../../node_modules/core-js/modules/es7.object.lookup-setter.js","../../../../node_modules/core-js/modules/es6.object.prevent-extensions.js","../../../../node_modules/core-js/modules/_same-value.js","../../../../node_modules/core-js/modules/es6.object.is.js","../../../../node_modules/core-js/modules/es6.object.is-frozen.js","../../../../node_modules/core-js/modules/es6.object.is-sealed.js","../../../../node_modules/core-js/modules/es6.object.is-extensible.js","../../../../node_modules/core-js/modules/es6.object.keys.js","../../../../node_modules/core-js/modules/es6.object.seal.js","../../../../node_modules/core-js/modules/es6.object.set-prototype-of.js","../../../../node_modules/core-js/modules/es7.object.values.js","../../../../node_modules/core-js/modules/_species-constructor.js","../../../../node_modules/core-js/modules/_invoke.js","../../../../node_modules/core-js/modules/_task.js","../../../../node_modules/core-js/modules/_microtask.js","../../../../node_modules/core-js/modules/_new-promise-capability.js","../../../../node_modules/core-js/modules/_perform.js","../../../../node_modules/core-js/modules/_user-agent.js","../../../../node_modules/core-js/modules/_promise-resolve.js","../../../../node_modules/core-js/modules/es6.promise.js","../../../../node_modules/core-js/modules/es7.promise.finally.js","../../../../node_modules/core-js/modules/es6.reflect.apply.js","../../../../node_modules/core-js/modules/_bind.js","../../../../node_modules/core-js/modules/es6.reflect.construct.js","../../../../node_modules/core-js/modules/es6.reflect.define-property.js","../../../../node_modules/core-js/modules/es6.reflect.delete-property.js","../../../../node_modules/core-js/modules/es6.reflect.get.js","../../../../node_modules/core-js/modules/es6.reflect.get-own-property-descriptor.js","../../../../node_modules/core-js/modules/es6.reflect.get-prototype-of.js","../../../../node_modules/core-js/modules/es6.reflect.has.js","../../../../node_modules/core-js/modules/es6.reflect.is-extensible.js","../../../../node_modules/core-js/modules/es6.reflect.own-keys.js","../../../../node_modules/core-js/modules/es6.reflect.prevent-extensions.js","../../../../node_modules/core-js/modules/es6.reflect.set.js","../../../../node_modules/core-js/modules/es6.reflect.set-prototype-of.js","../../../../node_modules/core-js/modules/_is-regexp.js","../../../../node_modules/core-js/modules/_flags.js","../../../../node_modules/core-js/modules/es6.regexp.constructor.js","../../../../node_modules/core-js/modules/es6.regexp.flags.js","../../../../node_modules/core-js/modules/_string-at.js","../../../../node_modules/core-js/modules/_advance-string-index.js","../../../../node_modules/core-js/modules/_regexp-exec-abstract.js","../../../../node_modules/core-js/modules/_regexp-exec.js","../../../../node_modules/core-js/modules/es6.regexp.exec.js","../../../../node_modules/core-js/modules/_fix-re-wks.js","../../../../node_modules/core-js/modules/es6.regexp.match.js","../../../../node_modules/core-js/modules/es6.regexp.replace.js","../../../../node_modules/core-js/modules/es6.regexp.split.js","../../../../node_modules/core-js/modules/es6.regexp.search.js","../../../../node_modules/core-js/modules/es6.regexp.to-string.js","../../../../node_modules/core-js/modules/es6.set.js","../../../../node_modules/core-js/modules/_wks-ext.js","../../../../node_modules/core-js/modules/_wks-define.js","../../../../node_modules/core-js/modules/_enum-keys.js","../../../../node_modules/core-js/modules/es6.symbol.js","../../../../node_modules/core-js/modules/es7.symbol.async-iterator.js","../../../../node_modules/core-js/modules/_string-html.js","../../../../node_modules/core-js/modules/es6.string.anchor.js","../../../../node_modules/core-js/modules/es6.string.big.js","../../../../node_modules/core-js/modules/es6.string.blink.js","../../../../node_modules/core-js/modules/es6.string.bold.js","../../../../node_modules/core-js/modules/es6.string.code-point-at.js","../../../../node_modules/core-js/modules/_string-context.js","../../../../node_modules/core-js/modules/_fails-is-regexp.js","../../../../node_modules/core-js/modules/es6.string.ends-with.js","../../../../node_modules/core-js/modules/es6.string.fixed.js","../../../../node_modules/core-js/modules/es6.string.fontcolor.js","../../../../node_modules/core-js/modules/es6.string.fontsize.js","../../../../node_modules/core-js/modules/es6.string.from-code-point.js","../../../../node_modules/core-js/modules/es6.string.includes.js","../../../../node_modules/core-js/modules/es6.string.italics.js","../../../../node_modules/core-js/modules/es6.string.iterator.js","../../../../node_modules/core-js/modules/es6.string.link.js","../../../../node_modules/core-js/modules/_string-repeat.js","../../../../node_modules/core-js/modules/_string-pad.js","../../../../node_modules/core-js/modules/es7.string.pad-start.js","../../../../node_modules/core-js/modules/es7.string.pad-end.js","../../../../node_modules/core-js/modules/es6.string.raw.js","../../../../node_modules/core-js/modules/es6.string.repeat.js","../../../../node_modules/core-js/modules/es6.string.small.js","../../../../node_modules/core-js/modules/es6.string.starts-with.js","../../../../node_modules/core-js/modules/es6.string.strike.js","../../../../node_modules/core-js/modules/es6.string.sub.js","../../../../node_modules/core-js/modules/es6.string.sup.js","../../../../node_modules/core-js/modules/_typed.js","../../../../node_modules/core-js/modules/_to-index.js","../../../../node_modules/core-js/modules/_typed-buffer.js","../../../../node_modules/core-js/modules/es6.typed.array-buffer.js","../../../../node_modules/core-js/modules/_typed-array.js","../../../../node_modules/core-js/modules/es6.typed.int8-array.js","../../../../node_modules/core-js/modules/es6.typed.uint8-array.js","../../../../node_modules/core-js/modules/es6.typed.uint8-clamped-array.js","../../../../node_modules/core-js/modules/es6.typed.int16-array.js","../../../../node_modules/core-js/modules/es6.typed.uint16-array.js","../../../../node_modules/core-js/modules/es6.typed.int32-array.js","../../../../node_modules/core-js/modules/es6.typed.uint32-array.js","../../../../node_modules/core-js/modules/es6.typed.float32-array.js","../../../../node_modules/core-js/modules/es6.typed.float64-array.js","../../../../node_modules/core-js/modules/_collection-weak.js","../../../../node_modules/core-js/modules/es6.weak-map.js","../../../../node_modules/core-js/modules/es6.weak-set.js","../../../../node_modules/core-js/modules/_flatten-into-array.js","../../../../node_modules/core-js/modules/es7.array.flat-map.js","../../../../node_modules/core-js/modules/web.timers.js","../../../../node_modules/core-js/modules/web.immediate.js","../../../../node_modules/core-js/modules/web.dom.iterable.js","../../../../node_modules/regenerator-runtime/runtime.js","../../../../node_modules/tslib/tslib.es6.js","../../../src/internal/util/isFunction.ts","../../src/internal/config.ts","../../../src/internal/util/hostReportError.ts","../../src/internal/Observer.ts","../../../src/internal/util/isArray.ts","../../../src/internal/util/isObject.ts","../../../src/internal/util/UnsubscriptionError.ts","../../src/internal/Subscription.ts","../../../src/internal/symbol/rxSubscriber.ts","../../src/internal/Subscriber.ts","../../../src/internal/util/canReportError.ts","../../../src/internal/util/toSubscriber.ts","../../../src/internal/symbol/observable.ts","../../../src/internal/util/noop.ts","../../../src/internal/util/pipe.ts","../../src/internal/Observable.ts","../../../src/internal/util/ObjectUnsubscribedError.ts","../../src/internal/SubjectSubscription.ts","../../src/internal/Subject.ts","../../../src/internal/operators/refCount.ts","../../../src/internal/observable/ConnectableObservable.ts","../../../src/internal/operators/groupBy.ts","../../src/internal/BehaviorSubject.ts","../../../src/internal/scheduler/Action.ts","../../../src/internal/scheduler/AsyncAction.ts","../../../src/internal/scheduler/QueueAction.ts","../../src/internal/Scheduler.ts","../../../src/internal/scheduler/AsyncScheduler.ts","../../../src/internal/scheduler/QueueScheduler.ts","../../../src/internal/scheduler/queue.ts","../../../src/internal/observable/empty.ts","../../../src/internal/util/isScheduler.ts","../../../src/internal/util/subscribeToArray.ts","../../../src/internal/scheduled/scheduleArray.ts","../../../src/internal/observable/fromArray.ts","../../../src/internal/observable/of.ts","../../../src/internal/observable/throwError.ts","../../src/internal/Notification.ts","../../../src/internal/operators/observeOn.ts","../../src/internal/ReplaySubject.ts","../../src/internal/AsyncSubject.ts","../../../src/internal/util/Immediate.ts","../../../src/internal/scheduler/AsapAction.ts","../../../src/internal/scheduler/AsapScheduler.ts","../../../src/internal/scheduler/asap.ts","../../../src/internal/scheduler/async.ts","../../../src/internal/scheduler/AnimationFrameAction.ts","../../../src/internal/scheduler/AnimationFrameScheduler.ts","../../../src/internal/scheduler/animationFrame.ts","../../../src/internal/scheduler/VirtualTimeScheduler.ts","../../../src/internal/util/identity.ts","../../../src/internal/util/isObservable.ts","../../../src/internal/util/ArgumentOutOfRangeError.ts","../../../src/internal/util/EmptyError.ts","../../../src/internal/util/TimeoutError.ts","../../../src/internal/operators/map.ts","../../../src/internal/observable/bindCallback.ts","../../../src/internal/observable/bindNodeCallback.ts","../../src/internal/OuterSubscriber.ts","../../src/internal/InnerSubscriber.ts","../../../src/internal/util/subscribeToPromise.ts","../../../src/internal/symbol/iterator.ts","../../../src/internal/util/subscribeToIterable.ts","../../../src/internal/util/subscribeToObservable.ts","../../../src/internal/util/isArrayLike.ts","../../../src/internal/util/isPromise.ts","../../../src/internal/util/subscribeTo.ts","../../../src/internal/util/subscribeToResult.ts","../../../src/internal/observable/combineLatest.ts","../../../src/internal/scheduled/scheduleObservable.ts","../../../src/internal/scheduled/schedulePromise.ts","../../../src/internal/scheduled/scheduleIterable.ts","../../../src/internal/util/isInteropObservable.ts","../../../src/internal/util/isIterable.ts","../../../src/internal/scheduled/scheduled.ts","../../../src/internal/observable/from.ts","../../../src/internal/operators/mergeMap.ts","../../../src/internal/operators/mergeAll.ts","../../../src/internal/operators/concatAll.ts","../../../src/internal/observable/concat.ts","../../../src/internal/observable/defer.ts","../../../src/internal/observable/forkJoin.ts","../../../src/internal/observable/fromEvent.ts","../../../src/internal/observable/fromEventPattern.ts","../../../src/internal/observable/generate.ts","../../../src/internal/observable/iif.ts","../../../src/internal/util/isNumeric.ts","../../../src/internal/observable/interval.ts","../../../src/internal/observable/merge.ts","../../../src/internal/observable/never.ts","../../../src/internal/observable/onErrorResumeNext.ts","../../../src/internal/observable/pairs.ts","../../../src/internal/util/not.ts","../../../src/internal/operators/filter.ts","../../../src/internal/observable/partition.ts","../../../src/internal/observable/race.ts","../../../src/internal/observable/range.ts","../../../src/internal/observable/timer.ts","../../../src/internal/observable/using.ts","../../../src/internal/observable/zip.ts","../src/index.ts","../../../src/internal/operators/audit.ts","../../../src/internal/operators/auditTime.ts","../../../src/internal/operators/buffer.ts","../../../src/internal/operators/bufferCount.ts","../../../src/internal/operators/bufferTime.ts","../../../src/internal/operators/bufferToggle.ts","../../../src/internal/operators/bufferWhen.ts","../../../src/internal/operators/catchError.ts","../../../src/internal/operators/combineAll.ts","../../../src/internal/operators/combineLatest.ts","../../../src/internal/operators/concat.ts","../../../src/internal/operators/concatMap.ts","../../../src/internal/operators/concatMapTo.ts","../../../src/internal/operators/count.ts","../../../src/internal/operators/debounce.ts","../../../src/internal/operators/debounceTime.ts","../../../src/internal/operators/defaultIfEmpty.ts","../../../src/internal/util/isDate.ts","../../../src/internal/operators/delay.ts","../../../src/internal/operators/delayWhen.ts","../../../src/internal/operators/dematerialize.ts","../../../src/internal/operators/distinct.ts","../../../src/internal/operators/distinctUntilChanged.ts","../../../src/internal/operators/distinctUntilKeyChanged.ts","../../../src/internal/operators/throwIfEmpty.ts","../../../src/internal/operators/take.ts","../../../src/internal/operators/elementAt.ts","../../../src/internal/operators/endWith.ts","../../../src/internal/operators/every.ts","../../../src/internal/operators/exhaust.ts","../../../src/internal/operators/exhaustMap.ts","../../../src/internal/operators/expand.ts","../../../src/internal/operators/finalize.ts","../../../src/internal/operators/find.ts","../../../src/internal/operators/findIndex.ts","../../../src/internal/operators/first.ts","../../../src/internal/operators/ignoreElements.ts","../../../src/internal/operators/isEmpty.ts","../../../src/internal/operators/takeLast.ts","../../../src/internal/operators/last.ts","../../../src/internal/operators/mapTo.ts","../../../src/internal/operators/materialize.ts","../../../src/internal/operators/scan.ts","../../../src/internal/operators/reduce.ts","../../../src/internal/operators/max.ts","../../../src/internal/operators/merge.ts","../../../src/internal/operators/mergeMapTo.ts","../../../src/internal/operators/mergeScan.ts","../../../src/internal/operators/min.ts","../../../src/internal/operators/multicast.ts","../../../src/internal/operators/onErrorResumeNext.ts","../../../src/internal/operators/pairwise.ts","../../../src/internal/operators/partition.ts","../../../src/internal/operators/pluck.ts","../../../src/internal/operators/publish.ts","../../../src/internal/operators/publishBehavior.ts","../../../src/internal/operators/publishLast.ts","../../../src/internal/operators/publishReplay.ts","../../../src/internal/operators/race.ts","../../../src/internal/operators/repeat.ts","../../../src/internal/operators/repeatWhen.ts","../../../src/internal/operators/retry.ts","../../../src/internal/operators/retryWhen.ts","../../../src/internal/operators/sample.ts","../../../src/internal/operators/sampleTime.ts","../../../src/internal/operators/sequenceEqual.ts","../../../src/internal/operators/share.ts","../../../src/internal/operators/shareReplay.ts","../../../src/internal/operators/single.ts","../../../src/internal/operators/skip.ts","../../../src/internal/operators/skipLast.ts","../../../src/internal/operators/skipUntil.ts","../../../src/internal/operators/skipWhile.ts","../../../src/internal/operators/startWith.ts","../../../src/internal/observable/SubscribeOnObservable.ts","../../../src/internal/operators/subscribeOn.ts","../../../src/internal/operators/switchMap.ts","../../../src/internal/operators/switchAll.ts","../../../src/internal/operators/switchMapTo.ts","../../../src/internal/operators/takeUntil.ts","../../../src/internal/operators/takeWhile.ts","../../../src/internal/operators/tap.ts","../../../src/internal/operators/throttle.ts","../../../src/internal/operators/throttleTime.ts","../../../src/internal/operators/timeInterval.ts","../../../src/internal/operators/timeoutWith.ts","../../../src/internal/operators/timeout.ts","../../../src/internal/operators/timestamp.ts","../../../src/internal/operators/toArray.ts","../../../src/internal/operators/window.ts","../../../src/internal/operators/windowCount.ts","../../../src/internal/operators/windowTime.ts","../../../src/internal/operators/windowToggle.ts","../../../src/internal/operators/windowWhen.ts","../../../src/internal/operators/withLatestFrom.ts","../../../src/internal/operators/zip.ts","../../../src/internal/operators/zipAll.ts","../../src/operators/index.ts","../../../config.ts","../../../errors/assertion_error.ts","../../../errors/error_codes.ts","../../../errors/error_message.ts","../../../errors/encrypted_media_error.ts","../../../errors/media_error.ts","../../../errors/network_error.ts","../../../errors/other_error.ts","../../../errors/is_known_error.ts","../../../errors/format_error.ts","../../../errors/request_error.ts","../../../errors/index.ts","../../../utils/noop.ts","../../../utils/logger.ts","../../../log.ts","../../../utils/request/fetch.ts","../../../utils/request/xhr.ts","../../../utils/request/index.ts","../../../transports/utils/call_custom_manifest_loader.ts","../../../transports/utils/document_manifest_loader.ts","../../../features/add_features.ts","../../../features/types.ts","../../../features/index.ts","../../../transports/dash/image_pipelines.ts","../../../../node_modules/object-assign/index.js","../../../utils/array_find.ts","../../../utils/array_includes.ts","../../../utils/languages/ISO_639-1_to_ISO_639-3.ts","../../../utils/languages/ISO_639-2_to_ISO_639-3.ts","../../../utils/languages/normalize.ts","../../../utils/languages/index.ts","../../../utils/uniq.ts","../../../compat/browser_detection.ts","../../../compat/add_text_track.ts","../../../compat/should_use_webkit_media_keys.ts","../../../compat/browser_compatibility_types.ts","../../../compat/can_patch_isobmff.ts","../../../compat/change_source_buffer_type.ts","../../../compat/clear_element_src.ts","../../../../node_modules/pinkie/index.js","../../../utils/promise.ts","../../../compat/eme/custom_key_system_access.ts","../../../utils/assert.ts","../../../utils/byte_parsing.ts","../../../utils/cast_to_observable.ts","../../../utils/event_emitter.ts","../../../compat/event_listeners.ts","../../../compat/eme/custom_media_keys.ts","../../../compat/eme/constants.ts","../../../compat/eme/generate_key_request.ts","../../../utils/hash_buffer.ts","../../../utils/simple_set.ts","../../../compat/eme/get_init_data.ts","../../../compat/eme/set_media_keys.ts","../../../compat/eme/index.ts","../../../compat/fullscreen.ts","../../../compat/has_eme_apis.ts","../../../compat/is_codec_supported.ts","../../../compat/is_offline.ts","../../../compat/is_playback_stuck.ts","../../../compat/is_vtt_cue.ts","../../../compat/make_vtt_cue.ts","../../../../../../../.config/yarn/global/node_modules/process/browser.js","../../../../node_modules/next-tick/index.js","../../../compat/patch_webkit_source_buffer.ts","../../../utils/rx-try_catch.ts","../../../compat/play.ts","../../../compat/set_element_src.ts","../../../compat/should_renew_media_keys.ts","../../../compat/should_unset_media_keys.ts","../../../compat/should_validate_metadata.ts","../../../compat/when_loaded_metadata.ts","../../../compat/when_media_source_open.ts","../../../compat/index.ts","../../../manifest/filter_supported_representations.ts","../../../manifest/representation.ts","../../../manifest/adaptation.ts","../../../manifest/are_same_content.ts","../../../utils/id_generator.ts","../../../utils/warn_once.ts","../../../utils/object_values.ts","../../../manifest/period.ts","../../../manifest/representation_index/static.ts","../../../manifest/representation_index/types.ts","../../../manifest/representation_index/index.ts","../../../manifest/update_period_in_place.ts","../../../manifest/update_periods.ts","../../../manifest/manifest.ts","../../../manifest/index.ts","../../../utils/resolve_url.ts","../../../parsers/manifest/utils/check_manifest_ids.ts","../../../parsers/manifest/dash/get_clock_offset.ts","../../../parsers/manifest/dash/get_http_utc-timing_url.ts","../../../parsers/manifest/dash/get_last_time_from_adaptation.ts","../../../parsers/manifest/dash/get_maximum_position.ts","../../../parsers/manifest/dash/get_first_time_from_adaptation.ts","../../../parsers/manifest/dash/get_minimum_position.ts","../../../parsers/manifest/dash/get_minimum_and_maximum_positions.ts","../../../parsers/manifest/dash/node_parsers/ContentComponent.ts","../../../parsers/manifest/dash/node_parsers/ContentProtection.ts","../../../parsers/manifest/dash/node_parsers/utils.ts","../../../parsers/manifest/dash/node_parsers/Initialization.ts","../../../parsers/manifest/dash/node_parsers/SegmentBase.ts","../../../parsers/manifest/dash/node_parsers/SegmentURL.ts","../../../parsers/manifest/dash/node_parsers/SegmentList.ts","../../../parsers/manifest/dash/node_parsers/S.ts","../../../parsers/manifest/dash/node_parsers/SegmentTimeline.ts","../../../parsers/manifest/dash/node_parsers/SegmentTemplate.ts","../../../parsers/manifest/dash/node_parsers/Representation.ts","../../../parsers/manifest/dash/node_parsers/AdaptationSet.ts","../../../parsers/manifest/dash/node_parsers/Period.ts","../../../parsers/manifest/dash/node_parsers/MPD.ts","../../../parsers/manifest/dash/parse_availability_start_time.ts","../../../parsers/manifest/dash/parse_duration.ts","../../../utils/flat_map.ts","../../../parsers/manifest/dash/flatten_overlapping_periods.ts","../../../parsers/manifest/dash/get_periods_time_infos.ts","../../../parsers/manifest/dash/manifest_bounds_calculator.ts","../../../parsers/manifest/dash/infer_adaptation_type.ts","../../../parsers/manifest/utils/index_helpers.ts","../../../parsers/manifest/dash/indexes/get_init_segment.ts","../../../parsers/manifest/dash/indexes/tokens.ts","../../../parsers/manifest/dash/indexes/get_segments_from_timeline.ts","../../../parsers/manifest/dash/indexes/base.ts","../../../parsers/manifest/dash/indexes/list.ts","../../../parsers/manifest/dash/indexes/template.ts","../../../parsers/manifest/utils/clear_timeline_from_position.ts","../../../parsers/manifest/utils/is_segment_still_available.ts","../../../parsers/manifest/dash/indexes/timeline.ts","../../../parsers/manifest/dash/parse_representations.ts","../../../parsers/manifest/dash/parse_adaptation_sets.ts","../../../parsers/manifest/dash/parse_periods.ts","../../../parsers/manifest/dash/parse_mpd.ts","../../../parsers/manifest/dash/parse_from_document.ts","../../../parsers/manifest/dash/index.ts","../../../transports/dash/manifest_parser.ts","../../../transports/utils/byte_range.ts","../../../transports/utils/find_complete_box.ts","../../../transports/utils/check_isobmff_integrity.ts","../../../transports/utils/is_webm_embedded_track.ts","../../../transports/dash/init_segment_loader.ts","../../../transports/dash/extract_complete_chunks.ts","../../../transports/dash/low_latency_segment_loader.ts","../../../transports/dash/segment_loader.ts","../../../parsers/containers/isobmff/create_box.ts","../../../parsers/containers/isobmff/get_box.ts","../../../parsers/containers/isobmff/read.ts","../../../parsers/containers/isobmff/drm/playready.ts","../../../parsers/containers/isobmff/drm/index.ts","../../../parsers/containers/isobmff/utils.ts","../../../parsers/containers/isobmff/index.ts","../../../parsers/containers/matroska/utils.ts","../../../parsers/containers/matroska/index.ts","../../../transports/utils/get_isobmff_timing_infos.ts","../../../transports/dash/segment_parser.ts","../../../transports/utils/is_mp4_embedded_text_track.ts","../../../transports/dash/text_loader.ts","../../../utils/string_from_utf8.ts","../../../transports/utils/parse_text_track.ts","../../../transports/dash/text_parser.ts","../../../transports/dash/pipelines.ts","../../../transports/dash/index.ts","../../../parsers/manifest/smooth/get_codecs.ts","../../../parsers/manifest/smooth/parse_C_nodes.ts","../../../parsers/manifest/smooth/parse_protection_node.ts","../../../parsers/manifest/smooth/utils/add_segment_infos.ts","../../../parsers/manifest/smooth/utils/tokens.ts","../../../parsers/manifest/smooth/representation_index.ts","../../../parsers/manifest/smooth/utils/parseBoolean.ts","../../../parsers/manifest/smooth/utils/reduceChildren.ts","../../../parsers/manifest/smooth/create_parser.ts","../../../parsers/manifest/smooth/index.ts","../../../transports/smooth/isobmff/create_boxes.ts","../../../transports/smooth/isobmff/create_init_segment.ts","../../../transports/smooth/isobmff/get_aaces_header.ts","../../../transports/smooth/isobmff/create_audio_init_segment.ts","../../../transports/smooth/isobmff/create_video_init_segment.ts","../../../transports/smooth/isobmff/parse_tfrf.ts","../../../transports/smooth/isobmff/parse_tfxd.ts","../../../transports/smooth/isobmff/add_data_offset_flag_in_trun.ts","../../../transports/smooth/isobmff/create_traf_box.ts","../../../transports/smooth/isobmff/replace_moof.ts","../../../transports/smooth/isobmff/patch_segment.ts","../../../transports/smooth/isobmff/index.ts","../../../transports/smooth/extract_timings_infos.ts","../../../transports/smooth/segment_loader.ts","../../../transports/smooth/utils.ts","../../../transports/smooth/pipelines.ts","../../../transports/smooth/index.ts","../../../utils/get_fuzzed_delay.ts","../../../core/pipelines/utils/backoff.ts","../../../core/pipelines/utils/error_selector.ts","../../../core/pipelines/manifest/create_manifest_loader.ts","../../../core/pipelines/manifest/parse_manifest_pipeline_options.ts","../../../core/pipelines/manifest/create_manifest_pipeline.ts","../../../core/pipelines/manifest/index.ts","../../../core/pipelines/segment/prioritized_segment_fetcher.ts","../../../utils/assert_unreachable.ts","../../../core/pipelines/segment/create_segment_loader.ts","../../../core/pipelines/segment/segment_fetcher.ts","../../../utils/initialization_segment_cache.ts","../../../core/pipelines/segment/get_segment_pipeline_options.ts","../../../utils/array_find_index.ts","../../../core/pipelines/segment/prioritizer.ts","../../../core/pipelines/segment/segment_pipelines_manager.ts","../../../core/pipelines/segment/index.ts","../../../core/pipelines/index.ts","apis/downloader/manifest.ts","apis/downloader/segment.ts","apis/transports/ContentsManager.ts","apis/downloader/initSegment.ts","apis/downloader/downloadManager.ts","../../../../node_modules/idb/build/esm/chunk.js","../../../../node_modules/idb/build/esm/index.js","utils.ts","apis/transactionDB/dbSetUp.ts","index.ts","../../../../../../../.config/yarn/global/node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__decorate","decorators","target","key","desc","c","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__param","paramIndex","decorator","__metadata","metadataKey","metadataValue","metadata","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","rejected","result","done","then","__generator","body","_","label","sent","trys","ops","f","y","g","verb","Symbol","iterator","v","op","TypeError","pop","push","__exportStar","m","exports","__values","o","__read","ar","error","__spread","concat","__spreadArrays","il","k","a","j","jl","__await","__asyncGenerator","asyncIterator","q","resume","settle","fulfill","shift","__asyncDelegator","__asyncValues","__makeTemplateObject","cooked","raw","__importStar","mod","__esModule","default","__importDefault","propIsEnumerable","toObject","val","undefined","shouldUseNative","test1","String","getOwnPropertyNames","test2","fromCharCode","order2","map","join","test3","split","forEach","letter","keys","err","module","source","from","to","symbols","PENDING","SETTLED","FULFILLED","REJECTED","NOOP","isNode","global","process","emit","asyncSetTimer","setImmediate","setTimeout","asyncQueue","asyncTimer","asyncFlush","asyncCall","callback","arg","invokeResolver","resolver","promise","resolvePromise","rejectPromise","reason","invokeCallback","subscriber","owner","settled","_state","_data","handleThenable","resolved","publishFulfillment","publishRejection","publish","_then","_handled","notifyRejectionHandled","onFulfillment","onRejection","catch","all","promises","isArray","results","remaining","index","race","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","Error","defaultClearTimeout","clearTimeout","runTimeout","fun","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","drainQueue","timeout","len","run","nextTick","args","Item","array","title","env","argv","version","versions","noop","on","addListener","once","off","removeListener","removeAllListeners","prependListener","prependOnceListener","listeners","name","binding","cwd","chdir","dir","umask","instanceOfAny","object","constructors","some","idbProxyableTypes","cursorAdvanceMethods","getIdbProxyableTypes","IDBDatabase","IDBObjectStore","IDBIndex","IDBCursor","IDBTransaction","getCursorAdvanceMethods","advance","continue","continuePrimaryKey","cursorRequestMap","WeakMap","transactionDoneMap","transactionStoreNamesMap","transformCache","reverseTransformCache","promisifyRequest","request","unlisten","removeEventListener","success","wrap","addEventListener","set","cacheDonePromiseForTransaction","tx","has","complete","idbProxyTraps","get","prop","receiver","objectStoreNames","objectStore","addTraps","wrapFunction","func","transaction","storeNames","unwrap","sort","includes","transformCachableValue","Proxy","IDBRequest","newValue","openDB","blocked","upgrade","blocking","indexedDB","open","openPromise","event","oldVersion","newVersion","db","deleteDB","deleteDatabase","readMethods","writeMethods","cachedMethods","Map","getMethod","targetFuncName","replace","useIndex","isWrite","method","storeName","store","returnVal","oldTraps","OVERLAY_ID","OldModule","bundle","Module","moduleName","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","JSON","parse","type","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","parcelRequire","id","every","generated","js","console","clear","hmrApply","hmrAcceptRun","window","reload","close","onclose","log","removeErrorOverlay","message","stack","overlay","createErrorOverlay","document","appendChild","getElementById","remove","createElement","stackTrace","innerText","innerHTML","getParents","modules","parents","dep","Function","deps","cached","cache","cb"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;;ACFA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/BA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3CA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrDA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChJA;AACA;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrEA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;;ACJA;AACA;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACpFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACPA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC9RA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3CA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtPA;AACA;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACheA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACrFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA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","file":"download2go.77de5100.js","sourceRoot":"../src/experimental/tools/download2go","sourcesContent":["// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self\n  // eslint-disable-next-line no-new-func\n  : Function('return this')();\nif (typeof __g == 'number') __g = global; // eslint-disable-line no-undef\n","var core = module.exports = { version: '2.6.9' };\nif (typeof __e == 'number') __e = core; // eslint-disable-line no-undef\n","module.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n","var isObject = require('./_is-object');\nmodule.exports = function (it) {\n  if (!isObject(it)) throw TypeError(it + ' is not an object!');\n  return it;\n};\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (e) {\n    return true;\n  }\n};\n","// Thank's IE8 for his funny defineProperty\nmodule.exports = !require('./_fails')(function () {\n  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;\n});\n","var isObject = require('./_is-object');\nvar document = require('./_global').document;\n// typeof document.createElement is 'object' in old IE\nvar is = isObject(document) && isObject(document.createElement);\nmodule.exports = function (it) {\n  return is ? document.createElement(it) : {};\n};\n","module.exports = !require('./_descriptors') && !require('./_fails')(function () {\n  return Object.defineProperty(require('./_dom-create')('div'), 'a', { get: function () { return 7; } }).a != 7;\n});\n","// 7.1.1 ToPrimitive(input [, PreferredType])\nvar isObject = require('./_is-object');\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (it, S) {\n  if (!isObject(it)) return it;\n  var fn, val;\n  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","var anObject = require('./_an-object');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar toPrimitive = require('./_to-primitive');\nvar dP = Object.defineProperty;\n\nexports.f = require('./_descriptors') ? Object.defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return dP(O, P, Attributes);\n  } catch (e) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","var dP = require('./_object-dp');\nvar createDesc = require('./_property-desc');\nmodule.exports = require('./_descriptors') ? function (object, key, value) {\n  return dP.f(object, key, createDesc(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","var hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function (it, key) {\n  return hasOwnProperty.call(it, key);\n};\n","var id = 0;\nvar px = Math.random();\nmodule.exports = function (key) {\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};\n","module.exports = false;\n","var core = require('./_core');\nvar global = require('./_global');\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || (global[SHARED] = {});\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: core.version,\n  mode: require('./_library') ? 'pure' : 'global',\n  copyright: ' 2019 Denis Pushkarev (zloirock.ru)'\n});\n","module.exports = require('./_shared')('native-function-to-string', Function.toString);\n","var global = require('./_global');\nvar hide = require('./_hide');\nvar has = require('./_has');\nvar SRC = require('./_uid')('src');\nvar $toString = require('./_function-to-string');\nvar TO_STRING = 'toString';\nvar TPL = ('' + $toString).split(TO_STRING);\n\nrequire('./_core').inspectSource = function (it) {\n  return $toString.call(it);\n};\n\n(module.exports = function (O, key, val, safe) {\n  var isFunction = typeof val == 'function';\n  if (isFunction) has(val, 'name') || hide(val, 'name', key);\n  if (O[key] === val) return;\n  if (isFunction) has(val, SRC) || hide(val, SRC, O[key] ? '' + O[key] : TPL.join(String(key)));\n  if (O === global) {\n    O[key] = val;\n  } else if (!safe) {\n    delete O[key];\n    hide(O, key, val);\n  } else if (O[key]) {\n    O[key] = val;\n  } else {\n    hide(O, key, val);\n  }\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype, TO_STRING, function toString() {\n  return typeof this == 'function' && this[SRC] || $toString.call(this);\n});\n","module.exports = function (it) {\n  if (typeof it != 'function') throw TypeError(it + ' is not a function!');\n  return it;\n};\n","// optional / simple context binding\nvar aFunction = require('./_a-function');\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","var global = require('./_global');\nvar core = require('./_core');\nvar hide = require('./_hide');\nvar redefine = require('./_redefine');\nvar ctx = require('./_ctx');\nvar PROTOTYPE = 'prototype';\n\nvar $export = function (type, name, source) {\n  var IS_FORCED = type & $export.F;\n  var IS_GLOBAL = type & $export.G;\n  var IS_STATIC = type & $export.S;\n  var IS_PROTO = type & $export.P;\n  var IS_BIND = type & $export.B;\n  var target = IS_GLOBAL ? global : IS_STATIC ? global[name] || (global[name] = {}) : (global[name] || {})[PROTOTYPE];\n  var exports = IS_GLOBAL ? core : core[name] || (core[name] = {});\n  var expProto = exports[PROTOTYPE] || (exports[PROTOTYPE] = {});\n  var key, own, out, exp;\n  if (IS_GLOBAL) source = name;\n  for (key in source) {\n    // contains in native\n    own = !IS_FORCED && target && target[key] !== undefined;\n    // export native or passed\n    out = (own ? target : source)[key];\n    // bind timers to global for call from export context\n    exp = IS_BIND && own ? ctx(out, global) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    // extend global\n    if (target) redefine(target, key, out, type & $export.U);\n    // export\n    if (exports[key] != out) hide(exports, key, exp);\n    if (IS_PROTO && expProto[key] != out) expProto[key] = out;\n  }\n};\nglobal.core = core;\n// type bitmap\n$export.F = 1;   // forced\n$export.G = 2;   // global\n$export.S = 4;   // static\n$export.P = 8;   // proto\n$export.B = 16;  // bind\n$export.W = 32;  // wrap\n$export.U = 64;  // safe\n$export.R = 128; // real proto method for `library`\nmodule.exports = $export;\n","// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on  \" + it);\n  return it;\n};\n","// 7.1.13 ToObject(argument)\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return Object(defined(it));\n};\n","// 7.1.4 ToInteger\nvar ceil = Math.ceil;\nvar floor = Math.floor;\nmodule.exports = function (it) {\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};\n","var toInteger = require('./_to-integer');\nvar max = Math.max;\nvar min = Math.min;\nmodule.exports = function (index, length) {\n  index = toInteger(index);\n  return index < 0 ? max(index + length, 0) : min(index, length);\n};\n","// 7.1.15 ToLength\nvar toInteger = require('./_to-integer');\nvar min = Math.min;\nmodule.exports = function (it) {\n  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n};\n","// 22.1.3.3 Array.prototype.copyWithin(target, start, end = this.length)\n'use strict';\nvar toObject = require('./_to-object');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nvar toLength = require('./_to-length');\n\nmodule.exports = [].copyWithin || function copyWithin(target /* = 0 */, start /* = 0, end = @length */) {\n  var O = toObject(this);\n  var len = toLength(O.length);\n  var to = toAbsoluteIndex(target, len);\n  var from = toAbsoluteIndex(start, len);\n  var end = arguments.length > 2 ? arguments[2] : undefined;\n  var count = Math.min((end === undefined ? len : toAbsoluteIndex(end, len)) - from, len - to);\n  var inc = 1;\n  if (from < to && to < from + count) {\n    inc = -1;\n    from += count - 1;\n    to += count - 1;\n  }\n  while (count-- > 0) {\n    if (from in O) O[to] = O[from];\n    else delete O[to];\n    to += inc;\n    from += inc;\n  } return O;\n};\n","var store = require('./_shared')('wks');\nvar uid = require('./_uid');\nvar Symbol = require('./_global').Symbol;\nvar USE_SYMBOL = typeof Symbol == 'function';\n\nvar $exports = module.exports = function (name) {\n  return store[name] || (store[name] =\n    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));\n};\n\n$exports.store = store;\n","// 22.1.3.31 Array.prototype[@@unscopables]\nvar UNSCOPABLES = require('./_wks')('unscopables');\nvar ArrayProto = Array.prototype;\nif (ArrayProto[UNSCOPABLES] == undefined) require('./_hide')(ArrayProto, UNSCOPABLES, {});\nmodule.exports = function (key) {\n  ArrayProto[UNSCOPABLES][key] = true;\n};\n","// 22.1.3.3 Array.prototype.copyWithin(target, start, end = this.length)\nvar $export = require('./_export');\n\n$export($export.P, 'Array', { copyWithin: require('./_array-copy-within') });\n\nrequire('./_add-to-unscopables')('copyWithin');\n","// 22.1.3.6 Array.prototype.fill(value, start = 0, end = this.length)\n'use strict';\nvar toObject = require('./_to-object');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nvar toLength = require('./_to-length');\nmodule.exports = function fill(value /* , start = 0, end = @length */) {\n  var O = toObject(this);\n  var length = toLength(O.length);\n  var aLen = arguments.length;\n  var index = toAbsoluteIndex(aLen > 1 ? arguments[1] : undefined, length);\n  var end = aLen > 2 ? arguments[2] : undefined;\n  var endPos = end === undefined ? length : toAbsoluteIndex(end, length);\n  while (endPos > index) O[index++] = value;\n  return O;\n};\n","// 22.1.3.6 Array.prototype.fill(value, start = 0, end = this.length)\nvar $export = require('./_export');\n\n$export($export.P, 'Array', { fill: require('./_array-fill') });\n\nrequire('./_add-to-unscopables')('fill');\n","var toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n","// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar cof = require('./_cof');\n// eslint-disable-next-line no-prototype-builtins\nmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function (it) {\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};\n","// 7.2.2 IsArray(argument)\nvar cof = require('./_cof');\nmodule.exports = Array.isArray || function isArray(arg) {\n  return cof(arg) == 'Array';\n};\n","var isObject = require('./_is-object');\nvar isArray = require('./_is-array');\nvar SPECIES = require('./_wks')('species');\n\nmodule.exports = function (original) {\n  var C;\n  if (isArray(original)) {\n    C = original.constructor;\n    // cross-realm fallback\n    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) C = undefined;\n    if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return C === undefined ? Array : C;\n};\n","// 9.4.2.3 ArraySpeciesCreate(originalArray, length)\nvar speciesConstructor = require('./_array-species-constructor');\n\nmodule.exports = function (original, length) {\n  return new (speciesConstructor(original))(length);\n};\n","// 0 -> Array#forEach\n// 1 -> Array#map\n// 2 -> Array#filter\n// 3 -> Array#some\n// 4 -> Array#every\n// 5 -> Array#find\n// 6 -> Array#findIndex\nvar ctx = require('./_ctx');\nvar IObject = require('./_iobject');\nvar toObject = require('./_to-object');\nvar toLength = require('./_to-length');\nvar asc = require('./_array-species-create');\nmodule.exports = function (TYPE, $create) {\n  var IS_MAP = TYPE == 1;\n  var IS_FILTER = TYPE == 2;\n  var IS_SOME = TYPE == 3;\n  var IS_EVERY = TYPE == 4;\n  var IS_FIND_INDEX = TYPE == 6;\n  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;\n  var create = $create || asc;\n  return function ($this, callbackfn, that) {\n    var O = toObject($this);\n    var self = IObject(O);\n    var f = ctx(callbackfn, that, 3);\n    var length = toLength(self.length);\n    var index = 0;\n    var result = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined;\n    var val, res;\n    for (;length > index; index++) if (NO_HOLES || index in self) {\n      val = self[index];\n      res = f(val, index, O);\n      if (TYPE) {\n        if (IS_MAP) result[index] = res;   // map\n        else if (res) switch (TYPE) {\n          case 3: return true;             // some\n          case 5: return val;              // find\n          case 6: return index;            // findIndex\n          case 2: result.push(val);        // filter\n        } else if (IS_EVERY) return false; // every\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : result;\n  };\n};\n","'use strict';\n// 22.1.3.8 Array.prototype.find(predicate, thisArg = undefined)\nvar $export = require('./_export');\nvar $find = require('./_array-methods')(5);\nvar KEY = 'find';\nvar forced = true;\n// Shouldn't skip holes\nif (KEY in []) Array(1)[KEY](function () { forced = false; });\n$export($export.P + $export.F * forced, 'Array', {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\nrequire('./_add-to-unscopables')(KEY);\n","'use strict';\n// 22.1.3.9 Array.prototype.findIndex(predicate, thisArg = undefined)\nvar $export = require('./_export');\nvar $find = require('./_array-methods')(6);\nvar KEY = 'findIndex';\nvar forced = true;\n// Shouldn't skip holes\nif (KEY in []) Array(1)[KEY](function () { forced = false; });\n$export($export.P + $export.F * forced, 'Array', {\n  findIndex: function findIndex(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\nrequire('./_add-to-unscopables')(KEY);\n","// call something on iterator step with safe closing on error\nvar anObject = require('./_an-object');\nmodule.exports = function (iterator, fn, value, entries) {\n  try {\n    return entries ? fn(anObject(value)[0], value[1]) : fn(value);\n  // 7.4.6 IteratorClose(iterator, completion)\n  } catch (e) {\n    var ret = iterator['return'];\n    if (ret !== undefined) anObject(ret.call(iterator));\n    throw e;\n  }\n};\n","module.exports = {};\n","// check on default Array iterator\nvar Iterators = require('./_iterators');\nvar ITERATOR = require('./_wks')('iterator');\nvar ArrayProto = Array.prototype;\n\nmodule.exports = function (it) {\n  return it !== undefined && (Iterators.Array === it || ArrayProto[ITERATOR] === it);\n};\n","'use strict';\nvar $defineProperty = require('./_object-dp');\nvar createDesc = require('./_property-desc');\n\nmodule.exports = function (object, index, value) {\n  if (index in object) $defineProperty.f(object, index, createDesc(0, value));\n  else object[index] = value;\n};\n","// getting tag from 19.1.3.6 Object.prototype.toString()\nvar cof = require('./_cof');\nvar TAG = require('./_wks')('toStringTag');\n// ES3 wrong here\nvar ARG = cof(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (e) { /* empty */ }\n};\n\nmodule.exports = function (it) {\n  var O, T, B;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (T = tryGet(O = Object(it), TAG)) == 'string' ? T\n    // builtinTag case\n    : ARG ? cof(O)\n    // ES3 arguments fallback\n    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;\n};\n","var classof = require('./_classof');\nvar ITERATOR = require('./_wks')('iterator');\nvar Iterators = require('./_iterators');\nmodule.exports = require('./_core').getIteratorMethod = function (it) {\n  if (it != undefined) return it[ITERATOR]\n    || it['@@iterator']\n    || Iterators[classof(it)];\n};\n","var ITERATOR = require('./_wks')('iterator');\nvar SAFE_CLOSING = false;\n\ntry {\n  var riter = [7][ITERATOR]();\n  riter['return'] = function () { SAFE_CLOSING = true; };\n  // eslint-disable-next-line no-throw-literal\n  Array.from(riter, function () { throw 2; });\n} catch (e) { /* empty */ }\n\nmodule.exports = function (exec, skipClosing) {\n  if (!skipClosing && !SAFE_CLOSING) return false;\n  var safe = false;\n  try {\n    var arr = [7];\n    var iter = arr[ITERATOR]();\n    iter.next = function () { return { done: safe = true }; };\n    arr[ITERATOR] = function () { return iter; };\n    exec(arr);\n  } catch (e) { /* empty */ }\n  return safe;\n};\n","'use strict';\nvar ctx = require('./_ctx');\nvar $export = require('./_export');\nvar toObject = require('./_to-object');\nvar call = require('./_iter-call');\nvar isArrayIter = require('./_is-array-iter');\nvar toLength = require('./_to-length');\nvar createProperty = require('./_create-property');\nvar getIterFn = require('./core.get-iterator-method');\n\n$export($export.S + $export.F * !require('./_iter-detect')(function (iter) { Array.from(iter); }), 'Array', {\n  // 22.1.2.1 Array.from(arrayLike, mapfn = undefined, thisArg = undefined)\n  from: function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {\n    var O = toObject(arrayLike);\n    var C = typeof this == 'function' ? this : Array;\n    var aLen = arguments.length;\n    var mapfn = aLen > 1 ? arguments[1] : undefined;\n    var mapping = mapfn !== undefined;\n    var index = 0;\n    var iterFn = getIterFn(O);\n    var length, result, step, iterator;\n    if (mapping) mapfn = ctx(mapfn, aLen > 2 ? arguments[2] : undefined, 2);\n    // if object isn't iterable or it's array with default iterator - use simple case\n    if (iterFn != undefined && !(C == Array && isArrayIter(iterFn))) {\n      for (iterator = iterFn.call(O), result = new C(); !(step = iterator.next()).done; index++) {\n        createProperty(result, index, mapping ? call(iterator, mapfn, [step.value, index], true) : step.value);\n      }\n    } else {\n      length = toLength(O.length);\n      for (result = new C(length); length > index; index++) {\n        createProperty(result, index, mapping ? mapfn(O[index], index) : O[index]);\n      }\n    }\n    result.length = index;\n    return result;\n  }\n});\n","// to indexed object, toObject with fallback for non-array-like ES3 strings\nvar IObject = require('./_iobject');\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return IObject(defined(it));\n};\n","// false -> Array#indexOf\n// true  -> Array#includes\nvar toIObject = require('./_to-iobject');\nvar toLength = require('./_to-length');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nmodule.exports = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {\n      if (O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n","'use strict';\n// https://github.com/tc39/Array.prototype.includes\nvar $export = require('./_export');\nvar $includes = require('./_array-includes')(true);\n\n$export($export.P, 'Array', {\n  includes: function includes(el /* , fromIndex = 0 */) {\n    return $includes(this, el, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\nrequire('./_add-to-unscopables')('includes');\n","module.exports = function (done, value) {\n  return { value: value, done: !!done };\n};\n","var shared = require('./_shared')('keys');\nvar uid = require('./_uid');\nmodule.exports = function (key) {\n  return shared[key] || (shared[key] = uid(key));\n};\n","var has = require('./_has');\nvar toIObject = require('./_to-iobject');\nvar arrayIndexOf = require('./_array-includes')(false);\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\n\nmodule.exports = function (object, names) {\n  var O = toIObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) if (key != IE_PROTO) has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~arrayIndexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n","// IE 8- don't enum bug keys\nmodule.exports = (\n  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'\n).split(',');\n","// 19.1.2.14 / 15.2.3.14 Object.keys(O)\nvar $keys = require('./_object-keys-internal');\nvar enumBugKeys = require('./_enum-bug-keys');\n\nmodule.exports = Object.keys || function keys(O) {\n  return $keys(O, enumBugKeys);\n};\n","var dP = require('./_object-dp');\nvar anObject = require('./_an-object');\nvar getKeys = require('./_object-keys');\n\nmodule.exports = require('./_descriptors') ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var keys = getKeys(Properties);\n  var length = keys.length;\n  var i = 0;\n  var P;\n  while (length > i) dP.f(O, P = keys[i++], Properties[P]);\n  return O;\n};\n","var document = require('./_global').document;\nmodule.exports = document && document.documentElement;\n","// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\nvar anObject = require('./_an-object');\nvar dPs = require('./_object-dps');\nvar enumBugKeys = require('./_enum-bug-keys');\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\nvar Empty = function () { /* empty */ };\nvar PROTOTYPE = 'prototype';\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar createDict = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = require('./_dom-create')('iframe');\n  var i = enumBugKeys.length;\n  var lt = '<';\n  var gt = '>';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  require('./_html').appendChild(iframe);\n  iframe.src = 'javascript:'; // eslint-disable-line no-script-url\n  // createDict = iframe.contentWindow.Object;\n  // html.removeChild(iframe);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);\n  iframeDocument.close();\n  createDict = iframeDocument.F;\n  while (i--) delete createDict[PROTOTYPE][enumBugKeys[i]];\n  return createDict();\n};\n\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    Empty[PROTOTYPE] = anObject(O);\n    result = new Empty();\n    Empty[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = createDict();\n  return Properties === undefined ? result : dPs(result, Properties);\n};\n","var def = require('./_object-dp').f;\nvar has = require('./_has');\nvar TAG = require('./_wks')('toStringTag');\n\nmodule.exports = function (it, tag, stat) {\n  if (it && !has(it = stat ? it : it.prototype, TAG)) def(it, TAG, { configurable: true, value: tag });\n};\n","'use strict';\nvar create = require('./_object-create');\nvar descriptor = require('./_property-desc');\nvar setToStringTag = require('./_set-to-string-tag');\nvar IteratorPrototype = {};\n\n// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\nrequire('./_hide')(IteratorPrototype, require('./_wks')('iterator'), function () { return this; });\n\nmodule.exports = function (Constructor, NAME, next) {\n  Constructor.prototype = create(IteratorPrototype, { next: descriptor(1, next) });\n  setToStringTag(Constructor, NAME + ' Iterator');\n};\n","// 19.1.2.9 / 15.2.3.2 Object.getPrototypeOf(O)\nvar has = require('./_has');\nvar toObject = require('./_to-object');\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\nvar ObjectProto = Object.prototype;\n\nmodule.exports = Object.getPrototypeOf || function (O) {\n  O = toObject(O);\n  if (has(O, IE_PROTO)) return O[IE_PROTO];\n  if (typeof O.constructor == 'function' && O instanceof O.constructor) {\n    return O.constructor.prototype;\n  } return O instanceof Object ? ObjectProto : null;\n};\n","'use strict';\nvar LIBRARY = require('./_library');\nvar $export = require('./_export');\nvar redefine = require('./_redefine');\nvar hide = require('./_hide');\nvar Iterators = require('./_iterators');\nvar $iterCreate = require('./_iter-create');\nvar setToStringTag = require('./_set-to-string-tag');\nvar getPrototypeOf = require('./_object-gpo');\nvar ITERATOR = require('./_wks')('iterator');\nvar BUGGY = !([].keys && 'next' in [].keys()); // Safari has buggy iterators w/o `next`\nvar FF_ITERATOR = '@@iterator';\nvar KEYS = 'keys';\nvar VALUES = 'values';\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED) {\n  $iterCreate(Constructor, NAME, next);\n  var getMethod = function (kind) {\n    if (!BUGGY && kind in proto) return proto[kind];\n    switch (kind) {\n      case KEYS: return function keys() { return new Constructor(this, kind); };\n      case VALUES: return function values() { return new Constructor(this, kind); };\n    } return function entries() { return new Constructor(this, kind); };\n  };\n  var TAG = NAME + ' Iterator';\n  var DEF_VALUES = DEFAULT == VALUES;\n  var VALUES_BUG = false;\n  var proto = Base.prototype;\n  var $native = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT];\n  var $default = $native || getMethod(DEFAULT);\n  var $entries = DEFAULT ? !DEF_VALUES ? $default : getMethod('entries') : undefined;\n  var $anyNative = NAME == 'Array' ? proto.entries || $native : $native;\n  var methods, key, IteratorPrototype;\n  // Fix native\n  if ($anyNative) {\n    IteratorPrototype = getPrototypeOf($anyNative.call(new Base()));\n    if (IteratorPrototype !== Object.prototype && IteratorPrototype.next) {\n      // Set @@toStringTag to native iterators\n      setToStringTag(IteratorPrototype, TAG, true);\n      // fix for some old engines\n      if (!LIBRARY && typeof IteratorPrototype[ITERATOR] != 'function') hide(IteratorPrototype, ITERATOR, returnThis);\n    }\n  }\n  // fix Array#{values, @@iterator}.name in V8 / FF\n  if (DEF_VALUES && $native && $native.name !== VALUES) {\n    VALUES_BUG = true;\n    $default = function values() { return $native.call(this); };\n  }\n  // Define iterator\n  if ((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])) {\n    hide(proto, ITERATOR, $default);\n  }\n  // Plug for library\n  Iterators[NAME] = $default;\n  Iterators[TAG] = returnThis;\n  if (DEFAULT) {\n    methods = {\n      values: DEF_VALUES ? $default : getMethod(VALUES),\n      keys: IS_SET ? $default : getMethod(KEYS),\n      entries: $entries\n    };\n    if (FORCED) for (key in methods) {\n      if (!(key in proto)) redefine(proto, key, methods[key]);\n    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);\n  }\n  return methods;\n};\n","'use strict';\nvar addToUnscopables = require('./_add-to-unscopables');\nvar step = require('./_iter-step');\nvar Iterators = require('./_iterators');\nvar toIObject = require('./_to-iobject');\n\n// 22.1.3.4 Array.prototype.entries()\n// 22.1.3.13 Array.prototype.keys()\n// 22.1.3.29 Array.prototype.values()\n// 22.1.3.30 Array.prototype[@@iterator]()\nmodule.exports = require('./_iter-define')(Array, 'Array', function (iterated, kind) {\n  this._t = toIObject(iterated); // target\n  this._i = 0;                   // next index\n  this._k = kind;                // kind\n// 22.1.5.2.1 %ArrayIteratorPrototype%.next()\n}, function () {\n  var O = this._t;\n  var kind = this._k;\n  var index = this._i++;\n  if (!O || index >= O.length) {\n    this._t = undefined;\n    return step(1);\n  }\n  if (kind == 'keys') return step(0, index);\n  if (kind == 'values') return step(0, O[index]);\n  return step(0, [index, O[index]]);\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)\nIterators.Arguments = Iterators.Array;\n\naddToUnscopables('keys');\naddToUnscopables('values');\naddToUnscopables('entries');\n","'use strict';\nvar $export = require('./_export');\nvar createProperty = require('./_create-property');\n\n// WebKit Array.of isn't generic\n$export($export.S + $export.F * require('./_fails')(function () {\n  function F() { /* empty */ }\n  return !(Array.of.call(F) instanceof F);\n}), 'Array', {\n  // 22.1.2.3 Array.of( ...items)\n  of: function of(/* ...args */) {\n    var index = 0;\n    var aLen = arguments.length;\n    var result = new (typeof this == 'function' ? this : Array)(aLen);\n    while (aLen > index) createProperty(result, index, arguments[index++]);\n    result.length = aLen;\n    return result;\n  }\n});\n","'use strict';\nvar fails = require('./_fails');\n\nmodule.exports = function (method, arg) {\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call\n    arg ? method.call(null, function () { /* empty */ }, 1) : method.call(null);\n  });\n};\n","'use strict';\nvar $export = require('./_export');\nvar aFunction = require('./_a-function');\nvar toObject = require('./_to-object');\nvar fails = require('./_fails');\nvar $sort = [].sort;\nvar test = [1, 2, 3];\n\n$export($export.P + $export.F * (fails(function () {\n  // IE8-\n  test.sort(undefined);\n}) || !fails(function () {\n  // V8 bug\n  test.sort(null);\n  // Old WebKit\n}) || !require('./_strict-method')($sort)), 'Array', {\n  // 22.1.3.25 Array.prototype.sort(comparefn)\n  sort: function sort(comparefn) {\n    return comparefn === undefined\n      ? $sort.call(toObject(this))\n      : $sort.call(toObject(this), aFunction(comparefn));\n  }\n});\n","'use strict';\nvar global = require('./_global');\nvar dP = require('./_object-dp');\nvar DESCRIPTORS = require('./_descriptors');\nvar SPECIES = require('./_wks')('species');\n\nmodule.exports = function (KEY) {\n  var C = global[KEY];\n  if (DESCRIPTORS && C && !C[SPECIES]) dP.f(C, SPECIES, {\n    configurable: true,\n    get: function () { return this; }\n  });\n};\n","require('./_set-species')('Array');\n","'use strict';\nvar $export = require('./_export');\nvar toObject = require('./_to-object');\nvar toPrimitive = require('./_to-primitive');\n\n$export($export.P + $export.F * require('./_fails')(function () {\n  return new Date(NaN).toJSON() !== null\n    || Date.prototype.toJSON.call({ toISOString: function () { return 1; } }) !== 1;\n}), 'Date', {\n  // eslint-disable-next-line no-unused-vars\n  toJSON: function toJSON(key) {\n    var O = toObject(this);\n    var pv = toPrimitive(O);\n    return typeof pv == 'number' && !isFinite(pv) ? null : O.toISOString();\n  }\n});\n","'use strict';\nvar anObject = require('./_an-object');\nvar toPrimitive = require('./_to-primitive');\nvar NUMBER = 'number';\n\nmodule.exports = function (hint) {\n  if (hint !== 'string' && hint !== NUMBER && hint !== 'default') throw TypeError('Incorrect hint');\n  return toPrimitive(anObject(this), hint != NUMBER);\n};\n","var TO_PRIMITIVE = require('./_wks')('toPrimitive');\nvar proto = Date.prototype;\n\nif (!(TO_PRIMITIVE in proto)) require('./_hide')(proto, TO_PRIMITIVE, require('./_date-to-primitive'));\n","'use strict';\nvar isObject = require('./_is-object');\nvar getPrototypeOf = require('./_object-gpo');\nvar HAS_INSTANCE = require('./_wks')('hasInstance');\nvar FunctionProto = Function.prototype;\n// 19.2.3.6 Function.prototype[@@hasInstance](V)\nif (!(HAS_INSTANCE in FunctionProto)) require('./_object-dp').f(FunctionProto, HAS_INSTANCE, { value: function (O) {\n  if (typeof this != 'function' || !isObject(O)) return false;\n  if (!isObject(this.prototype)) return O instanceof this;\n  // for environment w/o native `@@hasInstance` logic enough `instanceof`, but add this:\n  while (O = getPrototypeOf(O)) if (this.prototype === O) return true;\n  return false;\n} });\n","var dP = require('./_object-dp').f;\nvar FProto = Function.prototype;\nvar nameRE = /^\\s*function ([^ (]*)/;\nvar NAME = 'name';\n\n// 19.2.4.2 name\nNAME in FProto || require('./_descriptors') && dP(FProto, NAME, {\n  configurable: true,\n  get: function () {\n    try {\n      return ('' + this).match(nameRE)[1];\n    } catch (e) {\n      return '';\n    }\n  }\n});\n","var redefine = require('./_redefine');\nmodule.exports = function (target, src, safe) {\n  for (var key in src) redefine(target, key, src[key], safe);\n  return target;\n};\n","module.exports = function (it, Constructor, name, forbiddenField) {\n  if (!(it instanceof Constructor) || (forbiddenField !== undefined && forbiddenField in it)) {\n    throw TypeError(name + ': incorrect invocation!');\n  } return it;\n};\n","var ctx = require('./_ctx');\nvar call = require('./_iter-call');\nvar isArrayIter = require('./_is-array-iter');\nvar anObject = require('./_an-object');\nvar toLength = require('./_to-length');\nvar getIterFn = require('./core.get-iterator-method');\nvar BREAK = {};\nvar RETURN = {};\nvar exports = module.exports = function (iterable, entries, fn, that, ITERATOR) {\n  var iterFn = ITERATOR ? function () { return iterable; } : getIterFn(iterable);\n  var f = ctx(fn, that, entries ? 2 : 1);\n  var index = 0;\n  var length, step, iterator, result;\n  if (typeof iterFn != 'function') throw TypeError(iterable + ' is not iterable!');\n  // fast case for arrays with default iterator\n  if (isArrayIter(iterFn)) for (length = toLength(iterable.length); length > index; index++) {\n    result = entries ? f(anObject(step = iterable[index])[0], step[1]) : f(iterable[index]);\n    if (result === BREAK || result === RETURN) return result;\n  } else for (iterator = iterFn.call(iterable); !(step = iterator.next()).done;) {\n    result = call(iterator, f, step.value, entries);\n    if (result === BREAK || result === RETURN) return result;\n  }\n};\nexports.BREAK = BREAK;\nexports.RETURN = RETURN;\n","var META = require('./_uid')('meta');\nvar isObject = require('./_is-object');\nvar has = require('./_has');\nvar setDesc = require('./_object-dp').f;\nvar id = 0;\nvar isExtensible = Object.isExtensible || function () {\n  return true;\n};\nvar FREEZE = !require('./_fails')(function () {\n  return isExtensible(Object.preventExtensions({}));\n});\nvar setMeta = function (it) {\n  setDesc(it, META, { value: {\n    i: 'O' + ++id, // object ID\n    w: {}          // weak collections IDs\n  } });\n};\nvar fastKey = function (it, create) {\n  // return primitive with prefix\n  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if (!has(it, META)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return 'F';\n    // not necessary to add metadata\n    if (!create) return 'E';\n    // add missing metadata\n    setMeta(it);\n  // return object ID\n  } return it[META].i;\n};\nvar getWeak = function (it, create) {\n  if (!has(it, META)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return true;\n    // not necessary to add metadata\n    if (!create) return false;\n    // add missing metadata\n    setMeta(it);\n  // return hash weak collections IDs\n  } return it[META].w;\n};\n// add metadata on freeze-family methods calling\nvar onFreeze = function (it) {\n  if (FREEZE && meta.NEED && isExtensible(it) && !has(it, META)) setMeta(it);\n  return it;\n};\nvar meta = module.exports = {\n  KEY: META,\n  NEED: false,\n  fastKey: fastKey,\n  getWeak: getWeak,\n  onFreeze: onFreeze\n};\n","var isObject = require('./_is-object');\nmodule.exports = function (it, TYPE) {\n  if (!isObject(it) || it._t !== TYPE) throw TypeError('Incompatible receiver, ' + TYPE + ' required!');\n  return it;\n};\n","'use strict';\nvar dP = require('./_object-dp').f;\nvar create = require('./_object-create');\nvar redefineAll = require('./_redefine-all');\nvar ctx = require('./_ctx');\nvar anInstance = require('./_an-instance');\nvar forOf = require('./_for-of');\nvar $iterDefine = require('./_iter-define');\nvar step = require('./_iter-step');\nvar setSpecies = require('./_set-species');\nvar DESCRIPTORS = require('./_descriptors');\nvar fastKey = require('./_meta').fastKey;\nvar validate = require('./_validate-collection');\nvar SIZE = DESCRIPTORS ? '_s' : 'size';\n\nvar getEntry = function (that, key) {\n  // fast case\n  var index = fastKey(key);\n  var entry;\n  if (index !== 'F') return that._i[index];\n  // frozen object case\n  for (entry = that._f; entry; entry = entry.n) {\n    if (entry.k == key) return entry;\n  }\n};\n\nmodule.exports = {\n  getConstructor: function (wrapper, NAME, IS_MAP, ADDER) {\n    var C = wrapper(function (that, iterable) {\n      anInstance(that, C, NAME, '_i');\n      that._t = NAME;         // collection type\n      that._i = create(null); // index\n      that._f = undefined;    // first entry\n      that._l = undefined;    // last entry\n      that[SIZE] = 0;         // size\n      if (iterable != undefined) forOf(iterable, IS_MAP, that[ADDER], that);\n    });\n    redefineAll(C.prototype, {\n      // 23.1.3.1 Map.prototype.clear()\n      // 23.2.3.2 Set.prototype.clear()\n      clear: function clear() {\n        for (var that = validate(this, NAME), data = that._i, entry = that._f; entry; entry = entry.n) {\n          entry.r = true;\n          if (entry.p) entry.p = entry.p.n = undefined;\n          delete data[entry.i];\n        }\n        that._f = that._l = undefined;\n        that[SIZE] = 0;\n      },\n      // 23.1.3.3 Map.prototype.delete(key)\n      // 23.2.3.4 Set.prototype.delete(value)\n      'delete': function (key) {\n        var that = validate(this, NAME);\n        var entry = getEntry(that, key);\n        if (entry) {\n          var next = entry.n;\n          var prev = entry.p;\n          delete that._i[entry.i];\n          entry.r = true;\n          if (prev) prev.n = next;\n          if (next) next.p = prev;\n          if (that._f == entry) that._f = next;\n          if (that._l == entry) that._l = prev;\n          that[SIZE]--;\n        } return !!entry;\n      },\n      // 23.2.3.6 Set.prototype.forEach(callbackfn, thisArg = undefined)\n      // 23.1.3.5 Map.prototype.forEach(callbackfn, thisArg = undefined)\n      forEach: function forEach(callbackfn /* , that = undefined */) {\n        validate(this, NAME);\n        var f = ctx(callbackfn, arguments.length > 1 ? arguments[1] : undefined, 3);\n        var entry;\n        while (entry = entry ? entry.n : this._f) {\n          f(entry.v, entry.k, this);\n          // revert to the last existing entry\n          while (entry && entry.r) entry = entry.p;\n        }\n      },\n      // 23.1.3.7 Map.prototype.has(key)\n      // 23.2.3.7 Set.prototype.has(value)\n      has: function has(key) {\n        return !!getEntry(validate(this, NAME), key);\n      }\n    });\n    if (DESCRIPTORS) dP(C.prototype, 'size', {\n      get: function () {\n        return validate(this, NAME)[SIZE];\n      }\n    });\n    return C;\n  },\n  def: function (that, key, value) {\n    var entry = getEntry(that, key);\n    var prev, index;\n    // change existing entry\n    if (entry) {\n      entry.v = value;\n    // create new entry\n    } else {\n      that._l = entry = {\n        i: index = fastKey(key, true), // <- index\n        k: key,                        // <- key\n        v: value,                      // <- value\n        p: prev = that._l,             // <- previous entry\n        n: undefined,                  // <- next entry\n        r: false                       // <- removed\n      };\n      if (!that._f) that._f = entry;\n      if (prev) prev.n = entry;\n      that[SIZE]++;\n      // add to index\n      if (index !== 'F') that._i[index] = entry;\n    } return that;\n  },\n  getEntry: getEntry,\n  setStrong: function (C, NAME, IS_MAP) {\n    // add .keys, .values, .entries, [@@iterator]\n    // 23.1.3.4, 23.1.3.8, 23.1.3.11, 23.1.3.12, 23.2.3.5, 23.2.3.8, 23.2.3.10, 23.2.3.11\n    $iterDefine(C, NAME, function (iterated, kind) {\n      this._t = validate(iterated, NAME); // target\n      this._k = kind;                     // kind\n      this._l = undefined;                // previous\n    }, function () {\n      var that = this;\n      var kind = that._k;\n      var entry = that._l;\n      // revert to the last existing entry\n      while (entry && entry.r) entry = entry.p;\n      // get next entry\n      if (!that._t || !(that._l = entry = entry ? entry.n : that._t._f)) {\n        // or finish the iteration\n        that._t = undefined;\n        return step(1);\n      }\n      // return step by kind\n      if (kind == 'keys') return step(0, entry.k);\n      if (kind == 'values') return step(0, entry.v);\n      return step(0, [entry.k, entry.v]);\n    }, IS_MAP ? 'entries' : 'values', !IS_MAP, true);\n\n    // add [@@species], 23.1.2.2, 23.2.2.2\n    setSpecies(NAME);\n  }\n};\n","exports.f = {}.propertyIsEnumerable;\n","var pIE = require('./_object-pie');\nvar createDesc = require('./_property-desc');\nvar toIObject = require('./_to-iobject');\nvar toPrimitive = require('./_to-primitive');\nvar has = require('./_has');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar gOPD = Object.getOwnPropertyDescriptor;\n\nexports.f = require('./_descriptors') ? gOPD : function getOwnPropertyDescriptor(O, P) {\n  O = toIObject(O);\n  P = toPrimitive(P, true);\n  if (IE8_DOM_DEFINE) try {\n    return gOPD(O, P);\n  } catch (e) { /* empty */ }\n  if (has(O, P)) return createDesc(!pIE.f.call(O, P), O[P]);\n};\n","// Works with __proto__ only. Old v8 can't work with null proto objects.\n/* eslint-disable no-proto */\nvar isObject = require('./_is-object');\nvar anObject = require('./_an-object');\nvar check = function (O, proto) {\n  anObject(O);\n  if (!isObject(proto) && proto !== null) throw TypeError(proto + \": can't set as prototype!\");\n};\nmodule.exports = {\n  set: Object.setPrototypeOf || ('__proto__' in {} ? // eslint-disable-line\n    function (test, buggy, set) {\n      try {\n        set = require('./_ctx')(Function.call, require('./_object-gopd').f(Object.prototype, '__proto__').set, 2);\n        set(test, []);\n        buggy = !(test instanceof Array);\n      } catch (e) { buggy = true; }\n      return function setPrototypeOf(O, proto) {\n        check(O, proto);\n        if (buggy) O.__proto__ = proto;\n        else set(O, proto);\n        return O;\n      };\n    }({}, false) : undefined),\n  check: check\n};\n","var isObject = require('./_is-object');\nvar setPrototypeOf = require('./_set-proto').set;\nmodule.exports = function (that, target, C) {\n  var S = target.constructor;\n  var P;\n  if (S !== C && typeof S == 'function' && (P = S.prototype) !== C.prototype && isObject(P) && setPrototypeOf) {\n    setPrototypeOf(that, P);\n  } return that;\n};\n","'use strict';\nvar global = require('./_global');\nvar $export = require('./_export');\nvar redefine = require('./_redefine');\nvar redefineAll = require('./_redefine-all');\nvar meta = require('./_meta');\nvar forOf = require('./_for-of');\nvar anInstance = require('./_an-instance');\nvar isObject = require('./_is-object');\nvar fails = require('./_fails');\nvar $iterDetect = require('./_iter-detect');\nvar setToStringTag = require('./_set-to-string-tag');\nvar inheritIfRequired = require('./_inherit-if-required');\n\nmodule.exports = function (NAME, wrapper, methods, common, IS_MAP, IS_WEAK) {\n  var Base = global[NAME];\n  var C = Base;\n  var ADDER = IS_MAP ? 'set' : 'add';\n  var proto = C && C.prototype;\n  var O = {};\n  var fixMethod = function (KEY) {\n    var fn = proto[KEY];\n    redefine(proto, KEY,\n      KEY == 'delete' ? function (a) {\n        return IS_WEAK && !isObject(a) ? false : fn.call(this, a === 0 ? 0 : a);\n      } : KEY == 'has' ? function has(a) {\n        return IS_WEAK && !isObject(a) ? false : fn.call(this, a === 0 ? 0 : a);\n      } : KEY == 'get' ? function get(a) {\n        return IS_WEAK && !isObject(a) ? undefined : fn.call(this, a === 0 ? 0 : a);\n      } : KEY == 'add' ? function add(a) { fn.call(this, a === 0 ? 0 : a); return this; }\n        : function set(a, b) { fn.call(this, a === 0 ? 0 : a, b); return this; }\n    );\n  };\n  if (typeof C != 'function' || !(IS_WEAK || proto.forEach && !fails(function () {\n    new C().entries().next();\n  }))) {\n    // create collection constructor\n    C = common.getConstructor(wrapper, NAME, IS_MAP, ADDER);\n    redefineAll(C.prototype, methods);\n    meta.NEED = true;\n  } else {\n    var instance = new C();\n    // early implementations not supports chaining\n    var HASNT_CHAINING = instance[ADDER](IS_WEAK ? {} : -0, 1) != instance;\n    // V8 ~  Chromium 40- weak-collections throws on primitives, but should return false\n    var THROWS_ON_PRIMITIVES = fails(function () { instance.has(1); });\n    // most early implementations doesn't supports iterables, most modern - not close it correctly\n    var ACCEPT_ITERABLES = $iterDetect(function (iter) { new C(iter); }); // eslint-disable-line no-new\n    // for early implementations -0 and +0 not the same\n    var BUGGY_ZERO = !IS_WEAK && fails(function () {\n      // V8 ~ Chromium 42- fails only with 5+ elements\n      var $instance = new C();\n      var index = 5;\n      while (index--) $instance[ADDER](index, index);\n      return !$instance.has(-0);\n    });\n    if (!ACCEPT_ITERABLES) {\n      C = wrapper(function (target, iterable) {\n        anInstance(target, C, NAME);\n        var that = inheritIfRequired(new Base(), target, C);\n        if (iterable != undefined) forOf(iterable, IS_MAP, that[ADDER], that);\n        return that;\n      });\n      C.prototype = proto;\n      proto.constructor = C;\n    }\n    if (THROWS_ON_PRIMITIVES || BUGGY_ZERO) {\n      fixMethod('delete');\n      fixMethod('has');\n      IS_MAP && fixMethod('get');\n    }\n    if (BUGGY_ZERO || HASNT_CHAINING) fixMethod(ADDER);\n    // weak collections should not contains .clear method\n    if (IS_WEAK && proto.clear) delete proto.clear;\n  }\n\n  setToStringTag(C, NAME);\n\n  O[NAME] = C;\n  $export($export.G + $export.W + $export.F * (C != Base), O);\n\n  if (!IS_WEAK) common.setStrong(C, NAME, IS_MAP);\n\n  return C;\n};\n","'use strict';\nvar strong = require('./_collection-strong');\nvar validate = require('./_validate-collection');\nvar MAP = 'Map';\n\n// 23.1 Map Objects\nmodule.exports = require('./_collection')(MAP, function (get) {\n  return function Map() { return get(this, arguments.length > 0 ? arguments[0] : undefined); };\n}, {\n  // 23.1.3.6 Map.prototype.get(key)\n  get: function get(key) {\n    var entry = strong.getEntry(validate(this, MAP), key);\n    return entry && entry.v;\n  },\n  // 23.1.3.9 Map.prototype.set(key, value)\n  set: function set(key, value) {\n    return strong.def(validate(this, MAP), key === 0 ? 0 : key, value);\n  }\n}, strong, true);\n","// 20.2.2.20 Math.log1p(x)\nmodule.exports = Math.log1p || function log1p(x) {\n  return (x = +x) > -1e-8 && x < 1e-8 ? x - x * x / 2 : Math.log(1 + x);\n};\n","// 20.2.2.3 Math.acosh(x)\nvar $export = require('./_export');\nvar log1p = require('./_math-log1p');\nvar sqrt = Math.sqrt;\nvar $acosh = Math.acosh;\n\n$export($export.S + $export.F * !($acosh\n  // V8 bug: https://code.google.com/p/v8/issues/detail?id=3509\n  && Math.floor($acosh(Number.MAX_VALUE)) == 710\n  // Tor Browser bug: Math.acosh(Infinity) -> NaN\n  && $acosh(Infinity) == Infinity\n), 'Math', {\n  acosh: function acosh(x) {\n    return (x = +x) < 1 ? NaN : x > 94906265.62425156\n      ? Math.log(x) + Math.LN2\n      : log1p(x - 1 + sqrt(x - 1) * sqrt(x + 1));\n  }\n});\n","// 20.2.2.5 Math.asinh(x)\nvar $export = require('./_export');\nvar $asinh = Math.asinh;\n\nfunction asinh(x) {\n  return !isFinite(x = +x) || x == 0 ? x : x < 0 ? -asinh(-x) : Math.log(x + Math.sqrt(x * x + 1));\n}\n\n// Tor Browser bug: Math.asinh(0) -> -0\n$export($export.S + $export.F * !($asinh && 1 / $asinh(0) > 0), 'Math', { asinh: asinh });\n","// 20.2.2.7 Math.atanh(x)\nvar $export = require('./_export');\nvar $atanh = Math.atanh;\n\n// Tor Browser bug: Math.atanh(-0) -> 0\n$export($export.S + $export.F * !($atanh && 1 / $atanh(-0) < 0), 'Math', {\n  atanh: function atanh(x) {\n    return (x = +x) == 0 ? x : Math.log((1 + x) / (1 - x)) / 2;\n  }\n});\n","// 20.2.2.28 Math.sign(x)\nmodule.exports = Math.sign || function sign(x) {\n  // eslint-disable-next-line no-self-compare\n  return (x = +x) == 0 || x != x ? x : x < 0 ? -1 : 1;\n};\n","// 20.2.2.9 Math.cbrt(x)\nvar $export = require('./_export');\nvar sign = require('./_math-sign');\n\n$export($export.S, 'Math', {\n  cbrt: function cbrt(x) {\n    return sign(x = +x) * Math.pow(Math.abs(x), 1 / 3);\n  }\n});\n","// 20.2.2.11 Math.clz32(x)\nvar $export = require('./_export');\n\n$export($export.S, 'Math', {\n  clz32: function clz32(x) {\n    return (x >>>= 0) ? 31 - Math.floor(Math.log(x + 0.5) * Math.LOG2E) : 32;\n  }\n});\n","// 20.2.2.12 Math.cosh(x)\nvar $export = require('./_export');\nvar exp = Math.exp;\n\n$export($export.S, 'Math', {\n  cosh: function cosh(x) {\n    return (exp(x = +x) + exp(-x)) / 2;\n  }\n});\n","// 20.2.2.14 Math.expm1(x)\nvar $expm1 = Math.expm1;\nmodule.exports = (!$expm1\n  // Old FF bug\n  || $expm1(10) > 22025.465794806719 || $expm1(10) < 22025.4657948067165168\n  // Tor Browser bug\n  || $expm1(-2e-17) != -2e-17\n) ? function expm1(x) {\n  return (x = +x) == 0 ? x : x > -1e-6 && x < 1e-6 ? x + x * x / 2 : Math.exp(x) - 1;\n} : $expm1;\n","// 20.2.2.14 Math.expm1(x)\nvar $export = require('./_export');\nvar $expm1 = require('./_math-expm1');\n\n$export($export.S + $export.F * ($expm1 != Math.expm1), 'Math', { expm1: $expm1 });\n","// 20.2.2.16 Math.fround(x)\nvar sign = require('./_math-sign');\nvar pow = Math.pow;\nvar EPSILON = pow(2, -52);\nvar EPSILON32 = pow(2, -23);\nvar MAX32 = pow(2, 127) * (2 - EPSILON32);\nvar MIN32 = pow(2, -126);\n\nvar roundTiesToEven = function (n) {\n  return n + 1 / EPSILON - 1 / EPSILON;\n};\n\nmodule.exports = Math.fround || function fround(x) {\n  var $abs = Math.abs(x);\n  var $sign = sign(x);\n  var a, result;\n  if ($abs < MIN32) return $sign * roundTiesToEven($abs / MIN32 / EPSILON32) * MIN32 * EPSILON32;\n  a = (1 + EPSILON32 / EPSILON) * $abs;\n  result = a - (a - $abs);\n  // eslint-disable-next-line no-self-compare\n  if (result > MAX32 || result != result) return $sign * Infinity;\n  return $sign * result;\n};\n","// 20.2.2.16 Math.fround(x)\nvar $export = require('./_export');\n\n$export($export.S, 'Math', { fround: require('./_math-fround') });\n","// 20.2.2.17 Math.hypot([value1[, value2[,  ]]])\nvar $export = require('./_export');\nvar abs = Math.abs;\n\n$export($export.S, 'Math', {\n  hypot: function hypot(value1, value2) { // eslint-disable-line no-unused-vars\n    var sum = 0;\n    var i = 0;\n    var aLen = arguments.length;\n    var larg = 0;\n    var arg, div;\n    while (i < aLen) {\n      arg = abs(arguments[i++]);\n      if (larg < arg) {\n        div = larg / arg;\n        sum = sum * div * div + 1;\n        larg = arg;\n      } else if (arg > 0) {\n        div = arg / larg;\n        sum += div * div;\n      } else sum += arg;\n    }\n    return larg === Infinity ? Infinity : larg * Math.sqrt(sum);\n  }\n});\n","// 20.2.2.18 Math.imul(x, y)\nvar $export = require('./_export');\nvar $imul = Math.imul;\n\n// some WebKit versions fails with big numbers, some has wrong arity\n$export($export.S + $export.F * require('./_fails')(function () {\n  return $imul(0xffffffff, 5) != -5 || $imul.length != 2;\n}), 'Math', {\n  imul: function imul(x, y) {\n    var UINT16 = 0xffff;\n    var xn = +x;\n    var yn = +y;\n    var xl = UINT16 & xn;\n    var yl = UINT16 & yn;\n    return 0 | xl * yl + ((UINT16 & xn >>> 16) * yl + xl * (UINT16 & yn >>> 16) << 16 >>> 0);\n  }\n});\n","// 20.2.2.20 Math.log1p(x)\nvar $export = require('./_export');\n\n$export($export.S, 'Math', { log1p: require('./_math-log1p') });\n","// 20.2.2.21 Math.log10(x)\nvar $export = require('./_export');\n\n$export($export.S, 'Math', {\n  log10: function log10(x) {\n    return Math.log(x) * Math.LOG10E;\n  }\n});\n","// 20.2.2.22 Math.log2(x)\nvar $export = require('./_export');\n\n$export($export.S, 'Math', {\n  log2: function log2(x) {\n    return Math.log(x) / Math.LN2;\n  }\n});\n","// 20.2.2.28 Math.sign(x)\nvar $export = require('./_export');\n\n$export($export.S, 'Math', { sign: require('./_math-sign') });\n","// 20.2.2.30 Math.sinh(x)\nvar $export = require('./_export');\nvar expm1 = require('./_math-expm1');\nvar exp = Math.exp;\n\n// V8 near Chromium 38 has a problem with very small numbers\n$export($export.S + $export.F * require('./_fails')(function () {\n  return !Math.sinh(-2e-17) != -2e-17;\n}), 'Math', {\n  sinh: function sinh(x) {\n    return Math.abs(x = +x) < 1\n      ? (expm1(x) - expm1(-x)) / 2\n      : (exp(x - 1) - exp(-x - 1)) * (Math.E / 2);\n  }\n});\n","// 20.2.2.33 Math.tanh(x)\nvar $export = require('./_export');\nvar expm1 = require('./_math-expm1');\nvar exp = Math.exp;\n\n$export($export.S, 'Math', {\n  tanh: function tanh(x) {\n    var a = expm1(x = +x);\n    var b = expm1(-x);\n    return a == Infinity ? 1 : b == Infinity ? -1 : (a - b) / (exp(x) + exp(-x));\n  }\n});\n","// 20.2.2.34 Math.trunc(x)\nvar $export = require('./_export');\n\n$export($export.S, 'Math', {\n  trunc: function trunc(it) {\n    return (it > 0 ? Math.floor : Math.ceil)(it);\n  }\n});\n","// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)\nvar $keys = require('./_object-keys-internal');\nvar hiddenKeys = require('./_enum-bug-keys').concat('length', 'prototype');\n\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return $keys(O, hiddenKeys);\n};\n","module.exports = '\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003' +\n  '\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF';\n","var $export = require('./_export');\nvar defined = require('./_defined');\nvar fails = require('./_fails');\nvar spaces = require('./_string-ws');\nvar space = '[' + spaces + ']';\nvar non = '\\u200b\\u0085';\nvar ltrim = RegExp('^' + space + space + '*');\nvar rtrim = RegExp(space + space + '*$');\n\nvar exporter = function (KEY, exec, ALIAS) {\n  var exp = {};\n  var FORCE = fails(function () {\n    return !!spaces[KEY]() || non[KEY]() != non;\n  });\n  var fn = exp[KEY] = FORCE ? exec(trim) : spaces[KEY];\n  if (ALIAS) exp[ALIAS] = fn;\n  $export($export.P + $export.F * FORCE, 'String', exp);\n};\n\n// 1 -> String#trimLeft\n// 2 -> String#trimRight\n// 3 -> String#trim\nvar trim = exporter.trim = function (string, TYPE) {\n  string = String(defined(string));\n  if (TYPE & 1) string = string.replace(ltrim, '');\n  if (TYPE & 2) string = string.replace(rtrim, '');\n  return string;\n};\n\nmodule.exports = exporter;\n","'use strict';\nvar global = require('./_global');\nvar has = require('./_has');\nvar cof = require('./_cof');\nvar inheritIfRequired = require('./_inherit-if-required');\nvar toPrimitive = require('./_to-primitive');\nvar fails = require('./_fails');\nvar gOPN = require('./_object-gopn').f;\nvar gOPD = require('./_object-gopd').f;\nvar dP = require('./_object-dp').f;\nvar $trim = require('./_string-trim').trim;\nvar NUMBER = 'Number';\nvar $Number = global[NUMBER];\nvar Base = $Number;\nvar proto = $Number.prototype;\n// Opera ~12 has broken Object#toString\nvar BROKEN_COF = cof(require('./_object-create')(proto)) == NUMBER;\nvar TRIM = 'trim' in String.prototype;\n\n// 7.1.3 ToNumber(argument)\nvar toNumber = function (argument) {\n  var it = toPrimitive(argument, false);\n  if (typeof it == 'string' && it.length > 2) {\n    it = TRIM ? it.trim() : $trim(it, 3);\n    var first = it.charCodeAt(0);\n    var third, radix, maxCode;\n    if (first === 43 || first === 45) {\n      third = it.charCodeAt(2);\n      if (third === 88 || third === 120) return NaN; // Number('+0x1') should be NaN, old V8 fix\n    } else if (first === 48) {\n      switch (it.charCodeAt(1)) {\n        case 66: case 98: radix = 2; maxCode = 49; break; // fast equal /^0b[01]+$/i\n        case 79: case 111: radix = 8; maxCode = 55; break; // fast equal /^0o[0-7]+$/i\n        default: return +it;\n      }\n      for (var digits = it.slice(2), i = 0, l = digits.length, code; i < l; i++) {\n        code = digits.charCodeAt(i);\n        // parseInt parses a string to a first unavailable symbol\n        // but ToNumber should return NaN if a string contains unavailable symbols\n        if (code < 48 || code > maxCode) return NaN;\n      } return parseInt(digits, radix);\n    }\n  } return +it;\n};\n\nif (!$Number(' 0o1') || !$Number('0b1') || $Number('+0x1')) {\n  $Number = function Number(value) {\n    var it = arguments.length < 1 ? 0 : value;\n    var that = this;\n    return that instanceof $Number\n      // check on 1..constructor(foo) case\n      && (BROKEN_COF ? fails(function () { proto.valueOf.call(that); }) : cof(that) != NUMBER)\n        ? inheritIfRequired(new Base(toNumber(it)), that, $Number) : toNumber(it);\n  };\n  for (var keys = require('./_descriptors') ? gOPN(Base) : (\n    // ES3:\n    'MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,' +\n    // ES6 (in case, if modules with ES6 Number statics required before):\n    'EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,' +\n    'MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger'\n  ).split(','), j = 0, key; keys.length > j; j++) {\n    if (has(Base, key = keys[j]) && !has($Number, key)) {\n      dP($Number, key, gOPD(Base, key));\n    }\n  }\n  $Number.prototype = proto;\n  proto.constructor = $Number;\n  require('./_redefine')(global, NUMBER, $Number);\n}\n","// 20.1.2.1 Number.EPSILON\nvar $export = require('./_export');\n\n$export($export.S, 'Number', { EPSILON: Math.pow(2, -52) });\n","// 20.1.2.2 Number.isFinite(number)\nvar $export = require('./_export');\nvar _isFinite = require('./_global').isFinite;\n\n$export($export.S, 'Number', {\n  isFinite: function isFinite(it) {\n    return typeof it == 'number' && _isFinite(it);\n  }\n});\n","// 20.1.2.3 Number.isInteger(number)\nvar isObject = require('./_is-object');\nvar floor = Math.floor;\nmodule.exports = function isInteger(it) {\n  return !isObject(it) && isFinite(it) && floor(it) === it;\n};\n","// 20.1.2.3 Number.isInteger(number)\nvar $export = require('./_export');\n\n$export($export.S, 'Number', { isInteger: require('./_is-integer') });\n","// 20.1.2.4 Number.isNaN(number)\nvar $export = require('./_export');\n\n$export($export.S, 'Number', {\n  isNaN: function isNaN(number) {\n    // eslint-disable-next-line no-self-compare\n    return number != number;\n  }\n});\n","// 20.1.2.5 Number.isSafeInteger(number)\nvar $export = require('./_export');\nvar isInteger = require('./_is-integer');\nvar abs = Math.abs;\n\n$export($export.S, 'Number', {\n  isSafeInteger: function isSafeInteger(number) {\n    return isInteger(number) && abs(number) <= 0x1fffffffffffff;\n  }\n});\n","// 20.1.2.6 Number.MAX_SAFE_INTEGER\nvar $export = require('./_export');\n\n$export($export.S, 'Number', { MAX_SAFE_INTEGER: 0x1fffffffffffff });\n","// 20.1.2.10 Number.MIN_SAFE_INTEGER\nvar $export = require('./_export');\n\n$export($export.S, 'Number', { MIN_SAFE_INTEGER: -0x1fffffffffffff });\n","var $parseFloat = require('./_global').parseFloat;\nvar $trim = require('./_string-trim').trim;\n\nmodule.exports = 1 / $parseFloat(require('./_string-ws') + '-0') !== -Infinity ? function parseFloat(str) {\n  var string = $trim(String(str), 3);\n  var result = $parseFloat(string);\n  return result === 0 && string.charAt(0) == '-' ? -0 : result;\n} : $parseFloat;\n","var $export = require('./_export');\nvar $parseFloat = require('./_parse-float');\n// 20.1.2.12 Number.parseFloat(string)\n$export($export.S + $export.F * (Number.parseFloat != $parseFloat), 'Number', { parseFloat: $parseFloat });\n","var $parseInt = require('./_global').parseInt;\nvar $trim = require('./_string-trim').trim;\nvar ws = require('./_string-ws');\nvar hex = /^[-+]?0[xX]/;\n\nmodule.exports = $parseInt(ws + '08') !== 8 || $parseInt(ws + '0x16') !== 22 ? function parseInt(str, radix) {\n  var string = $trim(String(str), 3);\n  return $parseInt(string, (radix >>> 0) || (hex.test(string) ? 16 : 10));\n} : $parseInt;\n","var $export = require('./_export');\nvar $parseInt = require('./_parse-int');\n// 20.1.2.13 Number.parseInt(string, radix)\n$export($export.S + $export.F * (Number.parseInt != $parseInt), 'Number', { parseInt: $parseInt });\n","exports.f = Object.getOwnPropertySymbols;\n","'use strict';\n// 19.1.2.1 Object.assign(target, source, ...)\nvar DESCRIPTORS = require('./_descriptors');\nvar getKeys = require('./_object-keys');\nvar gOPS = require('./_object-gops');\nvar pIE = require('./_object-pie');\nvar toObject = require('./_to-object');\nvar IObject = require('./_iobject');\nvar $assign = Object.assign;\n\n// should work with symbols and should have deterministic property order (V8 bug)\nmodule.exports = !$assign || require('./_fails')(function () {\n  var A = {};\n  var B = {};\n  // eslint-disable-next-line no-undef\n  var S = Symbol();\n  var K = 'abcdefghijklmnopqrst';\n  A[S] = 7;\n  K.split('').forEach(function (k) { B[k] = k; });\n  return $assign({}, A)[S] != 7 || Object.keys($assign({}, B)).join('') != K;\n}) ? function assign(target, source) { // eslint-disable-line no-unused-vars\n  var T = toObject(target);\n  var aLen = arguments.length;\n  var index = 1;\n  var getSymbols = gOPS.f;\n  var isEnum = pIE.f;\n  while (aLen > index) {\n    var S = IObject(arguments[index++]);\n    var keys = getSymbols ? getKeys(S).concat(getSymbols(S)) : getKeys(S);\n    var length = keys.length;\n    var j = 0;\n    var key;\n    while (length > j) {\n      key = keys[j++];\n      if (!DESCRIPTORS || isEnum.call(S, key)) T[key] = S[key];\n    }\n  } return T;\n} : $assign;\n","// 19.1.3.1 Object.assign(target, source)\nvar $export = require('./_export');\n\n$export($export.S + $export.F, 'Object', { assign: require('./_object-assign') });\n","'use strict';\n// Forced replacement prototype accessors methods\nmodule.exports = require('./_library') || !require('./_fails')(function () {\n  var K = Math.random();\n  // In FF throws only define methods\n  // eslint-disable-next-line no-undef, no-useless-call\n  __defineSetter__.call(null, K, function () { /* empty */ });\n  delete require('./_global')[K];\n});\n","'use strict';\nvar $export = require('./_export');\nvar toObject = require('./_to-object');\nvar aFunction = require('./_a-function');\nvar $defineProperty = require('./_object-dp');\n\n// B.2.2.2 Object.prototype.__defineGetter__(P, getter)\nrequire('./_descriptors') && $export($export.P + require('./_object-forced-pam'), 'Object', {\n  __defineGetter__: function __defineGetter__(P, getter) {\n    $defineProperty.f(toObject(this), P, { get: aFunction(getter), enumerable: true, configurable: true });\n  }\n});\n","'use strict';\nvar $export = require('./_export');\nvar toObject = require('./_to-object');\nvar aFunction = require('./_a-function');\nvar $defineProperty = require('./_object-dp');\n\n// B.2.2.3 Object.prototype.__defineSetter__(P, setter)\nrequire('./_descriptors') && $export($export.P + require('./_object-forced-pam'), 'Object', {\n  __defineSetter__: function __defineSetter__(P, setter) {\n    $defineProperty.f(toObject(this), P, { set: aFunction(setter), enumerable: true, configurable: true });\n  }\n});\n","var DESCRIPTORS = require('./_descriptors');\nvar getKeys = require('./_object-keys');\nvar toIObject = require('./_to-iobject');\nvar isEnum = require('./_object-pie').f;\nmodule.exports = function (isEntries) {\n  return function (it) {\n    var O = toIObject(it);\n    var keys = getKeys(O);\n    var length = keys.length;\n    var i = 0;\n    var result = [];\n    var key;\n    while (length > i) {\n      key = keys[i++];\n      if (!DESCRIPTORS || isEnum.call(O, key)) {\n        result.push(isEntries ? [key, O[key]] : O[key]);\n      }\n    }\n    return result;\n  };\n};\n","// https://github.com/tc39/proposal-object-values-entries\nvar $export = require('./_export');\nvar $entries = require('./_object-to-array')(true);\n\n$export($export.S, 'Object', {\n  entries: function entries(it) {\n    return $entries(it);\n  }\n});\n","// most Object methods by ES6 should accept primitives\nvar $export = require('./_export');\nvar core = require('./_core');\nvar fails = require('./_fails');\nmodule.exports = function (KEY, exec) {\n  var fn = (core.Object || {})[KEY] || Object[KEY];\n  var exp = {};\n  exp[KEY] = exec(fn);\n  $export($export.S + $export.F * fails(function () { fn(1); }), 'Object', exp);\n};\n","// 19.1.2.5 Object.freeze(O)\nvar isObject = require('./_is-object');\nvar meta = require('./_meta').onFreeze;\n\nrequire('./_object-sap')('freeze', function ($freeze) {\n  return function freeze(it) {\n    return $freeze && isObject(it) ? $freeze(meta(it)) : it;\n  };\n});\n","// 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\nvar toIObject = require('./_to-iobject');\nvar $getOwnPropertyDescriptor = require('./_object-gopd').f;\n\nrequire('./_object-sap')('getOwnPropertyDescriptor', function () {\n  return function getOwnPropertyDescriptor(it, key) {\n    return $getOwnPropertyDescriptor(toIObject(it), key);\n  };\n});\n","// all object keys, includes non-enumerable and symbols\nvar gOPN = require('./_object-gopn');\nvar gOPS = require('./_object-gops');\nvar anObject = require('./_an-object');\nvar Reflect = require('./_global').Reflect;\nmodule.exports = Reflect && Reflect.ownKeys || function ownKeys(it) {\n  var keys = gOPN.f(anObject(it));\n  var getSymbols = gOPS.f;\n  return getSymbols ? keys.concat(getSymbols(it)) : keys;\n};\n","// https://github.com/tc39/proposal-object-getownpropertydescriptors\nvar $export = require('./_export');\nvar ownKeys = require('./_own-keys');\nvar toIObject = require('./_to-iobject');\nvar gOPD = require('./_object-gopd');\nvar createProperty = require('./_create-property');\n\n$export($export.S, 'Object', {\n  getOwnPropertyDescriptors: function getOwnPropertyDescriptors(object) {\n    var O = toIObject(object);\n    var getDesc = gOPD.f;\n    var keys = ownKeys(O);\n    var result = {};\n    var i = 0;\n    var key, desc;\n    while (keys.length > i) {\n      desc = getDesc(O, key = keys[i++]);\n      if (desc !== undefined) createProperty(result, key, desc);\n    }\n    return result;\n  }\n});\n","// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window\nvar toIObject = require('./_to-iobject');\nvar gOPN = require('./_object-gopn').f;\nvar toString = {}.toString;\n\nvar windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames\n  ? Object.getOwnPropertyNames(window) : [];\n\nvar getWindowNames = function (it) {\n  try {\n    return gOPN(it);\n  } catch (e) {\n    return windowNames.slice();\n  }\n};\n\nmodule.exports.f = function getOwnPropertyNames(it) {\n  return windowNames && toString.call(it) == '[object Window]' ? getWindowNames(it) : gOPN(toIObject(it));\n};\n","// 19.1.2.7 Object.getOwnPropertyNames(O)\nrequire('./_object-sap')('getOwnPropertyNames', function () {\n  return require('./_object-gopn-ext').f;\n});\n","// 19.1.2.9 Object.getPrototypeOf(O)\nvar toObject = require('./_to-object');\nvar $getPrototypeOf = require('./_object-gpo');\n\nrequire('./_object-sap')('getPrototypeOf', function () {\n  return function getPrototypeOf(it) {\n    return $getPrototypeOf(toObject(it));\n  };\n});\n","'use strict';\nvar $export = require('./_export');\nvar toObject = require('./_to-object');\nvar toPrimitive = require('./_to-primitive');\nvar getPrototypeOf = require('./_object-gpo');\nvar getOwnPropertyDescriptor = require('./_object-gopd').f;\n\n// B.2.2.4 Object.prototype.__lookupGetter__(P)\nrequire('./_descriptors') && $export($export.P + require('./_object-forced-pam'), 'Object', {\n  __lookupGetter__: function __lookupGetter__(P) {\n    var O = toObject(this);\n    var K = toPrimitive(P, true);\n    var D;\n    do {\n      if (D = getOwnPropertyDescriptor(O, K)) return D.get;\n    } while (O = getPrototypeOf(O));\n  }\n});\n","'use strict';\nvar $export = require('./_export');\nvar toObject = require('./_to-object');\nvar toPrimitive = require('./_to-primitive');\nvar getPrototypeOf = require('./_object-gpo');\nvar getOwnPropertyDescriptor = require('./_object-gopd').f;\n\n// B.2.2.5 Object.prototype.__lookupSetter__(P)\nrequire('./_descriptors') && $export($export.P + require('./_object-forced-pam'), 'Object', {\n  __lookupSetter__: function __lookupSetter__(P) {\n    var O = toObject(this);\n    var K = toPrimitive(P, true);\n    var D;\n    do {\n      if (D = getOwnPropertyDescriptor(O, K)) return D.set;\n    } while (O = getPrototypeOf(O));\n  }\n});\n","// 19.1.2.15 Object.preventExtensions(O)\nvar isObject = require('./_is-object');\nvar meta = require('./_meta').onFreeze;\n\nrequire('./_object-sap')('preventExtensions', function ($preventExtensions) {\n  return function preventExtensions(it) {\n    return $preventExtensions && isObject(it) ? $preventExtensions(meta(it)) : it;\n  };\n});\n","// 7.2.9 SameValue(x, y)\nmodule.exports = Object.is || function is(x, y) {\n  // eslint-disable-next-line no-self-compare\n  return x === y ? x !== 0 || 1 / x === 1 / y : x != x && y != y;\n};\n","// 19.1.3.10 Object.is(value1, value2)\nvar $export = require('./_export');\n$export($export.S, 'Object', { is: require('./_same-value') });\n","// 19.1.2.12 Object.isFrozen(O)\nvar isObject = require('./_is-object');\n\nrequire('./_object-sap')('isFrozen', function ($isFrozen) {\n  return function isFrozen(it) {\n    return isObject(it) ? $isFrozen ? $isFrozen(it) : false : true;\n  };\n});\n","// 19.1.2.13 Object.isSealed(O)\nvar isObject = require('./_is-object');\n\nrequire('./_object-sap')('isSealed', function ($isSealed) {\n  return function isSealed(it) {\n    return isObject(it) ? $isSealed ? $isSealed(it) : false : true;\n  };\n});\n","// 19.1.2.11 Object.isExtensible(O)\nvar isObject = require('./_is-object');\n\nrequire('./_object-sap')('isExtensible', function ($isExtensible) {\n  return function isExtensible(it) {\n    return isObject(it) ? $isExtensible ? $isExtensible(it) : true : false;\n  };\n});\n","// 19.1.2.14 Object.keys(O)\nvar toObject = require('./_to-object');\nvar $keys = require('./_object-keys');\n\nrequire('./_object-sap')('keys', function () {\n  return function keys(it) {\n    return $keys(toObject(it));\n  };\n});\n","// 19.1.2.17 Object.seal(O)\nvar isObject = require('./_is-object');\nvar meta = require('./_meta').onFreeze;\n\nrequire('./_object-sap')('seal', function ($seal) {\n  return function seal(it) {\n    return $seal && isObject(it) ? $seal(meta(it)) : it;\n  };\n});\n","// 19.1.3.19 Object.setPrototypeOf(O, proto)\nvar $export = require('./_export');\n$export($export.S, 'Object', { setPrototypeOf: require('./_set-proto').set });\n","// https://github.com/tc39/proposal-object-values-entries\nvar $export = require('./_export');\nvar $values = require('./_object-to-array')(false);\n\n$export($export.S, 'Object', {\n  values: function values(it) {\n    return $values(it);\n  }\n});\n","// 7.3.20 SpeciesConstructor(O, defaultConstructor)\nvar anObject = require('./_an-object');\nvar aFunction = require('./_a-function');\nvar SPECIES = require('./_wks')('species');\nmodule.exports = function (O, D) {\n  var C = anObject(O).constructor;\n  var S;\n  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? D : aFunction(S);\n};\n","// fast apply, http://jsperf.lnkit.com/fast-apply/5\nmodule.exports = function (fn, args, that) {\n  var un = that === undefined;\n  switch (args.length) {\n    case 0: return un ? fn()\n                      : fn.call(that);\n    case 1: return un ? fn(args[0])\n                      : fn.call(that, args[0]);\n    case 2: return un ? fn(args[0], args[1])\n                      : fn.call(that, args[0], args[1]);\n    case 3: return un ? fn(args[0], args[1], args[2])\n                      : fn.call(that, args[0], args[1], args[2]);\n    case 4: return un ? fn(args[0], args[1], args[2], args[3])\n                      : fn.call(that, args[0], args[1], args[2], args[3]);\n  } return fn.apply(that, args);\n};\n","var ctx = require('./_ctx');\nvar invoke = require('./_invoke');\nvar html = require('./_html');\nvar cel = require('./_dom-create');\nvar global = require('./_global');\nvar process = global.process;\nvar setTask = global.setImmediate;\nvar clearTask = global.clearImmediate;\nvar MessageChannel = global.MessageChannel;\nvar Dispatch = global.Dispatch;\nvar counter = 0;\nvar queue = {};\nvar ONREADYSTATECHANGE = 'onreadystatechange';\nvar defer, channel, port;\nvar run = function () {\n  var id = +this;\n  // eslint-disable-next-line no-prototype-builtins\n  if (queue.hasOwnProperty(id)) {\n    var fn = queue[id];\n    delete queue[id];\n    fn();\n  }\n};\nvar listener = function (event) {\n  run.call(event.data);\n};\n// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\nif (!setTask || !clearTask) {\n  setTask = function setImmediate(fn) {\n    var args = [];\n    var i = 1;\n    while (arguments.length > i) args.push(arguments[i++]);\n    queue[++counter] = function () {\n      // eslint-disable-next-line no-new-func\n      invoke(typeof fn == 'function' ? fn : Function(fn), args);\n    };\n    defer(counter);\n    return counter;\n  };\n  clearTask = function clearImmediate(id) {\n    delete queue[id];\n  };\n  // Node.js 0.8-\n  if (require('./_cof')(process) == 'process') {\n    defer = function (id) {\n      process.nextTick(ctx(run, id, 1));\n    };\n  // Sphere (JS game engine) Dispatch API\n  } else if (Dispatch && Dispatch.now) {\n    defer = function (id) {\n      Dispatch.now(ctx(run, id, 1));\n    };\n  // Browsers with MessageChannel, includes WebWorkers\n  } else if (MessageChannel) {\n    channel = new MessageChannel();\n    port = channel.port2;\n    channel.port1.onmessage = listener;\n    defer = ctx(port.postMessage, port, 1);\n  // Browsers with postMessage, skip WebWorkers\n  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n  } else if (global.addEventListener && typeof postMessage == 'function' && !global.importScripts) {\n    defer = function (id) {\n      global.postMessage(id + '', '*');\n    };\n    global.addEventListener('message', listener, false);\n  // IE8-\n  } else if (ONREADYSTATECHANGE in cel('script')) {\n    defer = function (id) {\n      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function () {\n        html.removeChild(this);\n        run.call(id);\n      };\n    };\n  // Rest old browsers\n  } else {\n    defer = function (id) {\n      setTimeout(ctx(run, id, 1), 0);\n    };\n  }\n}\nmodule.exports = {\n  set: setTask,\n  clear: clearTask\n};\n","var global = require('./_global');\nvar macrotask = require('./_task').set;\nvar Observer = global.MutationObserver || global.WebKitMutationObserver;\nvar process = global.process;\nvar Promise = global.Promise;\nvar isNode = require('./_cof')(process) == 'process';\n\nmodule.exports = function () {\n  var head, last, notify;\n\n  var flush = function () {\n    var parent, fn;\n    if (isNode && (parent = process.domain)) parent.exit();\n    while (head) {\n      fn = head.fn;\n      head = head.next;\n      try {\n        fn();\n      } catch (e) {\n        if (head) notify();\n        else last = undefined;\n        throw e;\n      }\n    } last = undefined;\n    if (parent) parent.enter();\n  };\n\n  // Node.js\n  if (isNode) {\n    notify = function () {\n      process.nextTick(flush);\n    };\n  // browsers with MutationObserver, except iOS Safari - https://github.com/zloirock/core-js/issues/339\n  } else if (Observer && !(global.navigator && global.navigator.standalone)) {\n    var toggle = true;\n    var node = document.createTextNode('');\n    new Observer(flush).observe(node, { characterData: true }); // eslint-disable-line no-new\n    notify = function () {\n      node.data = toggle = !toggle;\n    };\n  // environments with maybe non-completely correct, but existent Promise\n  } else if (Promise && Promise.resolve) {\n    // Promise.resolve without an argument throws an error in LG WebOS 2\n    var promise = Promise.resolve(undefined);\n    notify = function () {\n      promise.then(flush);\n    };\n  // for other environments - macrotask based on:\n  // - setImmediate\n  // - MessageChannel\n  // - window.postMessag\n  // - onreadystatechange\n  // - setTimeout\n  } else {\n    notify = function () {\n      // strange IE + webpack dev server bug - use .call(global)\n      macrotask.call(global, flush);\n    };\n  }\n\n  return function (fn) {\n    var task = { fn: fn, next: undefined };\n    if (last) last.next = task;\n    if (!head) {\n      head = task;\n      notify();\n    } last = task;\n  };\n};\n","'use strict';\n// 25.4.1.5 NewPromiseCapability(C)\nvar aFunction = require('./_a-function');\n\nfunction PromiseCapability(C) {\n  var resolve, reject;\n  this.promise = new C(function ($$resolve, $$reject) {\n    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');\n    resolve = $$resolve;\n    reject = $$reject;\n  });\n  this.resolve = aFunction(resolve);\n  this.reject = aFunction(reject);\n}\n\nmodule.exports.f = function (C) {\n  return new PromiseCapability(C);\n};\n","module.exports = function (exec) {\n  try {\n    return { e: false, v: exec() };\n  } catch (e) {\n    return { e: true, v: e };\n  }\n};\n","var global = require('./_global');\nvar navigator = global.navigator;\n\nmodule.exports = navigator && navigator.userAgent || '';\n","var anObject = require('./_an-object');\nvar isObject = require('./_is-object');\nvar newPromiseCapability = require('./_new-promise-capability');\n\nmodule.exports = function (C, x) {\n  anObject(C);\n  if (isObject(x) && x.constructor === C) return x;\n  var promiseCapability = newPromiseCapability.f(C);\n  var resolve = promiseCapability.resolve;\n  resolve(x);\n  return promiseCapability.promise;\n};\n","'use strict';\nvar LIBRARY = require('./_library');\nvar global = require('./_global');\nvar ctx = require('./_ctx');\nvar classof = require('./_classof');\nvar $export = require('./_export');\nvar isObject = require('./_is-object');\nvar aFunction = require('./_a-function');\nvar anInstance = require('./_an-instance');\nvar forOf = require('./_for-of');\nvar speciesConstructor = require('./_species-constructor');\nvar task = require('./_task').set;\nvar microtask = require('./_microtask')();\nvar newPromiseCapabilityModule = require('./_new-promise-capability');\nvar perform = require('./_perform');\nvar userAgent = require('./_user-agent');\nvar promiseResolve = require('./_promise-resolve');\nvar PROMISE = 'Promise';\nvar TypeError = global.TypeError;\nvar process = global.process;\nvar versions = process && process.versions;\nvar v8 = versions && versions.v8 || '';\nvar $Promise = global[PROMISE];\nvar isNode = classof(process) == 'process';\nvar empty = function () { /* empty */ };\nvar Internal, newGenericPromiseCapability, OwnPromiseCapability, Wrapper;\nvar newPromiseCapability = newGenericPromiseCapability = newPromiseCapabilityModule.f;\n\nvar USE_NATIVE = !!function () {\n  try {\n    // correct subclassing with @@species support\n    var promise = $Promise.resolve(1);\n    var FakePromise = (promise.constructor = {})[require('./_wks')('species')] = function (exec) {\n      exec(empty, empty);\n    };\n    // unhandled rejections tracking support, NodeJS Promise without it fails @@species test\n    return (isNode || typeof PromiseRejectionEvent == 'function')\n      && promise.then(empty) instanceof FakePromise\n      // v8 6.6 (Node 10 and Chrome 66) have a bug with resolving custom thenables\n      // https://bugs.chromium.org/p/chromium/issues/detail?id=830565\n      // we can't detect it synchronously, so just check versions\n      && v8.indexOf('6.6') !== 0\n      && userAgent.indexOf('Chrome/66') === -1;\n  } catch (e) { /* empty */ }\n}();\n\n// helpers\nvar isThenable = function (it) {\n  var then;\n  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;\n};\nvar notify = function (promise, isReject) {\n  if (promise._n) return;\n  promise._n = true;\n  var chain = promise._c;\n  microtask(function () {\n    var value = promise._v;\n    var ok = promise._s == 1;\n    var i = 0;\n    var run = function (reaction) {\n      var handler = ok ? reaction.ok : reaction.fail;\n      var resolve = reaction.resolve;\n      var reject = reaction.reject;\n      var domain = reaction.domain;\n      var result, then, exited;\n      try {\n        if (handler) {\n          if (!ok) {\n            if (promise._h == 2) onHandleUnhandled(promise);\n            promise._h = 1;\n          }\n          if (handler === true) result = value;\n          else {\n            if (domain) domain.enter();\n            result = handler(value); // may throw\n            if (domain) {\n              domain.exit();\n              exited = true;\n            }\n          }\n          if (result === reaction.promise) {\n            reject(TypeError('Promise-chain cycle'));\n          } else if (then = isThenable(result)) {\n            then.call(result, resolve, reject);\n          } else resolve(result);\n        } else reject(value);\n      } catch (e) {\n        if (domain && !exited) domain.exit();\n        reject(e);\n      }\n    };\n    while (chain.length > i) run(chain[i++]); // variable length - can't use forEach\n    promise._c = [];\n    promise._n = false;\n    if (isReject && !promise._h) onUnhandled(promise);\n  });\n};\nvar onUnhandled = function (promise) {\n  task.call(global, function () {\n    var value = promise._v;\n    var unhandled = isUnhandled(promise);\n    var result, handler, console;\n    if (unhandled) {\n      result = perform(function () {\n        if (isNode) {\n          process.emit('unhandledRejection', value, promise);\n        } else if (handler = global.onunhandledrejection) {\n          handler({ promise: promise, reason: value });\n        } else if ((console = global.console) && console.error) {\n          console.error('Unhandled promise rejection', value);\n        }\n      });\n      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should\n      promise._h = isNode || isUnhandled(promise) ? 2 : 1;\n    } promise._a = undefined;\n    if (unhandled && result.e) throw result.v;\n  });\n};\nvar isUnhandled = function (promise) {\n  return promise._h !== 1 && (promise._a || promise._c).length === 0;\n};\nvar onHandleUnhandled = function (promise) {\n  task.call(global, function () {\n    var handler;\n    if (isNode) {\n      process.emit('rejectionHandled', promise);\n    } else if (handler = global.onrejectionhandled) {\n      handler({ promise: promise, reason: promise._v });\n    }\n  });\n};\nvar $reject = function (value) {\n  var promise = this;\n  if (promise._d) return;\n  promise._d = true;\n  promise = promise._w || promise; // unwrap\n  promise._v = value;\n  promise._s = 2;\n  if (!promise._a) promise._a = promise._c.slice();\n  notify(promise, true);\n};\nvar $resolve = function (value) {\n  var promise = this;\n  var then;\n  if (promise._d) return;\n  promise._d = true;\n  promise = promise._w || promise; // unwrap\n  try {\n    if (promise === value) throw TypeError(\"Promise can't be resolved itself\");\n    if (then = isThenable(value)) {\n      microtask(function () {\n        var wrapper = { _w: promise, _d: false }; // wrap\n        try {\n          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));\n        } catch (e) {\n          $reject.call(wrapper, e);\n        }\n      });\n    } else {\n      promise._v = value;\n      promise._s = 1;\n      notify(promise, false);\n    }\n  } catch (e) {\n    $reject.call({ _w: promise, _d: false }, e); // wrap\n  }\n};\n\n// constructor polyfill\nif (!USE_NATIVE) {\n  // 25.4.3.1 Promise(executor)\n  $Promise = function Promise(executor) {\n    anInstance(this, $Promise, PROMISE, '_h');\n    aFunction(executor);\n    Internal.call(this);\n    try {\n      executor(ctx($resolve, this, 1), ctx($reject, this, 1));\n    } catch (err) {\n      $reject.call(this, err);\n    }\n  };\n  // eslint-disable-next-line no-unused-vars\n  Internal = function Promise(executor) {\n    this._c = [];             // <- awaiting reactions\n    this._a = undefined;      // <- checked in isUnhandled reactions\n    this._s = 0;              // <- state\n    this._d = false;          // <- done\n    this._v = undefined;      // <- value\n    this._h = 0;              // <- rejection state, 0 - default, 1 - handled, 2 - unhandled\n    this._n = false;          // <- notify\n  };\n  Internal.prototype = require('./_redefine-all')($Promise.prototype, {\n    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)\n    then: function then(onFulfilled, onRejected) {\n      var reaction = newPromiseCapability(speciesConstructor(this, $Promise));\n      reaction.ok = typeof onFulfilled == 'function' ? onFulfilled : true;\n      reaction.fail = typeof onRejected == 'function' && onRejected;\n      reaction.domain = isNode ? process.domain : undefined;\n      this._c.push(reaction);\n      if (this._a) this._a.push(reaction);\n      if (this._s) notify(this, false);\n      return reaction.promise;\n    },\n    // 25.4.5.1 Promise.prototype.catch(onRejected)\n    'catch': function (onRejected) {\n      return this.then(undefined, onRejected);\n    }\n  });\n  OwnPromiseCapability = function () {\n    var promise = new Internal();\n    this.promise = promise;\n    this.resolve = ctx($resolve, promise, 1);\n    this.reject = ctx($reject, promise, 1);\n  };\n  newPromiseCapabilityModule.f = newPromiseCapability = function (C) {\n    return C === $Promise || C === Wrapper\n      ? new OwnPromiseCapability(C)\n      : newGenericPromiseCapability(C);\n  };\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, { Promise: $Promise });\nrequire('./_set-to-string-tag')($Promise, PROMISE);\nrequire('./_set-species')(PROMISE);\nWrapper = require('./_core')[PROMISE];\n\n// statics\n$export($export.S + $export.F * !USE_NATIVE, PROMISE, {\n  // 25.4.4.5 Promise.reject(r)\n  reject: function reject(r) {\n    var capability = newPromiseCapability(this);\n    var $$reject = capability.reject;\n    $$reject(r);\n    return capability.promise;\n  }\n});\n$export($export.S + $export.F * (LIBRARY || !USE_NATIVE), PROMISE, {\n  // 25.4.4.6 Promise.resolve(x)\n  resolve: function resolve(x) {\n    return promiseResolve(LIBRARY && this === Wrapper ? $Promise : this, x);\n  }\n});\n$export($export.S + $export.F * !(USE_NATIVE && require('./_iter-detect')(function (iter) {\n  $Promise.all(iter)['catch'](empty);\n})), PROMISE, {\n  // 25.4.4.1 Promise.all(iterable)\n  all: function all(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var values = [];\n      var index = 0;\n      var remaining = 1;\n      forOf(iterable, false, function (promise) {\n        var $index = index++;\n        var alreadyCalled = false;\n        values.push(undefined);\n        remaining++;\n        C.resolve(promise).then(function (value) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[$index] = value;\n          --remaining || resolve(values);\n        }, reject);\n      });\n      --remaining || resolve(values);\n    });\n    if (result.e) reject(result.v);\n    return capability.promise;\n  },\n  // 25.4.4.4 Promise.race(iterable)\n  race: function race(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var reject = capability.reject;\n    var result = perform(function () {\n      forOf(iterable, false, function (promise) {\n        C.resolve(promise).then(capability.resolve, reject);\n      });\n    });\n    if (result.e) reject(result.v);\n    return capability.promise;\n  }\n});\n","// https://github.com/tc39/proposal-promise-finally\n'use strict';\nvar $export = require('./_export');\nvar core = require('./_core');\nvar global = require('./_global');\nvar speciesConstructor = require('./_species-constructor');\nvar promiseResolve = require('./_promise-resolve');\n\n$export($export.P + $export.R, 'Promise', { 'finally': function (onFinally) {\n  var C = speciesConstructor(this, core.Promise || global.Promise);\n  var isFunction = typeof onFinally == 'function';\n  return this.then(\n    isFunction ? function (x) {\n      return promiseResolve(C, onFinally()).then(function () { return x; });\n    } : onFinally,\n    isFunction ? function (e) {\n      return promiseResolve(C, onFinally()).then(function () { throw e; });\n    } : onFinally\n  );\n} });\n","// 26.1.1 Reflect.apply(target, thisArgument, argumentsList)\nvar $export = require('./_export');\nvar aFunction = require('./_a-function');\nvar anObject = require('./_an-object');\nvar rApply = (require('./_global').Reflect || {}).apply;\nvar fApply = Function.apply;\n// MS Edge argumentsList argument is optional\n$export($export.S + $export.F * !require('./_fails')(function () {\n  rApply(function () { /* empty */ });\n}), 'Reflect', {\n  apply: function apply(target, thisArgument, argumentsList) {\n    var T = aFunction(target);\n    var L = anObject(argumentsList);\n    return rApply ? rApply(T, thisArgument, L) : fApply.call(T, thisArgument, L);\n  }\n});\n","'use strict';\nvar aFunction = require('./_a-function');\nvar isObject = require('./_is-object');\nvar invoke = require('./_invoke');\nvar arraySlice = [].slice;\nvar factories = {};\n\nvar construct = function (F, len, args) {\n  if (!(len in factories)) {\n    for (var n = [], i = 0; i < len; i++) n[i] = 'a[' + i + ']';\n    // eslint-disable-next-line no-new-func\n    factories[len] = Function('F,a', 'return new F(' + n.join(',') + ')');\n  } return factories[len](F, args);\n};\n\nmodule.exports = Function.bind || function bind(that /* , ...args */) {\n  var fn = aFunction(this);\n  var partArgs = arraySlice.call(arguments, 1);\n  var bound = function (/* args... */) {\n    var args = partArgs.concat(arraySlice.call(arguments));\n    return this instanceof bound ? construct(fn, args.length, args) : invoke(fn, args, that);\n  };\n  if (isObject(fn.prototype)) bound.prototype = fn.prototype;\n  return bound;\n};\n","// 26.1.2 Reflect.construct(target, argumentsList [, newTarget])\nvar $export = require('./_export');\nvar create = require('./_object-create');\nvar aFunction = require('./_a-function');\nvar anObject = require('./_an-object');\nvar isObject = require('./_is-object');\nvar fails = require('./_fails');\nvar bind = require('./_bind');\nvar rConstruct = (require('./_global').Reflect || {}).construct;\n\n// MS Edge supports only 2 arguments and argumentsList argument is optional\n// FF Nightly sets third argument as `new.target`, but does not create `this` from it\nvar NEW_TARGET_BUG = fails(function () {\n  function F() { /* empty */ }\n  return !(rConstruct(function () { /* empty */ }, [], F) instanceof F);\n});\nvar ARGS_BUG = !fails(function () {\n  rConstruct(function () { /* empty */ });\n});\n\n$export($export.S + $export.F * (NEW_TARGET_BUG || ARGS_BUG), 'Reflect', {\n  construct: function construct(Target, args /* , newTarget */) {\n    aFunction(Target);\n    anObject(args);\n    var newTarget = arguments.length < 3 ? Target : aFunction(arguments[2]);\n    if (ARGS_BUG && !NEW_TARGET_BUG) return rConstruct(Target, args, newTarget);\n    if (Target == newTarget) {\n      // w/o altered newTarget, optimization for 0-4 arguments\n      switch (args.length) {\n        case 0: return new Target();\n        case 1: return new Target(args[0]);\n        case 2: return new Target(args[0], args[1]);\n        case 3: return new Target(args[0], args[1], args[2]);\n        case 4: return new Target(args[0], args[1], args[2], args[3]);\n      }\n      // w/o altered newTarget, lot of arguments case\n      var $args = [null];\n      $args.push.apply($args, args);\n      return new (bind.apply(Target, $args))();\n    }\n    // with altered newTarget, not support built-in constructors\n    var proto = newTarget.prototype;\n    var instance = create(isObject(proto) ? proto : Object.prototype);\n    var result = Function.apply.call(Target, instance, args);\n    return isObject(result) ? result : instance;\n  }\n});\n","// 26.1.3 Reflect.defineProperty(target, propertyKey, attributes)\nvar dP = require('./_object-dp');\nvar $export = require('./_export');\nvar anObject = require('./_an-object');\nvar toPrimitive = require('./_to-primitive');\n\n// MS Edge has broken Reflect.defineProperty - throwing instead of returning false\n$export($export.S + $export.F * require('./_fails')(function () {\n  // eslint-disable-next-line no-undef\n  Reflect.defineProperty(dP.f({}, 1, { value: 1 }), 1, { value: 2 });\n}), 'Reflect', {\n  defineProperty: function defineProperty(target, propertyKey, attributes) {\n    anObject(target);\n    propertyKey = toPrimitive(propertyKey, true);\n    anObject(attributes);\n    try {\n      dP.f(target, propertyKey, attributes);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n});\n","// 26.1.4 Reflect.deleteProperty(target, propertyKey)\nvar $export = require('./_export');\nvar gOPD = require('./_object-gopd').f;\nvar anObject = require('./_an-object');\n\n$export($export.S, 'Reflect', {\n  deleteProperty: function deleteProperty(target, propertyKey) {\n    var desc = gOPD(anObject(target), propertyKey);\n    return desc && !desc.configurable ? false : delete target[propertyKey];\n  }\n});\n","// 26.1.6 Reflect.get(target, propertyKey [, receiver])\nvar gOPD = require('./_object-gopd');\nvar getPrototypeOf = require('./_object-gpo');\nvar has = require('./_has');\nvar $export = require('./_export');\nvar isObject = require('./_is-object');\nvar anObject = require('./_an-object');\n\nfunction get(target, propertyKey /* , receiver */) {\n  var receiver = arguments.length < 3 ? target : arguments[2];\n  var desc, proto;\n  if (anObject(target) === receiver) return target[propertyKey];\n  if (desc = gOPD.f(target, propertyKey)) return has(desc, 'value')\n    ? desc.value\n    : desc.get !== undefined\n      ? desc.get.call(receiver)\n      : undefined;\n  if (isObject(proto = getPrototypeOf(target))) return get(proto, propertyKey, receiver);\n}\n\n$export($export.S, 'Reflect', { get: get });\n","// 26.1.7 Reflect.getOwnPropertyDescriptor(target, propertyKey)\nvar gOPD = require('./_object-gopd');\nvar $export = require('./_export');\nvar anObject = require('./_an-object');\n\n$export($export.S, 'Reflect', {\n  getOwnPropertyDescriptor: function getOwnPropertyDescriptor(target, propertyKey) {\n    return gOPD.f(anObject(target), propertyKey);\n  }\n});\n","// 26.1.8 Reflect.getPrototypeOf(target)\nvar $export = require('./_export');\nvar getProto = require('./_object-gpo');\nvar anObject = require('./_an-object');\n\n$export($export.S, 'Reflect', {\n  getPrototypeOf: function getPrototypeOf(target) {\n    return getProto(anObject(target));\n  }\n});\n","// 26.1.9 Reflect.has(target, propertyKey)\nvar $export = require('./_export');\n\n$export($export.S, 'Reflect', {\n  has: function has(target, propertyKey) {\n    return propertyKey in target;\n  }\n});\n","// 26.1.10 Reflect.isExtensible(target)\nvar $export = require('./_export');\nvar anObject = require('./_an-object');\nvar $isExtensible = Object.isExtensible;\n\n$export($export.S, 'Reflect', {\n  isExtensible: function isExtensible(target) {\n    anObject(target);\n    return $isExtensible ? $isExtensible(target) : true;\n  }\n});\n","// 26.1.11 Reflect.ownKeys(target)\nvar $export = require('./_export');\n\n$export($export.S, 'Reflect', { ownKeys: require('./_own-keys') });\n","// 26.1.12 Reflect.preventExtensions(target)\nvar $export = require('./_export');\nvar anObject = require('./_an-object');\nvar $preventExtensions = Object.preventExtensions;\n\n$export($export.S, 'Reflect', {\n  preventExtensions: function preventExtensions(target) {\n    anObject(target);\n    try {\n      if ($preventExtensions) $preventExtensions(target);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n});\n","// 26.1.13 Reflect.set(target, propertyKey, V [, receiver])\nvar dP = require('./_object-dp');\nvar gOPD = require('./_object-gopd');\nvar getPrototypeOf = require('./_object-gpo');\nvar has = require('./_has');\nvar $export = require('./_export');\nvar createDesc = require('./_property-desc');\nvar anObject = require('./_an-object');\nvar isObject = require('./_is-object');\n\nfunction set(target, propertyKey, V /* , receiver */) {\n  var receiver = arguments.length < 4 ? target : arguments[3];\n  var ownDesc = gOPD.f(anObject(target), propertyKey);\n  var existingDescriptor, proto;\n  if (!ownDesc) {\n    if (isObject(proto = getPrototypeOf(target))) {\n      return set(proto, propertyKey, V, receiver);\n    }\n    ownDesc = createDesc(0);\n  }\n  if (has(ownDesc, 'value')) {\n    if (ownDesc.writable === false || !isObject(receiver)) return false;\n    if (existingDescriptor = gOPD.f(receiver, propertyKey)) {\n      if (existingDescriptor.get || existingDescriptor.set || existingDescriptor.writable === false) return false;\n      existingDescriptor.value = V;\n      dP.f(receiver, propertyKey, existingDescriptor);\n    } else dP.f(receiver, propertyKey, createDesc(0, V));\n    return true;\n  }\n  return ownDesc.set === undefined ? false : (ownDesc.set.call(receiver, V), true);\n}\n\n$export($export.S, 'Reflect', { set: set });\n","// 26.1.14 Reflect.setPrototypeOf(target, proto)\nvar $export = require('./_export');\nvar setProto = require('./_set-proto');\n\nif (setProto) $export($export.S, 'Reflect', {\n  setPrototypeOf: function setPrototypeOf(target, proto) {\n    setProto.check(target, proto);\n    try {\n      setProto.set(target, proto);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n});\n","// 7.2.8 IsRegExp(argument)\nvar isObject = require('./_is-object');\nvar cof = require('./_cof');\nvar MATCH = require('./_wks')('match');\nmodule.exports = function (it) {\n  var isRegExp;\n  return isObject(it) && ((isRegExp = it[MATCH]) !== undefined ? !!isRegExp : cof(it) == 'RegExp');\n};\n","'use strict';\n// 21.2.5.3 get RegExp.prototype.flags\nvar anObject = require('./_an-object');\nmodule.exports = function () {\n  var that = anObject(this);\n  var result = '';\n  if (that.global) result += 'g';\n  if (that.ignoreCase) result += 'i';\n  if (that.multiline) result += 'm';\n  if (that.unicode) result += 'u';\n  if (that.sticky) result += 'y';\n  return result;\n};\n","var global = require('./_global');\nvar inheritIfRequired = require('./_inherit-if-required');\nvar dP = require('./_object-dp').f;\nvar gOPN = require('./_object-gopn').f;\nvar isRegExp = require('./_is-regexp');\nvar $flags = require('./_flags');\nvar $RegExp = global.RegExp;\nvar Base = $RegExp;\nvar proto = $RegExp.prototype;\nvar re1 = /a/g;\nvar re2 = /a/g;\n// \"new\" creates a new object, old webkit buggy here\nvar CORRECT_NEW = new $RegExp(re1) !== re1;\n\nif (require('./_descriptors') && (!CORRECT_NEW || require('./_fails')(function () {\n  re2[require('./_wks')('match')] = false;\n  // RegExp constructor can alter flags and IsRegExp works correct with @@match\n  return $RegExp(re1) != re1 || $RegExp(re2) == re2 || $RegExp(re1, 'i') != '/a/i';\n}))) {\n  $RegExp = function RegExp(p, f) {\n    var tiRE = this instanceof $RegExp;\n    var piRE = isRegExp(p);\n    var fiU = f === undefined;\n    return !tiRE && piRE && p.constructor === $RegExp && fiU ? p\n      : inheritIfRequired(CORRECT_NEW\n        ? new Base(piRE && !fiU ? p.source : p, f)\n        : Base((piRE = p instanceof $RegExp) ? p.source : p, piRE && fiU ? $flags.call(p) : f)\n      , tiRE ? this : proto, $RegExp);\n  };\n  var proxy = function (key) {\n    key in $RegExp || dP($RegExp, key, {\n      configurable: true,\n      get: function () { return Base[key]; },\n      set: function (it) { Base[key] = it; }\n    });\n  };\n  for (var keys = gOPN(Base), i = 0; keys.length > i;) proxy(keys[i++]);\n  proto.constructor = $RegExp;\n  $RegExp.prototype = proto;\n  require('./_redefine')(global, 'RegExp', $RegExp);\n}\n\nrequire('./_set-species')('RegExp');\n","// 21.2.5.3 get RegExp.prototype.flags()\nif (require('./_descriptors') && /./g.flags != 'g') require('./_object-dp').f(RegExp.prototype, 'flags', {\n  configurable: true,\n  get: require('./_flags')\n});\n","var toInteger = require('./_to-integer');\nvar defined = require('./_defined');\n// true  -> String#at\n// false -> String#codePointAt\nmodule.exports = function (TO_STRING) {\n  return function (that, pos) {\n    var s = String(defined(that));\n    var i = toInteger(pos);\n    var l = s.length;\n    var a, b;\n    if (i < 0 || i >= l) return TO_STRING ? '' : undefined;\n    a = s.charCodeAt(i);\n    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff\n      ? TO_STRING ? s.charAt(i) : a\n      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;\n  };\n};\n","'use strict';\nvar at = require('./_string-at')(true);\n\n // `AdvanceStringIndex` abstract operation\n// https://tc39.github.io/ecma262/#sec-advancestringindex\nmodule.exports = function (S, index, unicode) {\n  return index + (unicode ? at(S, index).length : 1);\n};\n","'use strict';\n\nvar classof = require('./_classof');\nvar builtinExec = RegExp.prototype.exec;\n\n // `RegExpExec` abstract operation\n// https://tc39.github.io/ecma262/#sec-regexpexec\nmodule.exports = function (R, S) {\n  var exec = R.exec;\n  if (typeof exec === 'function') {\n    var result = exec.call(R, S);\n    if (typeof result !== 'object') {\n      throw new TypeError('RegExp exec method returned something other than an Object or null');\n    }\n    return result;\n  }\n  if (classof(R) !== 'RegExp') {\n    throw new TypeError('RegExp#exec called on incompatible receiver');\n  }\n  return builtinExec.call(R, S);\n};\n","'use strict';\n\nvar regexpFlags = require('./_flags');\n\nvar nativeExec = RegExp.prototype.exec;\n// This always refers to the native implementation, because the\n// String#replace polyfill uses ./fix-regexp-well-known-symbol-logic.js,\n// which loads this file before patching the method.\nvar nativeReplace = String.prototype.replace;\n\nvar patchedExec = nativeExec;\n\nvar LAST_INDEX = 'lastIndex';\n\nvar UPDATES_LAST_INDEX_WRONG = (function () {\n  var re1 = /a/,\n      re2 = /b*/g;\n  nativeExec.call(re1, 'a');\n  nativeExec.call(re2, 'a');\n  return re1[LAST_INDEX] !== 0 || re2[LAST_INDEX] !== 0;\n})();\n\n// nonparticipating capturing group, copied from es5-shim's String#split patch.\nvar NPCG_INCLUDED = /()??/.exec('')[1] !== undefined;\n\nvar PATCH = UPDATES_LAST_INDEX_WRONG || NPCG_INCLUDED;\n\nif (PATCH) {\n  patchedExec = function exec(str) {\n    var re = this;\n    var lastIndex, reCopy, match, i;\n\n    if (NPCG_INCLUDED) {\n      reCopy = new RegExp('^' + re.source + '$(?!\\\\s)', regexpFlags.call(re));\n    }\n    if (UPDATES_LAST_INDEX_WRONG) lastIndex = re[LAST_INDEX];\n\n    match = nativeExec.call(re, str);\n\n    if (UPDATES_LAST_INDEX_WRONG && match) {\n      re[LAST_INDEX] = re.global ? match.index + match[0].length : lastIndex;\n    }\n    if (NPCG_INCLUDED && match && match.length > 1) {\n      // Fix browsers whose `exec` methods don't consistently return `undefined`\n      // for NPCG, like IE8. NOTE: This doesn' work for /(.?)?/\n      // eslint-disable-next-line no-loop-func\n      nativeReplace.call(match[0], reCopy, function () {\n        for (i = 1; i < arguments.length - 2; i++) {\n          if (arguments[i] === undefined) match[i] = undefined;\n        }\n      });\n    }\n\n    return match;\n  };\n}\n\nmodule.exports = patchedExec;\n","'use strict';\nvar regexpExec = require('./_regexp-exec');\nrequire('./_export')({\n  target: 'RegExp',\n  proto: true,\n  forced: regexpExec !== /./.exec\n}, {\n  exec: regexpExec\n});\n","'use strict';\nrequire('./es6.regexp.exec');\nvar redefine = require('./_redefine');\nvar hide = require('./_hide');\nvar fails = require('./_fails');\nvar defined = require('./_defined');\nvar wks = require('./_wks');\nvar regexpExec = require('./_regexp-exec');\n\nvar SPECIES = wks('species');\n\nvar REPLACE_SUPPORTS_NAMED_GROUPS = !fails(function () {\n  // #replace needs built-in support for named groups.\n  // #match works fine because it just return the exec results, even if it has\n  // a \"grops\" property.\n  var re = /./;\n  re.exec = function () {\n    var result = [];\n    result.groups = { a: '7' };\n    return result;\n  };\n  return ''.replace(re, '$<a>') !== '7';\n});\n\nvar SPLIT_WORKS_WITH_OVERWRITTEN_EXEC = (function () {\n  // Chrome 51 has a buggy \"split\" implementation when RegExp#exec !== nativeExec\n  var re = /(?:)/;\n  var originalExec = re.exec;\n  re.exec = function () { return originalExec.apply(this, arguments); };\n  var result = 'ab'.split(re);\n  return result.length === 2 && result[0] === 'a' && result[1] === 'b';\n})();\n\nmodule.exports = function (KEY, length, exec) {\n  var SYMBOL = wks(KEY);\n\n  var DELEGATES_TO_SYMBOL = !fails(function () {\n    // String methods call symbol-named RegEp methods\n    var O = {};\n    O[SYMBOL] = function () { return 7; };\n    return ''[KEY](O) != 7;\n  });\n\n  var DELEGATES_TO_EXEC = DELEGATES_TO_SYMBOL ? !fails(function () {\n    // Symbol-named RegExp methods call .exec\n    var execCalled = false;\n    var re = /a/;\n    re.exec = function () { execCalled = true; return null; };\n    if (KEY === 'split') {\n      // RegExp[@@split] doesn't call the regex's exec method, but first creates\n      // a new one. We need to return the patched regex when creating the new one.\n      re.constructor = {};\n      re.constructor[SPECIES] = function () { return re; };\n    }\n    re[SYMBOL]('');\n    return !execCalled;\n  }) : undefined;\n\n  if (\n    !DELEGATES_TO_SYMBOL ||\n    !DELEGATES_TO_EXEC ||\n    (KEY === 'replace' && !REPLACE_SUPPORTS_NAMED_GROUPS) ||\n    (KEY === 'split' && !SPLIT_WORKS_WITH_OVERWRITTEN_EXEC)\n  ) {\n    var nativeRegExpMethod = /./[SYMBOL];\n    var fns = exec(\n      defined,\n      SYMBOL,\n      ''[KEY],\n      function maybeCallNative(nativeMethod, regexp, str, arg2, forceStringMethod) {\n        if (regexp.exec === regexpExec) {\n          if (DELEGATES_TO_SYMBOL && !forceStringMethod) {\n            // The native String method already delegates to @@method (this\n            // polyfilled function), leasing to infinite recursion.\n            // We avoid it by directly calling the native @@method method.\n            return { done: true, value: nativeRegExpMethod.call(regexp, str, arg2) };\n          }\n          return { done: true, value: nativeMethod.call(str, regexp, arg2) };\n        }\n        return { done: false };\n      }\n    );\n    var strfn = fns[0];\n    var rxfn = fns[1];\n\n    redefine(String.prototype, KEY, strfn);\n    hide(RegExp.prototype, SYMBOL, length == 2\n      // 21.2.5.8 RegExp.prototype[@@replace](string, replaceValue)\n      // 21.2.5.11 RegExp.prototype[@@split](string, limit)\n      ? function (string, arg) { return rxfn.call(string, this, arg); }\n      // 21.2.5.6 RegExp.prototype[@@match](string)\n      // 21.2.5.9 RegExp.prototype[@@search](string)\n      : function (string) { return rxfn.call(string, this); }\n    );\n  }\n};\n","'use strict';\n\nvar anObject = require('./_an-object');\nvar toLength = require('./_to-length');\nvar advanceStringIndex = require('./_advance-string-index');\nvar regExpExec = require('./_regexp-exec-abstract');\n\n// @@match logic\nrequire('./_fix-re-wks')('match', 1, function (defined, MATCH, $match, maybeCallNative) {\n  return [\n    // `String.prototype.match` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.match\n    function match(regexp) {\n      var O = defined(this);\n      var fn = regexp == undefined ? undefined : regexp[MATCH];\n      return fn !== undefined ? fn.call(regexp, O) : new RegExp(regexp)[MATCH](String(O));\n    },\n    // `RegExp.prototype[@@match]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@match\n    function (regexp) {\n      var res = maybeCallNative($match, regexp, this);\n      if (res.done) return res.value;\n      var rx = anObject(regexp);\n      var S = String(this);\n      if (!rx.global) return regExpExec(rx, S);\n      var fullUnicode = rx.unicode;\n      rx.lastIndex = 0;\n      var A = [];\n      var n = 0;\n      var result;\n      while ((result = regExpExec(rx, S)) !== null) {\n        var matchStr = String(result[0]);\n        A[n] = matchStr;\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n        n++;\n      }\n      return n === 0 ? null : A;\n    }\n  ];\n});\n","'use strict';\n\nvar anObject = require('./_an-object');\nvar toObject = require('./_to-object');\nvar toLength = require('./_to-length');\nvar toInteger = require('./_to-integer');\nvar advanceStringIndex = require('./_advance-string-index');\nvar regExpExec = require('./_regexp-exec-abstract');\nvar max = Math.max;\nvar min = Math.min;\nvar floor = Math.floor;\nvar SUBSTITUTION_SYMBOLS = /\\$([$&`']|\\d\\d?|<[^>]*>)/g;\nvar SUBSTITUTION_SYMBOLS_NO_NAMED = /\\$([$&`']|\\d\\d?)/g;\n\nvar maybeToString = function (it) {\n  return it === undefined ? it : String(it);\n};\n\n// @@replace logic\nrequire('./_fix-re-wks')('replace', 2, function (defined, REPLACE, $replace, maybeCallNative) {\n  return [\n    // `String.prototype.replace` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.replace\n    function replace(searchValue, replaceValue) {\n      var O = defined(this);\n      var fn = searchValue == undefined ? undefined : searchValue[REPLACE];\n      return fn !== undefined\n        ? fn.call(searchValue, O, replaceValue)\n        : $replace.call(String(O), searchValue, replaceValue);\n    },\n    // `RegExp.prototype[@@replace]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@replace\n    function (regexp, replaceValue) {\n      var res = maybeCallNative($replace, regexp, this, replaceValue);\n      if (res.done) return res.value;\n\n      var rx = anObject(regexp);\n      var S = String(this);\n      var functionalReplace = typeof replaceValue === 'function';\n      if (!functionalReplace) replaceValue = String(replaceValue);\n      var global = rx.global;\n      if (global) {\n        var fullUnicode = rx.unicode;\n        rx.lastIndex = 0;\n      }\n      var results = [];\n      while (true) {\n        var result = regExpExec(rx, S);\n        if (result === null) break;\n        results.push(result);\n        if (!global) break;\n        var matchStr = String(result[0]);\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n      }\n      var accumulatedResult = '';\n      var nextSourcePosition = 0;\n      for (var i = 0; i < results.length; i++) {\n        result = results[i];\n        var matched = String(result[0]);\n        var position = max(min(toInteger(result.index), S.length), 0);\n        var captures = [];\n        // NOTE: This is equivalent to\n        //   captures = result.slice(1).map(maybeToString)\n        // but for some reason `nativeSlice.call(result, 1, result.length)` (called in\n        // the slice polyfill when slicing native arrays) \"doesn't work\" in safari 9 and\n        // causes a crash (https://pastebin.com/N21QzeQA) when trying to debug it.\n        for (var j = 1; j < result.length; j++) captures.push(maybeToString(result[j]));\n        var namedCaptures = result.groups;\n        if (functionalReplace) {\n          var replacerArgs = [matched].concat(captures, position, S);\n          if (namedCaptures !== undefined) replacerArgs.push(namedCaptures);\n          var replacement = String(replaceValue.apply(undefined, replacerArgs));\n        } else {\n          replacement = getSubstitution(matched, S, position, captures, namedCaptures, replaceValue);\n        }\n        if (position >= nextSourcePosition) {\n          accumulatedResult += S.slice(nextSourcePosition, position) + replacement;\n          nextSourcePosition = position + matched.length;\n        }\n      }\n      return accumulatedResult + S.slice(nextSourcePosition);\n    }\n  ];\n\n    // https://tc39.github.io/ecma262/#sec-getsubstitution\n  function getSubstitution(matched, str, position, captures, namedCaptures, replacement) {\n    var tailPos = position + matched.length;\n    var m = captures.length;\n    var symbols = SUBSTITUTION_SYMBOLS_NO_NAMED;\n    if (namedCaptures !== undefined) {\n      namedCaptures = toObject(namedCaptures);\n      symbols = SUBSTITUTION_SYMBOLS;\n    }\n    return $replace.call(replacement, symbols, function (match, ch) {\n      var capture;\n      switch (ch.charAt(0)) {\n        case '$': return '$';\n        case '&': return matched;\n        case '`': return str.slice(0, position);\n        case \"'\": return str.slice(tailPos);\n        case '<':\n          capture = namedCaptures[ch.slice(1, -1)];\n          break;\n        default: // \\d\\d?\n          var n = +ch;\n          if (n === 0) return match;\n          if (n > m) {\n            var f = floor(n / 10);\n            if (f === 0) return match;\n            if (f <= m) return captures[f - 1] === undefined ? ch.charAt(1) : captures[f - 1] + ch.charAt(1);\n            return match;\n          }\n          capture = captures[n - 1];\n      }\n      return capture === undefined ? '' : capture;\n    });\n  }\n});\n","'use strict';\n\nvar isRegExp = require('./_is-regexp');\nvar anObject = require('./_an-object');\nvar speciesConstructor = require('./_species-constructor');\nvar advanceStringIndex = require('./_advance-string-index');\nvar toLength = require('./_to-length');\nvar callRegExpExec = require('./_regexp-exec-abstract');\nvar regexpExec = require('./_regexp-exec');\nvar fails = require('./_fails');\nvar $min = Math.min;\nvar $push = [].push;\nvar $SPLIT = 'split';\nvar LENGTH = 'length';\nvar LAST_INDEX = 'lastIndex';\nvar MAX_UINT32 = 0xffffffff;\n\n// babel-minify transpiles RegExp('x', 'y') -> /x/y and it causes SyntaxError\nvar SUPPORTS_Y = !fails(function () { RegExp(MAX_UINT32, 'y'); });\n\n// @@split logic\nrequire('./_fix-re-wks')('split', 2, function (defined, SPLIT, $split, maybeCallNative) {\n  var internalSplit;\n  if (\n    'abbc'[$SPLIT](/(b)*/)[1] == 'c' ||\n    'test'[$SPLIT](/(?:)/, -1)[LENGTH] != 4 ||\n    'ab'[$SPLIT](/(?:ab)*/)[LENGTH] != 2 ||\n    '.'[$SPLIT](/(.?)(.?)/)[LENGTH] != 4 ||\n    '.'[$SPLIT](/()()/)[LENGTH] > 1 ||\n    ''[$SPLIT](/.?/)[LENGTH]\n  ) {\n    // based on es5-shim implementation, need to rework it\n    internalSplit = function (separator, limit) {\n      var string = String(this);\n      if (separator === undefined && limit === 0) return [];\n      // If `separator` is not a regex, use native split\n      if (!isRegExp(separator)) return $split.call(string, separator, limit);\n      var output = [];\n      var flags = (separator.ignoreCase ? 'i' : '') +\n                  (separator.multiline ? 'm' : '') +\n                  (separator.unicode ? 'u' : '') +\n                  (separator.sticky ? 'y' : '');\n      var lastLastIndex = 0;\n      var splitLimit = limit === undefined ? MAX_UINT32 : limit >>> 0;\n      // Make `global` and avoid `lastIndex` issues by working with a copy\n      var separatorCopy = new RegExp(separator.source, flags + 'g');\n      var match, lastIndex, lastLength;\n      while (match = regexpExec.call(separatorCopy, string)) {\n        lastIndex = separatorCopy[LAST_INDEX];\n        if (lastIndex > lastLastIndex) {\n          output.push(string.slice(lastLastIndex, match.index));\n          if (match[LENGTH] > 1 && match.index < string[LENGTH]) $push.apply(output, match.slice(1));\n          lastLength = match[0][LENGTH];\n          lastLastIndex = lastIndex;\n          if (output[LENGTH] >= splitLimit) break;\n        }\n        if (separatorCopy[LAST_INDEX] === match.index) separatorCopy[LAST_INDEX]++; // Avoid an infinite loop\n      }\n      if (lastLastIndex === string[LENGTH]) {\n        if (lastLength || !separatorCopy.test('')) output.push('');\n      } else output.push(string.slice(lastLastIndex));\n      return output[LENGTH] > splitLimit ? output.slice(0, splitLimit) : output;\n    };\n  // Chakra, V8\n  } else if ('0'[$SPLIT](undefined, 0)[LENGTH]) {\n    internalSplit = function (separator, limit) {\n      return separator === undefined && limit === 0 ? [] : $split.call(this, separator, limit);\n    };\n  } else {\n    internalSplit = $split;\n  }\n\n  return [\n    // `String.prototype.split` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.split\n    function split(separator, limit) {\n      var O = defined(this);\n      var splitter = separator == undefined ? undefined : separator[SPLIT];\n      return splitter !== undefined\n        ? splitter.call(separator, O, limit)\n        : internalSplit.call(String(O), separator, limit);\n    },\n    // `RegExp.prototype[@@split]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@split\n    //\n    // NOTE: This cannot be properly polyfilled in engines that don't support\n    // the 'y' flag.\n    function (regexp, limit) {\n      var res = maybeCallNative(internalSplit, regexp, this, limit, internalSplit !== $split);\n      if (res.done) return res.value;\n\n      var rx = anObject(regexp);\n      var S = String(this);\n      var C = speciesConstructor(rx, RegExp);\n\n      var unicodeMatching = rx.unicode;\n      var flags = (rx.ignoreCase ? 'i' : '') +\n                  (rx.multiline ? 'm' : '') +\n                  (rx.unicode ? 'u' : '') +\n                  (SUPPORTS_Y ? 'y' : 'g');\n\n      // ^(? + rx + ) is needed, in combination with some S slicing, to\n      // simulate the 'y' flag.\n      var splitter = new C(SUPPORTS_Y ? rx : '^(?:' + rx.source + ')', flags);\n      var lim = limit === undefined ? MAX_UINT32 : limit >>> 0;\n      if (lim === 0) return [];\n      if (S.length === 0) return callRegExpExec(splitter, S) === null ? [S] : [];\n      var p = 0;\n      var q = 0;\n      var A = [];\n      while (q < S.length) {\n        splitter.lastIndex = SUPPORTS_Y ? q : 0;\n        var z = callRegExpExec(splitter, SUPPORTS_Y ? S : S.slice(q));\n        var e;\n        if (\n          z === null ||\n          (e = $min(toLength(splitter.lastIndex + (SUPPORTS_Y ? 0 : q)), S.length)) === p\n        ) {\n          q = advanceStringIndex(S, q, unicodeMatching);\n        } else {\n          A.push(S.slice(p, q));\n          if (A.length === lim) return A;\n          for (var i = 1; i <= z.length - 1; i++) {\n            A.push(z[i]);\n            if (A.length === lim) return A;\n          }\n          q = p = e;\n        }\n      }\n      A.push(S.slice(p));\n      return A;\n    }\n  ];\n});\n","'use strict';\n\nvar anObject = require('./_an-object');\nvar sameValue = require('./_same-value');\nvar regExpExec = require('./_regexp-exec-abstract');\n\n// @@search logic\nrequire('./_fix-re-wks')('search', 1, function (defined, SEARCH, $search, maybeCallNative) {\n  return [\n    // `String.prototype.search` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.search\n    function search(regexp) {\n      var O = defined(this);\n      var fn = regexp == undefined ? undefined : regexp[SEARCH];\n      return fn !== undefined ? fn.call(regexp, O) : new RegExp(regexp)[SEARCH](String(O));\n    },\n    // `RegExp.prototype[@@search]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@search\n    function (regexp) {\n      var res = maybeCallNative($search, regexp, this);\n      if (res.done) return res.value;\n      var rx = anObject(regexp);\n      var S = String(this);\n      var previousLastIndex = rx.lastIndex;\n      if (!sameValue(previousLastIndex, 0)) rx.lastIndex = 0;\n      var result = regExpExec(rx, S);\n      if (!sameValue(rx.lastIndex, previousLastIndex)) rx.lastIndex = previousLastIndex;\n      return result === null ? -1 : result.index;\n    }\n  ];\n});\n","'use strict';\nrequire('./es6.regexp.flags');\nvar anObject = require('./_an-object');\nvar $flags = require('./_flags');\nvar DESCRIPTORS = require('./_descriptors');\nvar TO_STRING = 'toString';\nvar $toString = /./[TO_STRING];\n\nvar define = function (fn) {\n  require('./_redefine')(RegExp.prototype, TO_STRING, fn, true);\n};\n\n// 21.2.5.14 RegExp.prototype.toString()\nif (require('./_fails')(function () { return $toString.call({ source: 'a', flags: 'b' }) != '/a/b'; })) {\n  define(function toString() {\n    var R = anObject(this);\n    return '/'.concat(R.source, '/',\n      'flags' in R ? R.flags : !DESCRIPTORS && R instanceof RegExp ? $flags.call(R) : undefined);\n  });\n// FF44- RegExp#toString has a wrong name\n} else if ($toString.name != TO_STRING) {\n  define(function toString() {\n    return $toString.call(this);\n  });\n}\n","'use strict';\nvar strong = require('./_collection-strong');\nvar validate = require('./_validate-collection');\nvar SET = 'Set';\n\n// 23.2 Set Objects\nmodule.exports = require('./_collection')(SET, function (get) {\n  return function Set() { return get(this, arguments.length > 0 ? arguments[0] : undefined); };\n}, {\n  // 23.2.3.1 Set.prototype.add(value)\n  add: function add(value) {\n    return strong.def(validate(this, SET), value = value === 0 ? 0 : value, value);\n  }\n}, strong);\n","exports.f = require('./_wks');\n","var global = require('./_global');\nvar core = require('./_core');\nvar LIBRARY = require('./_library');\nvar wksExt = require('./_wks-ext');\nvar defineProperty = require('./_object-dp').f;\nmodule.exports = function (name) {\n  var $Symbol = core.Symbol || (core.Symbol = LIBRARY ? {} : global.Symbol || {});\n  if (name.charAt(0) != '_' && !(name in $Symbol)) defineProperty($Symbol, name, { value: wksExt.f(name) });\n};\n","// all enumerable object keys, includes symbols\nvar getKeys = require('./_object-keys');\nvar gOPS = require('./_object-gops');\nvar pIE = require('./_object-pie');\nmodule.exports = function (it) {\n  var result = getKeys(it);\n  var getSymbols = gOPS.f;\n  if (getSymbols) {\n    var symbols = getSymbols(it);\n    var isEnum = pIE.f;\n    var i = 0;\n    var key;\n    while (symbols.length > i) if (isEnum.call(it, key = symbols[i++])) result.push(key);\n  } return result;\n};\n","'use strict';\n// ECMAScript 6 symbols shim\nvar global = require('./_global');\nvar has = require('./_has');\nvar DESCRIPTORS = require('./_descriptors');\nvar $export = require('./_export');\nvar redefine = require('./_redefine');\nvar META = require('./_meta').KEY;\nvar $fails = require('./_fails');\nvar shared = require('./_shared');\nvar setToStringTag = require('./_set-to-string-tag');\nvar uid = require('./_uid');\nvar wks = require('./_wks');\nvar wksExt = require('./_wks-ext');\nvar wksDefine = require('./_wks-define');\nvar enumKeys = require('./_enum-keys');\nvar isArray = require('./_is-array');\nvar anObject = require('./_an-object');\nvar isObject = require('./_is-object');\nvar toObject = require('./_to-object');\nvar toIObject = require('./_to-iobject');\nvar toPrimitive = require('./_to-primitive');\nvar createDesc = require('./_property-desc');\nvar _create = require('./_object-create');\nvar gOPNExt = require('./_object-gopn-ext');\nvar $GOPD = require('./_object-gopd');\nvar $GOPS = require('./_object-gops');\nvar $DP = require('./_object-dp');\nvar $keys = require('./_object-keys');\nvar gOPD = $GOPD.f;\nvar dP = $DP.f;\nvar gOPN = gOPNExt.f;\nvar $Symbol = global.Symbol;\nvar $JSON = global.JSON;\nvar _stringify = $JSON && $JSON.stringify;\nvar PROTOTYPE = 'prototype';\nvar HIDDEN = wks('_hidden');\nvar TO_PRIMITIVE = wks('toPrimitive');\nvar isEnum = {}.propertyIsEnumerable;\nvar SymbolRegistry = shared('symbol-registry');\nvar AllSymbols = shared('symbols');\nvar OPSymbols = shared('op-symbols');\nvar ObjectProto = Object[PROTOTYPE];\nvar USE_NATIVE = typeof $Symbol == 'function' && !!$GOPS.f;\nvar QObject = global.QObject;\n// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173\nvar setter = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;\n\n// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687\nvar setSymbolDesc = DESCRIPTORS && $fails(function () {\n  return _create(dP({}, 'a', {\n    get: function () { return dP(this, 'a', { value: 7 }).a; }\n  })).a != 7;\n}) ? function (it, key, D) {\n  var protoDesc = gOPD(ObjectProto, key);\n  if (protoDesc) delete ObjectProto[key];\n  dP(it, key, D);\n  if (protoDesc && it !== ObjectProto) dP(ObjectProto, key, protoDesc);\n} : dP;\n\nvar wrap = function (tag) {\n  var sym = AllSymbols[tag] = _create($Symbol[PROTOTYPE]);\n  sym._k = tag;\n  return sym;\n};\n\nvar isSymbol = USE_NATIVE && typeof $Symbol.iterator == 'symbol' ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  return it instanceof $Symbol;\n};\n\nvar $defineProperty = function defineProperty(it, key, D) {\n  if (it === ObjectProto) $defineProperty(OPSymbols, key, D);\n  anObject(it);\n  key = toPrimitive(key, true);\n  anObject(D);\n  if (has(AllSymbols, key)) {\n    if (!D.enumerable) {\n      if (!has(it, HIDDEN)) dP(it, HIDDEN, createDesc(1, {}));\n      it[HIDDEN][key] = true;\n    } else {\n      if (has(it, HIDDEN) && it[HIDDEN][key]) it[HIDDEN][key] = false;\n      D = _create(D, { enumerable: createDesc(0, false) });\n    } return setSymbolDesc(it, key, D);\n  } return dP(it, key, D);\n};\nvar $defineProperties = function defineProperties(it, P) {\n  anObject(it);\n  var keys = enumKeys(P = toIObject(P));\n  var i = 0;\n  var l = keys.length;\n  var key;\n  while (l > i) $defineProperty(it, key = keys[i++], P[key]);\n  return it;\n};\nvar $create = function create(it, P) {\n  return P === undefined ? _create(it) : $defineProperties(_create(it), P);\n};\nvar $propertyIsEnumerable = function propertyIsEnumerable(key) {\n  var E = isEnum.call(this, key = toPrimitive(key, true));\n  if (this === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return false;\n  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;\n};\nvar $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key) {\n  it = toIObject(it);\n  key = toPrimitive(key, true);\n  if (it === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return;\n  var D = gOPD(it, key);\n  if (D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key])) D.enumerable = true;\n  return D;\n};\nvar $getOwnPropertyNames = function getOwnPropertyNames(it) {\n  var names = gOPN(toIObject(it));\n  var result = [];\n  var i = 0;\n  var key;\n  while (names.length > i) {\n    if (!has(AllSymbols, key = names[i++]) && key != HIDDEN && key != META) result.push(key);\n  } return result;\n};\nvar $getOwnPropertySymbols = function getOwnPropertySymbols(it) {\n  var IS_OP = it === ObjectProto;\n  var names = gOPN(IS_OP ? OPSymbols : toIObject(it));\n  var result = [];\n  var i = 0;\n  var key;\n  while (names.length > i) {\n    if (has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectProto, key) : true)) result.push(AllSymbols[key]);\n  } return result;\n};\n\n// 19.4.1.1 Symbol([description])\nif (!USE_NATIVE) {\n  $Symbol = function Symbol() {\n    if (this instanceof $Symbol) throw TypeError('Symbol is not a constructor!');\n    var tag = uid(arguments.length > 0 ? arguments[0] : undefined);\n    var $set = function (value) {\n      if (this === ObjectProto) $set.call(OPSymbols, value);\n      if (has(this, HIDDEN) && has(this[HIDDEN], tag)) this[HIDDEN][tag] = false;\n      setSymbolDesc(this, tag, createDesc(1, value));\n    };\n    if (DESCRIPTORS && setter) setSymbolDesc(ObjectProto, tag, { configurable: true, set: $set });\n    return wrap(tag);\n  };\n  redefine($Symbol[PROTOTYPE], 'toString', function toString() {\n    return this._k;\n  });\n\n  $GOPD.f = $getOwnPropertyDescriptor;\n  $DP.f = $defineProperty;\n  require('./_object-gopn').f = gOPNExt.f = $getOwnPropertyNames;\n  require('./_object-pie').f = $propertyIsEnumerable;\n  $GOPS.f = $getOwnPropertySymbols;\n\n  if (DESCRIPTORS && !require('./_library')) {\n    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);\n  }\n\n  wksExt.f = function (name) {\n    return wrap(wks(name));\n  };\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, { Symbol: $Symbol });\n\nfor (var es6Symbols = (\n  // 19.4.2.2, 19.4.2.3, 19.4.2.4, 19.4.2.6, 19.4.2.8, 19.4.2.9, 19.4.2.10, 19.4.2.11, 19.4.2.12, 19.4.2.13, 19.4.2.14\n  'hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'\n).split(','), j = 0; es6Symbols.length > j;)wks(es6Symbols[j++]);\n\nfor (var wellKnownSymbols = $keys(wks.store), k = 0; wellKnownSymbols.length > k;) wksDefine(wellKnownSymbols[k++]);\n\n$export($export.S + $export.F * !USE_NATIVE, 'Symbol', {\n  // 19.4.2.1 Symbol.for(key)\n  'for': function (key) {\n    return has(SymbolRegistry, key += '')\n      ? SymbolRegistry[key]\n      : SymbolRegistry[key] = $Symbol(key);\n  },\n  // 19.4.2.5 Symbol.keyFor(sym)\n  keyFor: function keyFor(sym) {\n    if (!isSymbol(sym)) throw TypeError(sym + ' is not a symbol!');\n    for (var key in SymbolRegistry) if (SymbolRegistry[key] === sym) return key;\n  },\n  useSetter: function () { setter = true; },\n  useSimple: function () { setter = false; }\n});\n\n$export($export.S + $export.F * !USE_NATIVE, 'Object', {\n  // 19.1.2.2 Object.create(O [, Properties])\n  create: $create,\n  // 19.1.2.4 Object.defineProperty(O, P, Attributes)\n  defineProperty: $defineProperty,\n  // 19.1.2.3 Object.defineProperties(O, Properties)\n  defineProperties: $defineProperties,\n  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\n  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,\n  // 19.1.2.7 Object.getOwnPropertyNames(O)\n  getOwnPropertyNames: $getOwnPropertyNames,\n  // 19.1.2.8 Object.getOwnPropertySymbols(O)\n  getOwnPropertySymbols: $getOwnPropertySymbols\n});\n\n// Chrome 38 and 39 `Object.getOwnPropertySymbols` fails on primitives\n// https://bugs.chromium.org/p/v8/issues/detail?id=3443\nvar FAILS_ON_PRIMITIVES = $fails(function () { $GOPS.f(1); });\n\n$export($export.S + $export.F * FAILS_ON_PRIMITIVES, 'Object', {\n  getOwnPropertySymbols: function getOwnPropertySymbols(it) {\n    return $GOPS.f(toObject(it));\n  }\n});\n\n// 24.3.2 JSON.stringify(value [, replacer [, space]])\n$JSON && $export($export.S + $export.F * (!USE_NATIVE || $fails(function () {\n  var S = $Symbol();\n  // MS Edge converts symbol values to JSON as {}\n  // WebKit converts symbol values to JSON as null\n  // V8 throws on boxed symbols\n  return _stringify([S]) != '[null]' || _stringify({ a: S }) != '{}' || _stringify(Object(S)) != '{}';\n})), 'JSON', {\n  stringify: function stringify(it) {\n    var args = [it];\n    var i = 1;\n    var replacer, $replacer;\n    while (arguments.length > i) args.push(arguments[i++]);\n    $replacer = replacer = args[1];\n    if (!isObject(replacer) && it === undefined || isSymbol(it)) return; // IE8 returns string on undefined\n    if (!isArray(replacer)) replacer = function (key, value) {\n      if (typeof $replacer == 'function') value = $replacer.call(this, key, value);\n      if (!isSymbol(value)) return value;\n    };\n    args[1] = replacer;\n    return _stringify.apply($JSON, args);\n  }\n});\n\n// 19.4.3.4 Symbol.prototype[@@toPrimitive](hint)\n$Symbol[PROTOTYPE][TO_PRIMITIVE] || require('./_hide')($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);\n// 19.4.3.5 Symbol.prototype[@@toStringTag]\nsetToStringTag($Symbol, 'Symbol');\n// 20.2.1.9 Math[@@toStringTag]\nsetToStringTag(Math, 'Math', true);\n// 24.3.3 JSON[@@toStringTag]\nsetToStringTag(global.JSON, 'JSON', true);\n","require('./_wks-define')('asyncIterator');\n","var $export = require('./_export');\nvar fails = require('./_fails');\nvar defined = require('./_defined');\nvar quot = /\"/g;\n// B.2.3.2.1 CreateHTML(string, tag, attribute, value)\nvar createHTML = function (string, tag, attribute, value) {\n  var S = String(defined(string));\n  var p1 = '<' + tag;\n  if (attribute !== '') p1 += ' ' + attribute + '=\"' + String(value).replace(quot, '&quot;') + '\"';\n  return p1 + '>' + S + '</' + tag + '>';\n};\nmodule.exports = function (NAME, exec) {\n  var O = {};\n  O[NAME] = exec(createHTML);\n  $export($export.P + $export.F * fails(function () {\n    var test = ''[NAME]('\"');\n    return test !== test.toLowerCase() || test.split('\"').length > 3;\n  }), 'String', O);\n};\n","'use strict';\n// B.2.3.2 String.prototype.anchor(name)\nrequire('./_string-html')('anchor', function (createHTML) {\n  return function anchor(name) {\n    return createHTML(this, 'a', 'name', name);\n  };\n});\n","'use strict';\n// B.2.3.3 String.prototype.big()\nrequire('./_string-html')('big', function (createHTML) {\n  return function big() {\n    return createHTML(this, 'big', '', '');\n  };\n});\n","'use strict';\n// B.2.3.4 String.prototype.blink()\nrequire('./_string-html')('blink', function (createHTML) {\n  return function blink() {\n    return createHTML(this, 'blink', '', '');\n  };\n});\n","'use strict';\n// B.2.3.5 String.prototype.bold()\nrequire('./_string-html')('bold', function (createHTML) {\n  return function bold() {\n    return createHTML(this, 'b', '', '');\n  };\n});\n","'use strict';\nvar $export = require('./_export');\nvar $at = require('./_string-at')(false);\n$export($export.P, 'String', {\n  // 21.1.3.3 String.prototype.codePointAt(pos)\n  codePointAt: function codePointAt(pos) {\n    return $at(this, pos);\n  }\n});\n","// helper for String#{startsWith, endsWith, includes}\nvar isRegExp = require('./_is-regexp');\nvar defined = require('./_defined');\n\nmodule.exports = function (that, searchString, NAME) {\n  if (isRegExp(searchString)) throw TypeError('String#' + NAME + \" doesn't accept regex!\");\n  return String(defined(that));\n};\n","var MATCH = require('./_wks')('match');\nmodule.exports = function (KEY) {\n  var re = /./;\n  try {\n    '/./'[KEY](re);\n  } catch (e) {\n    try {\n      re[MATCH] = false;\n      return !'/./'[KEY](re);\n    } catch (f) { /* empty */ }\n  } return true;\n};\n","// 21.1.3.6 String.prototype.endsWith(searchString [, endPosition])\n'use strict';\nvar $export = require('./_export');\nvar toLength = require('./_to-length');\nvar context = require('./_string-context');\nvar ENDS_WITH = 'endsWith';\nvar $endsWith = ''[ENDS_WITH];\n\n$export($export.P + $export.F * require('./_fails-is-regexp')(ENDS_WITH), 'String', {\n  endsWith: function endsWith(searchString /* , endPosition = @length */) {\n    var that = context(this, searchString, ENDS_WITH);\n    var endPosition = arguments.length > 1 ? arguments[1] : undefined;\n    var len = toLength(that.length);\n    var end = endPosition === undefined ? len : Math.min(toLength(endPosition), len);\n    var search = String(searchString);\n    return $endsWith\n      ? $endsWith.call(that, search, end)\n      : that.slice(end - search.length, end) === search;\n  }\n});\n","'use strict';\n// B.2.3.6 String.prototype.fixed()\nrequire('./_string-html')('fixed', function (createHTML) {\n  return function fixed() {\n    return createHTML(this, 'tt', '', '');\n  };\n});\n","'use strict';\n// B.2.3.7 String.prototype.fontcolor(color)\nrequire('./_string-html')('fontcolor', function (createHTML) {\n  return function fontcolor(color) {\n    return createHTML(this, 'font', 'color', color);\n  };\n});\n","'use strict';\n// B.2.3.8 String.prototype.fontsize(size)\nrequire('./_string-html')('fontsize', function (createHTML) {\n  return function fontsize(size) {\n    return createHTML(this, 'font', 'size', size);\n  };\n});\n","var $export = require('./_export');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nvar fromCharCode = String.fromCharCode;\nvar $fromCodePoint = String.fromCodePoint;\n\n// length should be 1, old FF problem\n$export($export.S + $export.F * (!!$fromCodePoint && $fromCodePoint.length != 1), 'String', {\n  // 21.1.2.2 String.fromCodePoint(...codePoints)\n  fromCodePoint: function fromCodePoint(x) { // eslint-disable-line no-unused-vars\n    var res = [];\n    var aLen = arguments.length;\n    var i = 0;\n    var code;\n    while (aLen > i) {\n      code = +arguments[i++];\n      if (toAbsoluteIndex(code, 0x10ffff) !== code) throw RangeError(code + ' is not a valid code point');\n      res.push(code < 0x10000\n        ? fromCharCode(code)\n        : fromCharCode(((code -= 0x10000) >> 10) + 0xd800, code % 0x400 + 0xdc00)\n      );\n    } return res.join('');\n  }\n});\n","// 21.1.3.7 String.prototype.includes(searchString, position = 0)\n'use strict';\nvar $export = require('./_export');\nvar context = require('./_string-context');\nvar INCLUDES = 'includes';\n\n$export($export.P + $export.F * require('./_fails-is-regexp')(INCLUDES), 'String', {\n  includes: function includes(searchString /* , position = 0 */) {\n    return !!~context(this, searchString, INCLUDES)\n      .indexOf(searchString, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\n// B.2.3.9 String.prototype.italics()\nrequire('./_string-html')('italics', function (createHTML) {\n  return function italics() {\n    return createHTML(this, 'i', '', '');\n  };\n});\n","'use strict';\nvar $at = require('./_string-at')(true);\n\n// 21.1.3.27 String.prototype[@@iterator]()\nrequire('./_iter-define')(String, 'String', function (iterated) {\n  this._t = String(iterated); // target\n  this._i = 0;                // next index\n// 21.1.5.2.1 %StringIteratorPrototype%.next()\n}, function () {\n  var O = this._t;\n  var index = this._i;\n  var point;\n  if (index >= O.length) return { value: undefined, done: true };\n  point = $at(O, index);\n  this._i += point.length;\n  return { value: point, done: false };\n});\n","'use strict';\n// B.2.3.10 String.prototype.link(url)\nrequire('./_string-html')('link', function (createHTML) {\n  return function link(url) {\n    return createHTML(this, 'a', 'href', url);\n  };\n});\n","'use strict';\nvar toInteger = require('./_to-integer');\nvar defined = require('./_defined');\n\nmodule.exports = function repeat(count) {\n  var str = String(defined(this));\n  var res = '';\n  var n = toInteger(count);\n  if (n < 0 || n == Infinity) throw RangeError(\"Count can't be negative\");\n  for (;n > 0; (n >>>= 1) && (str += str)) if (n & 1) res += str;\n  return res;\n};\n","// https://github.com/tc39/proposal-string-pad-start-end\nvar toLength = require('./_to-length');\nvar repeat = require('./_string-repeat');\nvar defined = require('./_defined');\n\nmodule.exports = function (that, maxLength, fillString, left) {\n  var S = String(defined(that));\n  var stringLength = S.length;\n  var fillStr = fillString === undefined ? ' ' : String(fillString);\n  var intMaxLength = toLength(maxLength);\n  if (intMaxLength <= stringLength || fillStr == '') return S;\n  var fillLen = intMaxLength - stringLength;\n  var stringFiller = repeat.call(fillStr, Math.ceil(fillLen / fillStr.length));\n  if (stringFiller.length > fillLen) stringFiller = stringFiller.slice(0, fillLen);\n  return left ? stringFiller + S : S + stringFiller;\n};\n","'use strict';\n// https://github.com/tc39/proposal-string-pad-start-end\nvar $export = require('./_export');\nvar $pad = require('./_string-pad');\nvar userAgent = require('./_user-agent');\n\n// https://github.com/zloirock/core-js/issues/280\nvar WEBKIT_BUG = /Version\\/10\\.\\d+(\\.\\d+)?( Mobile\\/\\w+)? Safari\\//.test(userAgent);\n\n$export($export.P + $export.F * WEBKIT_BUG, 'String', {\n  padStart: function padStart(maxLength /* , fillString = ' ' */) {\n    return $pad(this, maxLength, arguments.length > 1 ? arguments[1] : undefined, true);\n  }\n});\n","'use strict';\n// https://github.com/tc39/proposal-string-pad-start-end\nvar $export = require('./_export');\nvar $pad = require('./_string-pad');\nvar userAgent = require('./_user-agent');\n\n// https://github.com/zloirock/core-js/issues/280\nvar WEBKIT_BUG = /Version\\/10\\.\\d+(\\.\\d+)?( Mobile\\/\\w+)? Safari\\//.test(userAgent);\n\n$export($export.P + $export.F * WEBKIT_BUG, 'String', {\n  padEnd: function padEnd(maxLength /* , fillString = ' ' */) {\n    return $pad(this, maxLength, arguments.length > 1 ? arguments[1] : undefined, false);\n  }\n});\n","var $export = require('./_export');\nvar toIObject = require('./_to-iobject');\nvar toLength = require('./_to-length');\n\n$export($export.S, 'String', {\n  // 21.1.2.4 String.raw(callSite, ...substitutions)\n  raw: function raw(callSite) {\n    var tpl = toIObject(callSite.raw);\n    var len = toLength(tpl.length);\n    var aLen = arguments.length;\n    var res = [];\n    var i = 0;\n    while (len > i) {\n      res.push(String(tpl[i++]));\n      if (i < aLen) res.push(String(arguments[i]));\n    } return res.join('');\n  }\n});\n","var $export = require('./_export');\n\n$export($export.P, 'String', {\n  // 21.1.3.13 String.prototype.repeat(count)\n  repeat: require('./_string-repeat')\n});\n","'use strict';\n// B.2.3.11 String.prototype.small()\nrequire('./_string-html')('small', function (createHTML) {\n  return function small() {\n    return createHTML(this, 'small', '', '');\n  };\n});\n","// 21.1.3.18 String.prototype.startsWith(searchString [, position ])\n'use strict';\nvar $export = require('./_export');\nvar toLength = require('./_to-length');\nvar context = require('./_string-context');\nvar STARTS_WITH = 'startsWith';\nvar $startsWith = ''[STARTS_WITH];\n\n$export($export.P + $export.F * require('./_fails-is-regexp')(STARTS_WITH), 'String', {\n  startsWith: function startsWith(searchString /* , position = 0 */) {\n    var that = context(this, searchString, STARTS_WITH);\n    var index = toLength(Math.min(arguments.length > 1 ? arguments[1] : undefined, that.length));\n    var search = String(searchString);\n    return $startsWith\n      ? $startsWith.call(that, search, index)\n      : that.slice(index, index + search.length) === search;\n  }\n});\n","'use strict';\n// B.2.3.12 String.prototype.strike()\nrequire('./_string-html')('strike', function (createHTML) {\n  return function strike() {\n    return createHTML(this, 'strike', '', '');\n  };\n});\n","'use strict';\n// B.2.3.13 String.prototype.sub()\nrequire('./_string-html')('sub', function (createHTML) {\n  return function sub() {\n    return createHTML(this, 'sub', '', '');\n  };\n});\n","'use strict';\n// B.2.3.14 String.prototype.sup()\nrequire('./_string-html')('sup', function (createHTML) {\n  return function sup() {\n    return createHTML(this, 'sup', '', '');\n  };\n});\n","var global = require('./_global');\nvar hide = require('./_hide');\nvar uid = require('./_uid');\nvar TYPED = uid('typed_array');\nvar VIEW = uid('view');\nvar ABV = !!(global.ArrayBuffer && global.DataView);\nvar CONSTR = ABV;\nvar i = 0;\nvar l = 9;\nvar Typed;\n\nvar TypedArrayConstructors = (\n  'Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array'\n).split(',');\n\nwhile (i < l) {\n  if (Typed = global[TypedArrayConstructors[i++]]) {\n    hide(Typed.prototype, TYPED, true);\n    hide(Typed.prototype, VIEW, true);\n  } else CONSTR = false;\n}\n\nmodule.exports = {\n  ABV: ABV,\n  CONSTR: CONSTR,\n  TYPED: TYPED,\n  VIEW: VIEW\n};\n","// https://tc39.github.io/ecma262/#sec-toindex\nvar toInteger = require('./_to-integer');\nvar toLength = require('./_to-length');\nmodule.exports = function (it) {\n  if (it === undefined) return 0;\n  var number = toInteger(it);\n  var length = toLength(number);\n  if (number !== length) throw RangeError('Wrong length!');\n  return length;\n};\n","'use strict';\nvar global = require('./_global');\nvar DESCRIPTORS = require('./_descriptors');\nvar LIBRARY = require('./_library');\nvar $typed = require('./_typed');\nvar hide = require('./_hide');\nvar redefineAll = require('./_redefine-all');\nvar fails = require('./_fails');\nvar anInstance = require('./_an-instance');\nvar toInteger = require('./_to-integer');\nvar toLength = require('./_to-length');\nvar toIndex = require('./_to-index');\nvar gOPN = require('./_object-gopn').f;\nvar dP = require('./_object-dp').f;\nvar arrayFill = require('./_array-fill');\nvar setToStringTag = require('./_set-to-string-tag');\nvar ARRAY_BUFFER = 'ArrayBuffer';\nvar DATA_VIEW = 'DataView';\nvar PROTOTYPE = 'prototype';\nvar WRONG_LENGTH = 'Wrong length!';\nvar WRONG_INDEX = 'Wrong index!';\nvar $ArrayBuffer = global[ARRAY_BUFFER];\nvar $DataView = global[DATA_VIEW];\nvar Math = global.Math;\nvar RangeError = global.RangeError;\n// eslint-disable-next-line no-shadow-restricted-names\nvar Infinity = global.Infinity;\nvar BaseBuffer = $ArrayBuffer;\nvar abs = Math.abs;\nvar pow = Math.pow;\nvar floor = Math.floor;\nvar log = Math.log;\nvar LN2 = Math.LN2;\nvar BUFFER = 'buffer';\nvar BYTE_LENGTH = 'byteLength';\nvar BYTE_OFFSET = 'byteOffset';\nvar $BUFFER = DESCRIPTORS ? '_b' : BUFFER;\nvar $LENGTH = DESCRIPTORS ? '_l' : BYTE_LENGTH;\nvar $OFFSET = DESCRIPTORS ? '_o' : BYTE_OFFSET;\n\n// IEEE754 conversions based on https://github.com/feross/ieee754\nfunction packIEEE754(value, mLen, nBytes) {\n  var buffer = new Array(nBytes);\n  var eLen = nBytes * 8 - mLen - 1;\n  var eMax = (1 << eLen) - 1;\n  var eBias = eMax >> 1;\n  var rt = mLen === 23 ? pow(2, -24) - pow(2, -77) : 0;\n  var i = 0;\n  var s = value < 0 || value === 0 && 1 / value < 0 ? 1 : 0;\n  var e, m, c;\n  value = abs(value);\n  // eslint-disable-next-line no-self-compare\n  if (value != value || value === Infinity) {\n    // eslint-disable-next-line no-self-compare\n    m = value != value ? 1 : 0;\n    e = eMax;\n  } else {\n    e = floor(log(value) / LN2);\n    if (value * (c = pow(2, -e)) < 1) {\n      e--;\n      c *= 2;\n    }\n    if (e + eBias >= 1) {\n      value += rt / c;\n    } else {\n      value += rt * pow(2, 1 - eBias);\n    }\n    if (value * c >= 2) {\n      e++;\n      c /= 2;\n    }\n    if (e + eBias >= eMax) {\n      m = 0;\n      e = eMax;\n    } else if (e + eBias >= 1) {\n      m = (value * c - 1) * pow(2, mLen);\n      e = e + eBias;\n    } else {\n      m = value * pow(2, eBias - 1) * pow(2, mLen);\n      e = 0;\n    }\n  }\n  for (; mLen >= 8; buffer[i++] = m & 255, m /= 256, mLen -= 8);\n  e = e << mLen | m;\n  eLen += mLen;\n  for (; eLen > 0; buffer[i++] = e & 255, e /= 256, eLen -= 8);\n  buffer[--i] |= s * 128;\n  return buffer;\n}\nfunction unpackIEEE754(buffer, mLen, nBytes) {\n  var eLen = nBytes * 8 - mLen - 1;\n  var eMax = (1 << eLen) - 1;\n  var eBias = eMax >> 1;\n  var nBits = eLen - 7;\n  var i = nBytes - 1;\n  var s = buffer[i--];\n  var e = s & 127;\n  var m;\n  s >>= 7;\n  for (; nBits > 0; e = e * 256 + buffer[i], i--, nBits -= 8);\n  m = e & (1 << -nBits) - 1;\n  e >>= -nBits;\n  nBits += mLen;\n  for (; nBits > 0; m = m * 256 + buffer[i], i--, nBits -= 8);\n  if (e === 0) {\n    e = 1 - eBias;\n  } else if (e === eMax) {\n    return m ? NaN : s ? -Infinity : Infinity;\n  } else {\n    m = m + pow(2, mLen);\n    e = e - eBias;\n  } return (s ? -1 : 1) * m * pow(2, e - mLen);\n}\n\nfunction unpackI32(bytes) {\n  return bytes[3] << 24 | bytes[2] << 16 | bytes[1] << 8 | bytes[0];\n}\nfunction packI8(it) {\n  return [it & 0xff];\n}\nfunction packI16(it) {\n  return [it & 0xff, it >> 8 & 0xff];\n}\nfunction packI32(it) {\n  return [it & 0xff, it >> 8 & 0xff, it >> 16 & 0xff, it >> 24 & 0xff];\n}\nfunction packF64(it) {\n  return packIEEE754(it, 52, 8);\n}\nfunction packF32(it) {\n  return packIEEE754(it, 23, 4);\n}\n\nfunction addGetter(C, key, internal) {\n  dP(C[PROTOTYPE], key, { get: function () { return this[internal]; } });\n}\n\nfunction get(view, bytes, index, isLittleEndian) {\n  var numIndex = +index;\n  var intIndex = toIndex(numIndex);\n  if (intIndex + bytes > view[$LENGTH]) throw RangeError(WRONG_INDEX);\n  var store = view[$BUFFER]._b;\n  var start = intIndex + view[$OFFSET];\n  var pack = store.slice(start, start + bytes);\n  return isLittleEndian ? pack : pack.reverse();\n}\nfunction set(view, bytes, index, conversion, value, isLittleEndian) {\n  var numIndex = +index;\n  var intIndex = toIndex(numIndex);\n  if (intIndex + bytes > view[$LENGTH]) throw RangeError(WRONG_INDEX);\n  var store = view[$BUFFER]._b;\n  var start = intIndex + view[$OFFSET];\n  var pack = conversion(+value);\n  for (var i = 0; i < bytes; i++) store[start + i] = pack[isLittleEndian ? i : bytes - i - 1];\n}\n\nif (!$typed.ABV) {\n  $ArrayBuffer = function ArrayBuffer(length) {\n    anInstance(this, $ArrayBuffer, ARRAY_BUFFER);\n    var byteLength = toIndex(length);\n    this._b = arrayFill.call(new Array(byteLength), 0);\n    this[$LENGTH] = byteLength;\n  };\n\n  $DataView = function DataView(buffer, byteOffset, byteLength) {\n    anInstance(this, $DataView, DATA_VIEW);\n    anInstance(buffer, $ArrayBuffer, DATA_VIEW);\n    var bufferLength = buffer[$LENGTH];\n    var offset = toInteger(byteOffset);\n    if (offset < 0 || offset > bufferLength) throw RangeError('Wrong offset!');\n    byteLength = byteLength === undefined ? bufferLength - offset : toLength(byteLength);\n    if (offset + byteLength > bufferLength) throw RangeError(WRONG_LENGTH);\n    this[$BUFFER] = buffer;\n    this[$OFFSET] = offset;\n    this[$LENGTH] = byteLength;\n  };\n\n  if (DESCRIPTORS) {\n    addGetter($ArrayBuffer, BYTE_LENGTH, '_l');\n    addGetter($DataView, BUFFER, '_b');\n    addGetter($DataView, BYTE_LENGTH, '_l');\n    addGetter($DataView, BYTE_OFFSET, '_o');\n  }\n\n  redefineAll($DataView[PROTOTYPE], {\n    getInt8: function getInt8(byteOffset) {\n      return get(this, 1, byteOffset)[0] << 24 >> 24;\n    },\n    getUint8: function getUint8(byteOffset) {\n      return get(this, 1, byteOffset)[0];\n    },\n    getInt16: function getInt16(byteOffset /* , littleEndian */) {\n      var bytes = get(this, 2, byteOffset, arguments[1]);\n      return (bytes[1] << 8 | bytes[0]) << 16 >> 16;\n    },\n    getUint16: function getUint16(byteOffset /* , littleEndian */) {\n      var bytes = get(this, 2, byteOffset, arguments[1]);\n      return bytes[1] << 8 | bytes[0];\n    },\n    getInt32: function getInt32(byteOffset /* , littleEndian */) {\n      return unpackI32(get(this, 4, byteOffset, arguments[1]));\n    },\n    getUint32: function getUint32(byteOffset /* , littleEndian */) {\n      return unpackI32(get(this, 4, byteOffset, arguments[1])) >>> 0;\n    },\n    getFloat32: function getFloat32(byteOffset /* , littleEndian */) {\n      return unpackIEEE754(get(this, 4, byteOffset, arguments[1]), 23, 4);\n    },\n    getFloat64: function getFloat64(byteOffset /* , littleEndian */) {\n      return unpackIEEE754(get(this, 8, byteOffset, arguments[1]), 52, 8);\n    },\n    setInt8: function setInt8(byteOffset, value) {\n      set(this, 1, byteOffset, packI8, value);\n    },\n    setUint8: function setUint8(byteOffset, value) {\n      set(this, 1, byteOffset, packI8, value);\n    },\n    setInt16: function setInt16(byteOffset, value /* , littleEndian */) {\n      set(this, 2, byteOffset, packI16, value, arguments[2]);\n    },\n    setUint16: function setUint16(byteOffset, value /* , littleEndian */) {\n      set(this, 2, byteOffset, packI16, value, arguments[2]);\n    },\n    setInt32: function setInt32(byteOffset, value /* , littleEndian */) {\n      set(this, 4, byteOffset, packI32, value, arguments[2]);\n    },\n    setUint32: function setUint32(byteOffset, value /* , littleEndian */) {\n      set(this, 4, byteOffset, packI32, value, arguments[2]);\n    },\n    setFloat32: function setFloat32(byteOffset, value /* , littleEndian */) {\n      set(this, 4, byteOffset, packF32, value, arguments[2]);\n    },\n    setFloat64: function setFloat64(byteOffset, value /* , littleEndian */) {\n      set(this, 8, byteOffset, packF64, value, arguments[2]);\n    }\n  });\n} else {\n  if (!fails(function () {\n    $ArrayBuffer(1);\n  }) || !fails(function () {\n    new $ArrayBuffer(-1); // eslint-disable-line no-new\n  }) || fails(function () {\n    new $ArrayBuffer(); // eslint-disable-line no-new\n    new $ArrayBuffer(1.5); // eslint-disable-line no-new\n    new $ArrayBuffer(NaN); // eslint-disable-line no-new\n    return $ArrayBuffer.name != ARRAY_BUFFER;\n  })) {\n    $ArrayBuffer = function ArrayBuffer(length) {\n      anInstance(this, $ArrayBuffer);\n      return new BaseBuffer(toIndex(length));\n    };\n    var ArrayBufferProto = $ArrayBuffer[PROTOTYPE] = BaseBuffer[PROTOTYPE];\n    for (var keys = gOPN(BaseBuffer), j = 0, key; keys.length > j;) {\n      if (!((key = keys[j++]) in $ArrayBuffer)) hide($ArrayBuffer, key, BaseBuffer[key]);\n    }\n    if (!LIBRARY) ArrayBufferProto.constructor = $ArrayBuffer;\n  }\n  // iOS Safari 7.x bug\n  var view = new $DataView(new $ArrayBuffer(2));\n  var $setInt8 = $DataView[PROTOTYPE].setInt8;\n  view.setInt8(0, 2147483648);\n  view.setInt8(1, 2147483649);\n  if (view.getInt8(0) || !view.getInt8(1)) redefineAll($DataView[PROTOTYPE], {\n    setInt8: function setInt8(byteOffset, value) {\n      $setInt8.call(this, byteOffset, value << 24 >> 24);\n    },\n    setUint8: function setUint8(byteOffset, value) {\n      $setInt8.call(this, byteOffset, value << 24 >> 24);\n    }\n  }, true);\n}\nsetToStringTag($ArrayBuffer, ARRAY_BUFFER);\nsetToStringTag($DataView, DATA_VIEW);\nhide($DataView[PROTOTYPE], $typed.VIEW, true);\nexports[ARRAY_BUFFER] = $ArrayBuffer;\nexports[DATA_VIEW] = $DataView;\n","'use strict';\nvar $export = require('./_export');\nvar $typed = require('./_typed');\nvar buffer = require('./_typed-buffer');\nvar anObject = require('./_an-object');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nvar toLength = require('./_to-length');\nvar isObject = require('./_is-object');\nvar ArrayBuffer = require('./_global').ArrayBuffer;\nvar speciesConstructor = require('./_species-constructor');\nvar $ArrayBuffer = buffer.ArrayBuffer;\nvar $DataView = buffer.DataView;\nvar $isView = $typed.ABV && ArrayBuffer.isView;\nvar $slice = $ArrayBuffer.prototype.slice;\nvar VIEW = $typed.VIEW;\nvar ARRAY_BUFFER = 'ArrayBuffer';\n\n$export($export.G + $export.W + $export.F * (ArrayBuffer !== $ArrayBuffer), { ArrayBuffer: $ArrayBuffer });\n\n$export($export.S + $export.F * !$typed.CONSTR, ARRAY_BUFFER, {\n  // 24.1.3.1 ArrayBuffer.isView(arg)\n  isView: function isView(it) {\n    return $isView && $isView(it) || isObject(it) && VIEW in it;\n  }\n});\n\n$export($export.P + $export.U + $export.F * require('./_fails')(function () {\n  return !new $ArrayBuffer(2).slice(1, undefined).byteLength;\n}), ARRAY_BUFFER, {\n  // 24.1.4.3 ArrayBuffer.prototype.slice(start, end)\n  slice: function slice(start, end) {\n    if ($slice !== undefined && end === undefined) return $slice.call(anObject(this), start); // FF fix\n    var len = anObject(this).byteLength;\n    var first = toAbsoluteIndex(start, len);\n    var fin = toAbsoluteIndex(end === undefined ? len : end, len);\n    var result = new (speciesConstructor(this, $ArrayBuffer))(toLength(fin - first));\n    var viewS = new $DataView(this);\n    var viewT = new $DataView(result);\n    var index = 0;\n    while (first < fin) {\n      viewT.setUint8(index++, viewS.getUint8(first++));\n    } return result;\n  }\n});\n\nrequire('./_set-species')(ARRAY_BUFFER);\n","'use strict';\nif (require('./_descriptors')) {\n  var LIBRARY = require('./_library');\n  var global = require('./_global');\n  var fails = require('./_fails');\n  var $export = require('./_export');\n  var $typed = require('./_typed');\n  var $buffer = require('./_typed-buffer');\n  var ctx = require('./_ctx');\n  var anInstance = require('./_an-instance');\n  var propertyDesc = require('./_property-desc');\n  var hide = require('./_hide');\n  var redefineAll = require('./_redefine-all');\n  var toInteger = require('./_to-integer');\n  var toLength = require('./_to-length');\n  var toIndex = require('./_to-index');\n  var toAbsoluteIndex = require('./_to-absolute-index');\n  var toPrimitive = require('./_to-primitive');\n  var has = require('./_has');\n  var classof = require('./_classof');\n  var isObject = require('./_is-object');\n  var toObject = require('./_to-object');\n  var isArrayIter = require('./_is-array-iter');\n  var create = require('./_object-create');\n  var getPrototypeOf = require('./_object-gpo');\n  var gOPN = require('./_object-gopn').f;\n  var getIterFn = require('./core.get-iterator-method');\n  var uid = require('./_uid');\n  var wks = require('./_wks');\n  var createArrayMethod = require('./_array-methods');\n  var createArrayIncludes = require('./_array-includes');\n  var speciesConstructor = require('./_species-constructor');\n  var ArrayIterators = require('./es6.array.iterator');\n  var Iterators = require('./_iterators');\n  var $iterDetect = require('./_iter-detect');\n  var setSpecies = require('./_set-species');\n  var arrayFill = require('./_array-fill');\n  var arrayCopyWithin = require('./_array-copy-within');\n  var $DP = require('./_object-dp');\n  var $GOPD = require('./_object-gopd');\n  var dP = $DP.f;\n  var gOPD = $GOPD.f;\n  var RangeError = global.RangeError;\n  var TypeError = global.TypeError;\n  var Uint8Array = global.Uint8Array;\n  var ARRAY_BUFFER = 'ArrayBuffer';\n  var SHARED_BUFFER = 'Shared' + ARRAY_BUFFER;\n  var BYTES_PER_ELEMENT = 'BYTES_PER_ELEMENT';\n  var PROTOTYPE = 'prototype';\n  var ArrayProto = Array[PROTOTYPE];\n  var $ArrayBuffer = $buffer.ArrayBuffer;\n  var $DataView = $buffer.DataView;\n  var arrayForEach = createArrayMethod(0);\n  var arrayFilter = createArrayMethod(2);\n  var arraySome = createArrayMethod(3);\n  var arrayEvery = createArrayMethod(4);\n  var arrayFind = createArrayMethod(5);\n  var arrayFindIndex = createArrayMethod(6);\n  var arrayIncludes = createArrayIncludes(true);\n  var arrayIndexOf = createArrayIncludes(false);\n  var arrayValues = ArrayIterators.values;\n  var arrayKeys = ArrayIterators.keys;\n  var arrayEntries = ArrayIterators.entries;\n  var arrayLastIndexOf = ArrayProto.lastIndexOf;\n  var arrayReduce = ArrayProto.reduce;\n  var arrayReduceRight = ArrayProto.reduceRight;\n  var arrayJoin = ArrayProto.join;\n  var arraySort = ArrayProto.sort;\n  var arraySlice = ArrayProto.slice;\n  var arrayToString = ArrayProto.toString;\n  var arrayToLocaleString = ArrayProto.toLocaleString;\n  var ITERATOR = wks('iterator');\n  var TAG = wks('toStringTag');\n  var TYPED_CONSTRUCTOR = uid('typed_constructor');\n  var DEF_CONSTRUCTOR = uid('def_constructor');\n  var ALL_CONSTRUCTORS = $typed.CONSTR;\n  var TYPED_ARRAY = $typed.TYPED;\n  var VIEW = $typed.VIEW;\n  var WRONG_LENGTH = 'Wrong length!';\n\n  var $map = createArrayMethod(1, function (O, length) {\n    return allocate(speciesConstructor(O, O[DEF_CONSTRUCTOR]), length);\n  });\n\n  var LITTLE_ENDIAN = fails(function () {\n    // eslint-disable-next-line no-undef\n    return new Uint8Array(new Uint16Array([1]).buffer)[0] === 1;\n  });\n\n  var FORCED_SET = !!Uint8Array && !!Uint8Array[PROTOTYPE].set && fails(function () {\n    new Uint8Array(1).set({});\n  });\n\n  var toOffset = function (it, BYTES) {\n    var offset = toInteger(it);\n    if (offset < 0 || offset % BYTES) throw RangeError('Wrong offset!');\n    return offset;\n  };\n\n  var validate = function (it) {\n    if (isObject(it) && TYPED_ARRAY in it) return it;\n    throw TypeError(it + ' is not a typed array!');\n  };\n\n  var allocate = function (C, length) {\n    if (!(isObject(C) && TYPED_CONSTRUCTOR in C)) {\n      throw TypeError('It is not a typed array constructor!');\n    } return new C(length);\n  };\n\n  var speciesFromList = function (O, list) {\n    return fromList(speciesConstructor(O, O[DEF_CONSTRUCTOR]), list);\n  };\n\n  var fromList = function (C, list) {\n    var index = 0;\n    var length = list.length;\n    var result = allocate(C, length);\n    while (length > index) result[index] = list[index++];\n    return result;\n  };\n\n  var addGetter = function (it, key, internal) {\n    dP(it, key, { get: function () { return this._d[internal]; } });\n  };\n\n  var $from = function from(source /* , mapfn, thisArg */) {\n    var O = toObject(source);\n    var aLen = arguments.length;\n    var mapfn = aLen > 1 ? arguments[1] : undefined;\n    var mapping = mapfn !== undefined;\n    var iterFn = getIterFn(O);\n    var i, length, values, result, step, iterator;\n    if (iterFn != undefined && !isArrayIter(iterFn)) {\n      for (iterator = iterFn.call(O), values = [], i = 0; !(step = iterator.next()).done; i++) {\n        values.push(step.value);\n      } O = values;\n    }\n    if (mapping && aLen > 2) mapfn = ctx(mapfn, arguments[2], 2);\n    for (i = 0, length = toLength(O.length), result = allocate(this, length); length > i; i++) {\n      result[i] = mapping ? mapfn(O[i], i) : O[i];\n    }\n    return result;\n  };\n\n  var $of = function of(/* ...items */) {\n    var index = 0;\n    var length = arguments.length;\n    var result = allocate(this, length);\n    while (length > index) result[index] = arguments[index++];\n    return result;\n  };\n\n  // iOS Safari 6.x fails here\n  var TO_LOCALE_BUG = !!Uint8Array && fails(function () { arrayToLocaleString.call(new Uint8Array(1)); });\n\n  var $toLocaleString = function toLocaleString() {\n    return arrayToLocaleString.apply(TO_LOCALE_BUG ? arraySlice.call(validate(this)) : validate(this), arguments);\n  };\n\n  var proto = {\n    copyWithin: function copyWithin(target, start /* , end */) {\n      return arrayCopyWithin.call(validate(this), target, start, arguments.length > 2 ? arguments[2] : undefined);\n    },\n    every: function every(callbackfn /* , thisArg */) {\n      return arrayEvery(validate(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    fill: function fill(value /* , start, end */) { // eslint-disable-line no-unused-vars\n      return arrayFill.apply(validate(this), arguments);\n    },\n    filter: function filter(callbackfn /* , thisArg */) {\n      return speciesFromList(this, arrayFilter(validate(this), callbackfn,\n        arguments.length > 1 ? arguments[1] : undefined));\n    },\n    find: function find(predicate /* , thisArg */) {\n      return arrayFind(validate(this), predicate, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    findIndex: function findIndex(predicate /* , thisArg */) {\n      return arrayFindIndex(validate(this), predicate, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    forEach: function forEach(callbackfn /* , thisArg */) {\n      arrayForEach(validate(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    indexOf: function indexOf(searchElement /* , fromIndex */) {\n      return arrayIndexOf(validate(this), searchElement, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    includes: function includes(searchElement /* , fromIndex */) {\n      return arrayIncludes(validate(this), searchElement, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    join: function join(separator) { // eslint-disable-line no-unused-vars\n      return arrayJoin.apply(validate(this), arguments);\n    },\n    lastIndexOf: function lastIndexOf(searchElement /* , fromIndex */) { // eslint-disable-line no-unused-vars\n      return arrayLastIndexOf.apply(validate(this), arguments);\n    },\n    map: function map(mapfn /* , thisArg */) {\n      return $map(validate(this), mapfn, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    reduce: function reduce(callbackfn /* , initialValue */) { // eslint-disable-line no-unused-vars\n      return arrayReduce.apply(validate(this), arguments);\n    },\n    reduceRight: function reduceRight(callbackfn /* , initialValue */) { // eslint-disable-line no-unused-vars\n      return arrayReduceRight.apply(validate(this), arguments);\n    },\n    reverse: function reverse() {\n      var that = this;\n      var length = validate(that).length;\n      var middle = Math.floor(length / 2);\n      var index = 0;\n      var value;\n      while (index < middle) {\n        value = that[index];\n        that[index++] = that[--length];\n        that[length] = value;\n      } return that;\n    },\n    some: function some(callbackfn /* , thisArg */) {\n      return arraySome(validate(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    sort: function sort(comparefn) {\n      return arraySort.call(validate(this), comparefn);\n    },\n    subarray: function subarray(begin, end) {\n      var O = validate(this);\n      var length = O.length;\n      var $begin = toAbsoluteIndex(begin, length);\n      return new (speciesConstructor(O, O[DEF_CONSTRUCTOR]))(\n        O.buffer,\n        O.byteOffset + $begin * O.BYTES_PER_ELEMENT,\n        toLength((end === undefined ? length : toAbsoluteIndex(end, length)) - $begin)\n      );\n    }\n  };\n\n  var $slice = function slice(start, end) {\n    return speciesFromList(this, arraySlice.call(validate(this), start, end));\n  };\n\n  var $set = function set(arrayLike /* , offset */) {\n    validate(this);\n    var offset = toOffset(arguments[1], 1);\n    var length = this.length;\n    var src = toObject(arrayLike);\n    var len = toLength(src.length);\n    var index = 0;\n    if (len + offset > length) throw RangeError(WRONG_LENGTH);\n    while (index < len) this[offset + index] = src[index++];\n  };\n\n  var $iterators = {\n    entries: function entries() {\n      return arrayEntries.call(validate(this));\n    },\n    keys: function keys() {\n      return arrayKeys.call(validate(this));\n    },\n    values: function values() {\n      return arrayValues.call(validate(this));\n    }\n  };\n\n  var isTAIndex = function (target, key) {\n    return isObject(target)\n      && target[TYPED_ARRAY]\n      && typeof key != 'symbol'\n      && key in target\n      && String(+key) == String(key);\n  };\n  var $getDesc = function getOwnPropertyDescriptor(target, key) {\n    return isTAIndex(target, key = toPrimitive(key, true))\n      ? propertyDesc(2, target[key])\n      : gOPD(target, key);\n  };\n  var $setDesc = function defineProperty(target, key, desc) {\n    if (isTAIndex(target, key = toPrimitive(key, true))\n      && isObject(desc)\n      && has(desc, 'value')\n      && !has(desc, 'get')\n      && !has(desc, 'set')\n      // TODO: add validation descriptor w/o calling accessors\n      && !desc.configurable\n      && (!has(desc, 'writable') || desc.writable)\n      && (!has(desc, 'enumerable') || desc.enumerable)\n    ) {\n      target[key] = desc.value;\n      return target;\n    } return dP(target, key, desc);\n  };\n\n  if (!ALL_CONSTRUCTORS) {\n    $GOPD.f = $getDesc;\n    $DP.f = $setDesc;\n  }\n\n  $export($export.S + $export.F * !ALL_CONSTRUCTORS, 'Object', {\n    getOwnPropertyDescriptor: $getDesc,\n    defineProperty: $setDesc\n  });\n\n  if (fails(function () { arrayToString.call({}); })) {\n    arrayToString = arrayToLocaleString = function toString() {\n      return arrayJoin.call(this);\n    };\n  }\n\n  var $TypedArrayPrototype$ = redefineAll({}, proto);\n  redefineAll($TypedArrayPrototype$, $iterators);\n  hide($TypedArrayPrototype$, ITERATOR, $iterators.values);\n  redefineAll($TypedArrayPrototype$, {\n    slice: $slice,\n    set: $set,\n    constructor: function () { /* noop */ },\n    toString: arrayToString,\n    toLocaleString: $toLocaleString\n  });\n  addGetter($TypedArrayPrototype$, 'buffer', 'b');\n  addGetter($TypedArrayPrototype$, 'byteOffset', 'o');\n  addGetter($TypedArrayPrototype$, 'byteLength', 'l');\n  addGetter($TypedArrayPrototype$, 'length', 'e');\n  dP($TypedArrayPrototype$, TAG, {\n    get: function () { return this[TYPED_ARRAY]; }\n  });\n\n  // eslint-disable-next-line max-statements\n  module.exports = function (KEY, BYTES, wrapper, CLAMPED) {\n    CLAMPED = !!CLAMPED;\n    var NAME = KEY + (CLAMPED ? 'Clamped' : '') + 'Array';\n    var GETTER = 'get' + KEY;\n    var SETTER = 'set' + KEY;\n    var TypedArray = global[NAME];\n    var Base = TypedArray || {};\n    var TAC = TypedArray && getPrototypeOf(TypedArray);\n    var FORCED = !TypedArray || !$typed.ABV;\n    var O = {};\n    var TypedArrayPrototype = TypedArray && TypedArray[PROTOTYPE];\n    var getter = function (that, index) {\n      var data = that._d;\n      return data.v[GETTER](index * BYTES + data.o, LITTLE_ENDIAN);\n    };\n    var setter = function (that, index, value) {\n      var data = that._d;\n      if (CLAMPED) value = (value = Math.round(value)) < 0 ? 0 : value > 0xff ? 0xff : value & 0xff;\n      data.v[SETTER](index * BYTES + data.o, value, LITTLE_ENDIAN);\n    };\n    var addElement = function (that, index) {\n      dP(that, index, {\n        get: function () {\n          return getter(this, index);\n        },\n        set: function (value) {\n          return setter(this, index, value);\n        },\n        enumerable: true\n      });\n    };\n    if (FORCED) {\n      TypedArray = wrapper(function (that, data, $offset, $length) {\n        anInstance(that, TypedArray, NAME, '_d');\n        var index = 0;\n        var offset = 0;\n        var buffer, byteLength, length, klass;\n        if (!isObject(data)) {\n          length = toIndex(data);\n          byteLength = length * BYTES;\n          buffer = new $ArrayBuffer(byteLength);\n        } else if (data instanceof $ArrayBuffer || (klass = classof(data)) == ARRAY_BUFFER || klass == SHARED_BUFFER) {\n          buffer = data;\n          offset = toOffset($offset, BYTES);\n          var $len = data.byteLength;\n          if ($length === undefined) {\n            if ($len % BYTES) throw RangeError(WRONG_LENGTH);\n            byteLength = $len - offset;\n            if (byteLength < 0) throw RangeError(WRONG_LENGTH);\n          } else {\n            byteLength = toLength($length) * BYTES;\n            if (byteLength + offset > $len) throw RangeError(WRONG_LENGTH);\n          }\n          length = byteLength / BYTES;\n        } else if (TYPED_ARRAY in data) {\n          return fromList(TypedArray, data);\n        } else {\n          return $from.call(TypedArray, data);\n        }\n        hide(that, '_d', {\n          b: buffer,\n          o: offset,\n          l: byteLength,\n          e: length,\n          v: new $DataView(buffer)\n        });\n        while (index < length) addElement(that, index++);\n      });\n      TypedArrayPrototype = TypedArray[PROTOTYPE] = create($TypedArrayPrototype$);\n      hide(TypedArrayPrototype, 'constructor', TypedArray);\n    } else if (!fails(function () {\n      TypedArray(1);\n    }) || !fails(function () {\n      new TypedArray(-1); // eslint-disable-line no-new\n    }) || !$iterDetect(function (iter) {\n      new TypedArray(); // eslint-disable-line no-new\n      new TypedArray(null); // eslint-disable-line no-new\n      new TypedArray(1.5); // eslint-disable-line no-new\n      new TypedArray(iter); // eslint-disable-line no-new\n    }, true)) {\n      TypedArray = wrapper(function (that, data, $offset, $length) {\n        anInstance(that, TypedArray, NAME);\n        var klass;\n        // `ws` module bug, temporarily remove validation length for Uint8Array\n        // https://github.com/websockets/ws/pull/645\n        if (!isObject(data)) return new Base(toIndex(data));\n        if (data instanceof $ArrayBuffer || (klass = classof(data)) == ARRAY_BUFFER || klass == SHARED_BUFFER) {\n          return $length !== undefined\n            ? new Base(data, toOffset($offset, BYTES), $length)\n            : $offset !== undefined\n              ? new Base(data, toOffset($offset, BYTES))\n              : new Base(data);\n        }\n        if (TYPED_ARRAY in data) return fromList(TypedArray, data);\n        return $from.call(TypedArray, data);\n      });\n      arrayForEach(TAC !== Function.prototype ? gOPN(Base).concat(gOPN(TAC)) : gOPN(Base), function (key) {\n        if (!(key in TypedArray)) hide(TypedArray, key, Base[key]);\n      });\n      TypedArray[PROTOTYPE] = TypedArrayPrototype;\n      if (!LIBRARY) TypedArrayPrototype.constructor = TypedArray;\n    }\n    var $nativeIterator = TypedArrayPrototype[ITERATOR];\n    var CORRECT_ITER_NAME = !!$nativeIterator\n      && ($nativeIterator.name == 'values' || $nativeIterator.name == undefined);\n    var $iterator = $iterators.values;\n    hide(TypedArray, TYPED_CONSTRUCTOR, true);\n    hide(TypedArrayPrototype, TYPED_ARRAY, NAME);\n    hide(TypedArrayPrototype, VIEW, true);\n    hide(TypedArrayPrototype, DEF_CONSTRUCTOR, TypedArray);\n\n    if (CLAMPED ? new TypedArray(1)[TAG] != NAME : !(TAG in TypedArrayPrototype)) {\n      dP(TypedArrayPrototype, TAG, {\n        get: function () { return NAME; }\n      });\n    }\n\n    O[NAME] = TypedArray;\n\n    $export($export.G + $export.W + $export.F * (TypedArray != Base), O);\n\n    $export($export.S, NAME, {\n      BYTES_PER_ELEMENT: BYTES\n    });\n\n    $export($export.S + $export.F * fails(function () { Base.of.call(TypedArray, 1); }), NAME, {\n      from: $from,\n      of: $of\n    });\n\n    if (!(BYTES_PER_ELEMENT in TypedArrayPrototype)) hide(TypedArrayPrototype, BYTES_PER_ELEMENT, BYTES);\n\n    $export($export.P, NAME, proto);\n\n    setSpecies(NAME);\n\n    $export($export.P + $export.F * FORCED_SET, NAME, { set: $set });\n\n    $export($export.P + $export.F * !CORRECT_ITER_NAME, NAME, $iterators);\n\n    if (!LIBRARY && TypedArrayPrototype.toString != arrayToString) TypedArrayPrototype.toString = arrayToString;\n\n    $export($export.P + $export.F * fails(function () {\n      new TypedArray(1).slice();\n    }), NAME, { slice: $slice });\n\n    $export($export.P + $export.F * (fails(function () {\n      return [1, 2].toLocaleString() != new TypedArray([1, 2]).toLocaleString();\n    }) || !fails(function () {\n      TypedArrayPrototype.toLocaleString.call([1, 2]);\n    })), NAME, { toLocaleString: $toLocaleString });\n\n    Iterators[NAME] = CORRECT_ITER_NAME ? $nativeIterator : $iterator;\n    if (!LIBRARY && !CORRECT_ITER_NAME) hide(TypedArrayPrototype, ITERATOR, $iterator);\n  };\n} else module.exports = function () { /* empty */ };\n","require('./_typed-array')('Int8', 1, function (init) {\n  return function Int8Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","require('./_typed-array')('Uint8', 1, function (init) {\n  return function Uint8Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","require('./_typed-array')('Uint8', 1, function (init) {\n  return function Uint8ClampedArray(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n}, true);\n","require('./_typed-array')('Int16', 2, function (init) {\n  return function Int16Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","require('./_typed-array')('Uint16', 2, function (init) {\n  return function Uint16Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","require('./_typed-array')('Int32', 4, function (init) {\n  return function Int32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","require('./_typed-array')('Uint32', 4, function (init) {\n  return function Uint32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","require('./_typed-array')('Float32', 4, function (init) {\n  return function Float32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","require('./_typed-array')('Float64', 8, function (init) {\n  return function Float64Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","'use strict';\nvar redefineAll = require('./_redefine-all');\nvar getWeak = require('./_meta').getWeak;\nvar anObject = require('./_an-object');\nvar isObject = require('./_is-object');\nvar anInstance = require('./_an-instance');\nvar forOf = require('./_for-of');\nvar createArrayMethod = require('./_array-methods');\nvar $has = require('./_has');\nvar validate = require('./_validate-collection');\nvar arrayFind = createArrayMethod(5);\nvar arrayFindIndex = createArrayMethod(6);\nvar id = 0;\n\n// fallback for uncaught frozen keys\nvar uncaughtFrozenStore = function (that) {\n  return that._l || (that._l = new UncaughtFrozenStore());\n};\nvar UncaughtFrozenStore = function () {\n  this.a = [];\n};\nvar findUncaughtFrozen = function (store, key) {\n  return arrayFind(store.a, function (it) {\n    return it[0] === key;\n  });\n};\nUncaughtFrozenStore.prototype = {\n  get: function (key) {\n    var entry = findUncaughtFrozen(this, key);\n    if (entry) return entry[1];\n  },\n  has: function (key) {\n    return !!findUncaughtFrozen(this, key);\n  },\n  set: function (key, value) {\n    var entry = findUncaughtFrozen(this, key);\n    if (entry) entry[1] = value;\n    else this.a.push([key, value]);\n  },\n  'delete': function (key) {\n    var index = arrayFindIndex(this.a, function (it) {\n      return it[0] === key;\n    });\n    if (~index) this.a.splice(index, 1);\n    return !!~index;\n  }\n};\n\nmodule.exports = {\n  getConstructor: function (wrapper, NAME, IS_MAP, ADDER) {\n    var C = wrapper(function (that, iterable) {\n      anInstance(that, C, NAME, '_i');\n      that._t = NAME;      // collection type\n      that._i = id++;      // collection id\n      that._l = undefined; // leak store for uncaught frozen objects\n      if (iterable != undefined) forOf(iterable, IS_MAP, that[ADDER], that);\n    });\n    redefineAll(C.prototype, {\n      // 23.3.3.2 WeakMap.prototype.delete(key)\n      // 23.4.3.3 WeakSet.prototype.delete(value)\n      'delete': function (key) {\n        if (!isObject(key)) return false;\n        var data = getWeak(key);\n        if (data === true) return uncaughtFrozenStore(validate(this, NAME))['delete'](key);\n        return data && $has(data, this._i) && delete data[this._i];\n      },\n      // 23.3.3.4 WeakMap.prototype.has(key)\n      // 23.4.3.4 WeakSet.prototype.has(value)\n      has: function has(key) {\n        if (!isObject(key)) return false;\n        var data = getWeak(key);\n        if (data === true) return uncaughtFrozenStore(validate(this, NAME)).has(key);\n        return data && $has(data, this._i);\n      }\n    });\n    return C;\n  },\n  def: function (that, key, value) {\n    var data = getWeak(anObject(key), true);\n    if (data === true) uncaughtFrozenStore(that).set(key, value);\n    else data[that._i] = value;\n    return that;\n  },\n  ufstore: uncaughtFrozenStore\n};\n","'use strict';\nvar global = require('./_global');\nvar each = require('./_array-methods')(0);\nvar redefine = require('./_redefine');\nvar meta = require('./_meta');\nvar assign = require('./_object-assign');\nvar weak = require('./_collection-weak');\nvar isObject = require('./_is-object');\nvar validate = require('./_validate-collection');\nvar NATIVE_WEAK_MAP = require('./_validate-collection');\nvar IS_IE11 = !global.ActiveXObject && 'ActiveXObject' in global;\nvar WEAK_MAP = 'WeakMap';\nvar getWeak = meta.getWeak;\nvar isExtensible = Object.isExtensible;\nvar uncaughtFrozenStore = weak.ufstore;\nvar InternalMap;\n\nvar wrapper = function (get) {\n  return function WeakMap() {\n    return get(this, arguments.length > 0 ? arguments[0] : undefined);\n  };\n};\n\nvar methods = {\n  // 23.3.3.3 WeakMap.prototype.get(key)\n  get: function get(key) {\n    if (isObject(key)) {\n      var data = getWeak(key);\n      if (data === true) return uncaughtFrozenStore(validate(this, WEAK_MAP)).get(key);\n      return data ? data[this._i] : undefined;\n    }\n  },\n  // 23.3.3.5 WeakMap.prototype.set(key, value)\n  set: function set(key, value) {\n    return weak.def(validate(this, WEAK_MAP), key, value);\n  }\n};\n\n// 23.3 WeakMap Objects\nvar $WeakMap = module.exports = require('./_collection')(WEAK_MAP, wrapper, methods, weak, true, true);\n\n// IE11 WeakMap frozen keys fix\nif (NATIVE_WEAK_MAP && IS_IE11) {\n  InternalMap = weak.getConstructor(wrapper, WEAK_MAP);\n  assign(InternalMap.prototype, methods);\n  meta.NEED = true;\n  each(['delete', 'has', 'get', 'set'], function (key) {\n    var proto = $WeakMap.prototype;\n    var method = proto[key];\n    redefine(proto, key, function (a, b) {\n      // store frozen objects on internal weakmap shim\n      if (isObject(a) && !isExtensible(a)) {\n        if (!this._f) this._f = new InternalMap();\n        var result = this._f[key](a, b);\n        return key == 'set' ? this : result;\n      // store all the rest on native weakmap\n      } return method.call(this, a, b);\n    });\n  });\n}\n","'use strict';\nvar weak = require('./_collection-weak');\nvar validate = require('./_validate-collection');\nvar WEAK_SET = 'WeakSet';\n\n// 23.4 WeakSet Objects\nrequire('./_collection')(WEAK_SET, function (get) {\n  return function WeakSet() { return get(this, arguments.length > 0 ? arguments[0] : undefined); };\n}, {\n  // 23.4.3.1 WeakSet.prototype.add(value)\n  add: function add(value) {\n    return weak.def(validate(this, WEAK_SET), value, true);\n  }\n}, weak, false, true);\n","'use strict';\n// https://tc39.github.io/proposal-flatMap/#sec-FlattenIntoArray\nvar isArray = require('./_is-array');\nvar isObject = require('./_is-object');\nvar toLength = require('./_to-length');\nvar ctx = require('./_ctx');\nvar IS_CONCAT_SPREADABLE = require('./_wks')('isConcatSpreadable');\n\nfunction flattenIntoArray(target, original, source, sourceLen, start, depth, mapper, thisArg) {\n  var targetIndex = start;\n  var sourceIndex = 0;\n  var mapFn = mapper ? ctx(mapper, thisArg, 3) : false;\n  var element, spreadable;\n\n  while (sourceIndex < sourceLen) {\n    if (sourceIndex in source) {\n      element = mapFn ? mapFn(source[sourceIndex], sourceIndex, original) : source[sourceIndex];\n\n      spreadable = false;\n      if (isObject(element)) {\n        spreadable = element[IS_CONCAT_SPREADABLE];\n        spreadable = spreadable !== undefined ? !!spreadable : isArray(element);\n      }\n\n      if (spreadable && depth > 0) {\n        targetIndex = flattenIntoArray(target, original, element, toLength(element.length), targetIndex, depth - 1) - 1;\n      } else {\n        if (targetIndex >= 0x1fffffffffffff) throw TypeError();\n        target[targetIndex] = element;\n      }\n\n      targetIndex++;\n    }\n    sourceIndex++;\n  }\n  return targetIndex;\n}\n\nmodule.exports = flattenIntoArray;\n","'use strict';\n// https://tc39.github.io/proposal-flatMap/#sec-Array.prototype.flatMap\nvar $export = require('./_export');\nvar flattenIntoArray = require('./_flatten-into-array');\nvar toObject = require('./_to-object');\nvar toLength = require('./_to-length');\nvar aFunction = require('./_a-function');\nvar arraySpeciesCreate = require('./_array-species-create');\n\n$export($export.P, 'Array', {\n  flatMap: function flatMap(callbackfn /* , thisArg */) {\n    var O = toObject(this);\n    var sourceLen, A;\n    aFunction(callbackfn);\n    sourceLen = toLength(O.length);\n    A = arraySpeciesCreate(O, 0);\n    flattenIntoArray(A, O, O, sourceLen, 0, 1, callbackfn, arguments[1]);\n    return A;\n  }\n});\n\nrequire('./_add-to-unscopables')('flatMap');\n","// ie9- setTimeout & setInterval additional parameters fix\nvar global = require('./_global');\nvar $export = require('./_export');\nvar userAgent = require('./_user-agent');\nvar slice = [].slice;\nvar MSIE = /MSIE .\\./.test(userAgent); // <- dirty ie9- check\nvar wrap = function (set) {\n  return function (fn, time /* , ...args */) {\n    var boundArgs = arguments.length > 2;\n    var args = boundArgs ? slice.call(arguments, 2) : false;\n    return set(boundArgs ? function () {\n      // eslint-disable-next-line no-new-func\n      (typeof fn == 'function' ? fn : Function(fn)).apply(this, args);\n    } : fn, time);\n  };\n};\n$export($export.G + $export.B + $export.F * MSIE, {\n  setTimeout: wrap(global.setTimeout),\n  setInterval: wrap(global.setInterval)\n});\n","var $export = require('./_export');\nvar $task = require('./_task');\n$export($export.G + $export.B, {\n  setImmediate: $task.set,\n  clearImmediate: $task.clear\n});\n","var $iterators = require('./es6.array.iterator');\nvar getKeys = require('./_object-keys');\nvar redefine = require('./_redefine');\nvar global = require('./_global');\nvar hide = require('./_hide');\nvar Iterators = require('./_iterators');\nvar wks = require('./_wks');\nvar ITERATOR = wks('iterator');\nvar TO_STRING_TAG = wks('toStringTag');\nvar ArrayValues = Iterators.Array;\n\nvar DOMIterables = {\n  CSSRuleList: true, // TODO: Not spec compliant, should be false.\n  CSSStyleDeclaration: false,\n  CSSValueList: false,\n  ClientRectList: false,\n  DOMRectList: false,\n  DOMStringList: false,\n  DOMTokenList: true,\n  DataTransferItemList: false,\n  FileList: false,\n  HTMLAllCollection: false,\n  HTMLCollection: false,\n  HTMLFormElement: false,\n  HTMLSelectElement: false,\n  MediaList: true, // TODO: Not spec compliant, should be false.\n  MimeTypeArray: false,\n  NamedNodeMap: false,\n  NodeList: true,\n  PaintRequestList: false,\n  Plugin: false,\n  PluginArray: false,\n  SVGLengthList: false,\n  SVGNumberList: false,\n  SVGPathSegList: false,\n  SVGPointList: false,\n  SVGStringList: false,\n  SVGTransformList: false,\n  SourceBufferList: false,\n  StyleSheetList: true, // TODO: Not spec compliant, should be false.\n  TextTrackCueList: false,\n  TextTrackList: false,\n  TouchList: false\n};\n\nfor (var collections = getKeys(DOMIterables), i = 0; i < collections.length; i++) {\n  var NAME = collections[i];\n  var explicit = DOMIterables[NAME];\n  var Collection = global[NAME];\n  var proto = Collection && Collection.prototype;\n  var key;\n  if (proto) {\n    if (!proto[ITERATOR]) hide(proto, ITERATOR, ArrayValues);\n    if (!proto[TO_STRING_TAG]) hide(proto, TO_STRING_TAG, NAME);\n    Iterators[NAME] = ArrayValues;\n    if (explicit) for (key in $iterators) if (!proto[key]) redefine(proto, key, $iterators[key], true);\n  }\n}\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return Promise.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return Promise.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new Promise(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","export function isFunction(x: any): x is Function {\n  return typeof x === 'function';\n}\n","let _enable_super_gross_mode_that_will_cause_bad_things = false;\n\n/**\n * The global configuration object for RxJS, used to configure things\n * like what Promise contructor should used to create Promises\n */\nexport const config = {\n  /**\n   * The promise constructor used by default for methods such as\n   * {@link toPromise} and {@link forEach}\n   */\n  Promise: undefined as PromiseConstructorLike,\n\n  /**\n   * If true, turns on synchronous error rethrowing, which is a deprecated behavior\n   * in v6 and higher. This behavior enables bad patterns like wrapping a subscribe\n   * call in a try/catch block. It also enables producer interference, a nasty bug\n   * where a multicast can be broken for all observers by a downstream consumer with\n   * an unhandled error. DO NOT USE THIS FLAG UNLESS IT'S NEEDED TO BY TIME\n   * FOR MIGRATION REASONS.\n   */\n  set useDeprecatedSynchronousErrorHandling(value: boolean) {\n    if (value) {\n      const error = new Error();\n      console.warn('DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \\n' + error.stack);\n    } else if (_enable_super_gross_mode_that_will_cause_bad_things) {\n      console.log('RxJS: Back to a better error behavior. Thank you. <3');\n    }\n    _enable_super_gross_mode_that_will_cause_bad_things = value;\n  },\n\n  get useDeprecatedSynchronousErrorHandling() {\n    return _enable_super_gross_mode_that_will_cause_bad_things;\n  },\n};\n","/**\n * Throws an error on another job so that it's picked up by the runtime's\n * uncaught error handling mechanism.\n * @param err the error to throw\n */\nexport function hostReportError(err: any) {\n  setTimeout(() => { throw err; }, 0);\n}","import { Observer } from './types';\nimport { config } from './config';\nimport { hostReportError } from './util/hostReportError';\n\nexport const empty: Observer<any> = {\n  closed: true,\n  next(value: any): void { /* noop */},\n  error(err: any): void {\n    if (config.useDeprecatedSynchronousErrorHandling) {\n      throw err;\n    } else {\n      hostReportError(err);\n    }\n  },\n  complete(): void { /*noop*/ }\n};\n","export const isArray = (() => Array.isArray || (<T>(x: any): x is T[] => x && typeof x.length === 'number'))();\n","export function isObject(x: any): x is Object {\n  return x !== null && typeof x === 'object';\n}\n","export interface UnsubscriptionError extends Error {\n  readonly errors: any[];\n}\n\nexport interface UnsubscriptionErrorCtor {\n  new(errors: any[]): UnsubscriptionError;\n}\n\nconst UnsubscriptionErrorImpl = (() => {\n  function UnsubscriptionErrorImpl(this: any, errors: any[]) {\n    Error.call(this);\n    this.message = errors ?\n      `${errors.length} errors occurred during unsubscription:\n${errors.map((err, i) => `${i + 1}) ${err.toString()}`).join('\\n  ')}` : '';\n    this.name = 'UnsubscriptionError';\n    this.errors = errors;\n    return this;\n  }\n\n  UnsubscriptionErrorImpl.prototype = Object.create(Error.prototype);\n\n  return UnsubscriptionErrorImpl;\n})();\n\n/**\n * An error thrown when one or more errors have occurred during the\n * `unsubscribe` of a {@link Subscription}.\n */\nexport const UnsubscriptionError: UnsubscriptionErrorCtor = UnsubscriptionErrorImpl as any;","import { isArray } from './util/isArray';\nimport { isObject } from './util/isObject';\nimport { isFunction } from './util/isFunction';\nimport { UnsubscriptionError } from './util/UnsubscriptionError';\nimport { SubscriptionLike, TeardownLogic } from './types';\n\n/**\n * Represents a disposable resource, such as the execution of an Observable. A\n * Subscription has one important method, `unsubscribe`, that takes no argument\n * and just disposes the resource held by the subscription.\n *\n * Additionally, subscriptions may be grouped together through the `add()`\n * method, which will attach a child Subscription to the current Subscription.\n * When a Subscription is unsubscribed, all its children (and its grandchildren)\n * will be unsubscribed as well.\n *\n * @class Subscription\n */\nexport class Subscription implements SubscriptionLike {\n  /** @nocollapse */\n  public static EMPTY: Subscription = (function(empty: any) {\n    empty.closed = true;\n    return empty;\n  }(new Subscription()));\n\n  /**\n   * A flag to indicate whether this Subscription has already been unsubscribed.\n   * @type {boolean}\n   */\n  public closed: boolean = false;\n\n  /** @internal */\n  protected _parentOrParents: Subscription | Subscription[] = null;\n  /** @internal */\n  private _subscriptions: SubscriptionLike[] = null;\n\n  /**\n   * @param {function(): void} [unsubscribe] A function describing how to\n   * perform the disposal of resources when the `unsubscribe` method is called.\n   */\n  constructor(unsubscribe?: () => void) {\n    if (unsubscribe) {\n      (<any> this)._unsubscribe = unsubscribe;\n    }\n  }\n\n  /**\n   * Disposes the resources held by the subscription. May, for instance, cancel\n   * an ongoing Observable execution or cancel any other type of work that\n   * started when the Subscription was created.\n   * @return {void}\n   */\n  unsubscribe(): void {\n    let errors: any[];\n\n    if (this.closed) {\n      return;\n    }\n\n    let { _parentOrParents, _unsubscribe, _subscriptions } = (<any> this);\n\n    this.closed = true;\n    this._parentOrParents = null;\n    // null out _subscriptions first so any child subscriptions that attempt\n    // to remove themselves from this subscription will noop\n    this._subscriptions = null;\n\n    if (_parentOrParents instanceof Subscription) {\n      _parentOrParents.remove(this);\n    } else if (_parentOrParents !== null) {\n      for (let index = 0; index < _parentOrParents.length; ++index) {\n        const parent = _parentOrParents[index];\n        parent.remove(this);\n      }\n    }\n\n    if (isFunction(_unsubscribe)) {\n      try {\n        _unsubscribe.call(this);\n      } catch (e) {\n        errors = e instanceof UnsubscriptionError ? flattenUnsubscriptionErrors(e.errors) : [e];\n      }\n    }\n\n    if (isArray(_subscriptions)) {\n      let index = -1;\n      let len = _subscriptions.length;\n\n      while (++index < len) {\n        const sub = _subscriptions[index];\n        if (isObject(sub)) {\n          try {\n            sub.unsubscribe();\n          } catch (e) {\n            errors = errors || [];\n            if (e instanceof UnsubscriptionError) {\n              errors = errors.concat(flattenUnsubscriptionErrors(e.errors));\n            } else {\n              errors.push(e);\n            }\n          }\n        }\n      }\n    }\n\n    if (errors) {\n      throw new UnsubscriptionError(errors);\n    }\n  }\n\n  /**\n   * Adds a tear down to be called during the unsubscribe() of this\n   * Subscription. Can also be used to add a child subscription.\n   *\n   * If the tear down being added is a subscription that is already\n   * unsubscribed, is the same reference `add` is being called on, or is\n   * `Subscription.EMPTY`, it will not be added.\n   *\n   * If this subscription is already in an `closed` state, the passed\n   * tear down logic will be executed immediately.\n   *\n   * When a parent subscription is unsubscribed, any child subscriptions that were added to it are also unsubscribed.\n   *\n   * @param {TeardownLogic} teardown The additional logic to execute on\n   * teardown.\n   * @return {Subscription} Returns the Subscription used or created to be\n   * added to the inner subscriptions list. This Subscription can be used with\n   * `remove()` to remove the passed teardown logic from the inner subscriptions\n   * list.\n   */\n  add(teardown: TeardownLogic): Subscription {\n    let subscription = (<Subscription>teardown);\n\n    if (!(<any>teardown)) {\n      return Subscription.EMPTY;\n    }\n\n    switch (typeof teardown) {\n      case 'function':\n        subscription = new Subscription(<(() => void)>teardown);\n      case 'object':\n        if (subscription === this || subscription.closed || typeof subscription.unsubscribe !== 'function') {\n          // This also covers the case where `subscription` is `Subscription.EMPTY`, which is always in `closed` state.\n          return subscription;\n        } else if (this.closed) {\n          subscription.unsubscribe();\n          return subscription;\n        } else if (!(subscription instanceof Subscription)) {\n          const tmp = subscription;\n          subscription = new Subscription();\n          subscription._subscriptions = [tmp];\n        }\n        break;\n      default: {\n        throw new Error('unrecognized teardown ' + teardown + ' added to Subscription.');\n      }\n    }\n\n    // Add `this` as parent of `subscription` if that's not already the case.\n    let { _parentOrParents } = subscription;\n    if (_parentOrParents === null) {\n      // If we don't have a parent, then set `subscription._parents` to\n      // the `this`, which is the common case that we optimize for.\n      subscription._parentOrParents = this;\n    } else if (_parentOrParents instanceof Subscription) {\n      if (_parentOrParents === this) {\n        // The `subscription` already has `this` as a parent.\n        return subscription;\n      }\n      // If there's already one parent, but not multiple, allocate an\n      // Array to store the rest of the parent Subscriptions.\n      subscription._parentOrParents = [_parentOrParents, this];\n    } else if (_parentOrParents.indexOf(this) === -1) {\n      // Only add `this` to the _parentOrParents list if it's not already there.\n      _parentOrParents.push(this);\n    } else {\n      // The `subscription` already has `this` as a parent.\n      return subscription;\n    }\n\n    // Optimize for the common case when adding the first subscription.\n    const subscriptions = this._subscriptions;\n    if (subscriptions === null) {\n      this._subscriptions = [subscription];\n    } else {\n      subscriptions.push(subscription);\n    }\n\n    return subscription;\n  }\n\n  /**\n   * Removes a Subscription from the internal list of subscriptions that will\n   * unsubscribe during the unsubscribe process of this Subscription.\n   * @param {Subscription} subscription The subscription to remove.\n   * @return {void}\n   */\n  remove(subscription: Subscription): void {\n    const subscriptions = this._subscriptions;\n    if (subscriptions) {\n      const subscriptionIndex = subscriptions.indexOf(subscription);\n      if (subscriptionIndex !== -1) {\n        subscriptions.splice(subscriptionIndex, 1);\n      }\n    }\n  }\n}\n\nfunction flattenUnsubscriptionErrors(errors: any[]) {\n return errors.reduce((errs, err) => errs.concat((err instanceof UnsubscriptionError) ? err.errors : err), []);\n}\n","/** @deprecated do not use, this is no longer checked by RxJS internals */\nexport const rxSubscriber = (() =>\n  typeof Symbol === 'function'\n    ? Symbol('rxSubscriber')\n    : '@@rxSubscriber_' + Math.random())();\n\n/**\n * @deprecated use rxSubscriber instead\n */\nexport const $$rxSubscriber = rxSubscriber;\n","import { isFunction } from './util/isFunction';\nimport { empty as emptyObserver } from './Observer';\nimport { Observer, PartialObserver, TeardownLogic } from './types';\nimport { Subscription } from './Subscription';\nimport { rxSubscriber as rxSubscriberSymbol } from '../internal/symbol/rxSubscriber';\nimport { config } from './config';\nimport { hostReportError } from './util/hostReportError';\n\n/**\n * Implements the {@link Observer} interface and extends the\n * {@link Subscription} class. While the {@link Observer} is the public API for\n * consuming the values of an {@link Observable}, all Observers get converted to\n * a Subscriber, in order to provide Subscription-like capabilities such as\n * `unsubscribe`. Subscriber is a common type in RxJS, and crucial for\n * implementing operators, but it is rarely used as a public API.\n *\n * @class Subscriber<T>\n */\nexport class Subscriber<T> extends Subscription implements Observer<T> {\n\n  [rxSubscriberSymbol]() { return this; }\n\n  /**\n   * A static factory for a Subscriber, given a (potentially partial) definition\n   * of an Observer.\n   * @param {function(x: ?T): void} [next] The `next` callback of an Observer.\n   * @param {function(e: ?any): void} [error] The `error` callback of an\n   * Observer.\n   * @param {function(): void} [complete] The `complete` callback of an\n   * Observer.\n   * @return {Subscriber<T>} A Subscriber wrapping the (partially defined)\n   * Observer represented by the given arguments.\n   * @nocollapse\n   */\n  static create<T>(next?: (x?: T) => void,\n                   error?: (e?: any) => void,\n                   complete?: () => void): Subscriber<T> {\n    const subscriber = new Subscriber(next, error, complete);\n    subscriber.syncErrorThrowable = false;\n    return subscriber;\n  }\n\n  /** @internal */ syncErrorValue: any = null;\n  /** @internal */ syncErrorThrown: boolean = false;\n  /** @internal */ syncErrorThrowable: boolean = false;\n\n  protected isStopped: boolean = false;\n  protected destination: PartialObserver<any> | Subscriber<any>; // this `any` is the escape hatch to erase extra type param (e.g. R)\n\n  /**\n   * @param {Observer|function(value: T): void} [destinationOrNext] A partially\n   * defined Observer or a `next` callback function.\n   * @param {function(e: ?any): void} [error] The `error` callback of an\n   * Observer.\n   * @param {function(): void} [complete] The `complete` callback of an\n   * Observer.\n   */\n  constructor(destinationOrNext?: PartialObserver<any> | ((value: T) => void),\n              error?: (e?: any) => void,\n              complete?: () => void) {\n    super();\n\n    switch (arguments.length) {\n      case 0:\n        this.destination = emptyObserver;\n        break;\n      case 1:\n        if (!destinationOrNext) {\n          this.destination = emptyObserver;\n          break;\n        }\n        if (typeof destinationOrNext === 'object') {\n          if (destinationOrNext instanceof Subscriber) {\n            this.syncErrorThrowable = destinationOrNext.syncErrorThrowable;\n            this.destination = destinationOrNext;\n            destinationOrNext.add(this);\n          } else {\n            this.syncErrorThrowable = true;\n            this.destination = new SafeSubscriber<T>(this, <PartialObserver<any>> destinationOrNext);\n          }\n          break;\n        }\n      default:\n        this.syncErrorThrowable = true;\n        this.destination = new SafeSubscriber<T>(this, <((value: T) => void)> destinationOrNext, error, complete);\n        break;\n    }\n  }\n\n  /**\n   * The {@link Observer} callback to receive notifications of type `next` from\n   * the Observable, with a value. The Observable may call this method 0 or more\n   * times.\n   * @param {T} [value] The `next` value.\n   * @return {void}\n   */\n  next(value?: T): void {\n    if (!this.isStopped) {\n      this._next(value);\n    }\n  }\n\n  /**\n   * The {@link Observer} callback to receive notifications of type `error` from\n   * the Observable, with an attached `Error`. Notifies the Observer that\n   * the Observable has experienced an error condition.\n   * @param {any} [err] The `error` exception.\n   * @return {void}\n   */\n  error(err?: any): void {\n    if (!this.isStopped) {\n      this.isStopped = true;\n      this._error(err);\n    }\n  }\n\n  /**\n   * The {@link Observer} callback to receive a valueless notification of type\n   * `complete` from the Observable. Notifies the Observer that the Observable\n   * has finished sending push-based notifications.\n   * @return {void}\n   */\n  complete(): void {\n    if (!this.isStopped) {\n      this.isStopped = true;\n      this._complete();\n    }\n  }\n\n  unsubscribe(): void {\n    if (this.closed) {\n      return;\n    }\n    this.isStopped = true;\n    super.unsubscribe();\n  }\n\n  protected _next(value: T): void {\n    this.destination.next(value);\n  }\n\n  protected _error(err: any): void {\n    this.destination.error(err);\n    this.unsubscribe();\n  }\n\n  protected _complete(): void {\n    this.destination.complete();\n    this.unsubscribe();\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _unsubscribeAndRecycle(): Subscriber<T> {\n    const {  _parentOrParents } = this;\n    this._parentOrParents = null;\n    this.unsubscribe();\n    this.closed = false;\n    this.isStopped = false;\n    this._parentOrParents = _parentOrParents;\n    return this;\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nexport class SafeSubscriber<T> extends Subscriber<T> {\n\n  private _context: any;\n\n  constructor(private _parentSubscriber: Subscriber<T>,\n              observerOrNext?: PartialObserver<T> | ((value: T) => void),\n              error?: (e?: any) => void,\n              complete?: () => void) {\n    super();\n\n    let next: ((value: T) => void);\n    let context: any = this;\n\n    if (isFunction(observerOrNext)) {\n      next = (<((value: T) => void)> observerOrNext);\n    } else if (observerOrNext) {\n      next = (<PartialObserver<T>> observerOrNext).next;\n      error = (<PartialObserver<T>> observerOrNext).error;\n      complete = (<PartialObserver<T>> observerOrNext).complete;\n      if (observerOrNext !== emptyObserver) {\n        context = Object.create(observerOrNext);\n        if (isFunction(context.unsubscribe)) {\n          this.add(<() => void> context.unsubscribe.bind(context));\n        }\n        context.unsubscribe = this.unsubscribe.bind(this);\n      }\n    }\n\n    this._context = context;\n    this._next = next;\n    this._error = error;\n    this._complete = complete;\n  }\n\n  next(value?: T): void {\n    if (!this.isStopped && this._next) {\n      const { _parentSubscriber } = this;\n      if (!config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n        this.__tryOrUnsub(this._next, value);\n      } else if (this.__tryOrSetError(_parentSubscriber, this._next, value)) {\n        this.unsubscribe();\n      }\n    }\n  }\n\n  error(err?: any): void {\n    if (!this.isStopped) {\n      const { _parentSubscriber } = this;\n      const { useDeprecatedSynchronousErrorHandling } = config;\n      if (this._error) {\n        if (!useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n          this.__tryOrUnsub(this._error, err);\n          this.unsubscribe();\n        } else {\n          this.__tryOrSetError(_parentSubscriber, this._error, err);\n          this.unsubscribe();\n        }\n      } else if (!_parentSubscriber.syncErrorThrowable) {\n        this.unsubscribe();\n        if (useDeprecatedSynchronousErrorHandling) {\n          throw err;\n        }\n        hostReportError(err);\n      } else {\n        if (useDeprecatedSynchronousErrorHandling) {\n          _parentSubscriber.syncErrorValue = err;\n          _parentSubscriber.syncErrorThrown = true;\n        } else {\n          hostReportError(err);\n        }\n        this.unsubscribe();\n      }\n    }\n  }\n\n  complete(): void {\n    if (!this.isStopped) {\n      const { _parentSubscriber } = this;\n      if (this._complete) {\n        const wrappedComplete = () => this._complete.call(this._context);\n\n        if (!config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n          this.__tryOrUnsub(wrappedComplete);\n          this.unsubscribe();\n        } else {\n          this.__tryOrSetError(_parentSubscriber, wrappedComplete);\n          this.unsubscribe();\n        }\n      } else {\n        this.unsubscribe();\n      }\n    }\n  }\n\n  private __tryOrUnsub(fn: Function, value?: any): void {\n    try {\n      fn.call(this._context, value);\n    } catch (err) {\n      this.unsubscribe();\n      if (config.useDeprecatedSynchronousErrorHandling) {\n        throw err;\n      } else {\n        hostReportError(err);\n      }\n    }\n  }\n\n  private __tryOrSetError(parent: Subscriber<T>, fn: Function, value?: any): boolean {\n    if (!config.useDeprecatedSynchronousErrorHandling) {\n      throw new Error('bad call');\n    }\n    try {\n      fn.call(this._context, value);\n    } catch (err) {\n      if (config.useDeprecatedSynchronousErrorHandling) {\n        parent.syncErrorValue = err;\n        parent.syncErrorThrown = true;\n        return true;\n      } else {\n        hostReportError(err);\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /** @internal This is an internal implementation detail, do not use. */\n  _unsubscribe(): void {\n    const { _parentSubscriber } = this;\n    this._context = null;\n    this._parentSubscriber = null;\n    _parentSubscriber.unsubscribe();\n  }\n}\n","import { Subscriber } from '../Subscriber';\nimport { Subject } from '../Subject';\n\n/**\n * Determines whether the ErrorObserver is closed or stopped or has a\n * destination that is closed or stopped - in which case errors will\n * need to be reported via a different mechanism.\n * @param observer the observer\n */\nexport function canReportError(observer: Subscriber<any> | Subject<any>): boolean {\n  while (observer) {\n    const { closed, destination, isStopped } = observer as any;\n    if (closed || isStopped) {\n      return false;\n    } else if (destination && destination instanceof Subscriber) {\n      observer = destination;\n    } else {\n      observer = null;\n    }\n  }\n  return true;\n}\n","import { Subscriber } from '../Subscriber';\nimport { rxSubscriber as rxSubscriberSymbol } from '../symbol/rxSubscriber';\nimport { empty as emptyObserver } from '../Observer';\nimport { PartialObserver } from '../types';\n\nexport function toSubscriber<T>(\n  nextOrObserver?: PartialObserver<T> | ((value: T) => void),\n  error?: (error: any) => void,\n  complete?: () => void): Subscriber<T> {\n\n  if (nextOrObserver) {\n    if (nextOrObserver instanceof Subscriber) {\n      return (<Subscriber<T>> nextOrObserver);\n    }\n\n    if (nextOrObserver[rxSubscriberSymbol]) {\n      return nextOrObserver[rxSubscriberSymbol]();\n    }\n  }\n\n  if (!nextOrObserver && !error && !complete) {\n    return new Subscriber(emptyObserver);\n  }\n\n  return new Subscriber(nextOrObserver, error, complete);\n}\n","/** Symbol.observable addition */\n/* Note: This will add Symbol.observable globally for all TypeScript users,\n  however, we are no longer polyfilling Symbol.observable */\ndeclare global {\n  interface SymbolConstructor {\n    readonly observable: symbol;\n  }\n}\n\n/** Symbol.observable or a string \"@@observable\". Used for interop */\nexport const observable = (() => typeof Symbol === 'function' && Symbol.observable || '@@observable')();\n","/* tslint:disable:no-empty */\nexport function noop() { }\n","import { noop } from './noop';\nimport { UnaryFunction } from '../types';\n\n/* tslint:disable:max-line-length */\nexport function pipe<T>(): UnaryFunction<T, T>;\nexport function pipe<T, A>(fn1: UnaryFunction<T, A>): UnaryFunction<T, A>;\nexport function pipe<T, A, B>(fn1: UnaryFunction<T, A>, fn2: UnaryFunction<A, B>): UnaryFunction<T, B>;\nexport function pipe<T, A, B, C>(fn1: UnaryFunction<T, A>, fn2: UnaryFunction<A, B>, fn3: UnaryFunction<B, C>): UnaryFunction<T, C>;\nexport function pipe<T, A, B, C, D>(fn1: UnaryFunction<T, A>, fn2: UnaryFunction<A, B>, fn3: UnaryFunction<B, C>, fn4: UnaryFunction<C, D>): UnaryFunction<T, D>;\nexport function pipe<T, A, B, C, D, E>(fn1: UnaryFunction<T, A>, fn2: UnaryFunction<A, B>, fn3: UnaryFunction<B, C>, fn4: UnaryFunction<C, D>, fn5: UnaryFunction<D, E>): UnaryFunction<T, E>;\nexport function pipe<T, A, B, C, D, E, F>(fn1: UnaryFunction<T, A>, fn2: UnaryFunction<A, B>, fn3: UnaryFunction<B, C>, fn4: UnaryFunction<C, D>, fn5: UnaryFunction<D, E>, fn6: UnaryFunction<E, F>): UnaryFunction<T, F>;\nexport function pipe<T, A, B, C, D, E, F, G>(fn1: UnaryFunction<T, A>, fn2: UnaryFunction<A, B>, fn3: UnaryFunction<B, C>, fn4: UnaryFunction<C, D>, fn5: UnaryFunction<D, E>, fn6: UnaryFunction<E, F>, fn7: UnaryFunction<F, G>): UnaryFunction<T, G>;\nexport function pipe<T, A, B, C, D, E, F, G, H>(fn1: UnaryFunction<T, A>, fn2: UnaryFunction<A, B>, fn3: UnaryFunction<B, C>, fn4: UnaryFunction<C, D>, fn5: UnaryFunction<D, E>, fn6: UnaryFunction<E, F>, fn7: UnaryFunction<F, G>, fn8: UnaryFunction<G, H>): UnaryFunction<T, H>;\nexport function pipe<T, A, B, C, D, E, F, G, H, I>(fn1: UnaryFunction<T, A>, fn2: UnaryFunction<A, B>, fn3: UnaryFunction<B, C>, fn4: UnaryFunction<C, D>, fn5: UnaryFunction<D, E>, fn6: UnaryFunction<E, F>, fn7: UnaryFunction<F, G>, fn8: UnaryFunction<G, H>, fn9: UnaryFunction<H, I>): UnaryFunction<T, I>;\nexport function pipe<T, A, B, C, D, E, F, G, H, I>(fn1: UnaryFunction<T, A>, fn2: UnaryFunction<A, B>, fn3: UnaryFunction<B, C>, fn4: UnaryFunction<C, D>, fn5: UnaryFunction<D, E>, fn6: UnaryFunction<E, F>, fn7: UnaryFunction<F, G>, fn8: UnaryFunction<G, H>, fn9: UnaryFunction<H, I>, ...fns: UnaryFunction<any, any>[]): UnaryFunction<T, {}>;\n/* tslint:enable:max-line-length */\n\nexport function pipe(...fns: Array<UnaryFunction<any, any>>): UnaryFunction<any, any> {\n  return pipeFromArray(fns);\n}\n\n/** @internal */\nexport function pipeFromArray<T, R>(fns: Array<UnaryFunction<T, R>>): UnaryFunction<T, R> {\n  if (!fns) {\n    return noop as UnaryFunction<any, any>;\n  }\n\n  if (fns.length === 1) {\n    return fns[0];\n  }\n\n  return function piped(input: T): R {\n    return fns.reduce((prev: any, fn: UnaryFunction<T, R>) => fn(prev), input as any);\n  };\n}\n","import { Operator } from './Operator';\nimport { Subscriber } from './Subscriber';\nimport { Subscription } from './Subscription';\nimport { TeardownLogic, OperatorFunction, PartialObserver, Subscribable } from './types';\nimport { canReportError } from './util/canReportError';\nimport { toSubscriber } from './util/toSubscriber';\nimport { iif } from './observable/iif';\nimport { throwError } from './observable/throwError';\nimport { observable as Symbol_observable } from './symbol/observable';\nimport { pipeFromArray } from './util/pipe';\nimport { config } from './config';\n\n/**\n * A representation of any set of values over any amount of time. This is the most basic building block\n * of RxJS.\n *\n * @class Observable<T>\n */\nexport class Observable<T> implements Subscribable<T> {\n\n  /** Internal implementation detail, do not use directly. */\n  public _isScalar: boolean = false;\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  source: Observable<any>;\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  operator: Operator<any, T>;\n\n  /**\n   * @constructor\n   * @param {Function} subscribe the function that is called when the Observable is\n   * initially subscribed to. This function is given a Subscriber, to which new values\n   * can be `next`ed, or an `error` method can be called to raise an error, or\n   * `complete` can be called to notify of a successful completion.\n   */\n  constructor(subscribe?: (this: Observable<T>, subscriber: Subscriber<T>) => TeardownLogic) {\n    if (subscribe) {\n      this._subscribe = subscribe;\n    }\n  }\n\n  // HACK: Since TypeScript inherits static properties too, we have to\n  // fight against TypeScript here so Subject can have a different static create signature\n  /**\n   * Creates a new cold Observable by calling the Observable constructor\n   * @static true\n   * @owner Observable\n   * @method create\n   * @param {Function} subscribe? the subscriber function to be passed to the Observable constructor\n   * @return {Observable} a new cold observable\n   * @nocollapse\n   * @deprecated use new Observable() instead\n   */\n  static create: Function = <T>(subscribe?: (subscriber: Subscriber<T>) => TeardownLogic) => {\n    return new Observable<T>(subscribe);\n  }\n\n  /**\n   * Creates a new Observable, with this Observable as the source, and the passed\n   * operator defined as the new observable's operator.\n   * @method lift\n   * @param {Operator} operator the operator defining the operation to take on the observable\n   * @return {Observable} a new observable with the Operator applied\n   */\n  lift<R>(operator: Operator<T, R>): Observable<R> {\n    const observable = new Observable<R>();\n    observable.source = this;\n    observable.operator = operator;\n    return observable;\n  }\n\n  subscribe(observer?: PartialObserver<T>): Subscription;\n  /** @deprecated Use an observer instead of a complete callback */\n  subscribe(next: null | undefined, error: null | undefined, complete: () => void): Subscription;\n  /** @deprecated Use an observer instead of an error callback */\n  subscribe(next: null | undefined, error: (error: any) => void, complete?: () => void): Subscription;\n  /** @deprecated Use an observer instead of a complete callback */\n  subscribe(next: (value: T) => void, error: null | undefined, complete: () => void): Subscription;\n  subscribe(next?: (value: T) => void, error?: (error: any) => void, complete?: () => void): Subscription;\n  /**\n   * Invokes an execution of an Observable and registers Observer handlers for notifications it will emit.\n   *\n   * <span class=\"informal\">Use it when you have all these Observables, but still nothing is happening.</span>\n   *\n   * `subscribe` is not a regular operator, but a method that calls Observable's internal `subscribe` function. It\n   * might be for example a function that you passed to Observable's constructor, but most of the time it is\n   * a library implementation, which defines what will be emitted by an Observable, and when it be will emitted. This means\n   * that calling `subscribe` is actually the moment when Observable starts its work, not when it is created, as it is often\n   * the thought.\n   *\n   * Apart from starting the execution of an Observable, this method allows you to listen for values\n   * that an Observable emits, as well as for when it completes or errors. You can achieve this in two\n   * of the following ways.\n   *\n   * The first way is creating an object that implements {@link Observer} interface. It should have methods\n   * defined by that interface, but note that it should be just a regular JavaScript object, which you can create\n   * yourself in any way you want (ES6 class, classic function constructor, object literal etc.). In particular do\n   * not attempt to use any RxJS implementation details to create Observers - you don't need them. Remember also\n   * that your object does not have to implement all methods. If you find yourself creating a method that doesn't\n   * do anything, you can simply omit it. Note however, if the `error` method is not provided, all errors will\n   * be left uncaught.\n   *\n   * The second way is to give up on Observer object altogether and simply provide callback functions in place of its methods.\n   * This means you can provide three functions as arguments to `subscribe`, where the first function is equivalent\n   * of a `next` method, the second of an `error` method and the third of a `complete` method. Just as in case of Observer,\n   * if you do not need to listen for something, you can omit a function, preferably by passing `undefined` or `null`,\n   * since `subscribe` recognizes these functions by where they were placed in function call. When it comes\n   * to `error` function, just as before, if not provided, errors emitted by an Observable will be thrown.\n   *\n   * Whichever style of calling `subscribe` you use, in both cases it returns a Subscription object.\n   * This object allows you to call `unsubscribe` on it, which in turn will stop the work that an Observable does and will clean\n   * up all resources that an Observable used. Note that cancelling a subscription will not call `complete` callback\n   * provided to `subscribe` function, which is reserved for a regular completion signal that comes from an Observable.\n   *\n   * Remember that callbacks provided to `subscribe` are not guaranteed to be called asynchronously.\n   * It is an Observable itself that decides when these functions will be called. For example {@link of}\n   * by default emits all its values synchronously. Always check documentation for how given Observable\n   * will behave when subscribed and if its default behavior can be modified with a `scheduler`.\n   *\n   * ## Example\n   * ### Subscribe with an Observer\n   * ```ts\n   * import { of } from 'rxjs';\n   *\n   * const sumObserver = {\n   *   sum: 0,\n   *   next(value) {\n   *     console.log('Adding: ' + value);\n   *     this.sum = this.sum + value;\n   *   },\n   *   error() {\n   *     // We actually could just remove this method,\n   *     // since we do not really care about errors right now.\n   *   },\n   *   complete() {\n   *     console.log('Sum equals: ' + this.sum);\n   *   }\n   * };\n   *\n   * of(1, 2, 3) // Synchronously emits 1, 2, 3 and then completes.\n   *   .subscribe(sumObserver);\n   *\n   * // Logs:\n   * // \"Adding: 1\"\n   * // \"Adding: 2\"\n   * // \"Adding: 3\"\n   * // \"Sum equals: 6\"\n   * ```\n   *\n   * ### Subscribe with functions\n   * ```ts\n   * import { of } from 'rxjs'\n   *\n   * let sum = 0;\n   *\n   * of(1, 2, 3).subscribe(\n   *   value => {\n   *     console.log('Adding: ' + value);\n   *     sum = sum + value;\n   *   },\n   *   undefined,\n   *   () => console.log('Sum equals: ' + sum)\n   * );\n   *\n   * // Logs:\n   * // \"Adding: 1\"\n   * // \"Adding: 2\"\n   * // \"Adding: 3\"\n   * // \"Sum equals: 6\"\n   * ```\n   *\n   * ### Cancel a subscription\n   * ```ts\n   * import { interval } from 'rxjs';\n   *\n   * const subscription = interval(1000).subscribe(\n   *   num => console.log(num),\n   *   undefined,\n   *   () => {\n   *     // Will not be called, even when cancelling subscription.\n   *     console.log('completed!');\n   *   }\n   * );\n   *\n   * setTimeout(() => {\n   *   subscription.unsubscribe();\n   *   console.log('unsubscribed!');\n   * }, 2500);\n   *\n   * // Logs:\n   * // 0 after 1s\n   * // 1 after 2s\n   * // \"unsubscribed!\" after 2.5s\n   * ```\n   *\n   * @param {Observer|Function} observerOrNext (optional) Either an observer with methods to be called,\n   *  or the first of three possible handlers, which is the handler for each value emitted from the subscribed\n   *  Observable.\n   * @param {Function} error (optional) A handler for a terminal event resulting from an error. If no error handler is provided,\n   *  the error will be thrown as unhandled.\n   * @param {Function} complete (optional) A handler for a terminal event resulting from successful completion.\n   * @return {ISubscription} a subscription reference to the registered handlers\n   * @method subscribe\n   */\n  subscribe(observerOrNext?: PartialObserver<T> | ((value: T) => void),\n            error?: (error: any) => void,\n            complete?: () => void): Subscription {\n\n    const { operator } = this;\n    const sink = toSubscriber(observerOrNext, error, complete);\n\n    if (operator) {\n      sink.add(operator.call(sink, this.source));\n    } else {\n      sink.add(\n        this.source || (config.useDeprecatedSynchronousErrorHandling && !sink.syncErrorThrowable) ?\n        this._subscribe(sink) :\n        this._trySubscribe(sink)\n      );\n    }\n\n    if (config.useDeprecatedSynchronousErrorHandling) {\n      if (sink.syncErrorThrowable) {\n        sink.syncErrorThrowable = false;\n        if (sink.syncErrorThrown) {\n          throw sink.syncErrorValue;\n        }\n      }\n    }\n\n    return sink;\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _trySubscribe(sink: Subscriber<T>): TeardownLogic {\n    try {\n      return this._subscribe(sink);\n    } catch (err) {\n      if (config.useDeprecatedSynchronousErrorHandling) {\n        sink.syncErrorThrown = true;\n        sink.syncErrorValue = err;\n      }\n      if (canReportError(sink)) {\n        sink.error(err);\n      } else {\n        console.warn(err);\n      }\n    }\n  }\n\n  /**\n   * @method forEach\n   * @param {Function} next a handler for each value emitted by the observable\n   * @param {PromiseConstructor} [promiseCtor] a constructor function used to instantiate the Promise\n   * @return {Promise} a promise that either resolves on observable completion or\n   *  rejects with the handled error\n   */\n  forEach(next: (value: T) => void, promiseCtor?: PromiseConstructorLike): Promise<void> {\n    promiseCtor = getPromiseCtor(promiseCtor);\n\n    return new promiseCtor<void>((resolve, reject) => {\n      // Must be declared in a separate statement to avoid a ReferenceError when\n      // accessing subscription below in the closure due to Temporal Dead Zone.\n      let subscription: Subscription;\n      subscription = this.subscribe((value) => {\n        try {\n          next(value);\n        } catch (err) {\n          reject(err);\n          if (subscription) {\n            subscription.unsubscribe();\n          }\n        }\n      }, reject, resolve);\n    }) as Promise<void>;\n  }\n\n  /** @internal This is an internal implementation detail, do not use. */\n  _subscribe(subscriber: Subscriber<any>): TeardownLogic {\n    const { source } = this;\n    return source && source.subscribe(subscriber);\n  }\n\n  // `if` and `throw` are special snow flakes, the compiler sees them as reserved words. Deprecated in\n  // favor of iif and throwError functions.\n  /**\n   * @nocollapse\n   * @deprecated In favor of iif creation function: import { iif } from 'rxjs';\n   */\n  static if: typeof iif;\n  /**\n   * @nocollapse\n   * @deprecated In favor of throwError creation function: import { throwError } from 'rxjs';\n   */\n  static throw: typeof throwError;\n\n  /**\n   * An interop point defined by the es7-observable spec https://github.com/zenparsing/es-observable\n   * @method Symbol.observable\n   * @return {Observable} this instance of the observable\n   */\n  [Symbol_observable]() {\n    return this;\n  }\n\n  /* tslint:disable:max-line-length */\n  pipe(): Observable<T>;\n  pipe<A>(op1: OperatorFunction<T, A>): Observable<A>;\n  pipe<A, B>(op1: OperatorFunction<T, A>, op2: OperatorFunction<A, B>): Observable<B>;\n  pipe<A, B, C>(op1: OperatorFunction<T, A>, op2: OperatorFunction<A, B>, op3: OperatorFunction<B, C>): Observable<C>;\n  pipe<A, B, C, D>(op1: OperatorFunction<T, A>, op2: OperatorFunction<A, B>, op3: OperatorFunction<B, C>, op4: OperatorFunction<C, D>): Observable<D>;\n  pipe<A, B, C, D, E>(op1: OperatorFunction<T, A>, op2: OperatorFunction<A, B>, op3: OperatorFunction<B, C>, op4: OperatorFunction<C, D>, op5: OperatorFunction<D, E>): Observable<E>;\n  pipe<A, B, C, D, E, F>(op1: OperatorFunction<T, A>, op2: OperatorFunction<A, B>, op3: OperatorFunction<B, C>, op4: OperatorFunction<C, D>, op5: OperatorFunction<D, E>, op6: OperatorFunction<E, F>): Observable<F>;\n  pipe<A, B, C, D, E, F, G>(op1: OperatorFunction<T, A>, op2: OperatorFunction<A, B>, op3: OperatorFunction<B, C>, op4: OperatorFunction<C, D>, op5: OperatorFunction<D, E>, op6: OperatorFunction<E, F>, op7: OperatorFunction<F, G>): Observable<G>;\n  pipe<A, B, C, D, E, F, G, H>(op1: OperatorFunction<T, A>, op2: OperatorFunction<A, B>, op3: OperatorFunction<B, C>, op4: OperatorFunction<C, D>, op5: OperatorFunction<D, E>, op6: OperatorFunction<E, F>, op7: OperatorFunction<F, G>, op8: OperatorFunction<G, H>): Observable<H>;\n  pipe<A, B, C, D, E, F, G, H, I>(op1: OperatorFunction<T, A>, op2: OperatorFunction<A, B>, op3: OperatorFunction<B, C>, op4: OperatorFunction<C, D>, op5: OperatorFunction<D, E>, op6: OperatorFunction<E, F>, op7: OperatorFunction<F, G>, op8: OperatorFunction<G, H>, op9: OperatorFunction<H, I>): Observable<I>;\n  pipe<A, B, C, D, E, F, G, H, I>(op1: OperatorFunction<T, A>, op2: OperatorFunction<A, B>, op3: OperatorFunction<B, C>, op4: OperatorFunction<C, D>, op5: OperatorFunction<D, E>, op6: OperatorFunction<E, F>, op7: OperatorFunction<F, G>, op8: OperatorFunction<G, H>, op9: OperatorFunction<H, I>, ...operations: OperatorFunction<any, any>[]): Observable<{}>;\n  /* tslint:enable:max-line-length */\n\n  /**\n   * Used to stitch together functional operators into a chain.\n   * @method pipe\n   * @return {Observable} the Observable result of all of the operators having\n   * been called in the order they were passed in.\n   *\n   * ### Example\n   * ```ts\n   * import { interval } from 'rxjs';\n   * import { map, filter, scan } from 'rxjs/operators';\n   *\n   * interval(1000)\n   *   .pipe(\n   *     filter(x => x % 2 === 0),\n   *     map(x => x + x),\n   *     scan((acc, x) => acc + x)\n   *   )\n   *   .subscribe(x => console.log(x))\n   * ```\n   */\n  pipe(...operations: OperatorFunction<any, any>[]): Observable<any> {\n    if (operations.length === 0) {\n      return this as any;\n    }\n\n    return pipeFromArray(operations)(this);\n  }\n\n  /* tslint:disable:max-line-length */\n  toPromise<T>(this: Observable<T>): Promise<T>;\n  toPromise<T>(this: Observable<T>, PromiseCtor: typeof Promise): Promise<T>;\n  toPromise<T>(this: Observable<T>, PromiseCtor: PromiseConstructorLike): Promise<T>;\n  /* tslint:enable:max-line-length */\n\n  toPromise(promiseCtor?: PromiseConstructorLike): Promise<T> {\n    promiseCtor = getPromiseCtor(promiseCtor);\n\n    return new promiseCtor((resolve, reject) => {\n      let value: any;\n      this.subscribe((x: T) => value = x, (err: any) => reject(err), () => resolve(value));\n    }) as Promise<T>;\n  }\n}\n\n/**\n * Decides between a passed promise constructor from consuming code,\n * A default configured promise constructor, and the native promise\n * constructor and returns it. If nothing can be found, it will throw\n * an error.\n * @param promiseCtor The optional promise constructor to passed by consuming code\n */\nfunction getPromiseCtor(promiseCtor: PromiseConstructorLike | undefined) {\n  if (!promiseCtor) {\n    promiseCtor = config.Promise || Promise;\n  }\n\n  if (!promiseCtor) {\n    throw new Error('no Promise impl found');\n  }\n\n  return promiseCtor;\n}\n","export interface ObjectUnsubscribedError extends Error {\n}\n\nexport interface ObjectUnsubscribedErrorCtor {\n  new(): ObjectUnsubscribedError;\n}\n\nconst ObjectUnsubscribedErrorImpl = (() => {\n  function ObjectUnsubscribedErrorImpl(this: any) {\n    Error.call(this);\n    this.message = 'object unsubscribed';\n    this.name = 'ObjectUnsubscribedError';\n    return this;\n  }\n\n  ObjectUnsubscribedErrorImpl.prototype = Object.create(Error.prototype);\n\n  return ObjectUnsubscribedErrorImpl;\n})();\n\n/**\n * An error thrown when an action is invalid because the object has been\n * unsubscribed.\n *\n * @see {@link Subject}\n * @see {@link BehaviorSubject}\n *\n * @class ObjectUnsubscribedError\n */\nexport const ObjectUnsubscribedError: ObjectUnsubscribedErrorCtor = ObjectUnsubscribedErrorImpl as any;","import { Subject } from './Subject';\nimport { Observer } from './types';\nimport { Subscription } from './Subscription';\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nexport class SubjectSubscription<T> extends Subscription {\n  closed: boolean = false;\n\n  constructor(public subject: Subject<T>, public subscriber: Observer<T>) {\n    super();\n  }\n\n  unsubscribe() {\n    if (this.closed) {\n      return;\n    }\n\n    this.closed = true;\n\n    const subject = this.subject;\n    const observers = subject.observers;\n\n    this.subject = null;\n\n    if (!observers || observers.length === 0 || subject.isStopped || subject.closed) {\n      return;\n    }\n\n    const subscriberIndex = observers.indexOf(this.subscriber);\n\n    if (subscriberIndex !== -1) {\n      observers.splice(subscriberIndex, 1);\n    }\n  }\n}\n","import { Operator } from './Operator';\nimport { Observable } from './Observable';\nimport { Subscriber } from './Subscriber';\nimport { Subscription } from './Subscription';\nimport { Observer, SubscriptionLike, TeardownLogic } from './types';\nimport { ObjectUnsubscribedError } from './util/ObjectUnsubscribedError';\nimport { SubjectSubscription } from './SubjectSubscription';\nimport { rxSubscriber as rxSubscriberSymbol } from '../internal/symbol/rxSubscriber';\n\n/**\n * @class SubjectSubscriber<T>\n */\nexport class SubjectSubscriber<T> extends Subscriber<T> {\n  constructor(protected destination: Subject<T>) {\n    super(destination);\n  }\n}\n\n/**\n * A Subject is a special type of Observable that allows values to be\n * multicasted to many Observers. Subjects are like EventEmitters.\n *\n * Every Subject is an Observable and an Observer. You can subscribe to a\n * Subject, and you can call next to feed values as well as error and complete.\n *\n * @class Subject<T>\n */\nexport class Subject<T> extends Observable<T> implements SubscriptionLike {\n\n  [rxSubscriberSymbol]() {\n    return new SubjectSubscriber(this);\n  }\n\n  observers: Observer<T>[] = [];\n\n  closed = false;\n\n  isStopped = false;\n\n  hasError = false;\n\n  thrownError: any = null;\n\n  constructor() {\n    super();\n  }\n\n  /**@nocollapse\n   * @deprecated use new Subject() instead\n  */\n  static create: Function = <T>(destination: Observer<T>, source: Observable<T>): AnonymousSubject<T> => {\n    return new AnonymousSubject<T>(destination, source);\n  }\n\n  lift<R>(operator: Operator<T, R>): Observable<R> {\n    const subject = new AnonymousSubject(this, this);\n    subject.operator = <any>operator;\n    return <any>subject;\n  }\n\n  next(value?: T) {\n    if (this.closed) {\n      throw new ObjectUnsubscribedError();\n    }\n    if (!this.isStopped) {\n      const { observers } = this;\n      const len = observers.length;\n      const copy = observers.slice();\n      for (let i = 0; i < len; i++) {\n        copy[i].next(value);\n      }\n    }\n  }\n\n  error(err: any) {\n    if (this.closed) {\n      throw new ObjectUnsubscribedError();\n    }\n    this.hasError = true;\n    this.thrownError = err;\n    this.isStopped = true;\n    const { observers } = this;\n    const len = observers.length;\n    const copy = observers.slice();\n    for (let i = 0; i < len; i++) {\n      copy[i].error(err);\n    }\n    this.observers.length = 0;\n  }\n\n  complete() {\n    if (this.closed) {\n      throw new ObjectUnsubscribedError();\n    }\n    this.isStopped = true;\n    const { observers } = this;\n    const len = observers.length;\n    const copy = observers.slice();\n    for (let i = 0; i < len; i++) {\n      copy[i].complete();\n    }\n    this.observers.length = 0;\n  }\n\n  unsubscribe() {\n    this.isStopped = true;\n    this.closed = true;\n    this.observers = null;\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _trySubscribe(subscriber: Subscriber<T>): TeardownLogic {\n    if (this.closed) {\n      throw new ObjectUnsubscribedError();\n    } else {\n      return super._trySubscribe(subscriber);\n    }\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _subscribe(subscriber: Subscriber<T>): Subscription {\n    if (this.closed) {\n      throw new ObjectUnsubscribedError();\n    } else if (this.hasError) {\n      subscriber.error(this.thrownError);\n      return Subscription.EMPTY;\n    } else if (this.isStopped) {\n      subscriber.complete();\n      return Subscription.EMPTY;\n    } else {\n      this.observers.push(subscriber);\n      return new SubjectSubscription(this, subscriber);\n    }\n  }\n\n  /**\n   * Creates a new Observable with this Subject as the source. You can do this\n   * to create customize Observer-side logic of the Subject and conceal it from\n   * code that uses the Observable.\n   * @return {Observable} Observable that the Subject casts to\n   */\n  asObservable(): Observable<T> {\n    const observable = new Observable<T>();\n    (<any>observable).source = this;\n    return observable;\n  }\n}\n\n/**\n * @class AnonymousSubject<T>\n */\nexport class AnonymousSubject<T> extends Subject<T> {\n  constructor(protected destination?: Observer<T>, source?: Observable<T>) {\n    super();\n    this.source = source;\n  }\n\n  next(value: T) {\n    const { destination } = this;\n    if (destination && destination.next) {\n      destination.next(value);\n    }\n  }\n\n  error(err: any) {\n    const { destination } = this;\n    if (destination && destination.error) {\n      this.destination.error(err);\n    }\n  }\n\n  complete() {\n    const { destination } = this;\n    if (destination && destination.complete) {\n      this.destination.complete();\n    }\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _subscribe(subscriber: Subscriber<T>): Subscription {\n    const { source } = this;\n    if (source) {\n      return this.source.subscribe(subscriber);\n    } else {\n      return Subscription.EMPTY;\n    }\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { MonoTypeOperatorFunction, TeardownLogic } from '../types';\nimport { ConnectableObservable } from '../observable/ConnectableObservable';\nimport { Observable } from '../Observable';\n\n/**\n * Make a {@link ConnectableObservable} behave like a ordinary observable and automates the way\n * you can connect to it.\n *\n * Internally it counts the subscriptions to the observable and subscribes (only once) to the source if\n * the number of subscriptions is larger than 0. If the number of subscriptions is smaller than 1, it\n * unsubscribes from the source. This way you can make sure that everything before the *published*\n * refCount has only a single subscription independently of the number of subscribers to the target\n * observable.\n *\n * Note that using the {@link share} operator is exactly the same as using the *publish* operator\n * (making the observable hot) and the *refCount* operator in a sequence.\n *\n * ![](refCount.png)\n *\n * ## Example\n *\n * In the following example there are two intervals turned into connectable observables\n * by using the *publish* operator. The first one uses the *refCount* operator, the\n * second one does not use it. You will notice that a connectable observable does nothing\n * until you call its connect function.\n *\n * ```ts\n * import { interval } from 'rxjs';\n * import { tap, publish, refCount } from 'rxjs/operators';\n *\n * // Turn the interval observable into a ConnectableObservable (hot)\n * const refCountInterval = interval(400).pipe(\n *   tap((num) => console.log(`refCount ${num}`)),\n *   publish(),\n *   refCount()\n * );\n *\n * const publishedInterval = interval(400).pipe(\n *   tap((num) => console.log(`publish ${num}`)),\n *   publish()\n * );\n *\n * refCountInterval.subscribe();\n * refCountInterval.subscribe();\n * // 'refCount 0' -----> 'refCount 1' -----> etc\n * // All subscriptions will receive the same value and the tap (and\n * // every other operator) before the publish operator will be executed\n * // only once per event independently of the number of subscriptions.\n *\n * publishedInterval.subscribe();\n * // Nothing happens until you call .connect() on the observable.\n * ```\n *\n * @see {@link ConnectableObservable}\n * @see {@link share}\n * @see {@link publish}\n */\nexport function refCount<T>(): MonoTypeOperatorFunction<T> {\n  return function refCountOperatorFunction(source: ConnectableObservable<T>): Observable<T> {\n    return source.lift(new RefCountOperator(source));\n  } as MonoTypeOperatorFunction<T>;\n}\n\nclass RefCountOperator<T> implements Operator<T, T> {\n  constructor(private connectable: ConnectableObservable<T>) {\n  }\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n\n    const { connectable } = this;\n    (<any> connectable)._refCount++;\n\n    const refCounter = new RefCountSubscriber(subscriber, connectable);\n    const subscription = source.subscribe(refCounter);\n\n    if (!refCounter.closed) {\n      (<any> refCounter).connection = connectable.connect();\n    }\n\n    return subscription;\n  }\n}\n\nclass RefCountSubscriber<T> extends Subscriber<T> {\n\n  private connection: Subscription;\n\n  constructor(destination: Subscriber<T>,\n              private connectable: ConnectableObservable<T>) {\n    super(destination);\n  }\n\n  protected _unsubscribe() {\n\n    const { connectable } = this;\n    if (!connectable) {\n      this.connection = null;\n      return;\n    }\n\n    this.connectable = null;\n    const refCount = (<any> connectable)._refCount;\n    if (refCount <= 0) {\n      this.connection = null;\n      return;\n    }\n\n    (<any> connectable)._refCount = refCount - 1;\n    if (refCount > 1) {\n      this.connection = null;\n      return;\n    }\n\n    ///\n    // Compare the local RefCountSubscriber's connection Subscription to the\n    // connection Subscription on the shared ConnectableObservable. In cases\n    // where the ConnectableObservable source synchronously emits values, and\n    // the RefCountSubscriber's downstream Observers synchronously unsubscribe,\n    // execution continues to here before the RefCountOperator has a chance to\n    // supply the RefCountSubscriber with the shared connection Subscription.\n    // For example:\n    // ```\n    // range(0, 10).pipe(\n    //   publish(),\n    //   refCount(),\n    //   take(5),\n    // )\n    // .subscribe();\n    // ```\n    // In order to account for this case, RefCountSubscriber should only dispose\n    // the ConnectableObservable's shared connection Subscription if the\n    // connection Subscription exists, *and* either:\n    //   a. RefCountSubscriber doesn't have a reference to the shared connection\n    //      Subscription yet, or,\n    //   b. RefCountSubscriber's connection Subscription reference is identical\n    //      to the shared connection Subscription\n    ///\n    const { connection } = this;\n    const sharedConnection = (<any> connectable)._connection;\n    this.connection = null;\n\n    if (sharedConnection && (!connection || sharedConnection === connection)) {\n      sharedConnection.unsubscribe();\n    }\n  }\n}\n","import { Subject, SubjectSubscriber } from '../Subject';\nimport { Operator } from '../Operator';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { TeardownLogic } from '../types';\nimport { refCount as higherOrderRefCount } from '../operators/refCount';\n\n/**\n * @class ConnectableObservable<T>\n */\nexport class ConnectableObservable<T> extends Observable<T> {\n\n  protected _subject: Subject<T>;\n  protected _refCount: number = 0;\n  protected _connection: Subscription;\n  /** @internal */\n  _isComplete = false;\n\n  constructor(public source: Observable<T>,\n              protected subjectFactory: () => Subject<T>) {\n    super();\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _subscribe(subscriber: Subscriber<T>) {\n    return this.getSubject().subscribe(subscriber);\n  }\n\n  protected getSubject(): Subject<T> {\n    const subject = this._subject;\n    if (!subject || subject.isStopped) {\n      this._subject = this.subjectFactory();\n    }\n    return this._subject;\n  }\n\n  connect(): Subscription {\n    let connection = this._connection;\n    if (!connection) {\n      this._isComplete = false;\n      connection = this._connection = new Subscription();\n      connection.add(this.source\n        .subscribe(new ConnectableSubscriber(this.getSubject(), this)));\n      if (connection.closed) {\n        this._connection = null;\n        connection = Subscription.EMPTY;\n      }\n    }\n    return connection;\n  }\n\n  refCount(): Observable<T> {\n    return higherOrderRefCount()(this) as Observable<T>;\n  }\n}\n\nexport const connectableObservableDescriptor: PropertyDescriptorMap = (() => {\n  const connectableProto = <any>ConnectableObservable.prototype;\n  return {\n    operator: { value: null as null },\n    _refCount: { value: 0, writable: true },\n    _subject: { value: null as null, writable: true },\n    _connection: { value: null as null, writable: true },\n    _subscribe: { value: connectableProto._subscribe },\n    _isComplete: { value: connectableProto._isComplete, writable: true },\n    getSubject: { value: connectableProto.getSubject },\n    connect: { value: connectableProto.connect },\n    refCount: { value: connectableProto.refCount }\n  };\n})();\n\nclass ConnectableSubscriber<T> extends SubjectSubscriber<T> {\n  constructor(destination: Subject<T>,\n              private connectable: ConnectableObservable<T>) {\n    super(destination);\n  }\n  protected _error(err: any): void {\n    this._unsubscribe();\n    super._error(err);\n  }\n  protected _complete(): void {\n    this.connectable._isComplete = true;\n    this._unsubscribe();\n    super._complete();\n  }\n  protected _unsubscribe() {\n    const connectable = <any>this.connectable;\n    if (connectable) {\n      this.connectable = null;\n      const connection = connectable._connection;\n      connectable._refCount = 0;\n      connectable._subject = null;\n      connectable._connection = null;\n      if (connection) {\n        connection.unsubscribe();\n      }\n    }\n  }\n}\n\nclass RefCountOperator<T> implements Operator<T, T> {\n  constructor(private connectable: ConnectableObservable<T>) {\n  }\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n\n    const { connectable } = this;\n    (<any> connectable)._refCount++;\n\n    const refCounter = new RefCountSubscriber(subscriber, connectable);\n    const subscription = source.subscribe(refCounter);\n\n    if (!refCounter.closed) {\n      (<any> refCounter).connection = connectable.connect();\n    }\n\n    return subscription;\n  }\n}\n\nclass RefCountSubscriber<T> extends Subscriber<T> {\n\n  private connection: Subscription;\n\n  constructor(destination: Subscriber<T>,\n              private connectable: ConnectableObservable<T>) {\n    super(destination);\n  }\n\n  protected _unsubscribe() {\n\n    const { connectable } = this;\n    if (!connectable) {\n      this.connection = null;\n      return;\n    }\n\n    this.connectable = null;\n    const refCount = (<any> connectable)._refCount;\n    if (refCount <= 0) {\n      this.connection = null;\n      return;\n    }\n\n    (<any> connectable)._refCount = refCount - 1;\n    if (refCount > 1) {\n      this.connection = null;\n      return;\n    }\n\n    ///\n    // Compare the local RefCountSubscriber's connection Subscription to the\n    // connection Subscription on the shared ConnectableObservable. In cases\n    // where the ConnectableObservable source synchronously emits values, and\n    // the RefCountSubscriber's downstream Observers synchronously unsubscribe,\n    // execution continues to here before the RefCountOperator has a chance to\n    // supply the RefCountSubscriber with the shared connection Subscription.\n    // For example:\n    // ```\n    // range(0, 10).pipe(\n    //   publish(),\n    //   refCount(),\n    //   take(5),\n    // ).subscribe();\n    // ```\n    // In order to account for this case, RefCountSubscriber should only dispose\n    // the ConnectableObservable's shared connection Subscription if the\n    // connection Subscription exists, *and* either:\n    //   a. RefCountSubscriber doesn't have a reference to the shared connection\n    //      Subscription yet, or,\n    //   b. RefCountSubscriber's connection Subscription reference is identical\n    //      to the shared connection Subscription\n    ///\n    const { connection } = this;\n    const sharedConnection = (<any> connectable)._connection;\n    this.connection = null;\n\n    if (sharedConnection && (!connection || sharedConnection === connection)) {\n      sharedConnection.unsubscribe();\n    }\n  }\n}\n","import { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { Observable } from '../Observable';\nimport { Operator } from '../Operator';\nimport { Subject } from '../Subject';\nimport { OperatorFunction } from '../types';\n\n/* tslint:disable:max-line-length */\nexport function groupBy<T, K>(keySelector: (value: T) => K): OperatorFunction<T, GroupedObservable<K, T>>;\nexport function groupBy<T, K>(keySelector: (value: T) => K, elementSelector: void, durationSelector: (grouped: GroupedObservable<K, T>) => Observable<any>): OperatorFunction<T, GroupedObservable<K, T>>;\nexport function groupBy<T, K, R>(keySelector: (value: T) => K, elementSelector?: (value: T) => R, durationSelector?: (grouped: GroupedObservable<K, R>) => Observable<any>): OperatorFunction<T, GroupedObservable<K, R>>;\nexport function groupBy<T, K, R>(keySelector: (value: T) => K, elementSelector?: (value: T) => R, durationSelector?: (grouped: GroupedObservable<K, R>) => Observable<any>, subjectSelector?: () => Subject<R>): OperatorFunction<T, GroupedObservable<K, R>>;\n/* tslint:enable:max-line-length */\n\n/**\n * Groups the items emitted by an Observable according to a specified criterion,\n * and emits these grouped items as `GroupedObservables`, one\n * {@link GroupedObservable} per group.\n *\n * ![](groupBy.png)\n *\n * When the Observable emits an item, a key is computed for this item with the keySelector function.\n *\n * If a {@link GroupedObservable} for this key exists, this {@link GroupedObservable} emits. Elsewhere, a new\n * {@link GroupedObservable} for this key is created and emits.\n *\n * A {@link GroupedObservable} represents values belonging to the same group represented by a common key. The common\n * key is available as the key field of a {@link GroupedObservable} instance.\n *\n * The elements emitted by {@link GroupedObservable}s are by default the items emitted by the Observable, or elements\n * returned by the elementSelector function.\n *\n * ## Examples\n *\n * ### Group objects by id and return as array\n *\n * ```ts\n * import { of } from 'rxjs';\n * import { mergeMap, groupBy, reduce } from 'rxjs/operators';\n *\n * of(\n *   {id: 1, name: 'JavaScript'},\n *   {id: 2, name: 'Parcel'},\n *   {id: 2, name: 'webpack'},\n *   {id: 1, name: 'TypeScript'},\n *   {id: 3, name: 'TSLint'}\n * ).pipe(\n *   groupBy(p => p.id),\n *   mergeMap((group$) => group$.pipe(reduce((acc, cur) => [...acc, cur], []))),\n * )\n * .subscribe(p => console.log(p));\n *\n * // displays:\n * // [ { id: 1, name: 'JavaScript'},\n * //   { id: 1, name: 'TypeScript'} ]\n * //\n * // [ { id: 2, name: 'Parcel'},\n * //   { id: 2, name: 'webpack'} ]\n * //\n * // [ { id: 3, name: 'TSLint'} ]\n * ```\n *\n * ### Pivot data on the id field\n *\n * ```ts\n * import { of } from 'rxjs';\n * import { groupBy, map, mergeMap, reduce } from 'rxjs/operators';\n *\n * of(\n *   { id: 1, name: 'JavaScript' },\n *   { id: 2, name: 'Parcel' },\n *   { id: 2, name: 'webpack' },\n *   { id: 1, name: 'TypeScript' },\n *   { id: 3, name: 'TSLint' }\n * )\n *   .pipe(\n *     groupBy(p => p.id, p => p.name),\n *     mergeMap(group$ =>\n *       group$.pipe(reduce((acc, cur) => [...acc, cur], [`${group$.key}`]))\n *     ),\n *     map(arr => ({ id: parseInt(arr[0], 10), values: arr.slice(1) }))\n *  )\n *  .subscribe(p => console.log(p));\n *\n * // displays:\n * // { id: 1, values: [ 'JavaScript', 'TypeScript' ] }\n * // { id: 2, values: [ 'Parcel', 'webpack' ] }\n * // { id: 3, values: [ 'TSLint' ] }\n * ```\n *\n * @param {function(value: T): K} keySelector A function that extracts the key\n * for each item.\n * @param {function(value: T): R} [elementSelector] A function that extracts the\n * return element for each item.\n * @param {function(grouped: GroupedObservable<K,R>): Observable<any>} [durationSelector]\n * A function that returns an Observable to determine how long each group should\n * exist.\n * @return {Observable<GroupedObservable<K,R>>} An Observable that emits\n * GroupedObservables, each of which corresponds to a unique key value and each\n * of which emits those items from the source Observable that share that key\n * value.\n * @method groupBy\n * @owner Observable\n */\nexport function groupBy<T, K, R>(keySelector: (value: T) => K,\n                                 elementSelector?: ((value: T) => R) | void,\n                                 durationSelector?: (grouped: GroupedObservable<K, R>) => Observable<any>,\n                                 subjectSelector?: () => Subject<R>): OperatorFunction<T, GroupedObservable<K, R>> {\n  return (source: Observable<T>) =>\n    source.lift(new GroupByOperator(keySelector, elementSelector, durationSelector, subjectSelector));\n}\n\nexport interface RefCountSubscription {\n  count: number;\n  unsubscribe: () => void;\n  closed: boolean;\n  attemptedToUnsubscribe: boolean;\n}\n\nclass GroupByOperator<T, K, R> implements Operator<T, GroupedObservable<K, R>> {\n  constructor(private keySelector: (value: T) => K,\n              private elementSelector?: ((value: T) => R) | void,\n              private durationSelector?: (grouped: GroupedObservable<K, R>) => Observable<any>,\n              private subjectSelector?: () => Subject<R>) {\n  }\n\n  call(subscriber: Subscriber<GroupedObservable<K, R>>, source: any): any {\n    return source.subscribe(new GroupBySubscriber(\n      subscriber, this.keySelector, this.elementSelector, this.durationSelector, this.subjectSelector\n    ));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass GroupBySubscriber<T, K, R> extends Subscriber<T> implements RefCountSubscription {\n  private groups: Map<K, Subject<T | R>> = null;\n  public attemptedToUnsubscribe: boolean = false;\n  public count: number = 0;\n\n  constructor(destination: Subscriber<GroupedObservable<K, R>>,\n              private keySelector: (value: T) => K,\n              private elementSelector?: ((value: T) => R) | void,\n              private durationSelector?: (grouped: GroupedObservable<K, R>) => Observable<any>,\n              private subjectSelector?: () => Subject<R>) {\n    super(destination);\n  }\n\n  protected _next(value: T): void {\n    let key: K;\n    try {\n      key = this.keySelector(value);\n    } catch (err) {\n      this.error(err);\n      return;\n    }\n\n    this._group(value, key);\n  }\n\n  private _group(value: T, key: K) {\n    let groups = this.groups;\n\n    if (!groups) {\n      groups = this.groups = new Map<K, Subject<T | R>>();\n    }\n\n    let group = groups.get(key);\n\n    let element: R;\n    if (this.elementSelector) {\n      try {\n        element = this.elementSelector(value);\n      } catch (err) {\n        this.error(err);\n      }\n    } else {\n      element = <any>value;\n    }\n\n    if (!group) {\n      group = (this.subjectSelector ? this.subjectSelector() : new Subject<R>()) as Subject<T | R>;\n      groups.set(key, group);\n      const groupedObservable = new GroupedObservable(key, group, this);\n      this.destination.next(groupedObservable);\n      if (this.durationSelector) {\n        let duration: any;\n        try {\n          duration = this.durationSelector(new GroupedObservable<K, R>(key, <Subject<R>>group));\n        } catch (err) {\n          this.error(err);\n          return;\n        }\n        this.add(duration.subscribe(new GroupDurationSubscriber(key, group, this)));\n      }\n    }\n\n    if (!group.closed) {\n      group.next(element);\n    }\n  }\n\n  protected _error(err: any): void {\n    const groups = this.groups;\n    if (groups) {\n      groups.forEach((group, key) => {\n        group.error(err);\n      });\n\n      groups.clear();\n    }\n    this.destination.error(err);\n  }\n\n  protected _complete(): void {\n    const groups = this.groups;\n    if (groups) {\n      groups.forEach((group, key) => {\n        group.complete();\n      });\n\n      groups.clear();\n    }\n    this.destination.complete();\n  }\n\n  removeGroup(key: K): void {\n    this.groups.delete(key);\n  }\n\n  unsubscribe() {\n    if (!this.closed) {\n      this.attemptedToUnsubscribe = true;\n      if (this.count === 0) {\n        super.unsubscribe();\n      }\n    }\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass GroupDurationSubscriber<K, T> extends Subscriber<T> {\n  constructor(private key: K,\n              private group: Subject<T>,\n              private parent: GroupBySubscriber<any, K, T | any>) {\n    super(group);\n  }\n\n  protected _next(value: T): void {\n    this.complete();\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _unsubscribe() {\n    const { parent, key } = this;\n    this.key = this.parent = null;\n    if (parent) {\n      parent.removeGroup(key);\n    }\n  }\n}\n\n/**\n * An Observable representing values belonging to the same group represented by\n * a common key. The values emitted by a GroupedObservable come from the source\n * Observable. The common key is available as the field `key` on a\n * GroupedObservable instance.\n *\n * @class GroupedObservable<K, T>\n */\nexport class GroupedObservable<K, T> extends Observable<T> {\n  /** @deprecated Do not construct this type. Internal use only */\n  constructor(public key: K,\n              private groupSubject: Subject<T>,\n              private refCountSubscription?: RefCountSubscription) {\n    super();\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _subscribe(subscriber: Subscriber<T>) {\n    const subscription = new Subscription();\n    const { refCountSubscription, groupSubject } = this;\n    if (refCountSubscription && !refCountSubscription.closed) {\n      subscription.add(new InnerRefCountSubscription(refCountSubscription));\n    }\n    subscription.add(groupSubject.subscribe(subscriber));\n    return subscription;\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass InnerRefCountSubscription extends Subscription {\n  constructor(private parent: RefCountSubscription) {\n    super();\n    parent.count++;\n  }\n\n  unsubscribe() {\n    const parent = this.parent;\n    if (!parent.closed && !this.closed) {\n      super.unsubscribe();\n      parent.count -= 1;\n      if (parent.count === 0 && parent.attemptedToUnsubscribe) {\n        parent.unsubscribe();\n      }\n    }\n  }\n}\n","import { Subject } from './Subject';\nimport { Subscriber } from './Subscriber';\nimport { Subscription } from './Subscription';\nimport { SubscriptionLike } from './types';\nimport { ObjectUnsubscribedError } from './util/ObjectUnsubscribedError';\n\n/**\n * A variant of Subject that requires an initial value and emits its current\n * value whenever it is subscribed to.\n *\n * @class BehaviorSubject<T>\n */\nexport class BehaviorSubject<T> extends Subject<T> {\n\n  constructor(private _value: T) {\n    super();\n  }\n\n  get value(): T {\n    return this.getValue();\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _subscribe(subscriber: Subscriber<T>): Subscription {\n    const subscription = super._subscribe(subscriber);\n    if (subscription && !(<SubscriptionLike>subscription).closed) {\n      subscriber.next(this._value);\n    }\n    return subscription;\n  }\n\n  getValue(): T {\n    if (this.hasError) {\n      throw this.thrownError;\n    } else if (this.closed) {\n      throw new ObjectUnsubscribedError();\n    } else {\n      return this._value;\n    }\n  }\n\n  next(value: T): void {\n    super.next(this._value = value);\n  }\n}\n","import { Scheduler } from '../Scheduler';\nimport { Subscription } from '../Subscription';\nimport { SchedulerAction } from '../types';\n\n/**\n * A unit of work to be executed in a `scheduler`. An action is typically\n * created from within a {@link SchedulerLike} and an RxJS user does not need to concern\n * themselves about creating and manipulating an Action.\n *\n * ```ts\n * class Action<T> extends Subscription {\n *   new (scheduler: Scheduler, work: (state?: T) => void);\n *   schedule(state?: T, delay: number = 0): Subscription;\n * }\n * ```\n *\n * @class Action<T>\n */\nexport class Action<T> extends Subscription {\n  constructor(scheduler: Scheduler, work: (this: SchedulerAction<T>, state?: T) => void) {\n    super();\n  }\n  /**\n   * Schedules this action on its parent {@link SchedulerLike} for execution. May be passed\n   * some context object, `state`. May happen at some point in the future,\n   * according to the `delay` parameter, if specified.\n   * @param {T} [state] Some contextual data that the `work` function uses when\n   * called by the Scheduler.\n   * @param {number} [delay] Time to wait before executing the work, where the\n   * time unit is implicit and defined by the Scheduler.\n   * @return {void}\n   */\n  public schedule(state?: T, delay: number = 0): Subscription {\n    return this;\n  }\n}\n","import { Action } from './Action';\nimport { SchedulerAction } from '../types';\nimport { Subscription } from '../Subscription';\nimport { AsyncScheduler } from './AsyncScheduler';\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nexport class AsyncAction<T> extends Action<T> {\n\n  public id: any;\n  public state: T;\n  public delay: number;\n  protected pending: boolean = false;\n\n  constructor(protected scheduler: AsyncScheduler,\n              protected work: (this: SchedulerAction<T>, state?: T) => void) {\n    super(scheduler, work);\n  }\n\n  public schedule(state?: T, delay: number = 0): Subscription {\n\n    if (this.closed) {\n      return this;\n    }\n\n    // Always replace the current state with the new state.\n    this.state = state;\n\n    const id = this.id;\n    const scheduler = this.scheduler;\n\n    //\n    // Important implementation note:\n    //\n    // Actions only execute once by default, unless rescheduled from within the\n    // scheduled callback. This allows us to implement single and repeat\n    // actions via the same code path, without adding API surface area, as well\n    // as mimic traditional recursion but across asynchronous boundaries.\n    //\n    // However, JS runtimes and timers distinguish between intervals achieved by\n    // serial `setTimeout` calls vs. a single `setInterval` call. An interval of\n    // serial `setTimeout` calls can be individually delayed, which delays\n    // scheduling the next `setTimeout`, and so on. `setInterval` attempts to\n    // guarantee the interval callback will be invoked more precisely to the\n    // interval period, regardless of load.\n    //\n    // Therefore, we use `setInterval` to schedule single and repeat actions.\n    // If the action reschedules itself with the same delay, the interval is not\n    // canceled. If the action doesn't reschedule, or reschedules with a\n    // different delay, the interval will be canceled after scheduled callback\n    // execution.\n    //\n    if (id != null) {\n      this.id = this.recycleAsyncId(scheduler, id, delay);\n    }\n\n    // Set the pending flag indicating that this action has been scheduled, or\n    // has recursively rescheduled itself.\n    this.pending = true;\n\n    this.delay = delay;\n    // If this action has already an async Id, don't request a new one.\n    this.id = this.id || this.requestAsyncId(scheduler, this.id, delay);\n\n    return this;\n  }\n\n  protected requestAsyncId(scheduler: AsyncScheduler, id?: any, delay: number = 0): any {\n    return setInterval(scheduler.flush.bind(scheduler, this), delay);\n  }\n\n  protected recycleAsyncId(scheduler: AsyncScheduler, id: any, delay: number = 0): any {\n    // If this action is rescheduled with the same delay time, don't clear the interval id.\n    if (delay !== null && this.delay === delay && this.pending === false) {\n      return id;\n    }\n    // Otherwise, if the action's delay time is different from the current delay,\n    // or the action has been rescheduled before it's executed, clear the interval id\n    clearInterval(id);\n    return undefined;\n  }\n\n  /**\n   * Immediately executes this action and the `work` it contains.\n   * @return {any}\n   */\n  public execute(state: T, delay: number): any {\n\n    if (this.closed) {\n      return new Error('executing a cancelled action');\n    }\n\n    this.pending = false;\n    const error = this._execute(state, delay);\n    if (error) {\n      return error;\n    } else if (this.pending === false && this.id != null) {\n      // Dequeue if the action didn't reschedule itself. Don't call\n      // unsubscribe(), because the action could reschedule later.\n      // For example:\n      // ```\n      // scheduler.schedule(function doWork(counter) {\n      //   /* ... I'm a busy worker bee ... */\n      //   var originalAction = this;\n      //   /* wait 100ms before rescheduling the action */\n      //   setTimeout(function () {\n      //     originalAction.schedule(counter + 1);\n      //   }, 100);\n      // }, 1000);\n      // ```\n      this.id = this.recycleAsyncId(this.scheduler, this.id, null);\n    }\n  }\n\n  protected _execute(state: T, delay: number): any {\n    let errored: boolean = false;\n    let errorValue: any = undefined;\n    try {\n      this.work(state);\n    } catch (e) {\n      errored = true;\n      errorValue = !!e && e || new Error(e);\n    }\n    if (errored) {\n      this.unsubscribe();\n      return errorValue;\n    }\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _unsubscribe() {\n\n    const id = this.id;\n    const scheduler = this.scheduler;\n    const actions = scheduler.actions;\n    const index = actions.indexOf(this);\n\n    this.work  = null;\n    this.state = null;\n    this.pending = false;\n    this.scheduler = null;\n\n    if (index !== -1) {\n      actions.splice(index, 1);\n    }\n\n    if (id != null) {\n      this.id = this.recycleAsyncId(scheduler, id, null);\n    }\n\n    this.delay = null;\n  }\n}\n","import { AsyncAction } from './AsyncAction';\nimport { Subscription } from '../Subscription';\nimport { QueueScheduler } from './QueueScheduler';\nimport { SchedulerAction } from '../types';\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nexport class QueueAction<T> extends AsyncAction<T> {\n\n  constructor(protected scheduler: QueueScheduler,\n              protected work: (this: SchedulerAction<T>, state?: T) => void) {\n    super(scheduler, work);\n  }\n\n  public schedule(state?: T, delay: number = 0): Subscription {\n    if (delay > 0) {\n      return super.schedule(state, delay);\n    }\n    this.delay = delay;\n    this.state = state;\n    this.scheduler.flush(this);\n    return this;\n  }\n\n  public execute(state: T, delay: number): any {\n    return (delay > 0 || this.closed) ?\n      super.execute(state, delay) :\n      this._execute(state, delay) ;\n  }\n\n  protected requestAsyncId(scheduler: QueueScheduler, id?: any, delay: number = 0): any {\n    // If delay exists and is greater than 0, or if the delay is null (the\n    // action wasn't rescheduled) but was originally scheduled as an async\n    // action, then recycle as an async action.\n    if ((delay !== null && delay > 0) || (delay === null && this.delay > 0)) {\n      return super.requestAsyncId(scheduler, id, delay);\n    }\n    // Otherwise flush the scheduler starting with this action.\n    return scheduler.flush(this);\n  }\n}\n","import { Action } from './scheduler/Action';\nimport { Subscription } from './Subscription';\nimport { SchedulerLike, SchedulerAction } from './types';\n\n/**\n * An execution context and a data structure to order tasks and schedule their\n * execution. Provides a notion of (potentially virtual) time, through the\n * `now()` getter method.\n *\n * Each unit of work in a Scheduler is called an `Action`.\n *\n * ```ts\n * class Scheduler {\n *   now(): number;\n *   schedule(work, delay?, state?): Subscription;\n * }\n * ```\n *\n * @class Scheduler\n * @deprecated Scheduler is an internal implementation detail of RxJS, and\n * should not be used directly. Rather, create your own class and implement\n * {@link SchedulerLike}\n */\nexport class Scheduler implements SchedulerLike {\n\n  /**\n   * Note: the extra arrow function wrapper is to make testing by overriding\n   * Date.now easier.\n   * @nocollapse\n   */\n  public static now: () => number = () => Date.now();\n\n  constructor(private SchedulerAction: typeof Action,\n              now: () => number = Scheduler.now) {\n    this.now = now;\n  }\n\n  /**\n   * A getter method that returns a number representing the current time\n   * (at the time this function was called) according to the scheduler's own\n   * internal clock.\n   * @return {number} A number that represents the current time. May or may not\n   * have a relation to wall-clock time. May or may not refer to a time unit\n   * (e.g. milliseconds).\n   */\n  public now: () => number;\n\n  /**\n   * Schedules a function, `work`, for execution. May happen at some point in\n   * the future, according to the `delay` parameter, if specified. May be passed\n   * some context object, `state`, which will be passed to the `work` function.\n   *\n   * The given arguments will be processed an stored as an Action object in a\n   * queue of actions.\n   *\n   * @param {function(state: ?T): ?Subscription} work A function representing a\n   * task, or some unit of work to be executed by the Scheduler.\n   * @param {number} [delay] Time to wait before executing the work, where the\n   * time unit is implicit and defined by the Scheduler itself.\n   * @param {T} [state] Some contextual data that the `work` function uses when\n   * called by the Scheduler.\n   * @return {Subscription} A subscription in order to be able to unsubscribe\n   * the scheduled work.\n   */\n  public schedule<T>(work: (this: SchedulerAction<T>, state?: T) => void, delay: number = 0, state?: T): Subscription {\n    return new this.SchedulerAction<T>(this, work).schedule(state, delay);\n  }\n}\n","import { Scheduler } from '../Scheduler';\nimport { Action } from './Action';\nimport { AsyncAction } from './AsyncAction';\nimport { SchedulerAction } from '../types';\nimport { Subscription } from '../Subscription';\n\nexport class AsyncScheduler extends Scheduler {\n  public static delegate?: Scheduler;\n  public actions: Array<AsyncAction<any>> = [];\n  /**\n   * A flag to indicate whether the Scheduler is currently executing a batch of\n   * queued actions.\n   * @type {boolean}\n   * @deprecated internal use only\n   */\n  public active: boolean = false;\n  /**\n   * An internal ID used to track the latest asynchronous task such as those\n   * coming from `setTimeout`, `setInterval`, `requestAnimationFrame`, and\n   * others.\n   * @type {any}\n   * @deprecated internal use only\n   */\n  public scheduled: any = undefined;\n\n  constructor(SchedulerAction: typeof Action,\n              now: () => number = Scheduler.now) {\n    super(SchedulerAction, () => {\n      if (AsyncScheduler.delegate && AsyncScheduler.delegate !== this) {\n        return AsyncScheduler.delegate.now();\n      } else {\n        return now();\n      }\n    });\n  }\n\n  public schedule<T>(work: (this: SchedulerAction<T>, state?: T) => void, delay: number = 0, state?: T): Subscription {\n    if (AsyncScheduler.delegate && AsyncScheduler.delegate !== this) {\n      return AsyncScheduler.delegate.schedule(work, delay, state);\n    } else {\n      return super.schedule(work, delay, state);\n    }\n  }\n\n  public flush(action: AsyncAction<any>): void {\n\n    const {actions} = this;\n\n    if (this.active) {\n      actions.push(action);\n      return;\n    }\n\n    let error: any;\n    this.active = true;\n\n    do {\n      if (error = action.execute(action.state, action.delay)) {\n        break;\n      }\n    } while (action = actions.shift()); // exhaust the scheduler queue\n\n    this.active = false;\n\n    if (error) {\n      while (action = actions.shift()) {\n        action.unsubscribe();\n      }\n      throw error;\n    }\n  }\n}\n","import { AsyncScheduler } from './AsyncScheduler';\n\nexport class QueueScheduler extends AsyncScheduler {\n}\n","import { QueueAction } from './QueueAction';\nimport { QueueScheduler } from './QueueScheduler';\n\n/**\n *\n * Queue Scheduler\n *\n * <span class=\"informal\">Put every next task on a queue, instead of executing it immediately</span>\n *\n * `queue` scheduler, when used with delay, behaves the same as {@link asyncScheduler} scheduler.\n *\n * When used without delay, it schedules given task synchronously - executes it right when\n * it is scheduled. However when called recursively, that is when inside the scheduled task,\n * another task is scheduled with queue scheduler, instead of executing immediately as well,\n * that task will be put on a queue and wait for current one to finish.\n *\n * This means that when you execute task with `queue` scheduler, you are sure it will end\n * before any other task scheduled with that scheduler will start.\n *\n * ## Examples\n * Schedule recursively first, then do something\n * ```ts\n * import { queueScheduler } from 'rxjs';\n *\n * queueScheduler.schedule(() => {\n *   queueScheduler.schedule(() => console.log('second')); // will not happen now, but will be put on a queue\n *\n *   console.log('first');\n * });\n *\n * // Logs:\n * // \"first\"\n * // \"second\"\n * ```\n *\n * Reschedule itself recursively\n * ```ts\n * import { queueScheduler } from 'rxjs';\n *\n * queueScheduler.schedule(function(state) {\n *   if (state !== 0) {\n *     console.log('before', state);\n *     this.schedule(state - 1); // `this` references currently executing Action,\n *                               // which we reschedule with new state\n *     console.log('after', state);\n *   }\n * }, 0, 3);\n *\n * // In scheduler that runs recursively, you would expect:\n * // \"before\", 3\n * // \"before\", 2\n * // \"before\", 1\n * // \"after\", 1\n * // \"after\", 2\n * // \"after\", 3\n *\n * // But with queue it logs:\n * // \"before\", 3\n * // \"after\", 3\n * // \"before\", 2\n * // \"after\", 2\n * // \"before\", 1\n * // \"after\", 1\n * ```\n *\n * @static true\n * @name queue\n * @owner Scheduler\n */\n\nexport const queue = new QueueScheduler(QueueAction);\n","import { Observable } from '../Observable';\nimport { SchedulerLike } from '../types';\n\n/**\n * The same Observable instance returned by any call to {@link empty} without a\n * `scheduler`. It is preferrable to use this over `empty()`.\n */\nexport const EMPTY = new Observable<never>(subscriber => subscriber.complete());\n\n/**\n * Creates an Observable that emits no items to the Observer and immediately\n * emits a complete notification.\n *\n * <span class=\"informal\">Just emits 'complete', and nothing else.\n * </span>\n *\n * ![](empty.png)\n *\n * This static operator is useful for creating a simple Observable that only\n * emits the complete notification. It can be used for composing with other\n * Observables, such as in a {@link mergeMap}.\n *\n * ## Examples\n * ### Emit the number 7, then complete\n * ```ts\n * import { empty } from 'rxjs';\n * import { startWith } from 'rxjs/operators';\n *\n * const result = empty().pipe(startWith(7));\n * result.subscribe(x => console.log(x));\n * ```\n *\n * ### Map and flatten only odd numbers to the sequence 'a', 'b', 'c'\n * ```ts\n * import { empty, interval, of } from 'rxjs';\n * import { mergeMap } from 'rxjs/operators';\n *\n * const interval$ = interval(1000);\n * const result = interval$.pipe(\n *   mergeMap(x => x % 2 === 1 ? of('a', 'b', 'c') : empty()),\n * );\n * result.subscribe(x => console.log(x));\n *\n * // Results in the following to the console:\n * // x is equal to the count on the interval eg(0,1,2,3,...)\n * // x will occur every 1000ms\n * // if x % 2 is equal to 1 print abc\n * // if x % 2 is not equal to 1 nothing will be output\n * ```\n *\n * @see {@link Observable}\n * @see {@link never}\n * @see {@link of}\n * @see {@link throwError}\n *\n * @param scheduler A {@link SchedulerLike} to use for scheduling\n * the emission of the complete notification.\n * @return An \"empty\" Observable: emits only the complete\n * notification.\n * @deprecated Deprecated in favor of using {@link EMPTY} constant, or {@link scheduled} (e.g. `scheduled([], scheduler)`)\n */\nexport function empty(scheduler?: SchedulerLike) {\n  return scheduler ? emptyScheduled(scheduler) : EMPTY;\n}\n\nfunction emptyScheduled(scheduler: SchedulerLike) {\n  return new Observable<never>(subscriber => scheduler.schedule(() => subscriber.complete()));\n}\n","import { SchedulerLike } from '../types';\n\nexport function isScheduler(value: any): value is SchedulerLike {\n  return value && typeof (<any>value).schedule === 'function';\n}\n","import { Subscriber } from '../Subscriber';\n\n/**\n * Subscribes to an ArrayLike with a subscriber\n * @param array The array or array-like to subscribe to\n */\nexport const subscribeToArray = <T>(array: ArrayLike<T>) => (subscriber: Subscriber<T>) => {\n  for (let i = 0, len = array.length; i < len && !subscriber.closed; i++) {\n    subscriber.next(array[i]);\n  }\n  subscriber.complete();\n};\n","import { Observable } from '../Observable';\nimport { SchedulerLike } from '../types';\nimport { Subscription } from '../Subscription';\n\nexport function scheduleArray<T>(input: ArrayLike<T>, scheduler: SchedulerLike) {\n  return new Observable<T>(subscriber => {\n    const sub = new Subscription();\n    let i = 0;\n    sub.add(scheduler.schedule(function () {\n      if (i === input.length) {\n        subscriber.complete();\n        return;\n      }\n      subscriber.next(input[i++]);\n      if (!subscriber.closed) {\n        sub.add(this.schedule());\n      }\n    }));\n    return sub;\n  });\n}\n","import { Observable } from '../Observable';\nimport { SchedulerLike } from '../types';\nimport { subscribeToArray } from '../util/subscribeToArray';\nimport { scheduleArray } from '../scheduled/scheduleArray';\n\nexport function fromArray<T>(input: ArrayLike<T>, scheduler?: SchedulerLike) {\n  if (!scheduler) {\n    return new Observable<T>(subscribeToArray(input));\n  } else {\n    return scheduleArray(input, scheduler);\n  }\n}\n","import { SchedulerLike } from '../types';\nimport { isScheduler } from '../util/isScheduler';\nimport { fromArray } from './fromArray';\nimport { Observable } from '../Observable';\nimport { scheduleArray } from '../scheduled/scheduleArray';\n\n/* tslint:disable:max-line-length */\n/** @deprecated use {@link scheduled} instead `scheduled([a, b, c], scheduler)` */\nexport function of<T>(a: T, scheduler: SchedulerLike): Observable<T>;\n/** @deprecated use {@link scheduled} instead `scheduled([a, b, c], scheduler)` */\nexport function of<T, T2>(a: T, b: T2, scheduler: SchedulerLike): Observable<T | T2>;\n/** @deprecated use {@link scheduled} instead `scheduled([a, b, c], scheduler)` */\nexport function of<T, T2, T3>(a: T, b: T2, c: T3, scheduler: SchedulerLike): Observable<T | T2 | T3>;\n/** @deprecated use {@link scheduled} instead `scheduled([a, b, c], scheduler)` */\nexport function of<T, T2, T3, T4>(a: T, b: T2, c: T3, d: T4, scheduler: SchedulerLike): Observable<T | T2 | T3 | T4>;\n/** @deprecated use {@link scheduled} instead `scheduled([a, b, c], scheduler)` */\nexport function of<T, T2, T3, T4, T5>(a: T, b: T2, c: T3, d: T4, e: T5, scheduler: SchedulerLike): Observable<T | T2 | T3 | T4 | T5>;\n/** @deprecated use {@link scheduled} instead `scheduled([a, b, c], scheduler)` */\nexport function of<T, T2, T3, T4, T5, T6>(a: T, b: T2, c: T3, d: T4, e: T5, f: T6, scheduler: SchedulerLike): Observable<T | T2 | T3 | T4 | T5 | T6>;\n/** @deprecated use {@link scheduled} instead `scheduled([a, b, c], scheduler)` */\nexport function of<T, T2, T3, T4, T5, T6, T7>(a: T, b: T2, c: T3, d: T4, e: T5, f: T6, g: T7, scheduler: SchedulerLike):\n  Observable<T | T2 | T3 | T4 | T5 | T6 | T7>;\n/** @deprecated use {@link scheduled} instead `scheduled([a, b, c], scheduler)` */\nexport function of<T, T2, T3, T4, T5, T6, T7, T8>(a: T, b: T2, c: T3, d: T4, e: T5, f: T6, g: T7, h: T8, scheduler: SchedulerLike):\n  Observable<T | T2 | T3 | T4 | T5 | T6 | T7 | T8>;\n/** @deprecated use {@link scheduled} instead `scheduled([a, b, c], scheduler)` */\nexport function of<T, T2, T3, T4, T5, T6, T7, T8, T9>(a: T, b: T2, c: T3, d: T4, e: T5, f: T6, g: T7, h: T8, i: T9, scheduler: SchedulerLike):\n  Observable<T | T2 | T3 | T4 | T5 | T6 | T7 | T8 | T9>;\nexport function of<T>(...args: (T | SchedulerLike)[]): Observable<T>;\n\n// TODO(benlesh): Update the typings for this when we can switch to TS 3.x\nexport function of<T>(a: T): Observable<T>;\nexport function of<T, T2>(a: T, b: T2): Observable<T | T2>;\nexport function of<T, T2, T3>(a: T, b: T2, c: T3): Observable<T | T2 | T3>;\nexport function of<T, T2, T3, T4>(a: T, b: T2, c: T3, d: T4): Observable<T | T2 | T3 | T4>;\nexport function of<T, T2, T3, T4, T5>(a: T, b: T2, c: T3, d: T4, e: T5): Observable<T | T2 | T3 | T4 | T5>;\nexport function of<T, T2, T3, T4, T5, T6>(a: T, b: T2, c: T3, d: T4, e: T5, f: T6): Observable<T | T2 | T3 | T4 | T5 | T6>;\nexport function of<T, T2, T3, T4, T5, T6, T7>(a: T, b: T2, c: T3, d: T4, e: T5, f: T6, g: T7):\n  Observable<T | T2 | T3 | T4 | T5 | T6 | T7>;\nexport function of<T, T2, T3, T4, T5, T6, T7, T8>(a: T, b: T2, c: T3, d: T4, e: T5, f: T6, g: T7, h: T8):\n  Observable<T | T2 | T3 | T4 | T5 | T6 | T7 | T8>;\nexport function of<T, T2, T3, T4, T5, T6, T7, T8, T9>(a: T, b: T2, c: T3, d: T4, e: T5, f: T6, g: T7, h: T8, i: T9):\n  Observable<T | T2 | T3 | T4 | T5 | T6 | T7 | T8 | T9>;\nexport function of<T>(...args: T[]): Observable<T>;\n/* tslint:enable:max-line-length */\n\n/**\n * Converts the arguments to an observable sequence.\n *\n * <span class=\"informal\">Each argument becomes a `next` notification.</span>\n *\n * ![](of.png)\n *\n * Unlike {@link from}, it does not do any flattening and emits each argument in whole\n * as a separate `next` notification.\n *\n * ## Examples\n *\n * Emit the values `10, 20, 30`\n *\n * ```ts\n * import { of } from 'rxjs';\n *\n * of(10, 20, 30)\n * .subscribe(\n *   next => console.log('next:', next),\n *   err => console.log('error:', err),\n *   () => console.log('the end'),\n * );\n * // result:\n * // 'next: 10'\n * // 'next: 20'\n * // 'next: 30'\n *\n * ```\n *\n * Emit the array `[1,2,3]`\n *\n * ```ts\n * import { of } from 'rxjs';\n *\n * of([1,2,3])\n * .subscribe(\n *   next => console.log('next:', next),\n *   err => console.log('error:', err),\n *   () => console.log('the end'),\n * );\n * // result:\n * // 'next: [1,2,3]'\n * ```\n *\n * @see {@link from}\n * @see {@link range}\n *\n * @param {...T} values A comma separated list of arguments you want to be emitted\n * @return {Observable} An Observable that emits the arguments\n * described above and then completes.\n * @method of\n * @owner Observable\n */\n\nexport function of<T>(...args: Array<T | SchedulerLike>): Observable<T> {\n  let scheduler = args[args.length - 1] as SchedulerLike;\n  if (isScheduler(scheduler)) {\n    args.pop();\n    return scheduleArray(args as T[], scheduler);\n  } else {\n    return fromArray(args as T[]);\n  }\n}\n","import { Observable } from '../Observable';\nimport { SchedulerLike } from '../types';\nimport { Subscriber } from '../Subscriber';\n\n/**\n * Creates an Observable that emits no items to the Observer and immediately\n * emits an error notification.\n *\n * <span class=\"informal\">Just emits 'error', and nothing else.\n * </span>\n *\n * ![](throw.png)\n *\n * This static operator is useful for creating a simple Observable that only\n * emits the error notification. It can be used for composing with other\n * Observables, such as in a {@link mergeMap}.\n *\n * ## Examples\n * ### Emit the number 7, then emit an error\n * ```ts\n * import { throwError, concat, of } from 'rxjs';\n *\n * const result = concat(of(7), throwError(new Error('oops!')));\n * result.subscribe(x => console.log(x), e => console.error(e));\n *\n * // Logs:\n * // 7\n * // Error: oops!\n * ```\n *\n * ---\n *\n * ### Map and flatten numbers to the sequence 'a', 'b', 'c', but throw an error for 2\n * ```ts\n * import { throwError, interval, of } from 'rxjs';\n * import { mergeMap } from 'rxjs/operators';\n *\n * interval(1000).pipe(\n *   mergeMap(x => x === 2\n *     ? throwError('Twos are bad')\n *     : of('a', 'b', 'c')\n *   ),\n * ).subscribe(x => console.log(x), e => console.error(e));\n *\n * // Logs:\n * // a\n * // b\n * // c\n * // a\n * // b\n * // c\n * // Twos are bad\n * ```\n *\n * @see {@link Observable}\n * @see {@link empty}\n * @see {@link never}\n * @see {@link of}\n *\n * @param {any} error The particular Error to pass to the error notification.\n * @param {SchedulerLike} [scheduler] A {@link SchedulerLike} to use for scheduling\n * the emission of the error notification.\n * @return {Observable} An error Observable: emits only the error notification\n * using the given error argument.\n * @static true\n * @name throwError\n * @owner Observable\n */\nexport function throwError(error: any, scheduler?: SchedulerLike): Observable<never> {\n  if (!scheduler) {\n    return new Observable(subscriber => subscriber.error(error));\n  } else {\n    return new Observable(subscriber => scheduler.schedule(dispatch, 0, { error, subscriber }));\n  }\n}\n\ninterface DispatchArg {\n  error: any;\n  subscriber: Subscriber<any>;\n}\n\nfunction dispatch({ error, subscriber }: DispatchArg) {\n  subscriber.error(error);\n}\n","import { PartialObserver } from './types';\nimport { Observable } from './Observable';\nimport { empty } from './observable/empty';\nimport { of } from './observable/of';\nimport { throwError } from './observable/throwError';\nimport { deprecate } from 'util';\n\n// TODO: When this enum is removed, replace it with a type alias. See #4556.\n/**\n * @deprecated NotificationKind is deprecated as const enums are not compatible with isolated modules. Use a string literal instead.\n */\nexport enum NotificationKind {\n  NEXT = 'N',\n  ERROR = 'E',\n  COMPLETE = 'C',\n}\n\n/**\n * Represents a push-based event or value that an {@link Observable} can emit.\n * This class is particularly useful for operators that manage notifications,\n * like {@link materialize}, {@link dematerialize}, {@link observeOn}, and\n * others. Besides wrapping the actual delivered value, it also annotates it\n * with metadata of, for instance, what type of push message it is (`next`,\n * `error`, or `complete`).\n *\n * @see {@link materialize}\n * @see {@link dematerialize}\n * @see {@link observeOn}\n *\n * @class Notification<T>\n */\nexport class Notification<T> {\n  hasValue: boolean;\n\n  constructor(public kind: 'N' | 'E' | 'C', public value?: T, public error?: any) {\n    this.hasValue = kind === 'N';\n  }\n\n  /**\n   * Delivers to the given `observer` the value wrapped by this Notification.\n   * @param {Observer} observer\n   * @return\n   */\n  observe(observer: PartialObserver<T>): any {\n    switch (this.kind) {\n      case 'N':\n        return observer.next && observer.next(this.value);\n      case 'E':\n        return observer.error && observer.error(this.error);\n      case 'C':\n        return observer.complete && observer.complete();\n    }\n  }\n\n  /**\n   * Given some {@link Observer} callbacks, deliver the value represented by the\n   * current Notification to the correctly corresponding callback.\n   * @param {function(value: T): void} next An Observer `next` callback.\n   * @param {function(err: any): void} [error] An Observer `error` callback.\n   * @param {function(): void} [complete] An Observer `complete` callback.\n   * @return {any}\n   */\n  do(next: (value: T) => void, error?: (err: any) => void, complete?: () => void): any {\n    const kind = this.kind;\n    switch (kind) {\n      case 'N':\n        return next && next(this.value);\n      case 'E':\n        return error && error(this.error);\n      case 'C':\n        return complete && complete();\n    }\n  }\n\n  /**\n   * Takes an Observer or its individual callback functions, and calls `observe`\n   * or `do` methods accordingly.\n   * @param {Observer|function(value: T): void} nextOrObserver An Observer or\n   * the `next` callback.\n   * @param {function(err: any): void} [error] An Observer `error` callback.\n   * @param {function(): void} [complete] An Observer `complete` callback.\n   * @return {any}\n   */\n  accept(nextOrObserver: PartialObserver<T> | ((value: T) => void), error?: (err: any) => void, complete?: () => void) {\n    if (nextOrObserver && typeof (<PartialObserver<T>>nextOrObserver).next === 'function') {\n      return this.observe(<PartialObserver<T>>nextOrObserver);\n    } else {\n      return this.do(<(value: T) => void>nextOrObserver, error, complete);\n    }\n  }\n\n  /**\n   * Returns a simple Observable that just delivers the notification represented\n   * by this Notification instance.\n   * @return {any}\n   */\n  toObservable(): Observable<T> {\n    const kind = this.kind;\n    switch (kind) {\n      case 'N':\n        return of(this.value);\n      case 'E':\n        return throwError(this.error);\n      case 'C':\n        return empty();\n    }\n    throw new Error('unexpected notification kind value');\n  }\n\n  private static completeNotification: Notification<any> = new Notification('C');\n  private static undefinedValueNotification: Notification<any> = new Notification('N', undefined);\n\n  /**\n   * A shortcut to create a Notification instance of the type `next` from a\n   * given value.\n   * @param {T} value The `next` value.\n   * @return {Notification<T>} The \"next\" Notification representing the\n   * argument.\n   * @nocollapse\n   */\n  static createNext<T>(value: T): Notification<T> {\n    if (typeof value !== 'undefined') {\n      return new Notification('N', value);\n    }\n    return Notification.undefinedValueNotification;\n  }\n\n  /**\n   * A shortcut to create a Notification instance of the type `error` from a\n   * given error.\n   * @param {any} [err] The `error` error.\n   * @return {Notification<T>} The \"error\" Notification representing the\n   * argument.\n   * @nocollapse\n   */\n  static createError<T>(err?: any): Notification<T> {\n    return new Notification('E', undefined, err);\n  }\n\n  /**\n   * A shortcut to create a Notification instance of the type `complete`.\n   * @return {Notification<any>} The valueless \"complete\" Notification.\n   * @nocollapse\n   */\n  static createComplete(): Notification<any> {\n    return Notification.completeNotification;\n  }\n}\n","import { Observable } from '../Observable';\nimport { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { Notification } from '../Notification';\nimport { MonoTypeOperatorFunction, PartialObserver, SchedulerAction, SchedulerLike, TeardownLogic } from '../types';\n\n/**\n *\n * Re-emits all notifications from source Observable with specified scheduler.\n *\n * <span class=\"informal\">Ensure a specific scheduler is used, from outside of an Observable.</span>\n *\n * `observeOn` is an operator that accepts a scheduler as a first parameter, which will be used to reschedule\n * notifications emitted by the source Observable. It might be useful, if you do not have control over\n * internal scheduler of a given Observable, but want to control when its values are emitted nevertheless.\n *\n * Returned Observable emits the same notifications (nexted values, complete and error events) as the source Observable,\n * but rescheduled with provided scheduler. Note that this doesn't mean that source Observables internal\n * scheduler will be replaced in any way. Original scheduler still will be used, but when the source Observable emits\n * notification, it will be immediately scheduled again - this time with scheduler passed to `observeOn`.\n * An anti-pattern would be calling `observeOn` on Observable that emits lots of values synchronously, to split\n * that emissions into asynchronous chunks. For this to happen, scheduler would have to be passed into the source\n * Observable directly (usually into the operator that creates it). `observeOn` simply delays notifications a\n * little bit more, to ensure that they are emitted at expected moments.\n *\n * As a matter of fact, `observeOn` accepts second parameter, which specifies in milliseconds with what delay notifications\n * will be emitted. The main difference between {@link delay} operator and `observeOn` is that `observeOn`\n * will delay all notifications - including error notifications - while `delay` will pass through error\n * from source Observable immediately when it is emitted. In general it is highly recommended to use `delay` operator\n * for any kind of delaying of values in the stream, while using `observeOn` to specify which scheduler should be used\n * for notification emissions in general.\n *\n * ## Example\n * Ensure values in subscribe are called just before browser repaint.\n * ```ts\n * import { interval } from 'rxjs';\n * import { observeOn } from 'rxjs/operators';\n *\n * const intervals = interval(10);                // Intervals are scheduled\n *                                                // with async scheduler by default...\n * intervals.pipe(\n *   observeOn(animationFrameScheduler),          // ...but we will observe on animationFrame\n * )                                              // scheduler to ensure smooth animation.\n * .subscribe(val => {\n *   someDiv.style.height = val + 'px';\n * });\n * ```\n *\n * @see {@link delay}\n *\n * @param {SchedulerLike} scheduler Scheduler that will be used to reschedule notifications from source Observable.\n * @param {number} [delay] Number of milliseconds that states with what delay every notification should be rescheduled.\n * @return {Observable<T>} Observable that emits the same notifications as the source Observable,\n * but with provided scheduler.\n *\n * @method observeOn\n * @owner Observable\n */\nexport function observeOn<T>(scheduler: SchedulerLike, delay: number = 0): MonoTypeOperatorFunction<T> {\n  return function observeOnOperatorFunction(source: Observable<T>): Observable<T> {\n    return source.lift(new ObserveOnOperator(scheduler, delay));\n  };\n}\n\nexport class ObserveOnOperator<T> implements Operator<T, T> {\n  constructor(private scheduler: SchedulerLike, private delay: number = 0) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new ObserveOnSubscriber(subscriber, this.scheduler, this.delay));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nexport class ObserveOnSubscriber<T> extends Subscriber<T> {\n  /** @nocollapse */\n  static dispatch(this: SchedulerAction<ObserveOnMessage>, arg: ObserveOnMessage) {\n    const { notification, destination } = arg;\n    notification.observe(destination);\n    this.unsubscribe();\n  }\n\n  constructor(destination: Subscriber<T>,\n              private scheduler: SchedulerLike,\n              private delay: number = 0) {\n    super(destination);\n  }\n\n  private scheduleMessage(notification: Notification<any>): void {\n    const destination = this.destination as Subscription;\n    destination.add(this.scheduler.schedule(\n      ObserveOnSubscriber.dispatch,\n      this.delay,\n      new ObserveOnMessage(notification, this.destination)\n    ));\n  }\n\n  protected _next(value: T): void {\n    this.scheduleMessage(Notification.createNext(value));\n  }\n\n  protected _error(err: any): void {\n    this.scheduleMessage(Notification.createError(err));\n    this.unsubscribe();\n  }\n\n  protected _complete(): void {\n    this.scheduleMessage(Notification.createComplete());\n    this.unsubscribe();\n  }\n}\n\nexport class ObserveOnMessage {\n  constructor(public notification: Notification<any>,\n              public destination: PartialObserver<any>) {\n  }\n}\n","import { Subject } from './Subject';\nimport { SchedulerLike } from './types';\nimport { queue } from './scheduler/queue';\nimport { Subscriber } from './Subscriber';\nimport { Subscription } from './Subscription';\nimport { ObserveOnSubscriber } from './operators/observeOn';\nimport { ObjectUnsubscribedError } from './util/ObjectUnsubscribedError';\nimport { SubjectSubscription } from './SubjectSubscription';\n/**\n * A variant of Subject that \"replays\" or emits old values to new subscribers.\n * It buffers a set number of values and will emit those values immediately to\n * any new subscribers in addition to emitting new values to existing subscribers.\n *\n * @class ReplaySubject<T>\n */\nexport class ReplaySubject<T> extends Subject<T> {\n  private _events: (ReplayEvent<T> | T)[] = [];\n  private _bufferSize: number;\n  private _windowTime: number;\n  private _infiniteTimeWindow: boolean = false;\n\n  constructor(bufferSize: number = Number.POSITIVE_INFINITY,\n              windowTime: number = Number.POSITIVE_INFINITY,\n              private scheduler?: SchedulerLike) {\n    super();\n    this._bufferSize = bufferSize < 1 ? 1 : bufferSize;\n    this._windowTime = windowTime < 1 ? 1 : windowTime;\n\n    if (windowTime === Number.POSITIVE_INFINITY) {\n      this._infiniteTimeWindow = true;\n      this.next = this.nextInfiniteTimeWindow;\n    } else {\n      this.next = this.nextTimeWindow;\n    }\n  }\n\n  private nextInfiniteTimeWindow(value: T): void {\n    const _events = this._events;\n    _events.push(value);\n    // Since this method is invoked in every next() call than the buffer\n    // can overgrow the max size only by one item\n    if (_events.length > this._bufferSize) {\n      _events.shift();\n    }\n\n    super.next(value);\n  }\n\n  private nextTimeWindow(value: T): void {\n    this._events.push(new ReplayEvent(this._getNow(), value));\n    this._trimBufferThenGetEvents();\n\n    super.next(value);\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _subscribe(subscriber: Subscriber<T>): Subscription {\n    // When `_infiniteTimeWindow === true` then the buffer is already trimmed\n    const _infiniteTimeWindow = this._infiniteTimeWindow;\n    const _events = _infiniteTimeWindow ? this._events : this._trimBufferThenGetEvents();\n    const scheduler = this.scheduler;\n    const len = _events.length;\n    let subscription: Subscription;\n\n    if (this.closed) {\n      throw new ObjectUnsubscribedError();\n    } else if (this.isStopped || this.hasError) {\n      subscription = Subscription.EMPTY;\n    } else {\n      this.observers.push(subscriber);\n      subscription = new SubjectSubscription(this, subscriber);\n    }\n\n    if (scheduler) {\n      subscriber.add(subscriber = new ObserveOnSubscriber<T>(subscriber, scheduler));\n    }\n\n    if (_infiniteTimeWindow) {\n      for (let i = 0; i < len && !subscriber.closed; i++) {\n        subscriber.next(<T>_events[i]);\n      }\n    } else {\n      for (let i = 0; i < len && !subscriber.closed; i++) {\n        subscriber.next((<ReplayEvent<T>>_events[i]).value);\n      }\n    }\n\n    if (this.hasError) {\n      subscriber.error(this.thrownError);\n    } else if (this.isStopped) {\n      subscriber.complete();\n    }\n\n    return subscription;\n  }\n\n  _getNow(): number {\n    return (this.scheduler || queue).now();\n  }\n\n  private _trimBufferThenGetEvents(): ReplayEvent<T>[] {\n    const now = this._getNow();\n    const _bufferSize = this._bufferSize;\n    const _windowTime = this._windowTime;\n    const _events = <ReplayEvent<T>[]>this._events;\n\n    const eventsCount = _events.length;\n    let spliceCount = 0;\n\n    // Trim events that fall out of the time window.\n    // Start at the front of the list. Break early once\n    // we encounter an event that falls within the window.\n    while (spliceCount < eventsCount) {\n      if ((now - _events[spliceCount].time) < _windowTime) {\n        break;\n      }\n      spliceCount++;\n    }\n\n    if (eventsCount > _bufferSize) {\n      spliceCount = Math.max(spliceCount, eventsCount - _bufferSize);\n    }\n\n    if (spliceCount > 0) {\n      _events.splice(0, spliceCount);\n    }\n\n    return _events;\n  }\n\n}\n\nclass ReplayEvent<T> {\n  constructor(public time: number, public value: T) {\n  }\n}\n","import { Subject } from './Subject';\nimport { Subscriber } from './Subscriber';\nimport { Subscription } from './Subscription';\n\n/**\n * A variant of Subject that only emits a value when it completes. It will emit\n * its latest value to all its observers on completion.\n *\n * @class AsyncSubject<T>\n */\nexport class AsyncSubject<T> extends Subject<T> {\n  private value: T = null;\n  private hasNext: boolean = false;\n  private hasCompleted: boolean = false;\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _subscribe(subscriber: Subscriber<any>): Subscription {\n    if (this.hasError) {\n      subscriber.error(this.thrownError);\n      return Subscription.EMPTY;\n    } else if (this.hasCompleted && this.hasNext) {\n      subscriber.next(this.value);\n      subscriber.complete();\n      return Subscription.EMPTY;\n    }\n    return super._subscribe(subscriber);\n  }\n\n  next(value: T): void {\n    if (!this.hasCompleted) {\n      this.value = value;\n      this.hasNext = true;\n    }\n  }\n\n  error(error: any): void {\n    if (!this.hasCompleted) {\n      super.error(error);\n    }\n  }\n\n  complete(): void {\n    this.hasCompleted = true;\n    if (this.hasNext) {\n      super.next(this.value);\n    }\n    super.complete();\n  }\n}\n","let nextHandle = 1;\n\nconst tasksByHandle: { [handle: string]: () => void } = {};\n\nfunction runIfPresent(handle: number) {\n  const cb = tasksByHandle[handle];\n  if (cb) {\n    cb();\n  }\n}\n\nexport const Immediate = {\n  setImmediate(cb: () => void): number {\n    const handle = nextHandle++;\n    tasksByHandle[handle] = cb;\n    Promise.resolve().then(() => runIfPresent(handle));\n    return handle;\n  },\n\n  clearImmediate(handle: number): void {\n    delete tasksByHandle[handle];\n  },\n};\n","import { Immediate } from '../util/Immediate';\nimport { AsyncAction } from './AsyncAction';\nimport { AsapScheduler } from './AsapScheduler';\nimport { SchedulerAction } from '../types';\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nexport class AsapAction<T> extends AsyncAction<T> {\n\n  constructor(protected scheduler: AsapScheduler,\n              protected work: (this: SchedulerAction<T>, state?: T) => void) {\n    super(scheduler, work);\n  }\n\n  protected requestAsyncId(scheduler: AsapScheduler, id?: any, delay: number = 0): any {\n    // If delay is greater than 0, request as an async action.\n    if (delay !== null && delay > 0) {\n      return super.requestAsyncId(scheduler, id, delay);\n    }\n    // Push the action to the end of the scheduler queue.\n    scheduler.actions.push(this);\n    // If a microtask has already been scheduled, don't schedule another\n    // one. If a microtask hasn't been scheduled yet, schedule one now. Return\n    // the current scheduled microtask id.\n    return scheduler.scheduled || (scheduler.scheduled = Immediate.setImmediate(\n      scheduler.flush.bind(scheduler, null)\n    ));\n  }\n  protected recycleAsyncId(scheduler: AsapScheduler, id?: any, delay: number = 0): any {\n    // If delay exists and is greater than 0, or if the delay is null (the\n    // action wasn't rescheduled) but was originally scheduled as an async\n    // action, then recycle as an async action.\n    if ((delay !== null && delay > 0) || (delay === null && this.delay > 0)) {\n      return super.recycleAsyncId(scheduler, id, delay);\n    }\n    // If the scheduler queue is empty, cancel the requested microtask and\n    // set the scheduled flag to undefined so the next AsapAction will schedule\n    // its own.\n    if (scheduler.actions.length === 0) {\n      Immediate.clearImmediate(id);\n      scheduler.scheduled = undefined;\n    }\n    // Return undefined so the action knows to request a new async id if it's rescheduled.\n    return undefined;\n  }\n}\n","import { AsyncAction } from './AsyncAction';\nimport { AsyncScheduler } from './AsyncScheduler';\n\nexport class AsapScheduler extends AsyncScheduler {\n  public flush(action?: AsyncAction<any>): void {\n\n    this.active = true;\n    this.scheduled = undefined;\n\n    const {actions} = this;\n    let error: any;\n    let index: number = -1;\n    let count: number = actions.length;\n    action = action || actions.shift();\n\n    do {\n      if (error = action.execute(action.state, action.delay)) {\n        break;\n      }\n    } while (++index < count && (action = actions.shift()));\n\n    this.active = false;\n\n    if (error) {\n      while (++index < count && (action = actions.shift())) {\n        action.unsubscribe();\n      }\n      throw error;\n    }\n  }\n}\n","import { AsapAction } from './AsapAction';\nimport { AsapScheduler } from './AsapScheduler';\n\n/**\n *\n * Asap Scheduler\n *\n * <span class=\"informal\">Perform task as fast as it can be performed asynchronously</span>\n *\n * `asap` scheduler behaves the same as {@link asyncScheduler} scheduler when you use it to delay task\n * in time. If however you set delay to `0`, `asap` will wait for current synchronously executing\n * code to end and then it will try to execute given task as fast as possible.\n *\n * `asap` scheduler will do its best to minimize time between end of currently executing code\n * and start of scheduled task. This makes it best candidate for performing so called \"deferring\".\n * Traditionally this was achieved by calling `setTimeout(deferredTask, 0)`, but that technique involves\n * some (although minimal) unwanted delay.\n *\n * Note that using `asap` scheduler does not necessarily mean that your task will be first to process\n * after currently executing code. In particular, if some task was also scheduled with `asap` before,\n * that task will execute first. That being said, if you need to schedule task asynchronously, but\n * as soon as possible, `asap` scheduler is your best bet.\n *\n * ## Example\n * Compare async and asap scheduler<\n * ```ts\n * import { asapScheduler, asyncScheduler } from 'rxjs';\n *\n * asyncScheduler.schedule(() => console.log('async')); // scheduling 'async' first...\n * asapScheduler.schedule(() => console.log('asap'));\n *\n * // Logs:\n * // \"asap\"\n * // \"async\"\n * // ... but 'asap' goes first!\n * ```\n * @static true\n * @name asap\n * @owner Scheduler\n */\n\nexport const asap = new AsapScheduler(AsapAction);\n","import { AsyncAction } from './AsyncAction';\nimport { AsyncScheduler } from './AsyncScheduler';\n\n/**\n *\n * Async Scheduler\n *\n * <span class=\"informal\">Schedule task as if you used setTimeout(task, duration)</span>\n *\n * `async` scheduler schedules tasks asynchronously, by putting them on the JavaScript\n * event loop queue. It is best used to delay tasks in time or to schedule tasks repeating\n * in intervals.\n *\n * If you just want to \"defer\" task, that is to perform it right after currently\n * executing synchronous code ends (commonly achieved by `setTimeout(deferredTask, 0)`),\n * better choice will be the {@link asapScheduler} scheduler.\n *\n * ## Examples\n * Use async scheduler to delay task\n * ```ts\n * import { asyncScheduler } from 'rxjs';\n *\n * const task = () => console.log('it works!');\n *\n * asyncScheduler.schedule(task, 2000);\n *\n * // After 2 seconds logs:\n * // \"it works!\"\n * ```\n *\n * Use async scheduler to repeat task in intervals\n * ```ts\n * import { asyncScheduler } from 'rxjs';\n *\n * function task(state) {\n *   console.log(state);\n *   this.schedule(state + 1, 1000); // `this` references currently executing Action,\n *                                   // which we reschedule with new state and delay\n * }\n *\n * asyncScheduler.schedule(task, 3000, 0);\n *\n * // Logs:\n * // 0 after 3s\n * // 1 after 4s\n * // 2 after 5s\n * // 3 after 6s\n * ```\n *\n * @static true\n * @name async\n * @owner Scheduler\n */\n\nexport const async = new AsyncScheduler(AsyncAction);\n","import { AsyncAction } from './AsyncAction';\nimport { AnimationFrameScheduler } from './AnimationFrameScheduler';\nimport { SchedulerAction } from '../types';\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nexport class AnimationFrameAction<T> extends AsyncAction<T> {\n\n  constructor(protected scheduler: AnimationFrameScheduler,\n              protected work: (this: SchedulerAction<T>, state?: T) => void) {\n    super(scheduler, work);\n  }\n\n  protected requestAsyncId(scheduler: AnimationFrameScheduler, id?: any, delay: number = 0): any {\n    // If delay is greater than 0, request as an async action.\n    if (delay !== null && delay > 0) {\n      return super.requestAsyncId(scheduler, id, delay);\n    }\n    // Push the action to the end of the scheduler queue.\n    scheduler.actions.push(this);\n    // If an animation frame has already been requested, don't request another\n    // one. If an animation frame hasn't been requested yet, request one. Return\n    // the current animation frame request id.\n    return scheduler.scheduled || (scheduler.scheduled = requestAnimationFrame(\n      () => scheduler.flush(null)));\n  }\n  protected recycleAsyncId(scheduler: AnimationFrameScheduler, id?: any, delay: number = 0): any {\n    // If delay exists and is greater than 0, or if the delay is null (the\n    // action wasn't rescheduled) but was originally scheduled as an async\n    // action, then recycle as an async action.\n    if ((delay !== null && delay > 0) || (delay === null && this.delay > 0)) {\n      return super.recycleAsyncId(scheduler, id, delay);\n    }\n    // If the scheduler queue is empty, cancel the requested animation frame and\n    // set the scheduled flag to undefined so the next AnimationFrameAction will\n    // request its own.\n    if (scheduler.actions.length === 0) {\n      cancelAnimationFrame(id);\n      scheduler.scheduled = undefined;\n    }\n    // Return undefined so the action knows to request a new async id if it's rescheduled.\n    return undefined;\n  }\n}\n","import { AsyncAction } from './AsyncAction';\nimport { AsyncScheduler } from './AsyncScheduler';\n\nexport class AnimationFrameScheduler extends AsyncScheduler {\n  public flush(action?: AsyncAction<any>): void {\n\n    this.active = true;\n    this.scheduled = undefined;\n\n    const {actions} = this;\n    let error: any;\n    let index: number = -1;\n    let count: number = actions.length;\n    action = action || actions.shift();\n\n    do {\n      if (error = action.execute(action.state, action.delay)) {\n        break;\n      }\n    } while (++index < count && (action = actions.shift()));\n\n    this.active = false;\n\n    if (error) {\n      while (++index < count && (action = actions.shift())) {\n        action.unsubscribe();\n      }\n      throw error;\n    }\n  }\n}\n","import { AnimationFrameAction } from './AnimationFrameAction';\nimport { AnimationFrameScheduler } from './AnimationFrameScheduler';\n\n/**\n *\n * Animation Frame Scheduler\n *\n * <span class=\"informal\">Perform task when `window.requestAnimationFrame` would fire</span>\n *\n * When `animationFrame` scheduler is used with delay, it will fall back to {@link asyncScheduler} scheduler\n * behaviour.\n *\n * Without delay, `animationFrame` scheduler can be used to create smooth browser animations.\n * It makes sure scheduled task will happen just before next browser content repaint,\n * thus performing animations as efficiently as possible.\n *\n * ## Example\n * Schedule div height animation\n * ```ts\n * // html: <div style=\"background: #0ff;\"></div>\n * import { animationFrameScheduler } from 'rxjs';\n *\n * const div = document.querySelector('div');\n *\n * animationFrameScheduler.schedule(function(height) {\n *   div.style.height = height + \"px\";\n *\n *   this.schedule(height + 1);  // `this` references currently executing Action,\n *                               // which we reschedule with new state\n * }, 0, 0);\n *\n * // You will see a div element growing in height\n * ```\n *\n * @static true\n * @name animationFrame\n * @owner Scheduler\n */\n\nexport const animationFrame = new AnimationFrameScheduler(AnimationFrameAction);\n","import { AsyncAction } from './AsyncAction';\nimport { Subscription } from '../Subscription';\nimport { AsyncScheduler } from './AsyncScheduler';\nimport { SchedulerAction } from '../types';\n\nexport class VirtualTimeScheduler extends AsyncScheduler {\n\n  protected static frameTimeFactor: number = 10;\n\n  public frame: number = 0;\n  public index: number = -1;\n\n  constructor(SchedulerAction: typeof AsyncAction = VirtualAction as any,\n              public maxFrames: number = Number.POSITIVE_INFINITY) {\n    super(SchedulerAction, () => this.frame);\n  }\n\n  /**\n   * Prompt the Scheduler to execute all of its queued actions, therefore\n   * clearing its queue.\n   * @return {void}\n   */\n  public flush(): void {\n\n    const {actions, maxFrames} = this;\n    let error: any, action: AsyncAction<any>;\n\n    while ((action = actions[0]) && action.delay <= maxFrames) {\n      actions.shift();\n      this.frame = action.delay;\n\n      if (error = action.execute(action.state, action.delay)) {\n        break;\n      }\n    }\n\n    if (error) {\n      while (action = actions.shift()) {\n        action.unsubscribe();\n      }\n      throw error;\n    }\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @nodoc\n */\nexport class VirtualAction<T> extends AsyncAction<T> {\n\n  protected active: boolean = true;\n\n  constructor(protected scheduler: VirtualTimeScheduler,\n              protected work: (this: SchedulerAction<T>, state?: T) => void,\n              protected index: number = scheduler.index += 1) {\n    super(scheduler, work);\n    this.index = scheduler.index = index;\n  }\n\n  public schedule(state?: T, delay: number = 0): Subscription {\n    if (!this.id) {\n      return super.schedule(state, delay);\n    }\n    this.active = false;\n    // If an action is rescheduled, we save allocations by mutating its state,\n    // pushing it to the end of the scheduler queue, and recycling the action.\n    // But since the VirtualTimeScheduler is used for testing, VirtualActions\n    // must be immutable so they can be inspected later.\n    const action = new VirtualAction(this.scheduler, this.work);\n    this.add(action);\n    return action.schedule(state, delay);\n  }\n\n  protected requestAsyncId(scheduler: VirtualTimeScheduler, id?: any, delay: number = 0): any {\n    this.delay = scheduler.frame + delay;\n    const {actions} = scheduler;\n    actions.push(this);\n    (actions as Array<VirtualAction<T>>).sort(VirtualAction.sortActions);\n    return true;\n  }\n\n  protected recycleAsyncId(scheduler: VirtualTimeScheduler, id?: any, delay: number = 0): any {\n    return undefined;\n  }\n\n  protected _execute(state: T, delay: number): any {\n    if (this.active === true) {\n      return super._execute(state, delay);\n    }\n  }\n\n  public static sortActions<T>(a: VirtualAction<T>, b: VirtualAction<T>) {\n    if (a.delay === b.delay) {\n      if (a.index === b.index) {\n        return 0;\n      } else if (a.index > b.index) {\n        return 1;\n      } else {\n        return -1;\n      }\n    } else if (a.delay > b.delay) {\n      return 1;\n    } else {\n      return -1;\n    }\n  }\n}\n","export function identity<T>(x: T): T {\n  return x;\n}\n","import { Observable } from '../Observable';\nimport { ObservableInput } from '../types';\n\n/**\n * Tests to see if the object is an RxJS {@link Observable}\n * @param obj the object to test\n */\nexport function isObservable<T>(obj: any): obj is Observable<T> {\n  return !!obj && (obj instanceof Observable || (typeof obj.lift === 'function' && typeof obj.subscribe === 'function'));\n}\n","export interface ArgumentOutOfRangeError extends Error {\n}\n\nexport interface ArgumentOutOfRangeErrorCtor {\n  new(): ArgumentOutOfRangeError;\n}\n\nconst ArgumentOutOfRangeErrorImpl = (() => {\n  function ArgumentOutOfRangeErrorImpl(this: any) {\n    Error.call(this);\n    this.message = 'argument out of range';\n    this.name = 'ArgumentOutOfRangeError';\n    return this;\n  }\n\n  ArgumentOutOfRangeErrorImpl.prototype = Object.create(Error.prototype);\n\n  return ArgumentOutOfRangeErrorImpl;\n})();\n\n/**\n * An error thrown when an element was queried at a certain index of an\n * Observable, but no such index or position exists in that sequence.\n *\n * @see {@link elementAt}\n * @see {@link take}\n * @see {@link takeLast}\n *\n * @class ArgumentOutOfRangeError\n */\nexport const ArgumentOutOfRangeError: ArgumentOutOfRangeErrorCtor = ArgumentOutOfRangeErrorImpl as any;","export interface EmptyError extends Error {\n}\n\nexport interface EmptyErrorCtor {\n  new(): EmptyError;\n}\n\nconst EmptyErrorImpl = (() => {\n  function EmptyErrorImpl(this: any) {\n    Error.call(this);\n    this.message = 'no elements in sequence';\n    this.name = 'EmptyError';\n    return this;\n  }\n\n  EmptyErrorImpl.prototype = Object.create(Error.prototype);\n\n  return EmptyErrorImpl;\n})();\n\n/**\n * An error thrown when an Observable or a sequence was queried but has no\n * elements.\n *\n * @see {@link first}\n * @see {@link last}\n * @see {@link single}\n *\n * @class EmptyError\n */\nexport const EmptyError: EmptyErrorCtor = EmptyErrorImpl as any;","export interface TimeoutError extends Error {\n}\n\nexport interface TimeoutErrorCtor {\n  new(): TimeoutError;\n}\n\nconst TimeoutErrorImpl = (() => {\n  function TimeoutErrorImpl(this: any) {\n    Error.call(this);\n    this.message = 'Timeout has occurred';\n    this.name = 'TimeoutError';\n    return this;\n  }\n\n  TimeoutErrorImpl.prototype = Object.create(Error.prototype);\n\n  return TimeoutErrorImpl;\n})();\n\n/**\n * An error thrown when duetime elapses.\n *\n * @see {@link operators/timeout}\n *\n * @class TimeoutError\n */\nexport const TimeoutError: TimeoutErrorCtor = TimeoutErrorImpl as any;\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { OperatorFunction } from '../types';\n\n/**\n * Applies a given `project` function to each value emitted by the source\n * Observable, and emits the resulting values as an Observable.\n *\n * <span class=\"informal\">Like [Array.prototype.map()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map),\n * it passes each source value through a transformation function to get\n * corresponding output values.</span>\n *\n * ![](map.png)\n *\n * Similar to the well known `Array.prototype.map` function, this operator\n * applies a projection to each value and emits that projection in the output\n * Observable.\n *\n * ## Example\n * Map every click to the clientX position of that click\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { map } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const positions = clicks.pipe(map(ev => ev.clientX));\n * positions.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link mapTo}\n * @see {@link pluck}\n *\n * @param {function(value: T, index: number): R} project The function to apply\n * to each `value` emitted by the source Observable. The `index` parameter is\n * the number `i` for the i-th emission that has happened since the\n * subscription, starting from the number `0`.\n * @param {any} [thisArg] An optional argument to define what `this` is in the\n * `project` function.\n * @return {Observable<R>} An Observable that emits the values from the source\n * Observable transformed by the given `project` function.\n * @method map\n * @owner Observable\n */\nexport function map<T, R>(project: (value: T, index: number) => R, thisArg?: any): OperatorFunction<T, R> {\n  return function mapOperation(source: Observable<T>): Observable<R> {\n    if (typeof project !== 'function') {\n      throw new TypeError('argument is not a function. Are you looking for `mapTo()`?');\n    }\n    return source.lift(new MapOperator(project, thisArg));\n  };\n}\n\nexport class MapOperator<T, R> implements Operator<T, R> {\n  constructor(private project: (value: T, index: number) => R, private thisArg: any) {\n  }\n\n  call(subscriber: Subscriber<R>, source: any): any {\n    return source.subscribe(new MapSubscriber(subscriber, this.project, this.thisArg));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass MapSubscriber<T, R> extends Subscriber<T> {\n  count: number = 0;\n  private thisArg: any;\n\n  constructor(destination: Subscriber<R>,\n              private project: (value: T, index: number) => R,\n              thisArg: any) {\n    super(destination);\n    this.thisArg = thisArg || this;\n  }\n\n  // NOTE: This looks unoptimized, but it's actually purposefully NOT\n  // using try/catch optimizations.\n  protected _next(value: T) {\n    let result: any;\n    try {\n      result = this.project.call(this.thisArg, value, this.count++);\n    } catch (err) {\n      this.destination.error(err);\n      return;\n    }\n    this.destination.next(result);\n  }\n}\n","import { SchedulerLike, SchedulerAction } from '../types';\nimport { Observable } from '../Observable';\nimport { AsyncSubject } from '../AsyncSubject';\nimport { Subscriber } from '../Subscriber';\nimport { map } from '../operators/map';\nimport { canReportError } from '../util/canReportError';\nimport { isArray } from '../util/isArray';\nimport { isScheduler } from '../util/isScheduler';\n\n// tslint:disable:max-line-length\n/** @deprecated resultSelector is no longer supported, use a mapping function. */\nexport function bindCallback(callbackFunc: Function, resultSelector: Function, scheduler?: SchedulerLike): (...args: any[]) => Observable<any>;\n\nexport function bindCallback<R1, R2, R3, R4>(callbackFunc: (callback: (res1: R1, res2: R2, res3: R3, res4: R4, ...args: any[]) => any) => any, scheduler?: SchedulerLike): () => Observable<any[]>;\nexport function bindCallback<R1, R2, R3>(callbackFunc: (callback: (res1: R1, res2: R2, res3: R3) => any) => any, scheduler?: SchedulerLike): () => Observable<[R1, R2, R3]>;\nexport function bindCallback<R1, R2>(callbackFunc: (callback: (res1: R1, res2: R2) => any) => any, scheduler?: SchedulerLike): () => Observable<[R1, R2]>;\nexport function bindCallback<R1>(callbackFunc: (callback: (res1: R1) => any) => any, scheduler?: SchedulerLike): () => Observable<R1>;\nexport function bindCallback(callbackFunc: (callback: () => any) => any, scheduler?: SchedulerLike): () => Observable<void>;\n\nexport function bindCallback<A1, R1, R2, R3, R4>(callbackFunc: (arg1: A1, callback: (res1: R1, res2: R2, res3: R3, res4: R4, ...args: any[]) => any) => any, scheduler?: SchedulerLike): (arg1: A1) => Observable<any[]>;\nexport function bindCallback<A1, R1, R2, R3>(callbackFunc: (arg1: A1, callback: (res1: R1, res2: R2, res3: R3) => any) => any, scheduler?: SchedulerLike): (arg1: A1) => Observable<[R1, R2, R3]>;\nexport function bindCallback<A1, R1, R2>(callbackFunc: (arg1: A1, callback: (res1: R1, res2: R2) => any) => any, scheduler?: SchedulerLike): (arg1: A1) => Observable<[R1, R2]>;\nexport function bindCallback<A1, R1>(callbackFunc: (arg1: A1, callback: (res1: R1) => any) => any, scheduler?: SchedulerLike): (arg1: A1) => Observable<R1>;\nexport function bindCallback<A1>(callbackFunc: (arg1: A1, callback: () => any) => any, scheduler?: SchedulerLike): (arg1: A1) => Observable<void>;\n\nexport function bindCallback<A1, A2, R1, R2, R3, R4>(callbackFunc: (arg1: A1, arg2: A2, callback: (res1: R1, res2: R2, res3: R3, res4: R4, ...args: any[]) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2) => Observable<any[]>;\nexport function bindCallback<A1, A2, R1, R2, R3>(callbackFunc: (arg1: A1, arg2: A2, callback: (res1: R1, res2: R2, res3: R3) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2) => Observable<[R1, R2, R3]>;\nexport function bindCallback<A1, A2, R1, R2>(callbackFunc: (arg1: A1, arg2: A2, callback: (res1: R1, res2: R2) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2) => Observable<[R1, R2]>;\nexport function bindCallback<A1, A2, R1>(callbackFunc: (arg1: A1, arg2: A2, callback: (res1: R1) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2) => Observable<R1>;\nexport function bindCallback<A1, A2>(callbackFunc: (arg1: A1, arg2: A2, callback: () => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2) => Observable<void>;\n\nexport function bindCallback<A1, A2, A3, R1, R2, R3, R4>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, callback: (res1: R1, res2: R2, res3: R3, res4: R4, ...args: any[]) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3) => Observable<any[]>;\nexport function bindCallback<A1, A2, A3, R1, R2, R3>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, callback: (res1: R1, res2: R2, res3: R3) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3) => Observable<[R1, R2, R3]>;\nexport function bindCallback<A1, A2, A3, R1, R2>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, callback: (res1: R1, res2: R2) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3) => Observable<[R1, R2]>;\nexport function bindCallback<A1, A2, A3, R1>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, callback: (res1: R1) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3) => Observable<R1>;\nexport function bindCallback<A1, A2, A3>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, callback: () => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3) => Observable<void>;\n\nexport function bindCallback<A1, A2, A3, A4, R1, R2, R3, R4>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, arg4: A4, callback: (res1: R1, res2: R2, res3: R3, res4: R4, ...args: any[]) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3, arg4: A4) => Observable<any[]>;\nexport function bindCallback<A1, A2, A3, A4, R1, R2, R3>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, arg4: A4, callback: (res1: R1, res2: R2, res3: R3) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3, arg4: A4) => Observable<[R1, R2, R3]>;\nexport function bindCallback<A1, A2, A3, A4, R1, R2>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, arg4: A4, callback: (res1: R1, res2: R2) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3, arg4: A4) => Observable<[R1, R2]>;\nexport function bindCallback<A1, A2, A3, A4, R1>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, arg4: A4, callback: (res1: R1) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3, arg4: A4) => Observable<R1>;\nexport function bindCallback<A1, A2, A3, A4>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, arg4: A4, callback: () => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3, arg4: A4) => Observable<void>;\n\nexport function bindCallback<A1, A2, A3, A4, A5, R1, R2, R3, R4>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, arg4: A4, arg5: A5, callback: (res1: R1, res2: R2, res3: R3, res4: R4, ...args: any[]) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3, arg4: A4, arg5: A5) => Observable<any[]>;\nexport function bindCallback<A1, A2, A3, A4, A5, R1, R2, R3>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, arg4: A4, arg5: A5, callback: (res1: R1, res2: R2, res3: R3) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3, arg4: A4, arg5: A5) => Observable<[R1, R2, R3]>;\nexport function bindCallback<A1, A2, A3, A4, A5, R1, R2>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, arg4: A4, arg5: A5, callback: (res1: R1, res2: R2) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3, arg4: A4, arg5: A5) => Observable<[R1, R2]>;\nexport function bindCallback<A1, A2, A3, A4, A5, R1>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, arg4: A4, arg5: A5, callback: (res1: R1) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3, arg4: A4, arg5: A5) => Observable<R1>;\nexport function bindCallback<A1, A2, A3, A4, A5>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, arg4: A4, arg5: A5, callback: () => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3, arg4: A4, arg5: A5) => Observable<void>;\n\nexport function bindCallback<A, R>(callbackFunc: (...args: Array<A | ((result: R) => any)>) => any, scheduler?: SchedulerLike): (...args: A[]) => Observable<R>;\nexport function bindCallback<A, R>(callbackFunc: (...args: Array<A | ((...results: R[]) => any)>) => any, scheduler?: SchedulerLike): (...args: A[]) => Observable<R[]>;\n\nexport function bindCallback(callbackFunc: Function, scheduler?: SchedulerLike): (...args: any[]) => Observable<any>;\n\n// tslint:enable:max-line-length\n\n/**\n * Converts a callback API to a function that returns an Observable.\n *\n * <span class=\"informal\">Give it a function `f` of type `f(x, callback)` and\n * it will return a function `g` that when called as `g(x)` will output an\n * Observable.</span>\n *\n * `bindCallback` is not an operator because its input and output are not\n * Observables. The input is a function `func` with some parameters. The\n * last parameter must be a callback function that `func` calls when it is\n * done.\n *\n * The output of `bindCallback` is a function that takes the same parameters\n * as `func`, except the last one (the callback). When the output function\n * is called with arguments it will return an Observable. If function `func`\n * calls its callback with one argument, the Observable will emit that value.\n * If on the other hand the callback is called with multiple values the resulting\n * Observable will emit an array with said values as arguments.\n *\n * It is **very important** to remember that input function `func` is not called\n * when the output function is, but rather when the Observable returned by the output\n * function is subscribed. This means if `func` makes an AJAX request, that request\n * will be made every time someone subscribes to the resulting Observable, but not before.\n *\n * The last optional parameter - `scheduler` - can be used to control when the call\n * to `func` happens after someone subscribes to Observable, as well as when results\n * passed to callback will be emitted. By default, the subscription to an Observable calls `func`\n * synchronously, but using {@link asyncScheduler} as the last parameter will defer the call to `func`,\n * just like wrapping the call in `setTimeout` with a timeout of `0` would. If you were to use the async Scheduler\n * and call `subscribe` on the output Observable, all function calls that are currently executing\n * will end before `func` is invoked.\n *\n * By default, results passed to the callback are emitted immediately after `func` invokes the callback.\n * In particular, if the callback is called synchronously, then the subscription of the resulting Observable\n * will call the `next` function synchronously as well.  If you want to defer that call,\n * you may use {@link asyncScheduler} just as before.  This means that by using `Scheduler.async` you can\n * ensure that `func` always calls its callback asynchronously, thus avoiding terrifying Zalgo.\n *\n * Note that the Observable created by the output function will always emit a single value\n * and then complete immediately. If `func` calls the callback multiple times, values from subsequent\n * calls will not appear in the stream. If you need to listen for multiple calls,\n *  you probably want to use {@link fromEvent} or {@link fromEventPattern} instead.\n *\n * If `func` depends on some context (`this` property) and is not already bound, the context of `func`\n * will be the context that the output function has at call time. In particular, if `func`\n * is called as a method of some objec and if `func` is not already bound, in order to preserve the context\n * it is recommended that the context of the output function is set to that object as well.\n *\n * If the input function calls its callback in the \"node style\" (i.e. first argument to callback is\n * optional error parameter signaling whether the call failed or not), {@link bindNodeCallback}\n * provides convenient error handling and probably is a better choice.\n * `bindCallback` will treat such functions the same as any other and error parameters\n * (whether passed or not) will always be interpreted as regular callback argument.\n *\n * ## Examples\n *\n * ### Convert jQuery's getJSON to an Observable API\n * ```ts\n * import { bindCallback } from 'rxjs';\n * import * as jQuery from 'jquery';\n *\n * // Suppose we have jQuery.getJSON('/my/url', callback)\n * const getJSONAsObservable = bindCallback(jQuery.getJSON);\n * const result = getJSONAsObservable('/my/url');\n * result.subscribe(x => console.log(x), e => console.error(e));\n * ```\n *\n * ### Receive an array of arguments passed to a callback\n * ```ts\n * import { bindCallback } from 'rxjs';\n *\n * const someFunction = (a, b, c) => {\n *   console.log(a); // 5\n *   console.log(b); // 'some string'\n *   console.log(c); // {someProperty: 'someValue'}\n * };\n *\n * const boundSomeFunction = bindCallback(someFunction);\n * boundSomeFunction().subscribe(values => {\n *   console.log(values) // [5, 'some string', {someProperty: 'someValue'}]\n * });\n * ```\n *\n * ### Compare behaviour with and without async Scheduler\n * ```ts\n * import { bindCallback } from 'rxjs';\n *\n * function iCallMyCallbackSynchronously(cb) {\n *   cb();\n * }\n *\n * const boundSyncFn = bindCallback(iCallMyCallbackSynchronously);\n * const boundAsyncFn = bindCallback(iCallMyCallbackSynchronously, null, Rx.Scheduler.async);\n *\n * boundSyncFn().subscribe(() => console.log('I was sync!'));\n * boundAsyncFn().subscribe(() => console.log('I was async!'));\n * console.log('This happened...');\n *\n * // Logs:\n * // I was sync!\n * // This happened...\n * // I was async!\n * ```\n *\n * ### Use bindCallback on an object method\n * ```ts\n * import { bindCallback } from 'rxjs';\n *\n * const boundMethod = bindCallback(someObject.methodWithCallback);\n * boundMethod.call(someObject) // make sure methodWithCallback has access to someObject\n * .subscribe(subscriber);\n * ```\n *\n * @see {@link bindNodeCallback}\n * @see {@link from}\n *\n * @param {function} func A function with a callback as the last parameter.\n * @param {SchedulerLike} [scheduler] The scheduler on which to schedule the\n * callbacks.\n * @return {function(...params: *): Observable} A function which returns the\n * Observable that delivers the same values the callback would deliver.\n * @name bindCallback\n */\nexport function bindCallback<T>(\n  callbackFunc: Function,\n  resultSelector?: Function|SchedulerLike,\n  scheduler?: SchedulerLike\n): (...args: any[]) => Observable<T> {\n  if (resultSelector) {\n    if (isScheduler(resultSelector)) {\n      scheduler = resultSelector;\n    } else {\n      // DEPRECATED PATH\n      return (...args: any[]) => bindCallback(callbackFunc, scheduler)(...args).pipe(\n        map((args) => isArray(args) ? resultSelector(...args) : resultSelector(args)),\n      );\n    }\n  }\n\n  return function (this: any, ...args: any[]): Observable<T> {\n    const context = this;\n    let subject: AsyncSubject<T>;\n    const params = {\n      context,\n      subject,\n      callbackFunc,\n      scheduler,\n    };\n    return new Observable<T>(subscriber => {\n      if (!scheduler) {\n        if (!subject) {\n          subject = new AsyncSubject<T>();\n          const handler = (...innerArgs: any[]) => {\n            subject.next(innerArgs.length <= 1 ? innerArgs[0] : innerArgs);\n            subject.complete();\n          };\n\n          try {\n            callbackFunc.apply(context, [...args, handler]);\n          } catch (err) {\n            if (canReportError(subject)) {\n              subject.error(err);\n            } else {\n              console.warn(err);\n            }\n          }\n        }\n        return subject.subscribe(subscriber);\n      } else {\n        const state: DispatchState<T> = {\n          args, subscriber, params,\n        };\n        return scheduler.schedule<DispatchState<T>>(dispatch, 0, state);\n      }\n    });\n  };\n}\n\ninterface DispatchState<T> {\n  args: any[];\n  subscriber: Subscriber<T>;\n  params: ParamsContext<T>;\n}\n\ninterface ParamsContext<T> {\n  callbackFunc: Function;\n  scheduler: SchedulerLike;\n  context: any;\n  subject: AsyncSubject<T>;\n}\n\nfunction dispatch<T>(this: SchedulerAction<DispatchState<T>>, state: DispatchState<T>) {\n  const self = this;\n  const { args, subscriber, params } = state;\n  const { callbackFunc, context, scheduler } = params;\n  let { subject } = params;\n  if (!subject) {\n    subject = params.subject = new AsyncSubject<T>();\n\n    const handler = (...innerArgs: any[]) => {\n      const value = innerArgs.length <= 1 ? innerArgs[0] : innerArgs;\n      this.add(scheduler.schedule<NextState<T>>(dispatchNext, 0, { value, subject }));\n    };\n\n    try {\n      callbackFunc.apply(context, [...args, handler]);\n    } catch (err) {\n      subject.error(err);\n    }\n  }\n\n  this.add(subject.subscribe(subscriber));\n}\n\ninterface NextState<T> {\n  subject: AsyncSubject<T>;\n  value: T;\n}\n\nfunction dispatchNext<T>(this: SchedulerAction<NextState<T>>, state: NextState<T>) {\n  const { value, subject } = state;\n  subject.next(value);\n  subject.complete();\n}\n\ninterface ErrorState<T> {\n  subject: AsyncSubject<T>;\n  err: any;\n}\n\nfunction dispatchError<T>(this: SchedulerAction<ErrorState<T>>, state: ErrorState<T>) {\n  const { err, subject } = state;\n  subject.error(err);\n}\n","import { Observable } from '../Observable';\nimport { AsyncSubject } from '../AsyncSubject';\nimport { Subscriber } from '../Subscriber';\nimport { SchedulerAction, SchedulerLike } from '../types';\nimport { map } from '../operators/map';\nimport { canReportError } from '../util/canReportError';\nimport { isScheduler } from '../util/isScheduler';\nimport { isArray } from '../util/isArray';\n\n/* tslint:disable:max-line-length */\n/** @deprecated resultSelector is deprecated, pipe to map instead */\nexport function bindNodeCallback(callbackFunc: Function, resultSelector: Function, scheduler?: SchedulerLike): (...args: any[]) => Observable<any>;\n\nexport function bindNodeCallback<R1, R2, R3, R4>(callbackFunc: (callback: (err: any, res1: R1, res2: R2, res3: R3, res4: R4, ...args: any[]) => any) => any, scheduler?: SchedulerLike): (...args: any[]) => Observable<any[]>;\nexport function bindNodeCallback<R1, R2, R3>(callbackFunc: (callback: (err: any, res1: R1, res2: R2, res3: R3) => any) => any, scheduler?: SchedulerLike): () => Observable<[R1, R2, R3]>;\nexport function bindNodeCallback<R1, R2>(callbackFunc: (callback: (err: any, res1: R1, res2: R2) => any) => any, scheduler?: SchedulerLike): () => Observable<[R1, R2]>;\nexport function bindNodeCallback<R1>(callbackFunc: (callback: (err: any, res1: R1) => any) => any, scheduler?: SchedulerLike): () => Observable<R1>;\nexport function bindNodeCallback(callbackFunc: (callback: (err: any) => any) => any, scheduler?: SchedulerLike): () => Observable<void>;\n\nexport function bindNodeCallback<A1, R1, R2, R3, R4>(callbackFunc: (arg1: A1, callback: (err: any, res1: R1, res2: R2, res3: R3, res4: R4, ...args: any[]) => any) => any, scheduler?: SchedulerLike): (...args: any[]) => Observable<any[]>;\nexport function bindNodeCallback<A1, R1, R2, R3>(callbackFunc: (arg1: A1, callback: (err: any, res1: R1, res2: R2, res3: R3) => any) => any, scheduler?: SchedulerLike): (arg1: A1) => Observable<[R1, R2, R3]>;\nexport function bindNodeCallback<A1, R1, R2>(callbackFunc: (arg1: A1, callback: (err: any, res1: R1, res2: R2) => any) => any, scheduler?: SchedulerLike): (arg1: A1) => Observable<[R1, R2]>;\nexport function bindNodeCallback<A1, R1>(callbackFunc: (arg1: A1, callback: (err: any, res1: R1) => any) => any, scheduler?: SchedulerLike): (arg1: A1) => Observable<R1>;\nexport function bindNodeCallback<A1>(callbackFunc: (arg1: A1, callback: (err: any) => any) => any, scheduler?: SchedulerLike): (arg1: A1) => Observable<void>;\n\nexport function bindNodeCallback<A1, A2, R1, R2, R3, R4>(callbackFunc: (arg1: A1, arg2: A2, callback: (err: any, res1: R1, res2: R2, res3: R3, res4: R4, ...args: any[]) => any) => any, scheduler?: SchedulerLike): (...args: any[]) => Observable<any[]>;\nexport function bindNodeCallback<A1, A2, R1, R2, R3>(callbackFunc: (arg1: A1, arg2: A2, callback: (err: any, res1: R1, res2: R2, res3: R3) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2) => Observable<[R1, R2, R3]>;\nexport function bindNodeCallback<A1, A2, R1, R2>(callbackFunc: (arg1: A1, arg2: A2, callback: (err: any, res1: R1, res2: R2) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2) => Observable<[R1, R2]>;\nexport function bindNodeCallback<A1, A2, R1>(callbackFunc: (arg1: A1, arg2: A2, callback: (err: any, res1: R1) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2) => Observable<R1>;\nexport function bindNodeCallback<A1, A2>(callbackFunc: (arg1: A1, arg2: A2, callback: (err: any) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2) => Observable<void>;\n\nexport function bindNodeCallback<A1, A2, A3, R1, R2, R3, R4>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, callback: (err: any, res1: R1, res2: R2, res3: R3, res4: R4, ...args: any[]) => any) => any, scheduler?: SchedulerLike): (...args: any[]) => Observable<any[]>;\nexport function bindNodeCallback<A1, A2, A3, R1, R2, R3>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, callback: (err: any, res1: R1, res2: R2, res3: R3) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3) => Observable<[R1, R2, R3]>;\nexport function bindNodeCallback<A1, A2, A3, R1, R2>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, callback: (err: any, res1: R1, res2: R2) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3) => Observable<[R1, R2]>;\nexport function bindNodeCallback<A1, A2, A3, R1>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, callback: (err: any, res1: R1) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3) => Observable<R1>;\nexport function bindNodeCallback<A1, A2, A3>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, callback: (err: any) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3) => Observable<void>;\n\nexport function bindNodeCallback<A1, A2, A3, A4, R1, R2, R3, R4>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, arg4: A4, callback: (err: any, res1: R1, res2: R2, res3: R3, res4: R4, ...args: any[]) => any) => any, scheduler?: SchedulerLike): (...args: any[]) => Observable<any[]>;\nexport function bindNodeCallback<A1, A2, A3, A4, R1, R2, R3>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, arg4: A4, callback: (err: any, res1: R1, res2: R2, res3: R3) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3, arg4: A4) => Observable<[R1, R2, R3]>;\nexport function bindNodeCallback<A1, A2, A3, A4, R1, R2>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, arg4: A4, callback: (err: any, res1: R1, res2: R2) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3, arg4: A4) => Observable<[R1, R2]>;\nexport function bindNodeCallback<A1, A2, A3, A4, R1>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, arg4: A4, callback: (err: any, res1: R1) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3, arg4: A4) => Observable<R1>;\nexport function bindNodeCallback<A1, A2, A3, A4>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, arg4: A4, callback: (err: any) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3, arg4: A4) => Observable<void>;\n\nexport function bindNodeCallback<A1, A2, A3, A4, A5, R1, R2, R3, R4>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, arg4: A4, arg5: A5, callback: (err: any, res1: R1, res2: R2, res3: R3, res4: R4, ...args: any[]) => any) => any, scheduler?: SchedulerLike): (...args: any[]) => Observable<any[]>;\nexport function bindNodeCallback<A1, A2, A3, A4, A5, R1, R2, R3>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, arg4: A4, arg5: A5, callback: (err: any, res1: R1, res2: R2, res3: R3) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3, arg4: A4, arg5: A5) => Observable<[R1, R2, R3]>;\nexport function bindNodeCallback<A1, A2, A3, A4, A5, R1, R2>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, arg4: A4, arg5: A5, callback: (err: any, res1: R1, res2: R2) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3, arg4: A4, arg5: A5) => Observable<[R1, R2]>;\nexport function bindNodeCallback<A1, A2, A3, A4, A5, R1>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, arg4: A4, arg5: A5, callback: (err: any, res1: R1) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3, arg4: A4, arg5: A5) => Observable<R1>;\nexport function bindNodeCallback<A1, A2, A3, A4, A5>(callbackFunc: (arg1: A1, arg2: A2, arg3: A3, arg4: A4, arg5: A5, callback: (err: any) => any) => any, scheduler?: SchedulerLike): (arg1: A1, arg2: A2, arg3: A3, arg4: A4, arg5: A5) => Observable<void>; /* tslint:enable:max-line-length */\n\nexport function bindNodeCallback(callbackFunc: Function, scheduler?: SchedulerLike): (...args: any[]) => Observable<any[]>;\n/**\n * Converts a Node.js-style callback API to a function that returns an\n * Observable.\n *\n * <span class=\"informal\">It's just like {@link bindCallback}, but the\n * callback is expected to be of type `callback(error, result)`.</span>\n *\n * `bindNodeCallback` is not an operator because its input and output are not\n * Observables. The input is a function `func` with some parameters, but the\n * last parameter must be a callback function that `func` calls when it is\n * done. The callback function is expected to follow Node.js conventions,\n * where the first argument to the callback is an error object, signaling\n * whether call was successful. If that object is passed to callback, it means\n * something went wrong.\n *\n * The output of `bindNodeCallback` is a function that takes the same\n * parameters as `func`, except the last one (the callback). When the output\n * function is called with arguments, it will return an Observable.\n * If `func` calls its callback with error parameter present, Observable will\n * error with that value as well. If error parameter is not passed, Observable will emit\n * second parameter. If there are more parameters (third and so on),\n * Observable will emit an array with all arguments, except first error argument.\n *\n * Note that `func` will not be called at the same time output function is,\n * but rather whenever resulting Observable is subscribed. By default call to\n * `func` will happen synchronously after subscription, but that can be changed\n * with proper `scheduler` provided as optional third parameter. {@link SchedulerLike}\n * can also control when values from callback will be emitted by Observable.\n * To find out more, check out documentation for {@link bindCallback}, where\n * {@link SchedulerLike} works exactly the same.\n *\n * As in {@link bindCallback}, context (`this` property) of input function will be set to context\n * of returned function, when it is called.\n *\n * After Observable emits value, it will complete immediately. This means\n * even if `func` calls callback again, values from second and consecutive\n * calls will never appear on the stream. If you need to handle functions\n * that call callbacks multiple times, check out {@link fromEvent} or\n * {@link fromEventPattern} instead.\n *\n * Note that `bindNodeCallback` can be used in non-Node.js environments as well.\n * \"Node.js-style\" callbacks are just a convention, so if you write for\n * browsers or any other environment and API you use implements that callback style,\n * `bindNodeCallback` can be safely used on that API functions as well.\n *\n * Remember that Error object passed to callback does not have to be an instance\n * of JavaScript built-in `Error` object. In fact, it does not even have to an object.\n * Error parameter of callback function is interpreted as \"present\", when value\n * of that parameter is truthy. It could be, for example, non-zero number, non-empty\n * string or boolean `true`. In all of these cases resulting Observable would error\n * with that value. This means usually regular style callbacks will fail very often when\n * `bindNodeCallback` is used. If your Observable errors much more often then you\n * would expect, check if callback really is called in Node.js-style and, if not,\n * switch to {@link bindCallback} instead.\n *\n * Note that even if error parameter is technically present in callback, but its value\n * is falsy, it still won't appear in array emitted by Observable.\n *\n * ## Examples\n * ###  Read a file from the filesystem and get the data as an Observable\n * ```ts\n * import * as fs from 'fs';\n * const readFileAsObservable = bindNodeCallback(fs.readFile);\n * const result = readFileAsObservable('./roadNames.txt', 'utf8');\n * result.subscribe(x => console.log(x), e => console.error(e));\n * ```\n *\n * ### Use on function calling callback with multiple arguments\n * ```ts\n * someFunction((err, a, b) => {\n *   console.log(err); // null\n *   console.log(a); // 5\n *   console.log(b); // \"some string\"\n * });\n * const boundSomeFunction = bindNodeCallback(someFunction);\n * boundSomeFunction()\n * .subscribe(value => {\n *   console.log(value); // [5, \"some string\"]\n * });\n * ```\n *\n * ### Use on function calling callback in regular style\n * ```ts\n * someFunction(a => {\n *   console.log(a); // 5\n * });\n * const boundSomeFunction = bindNodeCallback(someFunction);\n * boundSomeFunction()\n * .subscribe(\n *   value => {}             // never gets called\n *   err => console.log(err) // 5\n * );\n * ```\n *\n * @see {@link bindCallback}\n * @see {@link from}\n *\n * @param {function} func Function with a Node.js-style callback as the last parameter.\n * @param {SchedulerLike} [scheduler] The scheduler on which to schedule the\n * callbacks.\n * @return {function(...params: *): Observable} A function which returns the\n * Observable that delivers the same values the Node.js callback would\n * deliver.\n * @name bindNodeCallback\n */\nexport function bindNodeCallback<T>(\n  callbackFunc: Function,\n  resultSelector: Function|SchedulerLike,\n  scheduler?: SchedulerLike\n): (...args: any[]) => Observable<T> {\n\n  if (resultSelector) {\n    if (isScheduler(resultSelector)) {\n      scheduler = resultSelector;\n    } else {\n      // DEPRECATED PATH\n      return (...args: any[]) => bindNodeCallback(callbackFunc, scheduler)(...args).pipe(\n        map(args => isArray(args) ? resultSelector(...args) : resultSelector(args))\n      );\n    }\n  }\n\n  return function(this: any, ...args: any[]): Observable<T> {\n    const params: ParamsState<T> = {\n      subject: undefined,\n      args,\n      callbackFunc,\n      scheduler,\n      context: this,\n    };\n    return new Observable<T>(subscriber => {\n      const { context } = params;\n      let { subject } = params;\n      if (!scheduler) {\n        if (!subject) {\n          subject = params.subject = new AsyncSubject<T>();\n          const handler = (...innerArgs: any[]) => {\n            const err = innerArgs.shift();\n\n            if (err) {\n              subject.error(err);\n              return;\n            }\n\n            subject.next(innerArgs.length <= 1 ? innerArgs[0] : innerArgs);\n            subject.complete();\n          };\n\n          try {\n            callbackFunc.apply(context, [...args, handler]);\n          } catch (err) {\n            if (canReportError(subject)) {\n              subject.error(err);\n            } else {\n              console.warn(err);\n            }\n          }\n        }\n        return subject.subscribe(subscriber);\n      } else {\n        return scheduler.schedule<DispatchState<T>>(dispatch, 0, { params, subscriber, context });\n      }\n    });\n  };\n}\n\ninterface DispatchState<T> {\n  subscriber: Subscriber<T>;\n  context: any;\n  params: ParamsState<T>;\n}\n\ninterface ParamsState<T> {\n  callbackFunc: Function;\n  args: any[];\n  scheduler: SchedulerLike;\n  subject: AsyncSubject<T>;\n  context: any;\n}\n\nfunction dispatch<T>(this: SchedulerAction<DispatchState<T>>, state: DispatchState<T>) {\n  const { params, subscriber, context } = state;\n  const { callbackFunc, args, scheduler } = params;\n  let subject = params.subject;\n\n  if (!subject) {\n    subject = params.subject = new AsyncSubject<T>();\n\n    const handler = (...innerArgs: any[]) => {\n      const err = innerArgs.shift();\n      if (err) {\n        this.add(scheduler.schedule<DispatchErrorArg<T>>(dispatchError, 0, { err, subject }));\n      } else {\n        const value = innerArgs.length <= 1 ? innerArgs[0] : innerArgs;\n        this.add(scheduler.schedule<DispatchNextArg<T>>(dispatchNext, 0, { value, subject }));\n      }\n    };\n\n    try {\n      callbackFunc.apply(context, [...args, handler]);\n    } catch (err) {\n      this.add(scheduler.schedule<DispatchErrorArg<T>>(dispatchError, 0, { err, subject }));\n    }\n  }\n\n  this.add(subject.subscribe(subscriber));\n}\n\ninterface DispatchNextArg<T> {\n  subject: AsyncSubject<T>;\n  value: T;\n}\n\nfunction dispatchNext<T>(arg: DispatchNextArg<T>) {\n  const { value, subject } = arg;\n  subject.next(value);\n  subject.complete();\n}\n\ninterface DispatchErrorArg<T> {\n  subject: AsyncSubject<T>;\n  err: any;\n}\n\nfunction dispatchError<T>(arg: DispatchErrorArg<T>) {\n  const { err, subject } = arg;\n  subject.error(err);\n}\n","import { Subscriber } from './Subscriber';\nimport { InnerSubscriber } from './InnerSubscriber';\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nexport class OuterSubscriber<T, R> extends Subscriber<T> {\n  notifyNext(outerValue: T, innerValue: R,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, R>): void {\n    this.destination.next(innerValue);\n  }\n\n  notifyError(error: any, innerSub: InnerSubscriber<T, R>): void {\n    this.destination.error(error);\n  }\n\n  notifyComplete(innerSub: InnerSubscriber<T, R>): void {\n    this.destination.complete();\n  }\n}\n","import { Subscriber } from './Subscriber';\nimport { OuterSubscriber } from './OuterSubscriber';\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nexport class InnerSubscriber<T, R> extends Subscriber<R> {\n  private index = 0;\n\n  constructor(private parent: OuterSubscriber<T, R>, public outerValue: T, public outerIndex: number) {\n    super();\n  }\n\n  protected _next(value: R): void {\n    this.parent.notifyNext(this.outerValue, value, this.outerIndex, this.index++, this);\n  }\n\n  protected _error(error: any): void {\n    this.parent.notifyError(error, this);\n    this.unsubscribe();\n  }\n\n  protected _complete(): void {\n    this.parent.notifyComplete(this);\n    this.unsubscribe();\n  }\n}\n","import { Subscriber } from '../Subscriber';\nimport { hostReportError } from './hostReportError';\n\nexport const subscribeToPromise = <T>(promise: PromiseLike<T>) => (subscriber: Subscriber<T>) => {\n  promise.then(\n    (value) => {\n      if (!subscriber.closed) {\n        subscriber.next(value);\n        subscriber.complete();\n      }\n    },\n    (err: any) => subscriber.error(err)\n  )\n  .then(null, hostReportError);\n  return subscriber;\n};\n","export function getSymbolIterator(): symbol {\n  if (typeof Symbol !== 'function' || !Symbol.iterator) {\n    return '@@iterator' as any;\n  }\n\n  return Symbol.iterator;\n}\n\nexport const iterator = getSymbolIterator();\n\n/**\n * @deprecated use {@link iterator} instead\n */\nexport const $$iterator = iterator;\n","import { Subscriber } from '../Subscriber';\nimport { iterator as Symbol_iterator } from '../symbol/iterator';\n\nexport const subscribeToIterable = <T>(iterable: Iterable<T>) => (subscriber: Subscriber<T>) => {\n  const iterator = iterable[Symbol_iterator]();\n  do {\n    const item = iterator.next();\n    if (item.done) {\n      subscriber.complete();\n      break;\n    }\n    subscriber.next(item.value);\n    if (subscriber.closed) {\n      break;\n    }\n  } while (true);\n\n  // Finalize the iterator if it happens to be a Generator\n  if (typeof iterator.return === 'function') {\n    subscriber.add(() => {\n      if (iterator.return) {\n        iterator.return();\n      }\n    });\n  }\n\n  return subscriber;\n};\n","import { Subscriber } from '../Subscriber';\nimport { observable as Symbol_observable } from '../symbol/observable';\n\n/**\n * Subscribes to an object that implements Symbol.observable with the given\n * Subscriber.\n * @param obj An object that implements Symbol.observable\n */\nexport const subscribeToObservable = <T>(obj: any) => (subscriber: Subscriber<T>) => {\n  const obs = obj[Symbol_observable]();\n  if (typeof obs.subscribe !== 'function') {\n    // Should be caught by observable subscribe function error handling.\n    throw new TypeError('Provided object does not correctly implement Symbol.observable');\n  } else {\n    return obs.subscribe(subscriber);\n  }\n};\n","export const isArrayLike = (<T>(x: any): x is ArrayLike<T> => x && typeof x.length === 'number' && typeof x !== 'function');","/**\n * Tests to see if the object is an ES2015 (ES6) Promise\n * @see {@link https://www.ecma-international.org/ecma-262/6.0/#sec-promise-objects}\n * @param value the object to test\n */\nexport function isPromise(value: any): value is PromiseLike<any> {\n  return !!value && typeof (<any>value).subscribe !== 'function' && typeof (value as any).then === 'function';\n}\n","import { ObservableInput } from '../types';\nimport { subscribeToArray } from './subscribeToArray';\nimport { subscribeToPromise } from './subscribeToPromise';\nimport { subscribeToIterable } from './subscribeToIterable';\nimport { subscribeToObservable } from './subscribeToObservable';\nimport { isArrayLike } from './isArrayLike';\nimport { isPromise } from './isPromise';\nimport { isObject } from './isObject';\nimport { iterator as Symbol_iterator } from '../symbol/iterator';\nimport { observable as Symbol_observable } from '../symbol/observable';\nimport { Subscription } from '../Subscription';\nimport { Subscriber } from '../Subscriber';\n\nexport const subscribeTo = <T>(result: ObservableInput<T>): (subscriber: Subscriber<T>) => Subscription | void => {\n  if (!!result && typeof result[Symbol_observable] === 'function') {\n    return subscribeToObservable(result as any);\n  } else if (isArrayLike(result)) {\n    return subscribeToArray(result);\n  } else if (isPromise(result)) {\n    return subscribeToPromise(result as Promise<any>);\n  } else if (!!result && typeof result[Symbol_iterator] === 'function') {\n    return subscribeToIterable(result as any);\n  } else {\n    const value = isObject(result) ? 'an invalid object' : `'${result}'`;\n    const msg = `You provided ${value} where a stream was expected.`\n      + ' You can provide an Observable, Promise, Array, or Iterable.';\n    throw new TypeError(msg);\n  }\n};\n","import { Subscription } from '../Subscription';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { Subscriber } from '../Subscriber';\nimport { subscribeTo } from './subscribeTo';\nimport { Observable } from '../Observable';\n\nexport function subscribeToResult<T, R>(\n  outerSubscriber: OuterSubscriber<T, R>,\n  result: any,\n  outerValue?: T,\n  outerIndex?: number,\n  destination?: Subscriber<any>\n): Subscription;\nexport function subscribeToResult<T, R>(\n  outerSubscriber: OuterSubscriber<T, R>,\n  result: any,\n  outerValue?: T,\n  outerIndex?: number,\n  destination: Subscriber<any> = new InnerSubscriber(outerSubscriber, outerValue, outerIndex)\n): Subscription | void {\n  if (destination.closed) {\n    return undefined;\n  }\n  if (result instanceof Observable) {\n    return result.subscribe(destination);\n  }\n  return subscribeTo(result)(destination);\n}\n","import { Observable } from '../Observable';\nimport { ObservableInput, SchedulerLike, ObservedValueOf } from '../types';\nimport { isScheduler  } from '../util/isScheduler';\nimport { isArray  } from '../util/isArray';\nimport { Subscriber } from '../Subscriber';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { Operator } from '../Operator';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { fromArray } from './fromArray';\n\nconst NONE = {};\n\n/* tslint:disable:max-line-length */\n\n// If called with a single array, it \"auto-spreads\" the array, with result selector\n/** @deprecated resultSelector no longer supported, pipe to map instead */\nexport function combineLatest<O1 extends ObservableInput<any>, R>(sources: [O1], resultSelector: (v1: ObservedValueOf<O1>) => R, scheduler?: SchedulerLike): Observable<R>;\n/** @deprecated resultSelector no longer supported, pipe to map instead */\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, R>(sources: [O1, O2], resultSelector: (v1: ObservedValueOf<O1>, v2: ObservedValueOf<O2>) => R, scheduler?: SchedulerLike): Observable<R>;\n/** @deprecated resultSelector no longer supported, pipe to map instead */\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, R>(sources: [O1, O2, O3], resultSelector: (v1: ObservedValueOf<O1>, v2: ObservedValueOf<O2>, v3: ObservedValueOf<O3>) => R, scheduler?: SchedulerLike): Observable<R>;\n/** @deprecated resultSelector no longer supported, pipe to map instead */\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, R>(sources: [O1, O2, O3, O4], resultSelector: (v1: ObservedValueOf<O1>, v2: ObservedValueOf<O2>, v3: ObservedValueOf<O3>, v4: ObservedValueOf<O4>) => R, scheduler?: SchedulerLike): Observable<R>;\n/** @deprecated resultSelector no longer supported, pipe to map instead */\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>, R>(sources: [O1, O2, O3, O4, O5], resultSelector: (v1: ObservedValueOf<O1>, v2: ObservedValueOf<O2>, v3: ObservedValueOf<O3>, v4: ObservedValueOf<O4>, v5: ObservedValueOf<O5>) => R, scheduler?: SchedulerLike): Observable<R>;\n/** @deprecated resultSelector no longer supported, pipe to map instead */\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>, O6 extends ObservableInput<any>, R>(sources: [O1, O2, O3, O4, O5, O6], resultSelector: (v1: ObservedValueOf<O1>, v2: ObservedValueOf<O2>, v3: ObservedValueOf<O3>, v4: ObservedValueOf<O4>, v5: ObservedValueOf<O5>, v6: ObservedValueOf<O6>) => R, scheduler?: SchedulerLike): Observable<R>;\n/** @deprecated resultSelector no longer supported, pipe to map instead */\nexport function combineLatest<O extends ObservableInput<any>, R>(sources: O[], resultSelector: (...args: ObservedValueOf<O>[]) => R, scheduler?: SchedulerLike): Observable<R>;\n\n// standard call, but with a result selector\n/** @deprecated resultSelector no longer supported, pipe to map instead */\nexport function combineLatest<O1 extends ObservableInput<any>, R>(v1: O1, resultSelector: (v1: ObservedValueOf<O1>) => R, scheduler?: SchedulerLike): Observable<R>;\n/** @deprecated resultSelector no longer supported, pipe to map instead */\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, R>(v1: O1, v2: O2, resultSelector: (v1: ObservedValueOf<O1>, v2: ObservedValueOf<O2>) => R, scheduler?: SchedulerLike): Observable<R>;\n/** @deprecated resultSelector no longer supported, pipe to map instead */\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, R>(v1: O1, v2: O2, v3: O3, resultSelector: (v1: ObservedValueOf<O1>, v2: ObservedValueOf<O2>, v3: ObservedValueOf<O3>) => R, scheduler?: SchedulerLike): Observable<R>;\n/** @deprecated resultSelector no longer supported, pipe to map instead */\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, R>(v1: O1, v2: O2, v3: O3, v4: O4, resultSelector: (v1: ObservedValueOf<O1>, v2: ObservedValueOf<O2>, v3: ObservedValueOf<O3>, v4: ObservedValueOf<O4>) => R, scheduler?: SchedulerLike): Observable<R>;\n/** @deprecated resultSelector no longer supported, pipe to map instead */\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>, R>(v1: O1, v2: O2, v3: O3, v4: O4, v5: O5, resultSelector: (v1: ObservedValueOf<O1>, v2: ObservedValueOf<O2>, v3: ObservedValueOf<O3>, v4: ObservedValueOf<O4>, v5: ObservedValueOf<O5>) => R, scheduler?: SchedulerLike): Observable<R>;\n/** @deprecated resultSelector no longer supported, pipe to map instead */\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>, O6 extends ObservableInput<any>, R>(v1: O1, v2: O2, v3: O3, v4: O4, v5: O5, v6: O6, resultSelector: (v1: ObservedValueOf<O1>, v2: ObservedValueOf<O2>, v3: ObservedValueOf<O3>, v4: ObservedValueOf<O4>, v5: ObservedValueOf<O5>, v6: ObservedValueOf<O6>) => R, scheduler?: SchedulerLike): Observable<R>;\n\n// With a scheduler (deprecated)\n/** @deprecated Passing a scheduler here is deprecated, use {@link subscribeOn} and/or {@link observeOn} instead */\nexport function combineLatest<O1 extends ObservableInput<any>>(sources: [O1], scheduler: SchedulerLike): Observable<[ObservedValueOf<O1>]>;\n/** @deprecated Passing a scheduler here is deprecated, use {@link subscribeOn} and/or {@link observeOn} instead */\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>>(sources: [O1, O2], scheduler: SchedulerLike): Observable<[ObservedValueOf<O1>, ObservedValueOf<O2>]>;\n/** @deprecated Passing a scheduler here is deprecated, use {@link subscribeOn} and/or {@link observeOn} instead */\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>>(sources: [O1, O2, O3], scheduler: SchedulerLike): Observable<[ObservedValueOf<O1>, ObservedValueOf<O2>, ObservedValueOf<O3>]>;\n/** @deprecated Passing a scheduler here is deprecated, use {@link subscribeOn} and/or {@link observeOn} instead */\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>>(sources: [O1, O2, O3, O4], scheduler: SchedulerLike): Observable<[ObservedValueOf<O1>, ObservedValueOf<O2>, ObservedValueOf<O3>, ObservedValueOf<O4>]>;\n/** @deprecated Passing a scheduler here is deprecated, use {@link subscribeOn} and/or {@link observeOn} instead */\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>>(sources: [O1, O2, O3, O4, O5], scheduler: SchedulerLike): Observable<[ObservedValueOf<O1>, ObservedValueOf<O2>, ObservedValueOf<O3>, ObservedValueOf<O4>, ObservedValueOf<O5>]>;\n/** @deprecated Passing a scheduler here is deprecated, use {@link subscribeOn} and/or {@link observeOn} instead */\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>, O6 extends ObservableInput<any>>(sources: [O1, O2, O3, O4, O5, O6], scheduler: SchedulerLike): Observable<[ObservedValueOf<O1>, ObservedValueOf<O2>, ObservedValueOf<O3>, ObservedValueOf<O4>, ObservedValueOf<O5>, ObservedValueOf<O6>]>;\n/** @deprecated Passing a scheduler here is deprecated, use {@link subscribeOn} and/or {@link observeOn} instead */\nexport function combineLatest<O extends ObservableInput<any>>(sources: O[], scheduler: SchedulerLike): Observable<ObservedValueOf<O>[]>;\n\n// Best case\nexport function combineLatest<O1 extends ObservableInput<any>>(sources: [O1]): Observable<[ObservedValueOf<O1>]>;\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>>(sources: [O1, O2]): Observable<[ObservedValueOf<O1>, ObservedValueOf<O2>]>;\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>>(sources: [O1, O2, O3]): Observable<[ObservedValueOf<O1>, ObservedValueOf<O2>, ObservedValueOf<O3>]>;\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>>(sources: [O1, O2, O3, O4]): Observable<[ObservedValueOf<O1>, ObservedValueOf<O2>, ObservedValueOf<O3>, ObservedValueOf<O4>]>;\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>>(sources: [O1, O2, O3, O4, O5]): Observable<[ObservedValueOf<O1>, ObservedValueOf<O2>, ObservedValueOf<O3>, ObservedValueOf<O4>, ObservedValueOf<O5>]>;\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>, O6 extends ObservableInput<any>>(sources: [O1, O2, O3, O4, O5, O6]): Observable<[ObservedValueOf<O1>, ObservedValueOf<O2>, ObservedValueOf<O3>, ObservedValueOf<O4>, ObservedValueOf<O5>, ObservedValueOf<O6>]>;\nexport function combineLatest<O extends ObservableInput<any>>(sources: O[]): Observable<ObservedValueOf<O>[]>;\n\n// Standard calls\n/** @deprecated Pass arguments in a single array instead `combineLatest([a, b, c])` */\nexport function combineLatest<O1 extends ObservableInput<any>>(v1: O1, scheduler?: SchedulerLike): Observable<[ObservedValueOf<O1>]>;\n/** @deprecated Pass arguments in a single array instead `combineLatest([a, b, c])` */\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>>(v1: O1, v2: O2, scheduler?: SchedulerLike): Observable<[ObservedValueOf<O1>, ObservedValueOf<O2>]>;\n/** @deprecated Pass arguments in a single array instead `combineLatest([a, b, c])` */\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>>(v1: O1, v2: O2, v3: O3, scheduler?: SchedulerLike): Observable<[ObservedValueOf<O1>, ObservedValueOf<O2>, ObservedValueOf<O3>]>;\n/** @deprecated Pass arguments in a single array instead `combineLatest([a, b, c])` */\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>>(v1: O1, v2: O2, v3: O3, v4: O4, scheduler?: SchedulerLike): Observable<[ObservedValueOf<O1>, ObservedValueOf<O2>, ObservedValueOf<O3>, ObservedValueOf<O4>]>;\n/** @deprecated Pass arguments in a single array instead `combineLatest([a, b, c])` */\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>>(v1: O1, v2: O2, v3: O3, v4: O4, v5: O5, scheduler?: SchedulerLike): Observable<[ObservedValueOf<O1>, ObservedValueOf<O2>, ObservedValueOf<O3>, ObservedValueOf<O4>, ObservedValueOf<O5>]>;\n/** @deprecated Pass arguments in a single array instead `combineLatest([a, b, c])` */\nexport function combineLatest<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>, O6 extends ObservableInput<any>>(v1: O1, v2: O2, v3: O3, v4: O4, v5: O5, v6: O6, scheduler?: SchedulerLike): Observable<[ObservedValueOf<O1>, ObservedValueOf<O2>, ObservedValueOf<O3>, ObservedValueOf<O4>, ObservedValueOf<O5>, ObservedValueOf<O6>]>;\n\n/** @deprecated Pass arguments in a single array instead `combineLatest([a, b, c])` */\nexport function combineLatest<O extends ObservableInput<any>>(...observables: O[]): Observable<any[]>;\n\n/** @deprecated Pass arguments in a single array instead `combineLatest([a, b, c])` */\nexport function combineLatest<O extends ObservableInput<any>, R>(...observables: Array<ObservableInput<any> | ((...values: Array<any>) => R)>): Observable<R>;\n\n/** @deprecated resultSelector no longer supported, pipe to map instead */\nexport function combineLatest<O extends ObservableInput<any>, R>(array: O[], resultSelector: (...values: ObservedValueOf<O>[]) => R, scheduler?: SchedulerLike): Observable<R>;\n\n/** @deprecated Passing a scheduler here is deprecated, use {@link subscribeOn} and/or {@link observeOn} instead */\nexport function combineLatest<O extends ObservableInput<any>>(...observables: Array<O | SchedulerLike>): Observable<any[]>;\n\n/** @deprecated Passing a scheduler here is deprecated, use {@link subscribeOn} and/or {@link observeOn} instead */\nexport function combineLatest<O extends ObservableInput<any>, R>(...observables: Array<O | ((...values: ObservedValueOf<O>[]) => R) | SchedulerLike>): Observable<R>;\n\n/** @deprecated Passing a scheduler here is deprecated, use {@link subscribeOn} and/or {@link observeOn} instead */\nexport function combineLatest<R>(...observables: Array<ObservableInput<any> | ((...values: Array<any>) => R) | SchedulerLike>): Observable<R>;\n/* tslint:enable:max-line-length */\n\n/**\n * Combines multiple Observables to create an Observable whose values are\n * calculated from the latest values of each of its input Observables.\n *\n * <span class=\"informal\">Whenever any input Observable emits a value, it\n * computes a formula using the latest values from all the inputs, then emits\n * the output of that formula.</span>\n *\n * ![](combineLatest.png)\n *\n * `combineLatest` combines the values from all the Observables passed as\n * arguments. This is done by subscribing to each Observable in order and,\n * whenever any Observable emits, collecting an array of the most recent\n * values from each Observable. So if you pass `n` Observables to operator,\n * returned Observable will always emit an array of `n` values, in order\n * corresponding to order of passed Observables (value from the first Observable\n * on the first place and so on).\n *\n * Static version of `combineLatest` accepts either an array of Observables\n * or each Observable can be put directly as an argument. Note that array of\n * Observables is good choice, if you don't know beforehand how many Observables\n * you will combine. Passing empty array will result in Observable that\n * completes immediately.\n *\n * To ensure output array has always the same length, `combineLatest` will\n * actually wait for all input Observables to emit at least once,\n * before it starts emitting results. This means if some Observable emits\n * values before other Observables started emitting, all these values but the last\n * will be lost. On the other hand, if some Observable does not emit a value but\n * completes, resulting Observable will complete at the same moment without\n * emitting anything, since it will be now impossible to include value from\n * completed Observable in resulting array. Also, if some input Observable does\n * not emit any value and never completes, `combineLatest` will also never emit\n * and never complete, since, again, it will wait for all streams to emit some\n * value.\n *\n * If at least one Observable was passed to `combineLatest` and all passed Observables\n * emitted something, resulting Observable will complete when all combined\n * streams complete. So even if some Observable completes, result of\n * `combineLatest` will still emit values when other Observables do. In case\n * of completed Observable, its value from now on will always be the last\n * emitted value. On the other hand, if any Observable errors, `combineLatest`\n * will error immediately as well, and all other Observables will be unsubscribed.\n *\n * `combineLatest` accepts as optional parameter `project` function, which takes\n * as arguments all values that would normally be emitted by resulting Observable.\n * `project` can return any kind of value, which will be then emitted by Observable\n * instead of default array. Note that `project` does not take as argument that array\n * of values, but values themselves. That means default `project` can be imagined\n * as function that takes all its arguments and puts them into an array.\n *\n * ## Examples\n * ### Combine two timer Observables\n * ```ts\n * import { combineLatest, timer } from 'rxjs';\n *\n * const firstTimer = timer(0, 1000); // emit 0, 1, 2... after every second, starting from now\n * const secondTimer = timer(500, 1000); // emit 0, 1, 2... after every second, starting 0,5s from now\n * const combinedTimers = combineLatest(firstTimer, secondTimer);\n * combinedTimers.subscribe(value => console.log(value));\n * // Logs\n * // [0, 0] after 0.5s\n * // [1, 0] after 1s\n * // [1, 1] after 1.5s\n * // [2, 1] after 2s\n * ```\n *\n * ### Combine an array of Observables\n * ```ts\n * import { combineLatest, of } from 'rxjs';\n * import { delay, starWith } from 'rxjs/operators';\n *\n * const observables = [1, 5, 10].map(\n *   n => of(n).pipe(\n *     delay(n * 1000),   // emit 0 and then emit n after n seconds\n *     startWith(0),\n *   )\n * );\n * const combined = combineLatest(observables);\n * combined.subscribe(value => console.log(value));\n * // Logs\n * // [0, 0, 0] immediately\n * // [1, 0, 0] after 1s\n * // [1, 5, 0] after 5s\n * // [1, 5, 10] after 10s\n * ```\n *\n *\n * ### Use project function to dynamically calculate the Body-Mass Index\n * ```ts\n * import { combineLatest, of } from 'rxjs';\n * import { map } from 'rxjs/operators';\n *\n * const weight = of(70, 72, 76, 79, 75);\n * const height = of(1.76, 1.77, 1.78);\n * const bmi = combineLatest(weight, height).pipe(\n *   map(([w, h]) => w / (h * h)),\n * );\n * bmi.subscribe(x => console.log('BMI is ' + x));\n *\n * // With output to console:\n * // BMI is 24.212293388429753\n * // BMI is 23.93948099205209\n * // BMI is 23.671253629592222\n * ```\n *\n * @see {@link combineAll}\n * @see {@link merge}\n * @see {@link withLatestFrom}\n *\n * @param {ObservableInput} observable1 An input Observable to combine with other Observables.\n * @param {ObservableInput} observable2 An input Observable to combine with other Observables.\n * More than one input Observables may be given as arguments\n * or an array of Observables may be given as the first argument.\n * @param {function} [project] An optional function to project the values from\n * the combined latest values into a new value on the output Observable.\n * @param {SchedulerLike} [scheduler=null] The {@link SchedulerLike} to use for subscribing to\n * each input Observable.\n * @return {Observable} An Observable of projected values from the most recent\n * values from each input Observable, or an array of the most recent values from\n * each input Observable.\n */\nexport function combineLatest<O extends ObservableInput<any>, R>(\n  ...observables: (O | ((...values: ObservedValueOf<O>[]) => R) | SchedulerLike)[]\n): Observable<R> {\n  let resultSelector: (...values: Array<any>) => R =  null;\n  let scheduler: SchedulerLike = null;\n\n  if (isScheduler(observables[observables.length - 1])) {\n    scheduler = observables.pop() as SchedulerLike;\n  }\n\n  if (typeof observables[observables.length - 1] === 'function') {\n    resultSelector = observables.pop() as (...values: Array<any>) => R;\n  }\n\n  // if the first and only other argument besides the resultSelector is an array\n  // assume it's been called with `combineLatest([obs1, obs2, obs3], resultSelector)`\n  if (observables.length === 1 && isArray(observables[0])) {\n    observables = observables[0] as any;\n  }\n\n  return fromArray(observables, scheduler).lift(new CombineLatestOperator<ObservedValueOf<O>, R>(resultSelector));\n}\n\nexport class CombineLatestOperator<T, R> implements Operator<T, R> {\n  constructor(private resultSelector?: (...values: Array<any>) => R) {\n  }\n\n  call(subscriber: Subscriber<R>, source: any): any {\n    return source.subscribe(new CombineLatestSubscriber(subscriber, this.resultSelector));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nexport class CombineLatestSubscriber<T, R> extends OuterSubscriber<T, R> {\n  private active: number = 0;\n  private values: any[] = [];\n  private observables: any[] = [];\n  private toRespond: number;\n\n  constructor(destination: Subscriber<R>, private resultSelector?: (...values: Array<any>) => R) {\n    super(destination);\n  }\n\n  protected _next(observable: any) {\n    this.values.push(NONE);\n    this.observables.push(observable);\n  }\n\n  protected _complete() {\n    const observables = this.observables;\n    const len = observables.length;\n    if (len === 0) {\n      this.destination.complete();\n    } else {\n      this.active = len;\n      this.toRespond = len;\n      for (let i = 0; i < len; i++) {\n        const observable = observables[i];\n        this.add(subscribeToResult(this, observable, observable, i));\n      }\n    }\n  }\n\n  notifyComplete(unused: Subscriber<R>): void {\n    if ((this.active -= 1) === 0) {\n      this.destination.complete();\n    }\n  }\n\n  notifyNext(outerValue: T, innerValue: R,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, R>): void {\n    const values = this.values;\n    const oldVal = values[outerIndex];\n    const toRespond = !this.toRespond\n      ? 0\n      : oldVal === NONE ? --this.toRespond : this.toRespond;\n    values[outerIndex] = innerValue;\n\n    if (toRespond === 0) {\n      if (this.resultSelector) {\n        this._tryResultSelector(values);\n      } else {\n        this.destination.next(values.slice());\n      }\n    }\n  }\n\n  private _tryResultSelector(values: any[]) {\n    let result: any;\n    try {\n      result = this.resultSelector.apply(this, values);\n    } catch (err) {\n      this.destination.error(err);\n      return;\n    }\n    this.destination.next(result);\n  }\n}\n","import { Observable } from '../Observable';\nimport { Subscription } from '../Subscription';\nimport { observable as Symbol_observable } from '../symbol/observable';\nimport { InteropObservable, SchedulerLike, Subscribable } from '../types';\n\nexport function scheduleObservable<T>(input: InteropObservable<T>, scheduler: SchedulerLike) {\n  return new Observable<T>(subscriber => {\n    const sub = new Subscription();\n    sub.add(scheduler.schedule(() => {\n      const observable: Subscribable<T> = input[Symbol_observable]();\n      sub.add(observable.subscribe({\n        next(value) { sub.add(scheduler.schedule(() => subscriber.next(value))); },\n        error(err) { sub.add(scheduler.schedule(() => subscriber.error(err))); },\n        complete() { sub.add(scheduler.schedule(() => subscriber.complete())); },\n      }));\n    }));\n    return sub;\n  });\n}\n","import { Observable } from '../Observable';\nimport { SchedulerLike } from '../types';\nimport { Subscription } from '../Subscription';\n\nexport function schedulePromise<T>(input: PromiseLike<T>, scheduler: SchedulerLike) {\n  return new Observable<T>(subscriber => {\n    const sub = new Subscription();\n    sub.add(scheduler.schedule(() => input.then(\n      value => {\n        sub.add(scheduler.schedule(() => {\n          subscriber.next(value);\n          sub.add(scheduler.schedule(() => subscriber.complete()));\n        }));\n      },\n      err => {\n        sub.add(scheduler.schedule(() => subscriber.error(err)));\n      }\n    )));\n    return sub;\n  });\n}\n","import { Observable } from '../Observable';\nimport { SchedulerLike } from '../types';\nimport { Subscription } from '../Subscription';\nimport { iterator as Symbol_iterator } from '../symbol/iterator';\n\nexport function scheduleIterable<T>(input: Iterable<T>, scheduler: SchedulerLike) {\n  if (!input) {\n    throw new Error('Iterable cannot be null');\n  }\n  return new Observable<T>(subscriber => {\n    const sub = new Subscription();\n    let iterator: Iterator<T>;\n    sub.add(() => {\n      // Finalize generators\n      if (iterator && typeof iterator.return === 'function') {\n        iterator.return();\n      }\n    });\n    sub.add(scheduler.schedule(() => {\n      iterator = input[Symbol_iterator]();\n      sub.add(scheduler.schedule(function () {\n        if (subscriber.closed) {\n          return;\n        }\n        let value: T;\n        let done: boolean;\n        try {\n          const result = iterator.next();\n          value = result.value;\n          done = result.done;\n        } catch (err) {\n          subscriber.error(err);\n          return;\n        }\n        if (done) {\n          subscriber.complete();\n        } else {\n          subscriber.next(value);\n          this.schedule();\n        }\n      }));\n    }));\n    return sub;\n  });\n}\n","import { InteropObservable } from '../types';\nimport { observable as Symbol_observable } from '../symbol/observable';\n\n/** Identifies an input as being Observable (but not necessary an Rx Observable) */\nexport function isInteropObservable(input: any): input is InteropObservable<any> {\n  return input && typeof input[Symbol_observable] === 'function';\n}\n","import { iterator as Symbol_iterator } from '../symbol/iterator';\n\n/** Identifies an input as being an Iterable */\nexport function isIterable(input: any): input is Iterable<any> {\n  return input && typeof input[Symbol_iterator] === 'function';\n}\n","import { scheduleObservable } from './scheduleObservable';\nimport { schedulePromise } from './schedulePromise';\nimport { scheduleArray } from './scheduleArray';\nimport { scheduleIterable } from './scheduleIterable';\nimport { ObservableInput, SchedulerLike, Observable } from 'rxjs';\nimport { isInteropObservable } from '../util/isInteropObservable';\nimport { isPromise } from '../util/isPromise';\nimport { isArrayLike } from '../util/isArrayLike';\nimport { isIterable } from '../util/isIterable';\n\n/**\n * Converts from a common {@link ObservableInput} type to an observable where subscription and emissions\n * are scheduled on the provided scheduler.\n *\n * @see from\n * @see of\n *\n * @param input The observable, array, promise, iterable, etc you would like to schedule\n * @param scheduler The scheduler to use to schedule the subscription and emissions from\n * the returned observable.\n */\nexport function scheduled<T>(input: ObservableInput<T>, scheduler: SchedulerLike): Observable<T> {\n  if (input != null) {\n    if (isInteropObservable(input)) {\n      return scheduleObservable(input, scheduler);\n    } else if (isPromise(input)) {\n      return schedulePromise(input, scheduler);\n    } else if (isArrayLike(input)) {\n      return scheduleArray(input, scheduler);\n    }  else if (isIterable(input) || typeof input === 'string') {\n      return scheduleIterable(input, scheduler);\n    }\n  }\n\n  throw new TypeError((input !== null && typeof input || input) + ' is not observable');\n}\n","import { Observable } from '../Observable';\nimport { subscribeTo } from '../util/subscribeTo';\nimport { ObservableInput, SchedulerLike, ObservedValueOf } from '../types';\nimport { scheduled } from '../scheduled/scheduled';\n\nexport function from<O extends ObservableInput<any>>(input: O): Observable<ObservedValueOf<O>>;\n/** @deprecated use {@link scheduled} instead. */\nexport function from<O extends ObservableInput<any>>(input: O, scheduler: SchedulerLike): Observable<ObservedValueOf<O>>;\n\n/**\n * Creates an Observable from an Array, an array-like object, a Promise, an iterable object, or an Observable-like object.\n *\n * <span class=\"informal\">Converts almost anything to an Observable.</span>\n *\n * ![](from.png)\n *\n * `from` converts various other objects and data types into Observables. It also converts a Promise, an array-like, or an\n * <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols#iterable\" target=\"_blank\">iterable</a>\n * object into an Observable that emits the items in that promise, array, or iterable. A String, in this context, is treated\n * as an array of characters. Observable-like objects (contains a function named with the ES2015 Symbol for Observable) can also be\n * converted through this operator.\n *\n * ## Examples\n *\n * ### Converts an array to an Observable\n *\n * ```ts\n * import { from } from 'rxjs';\n *\n * const array = [10, 20, 30];\n * const result = from(array);\n *\n * result.subscribe(x => console.log(x));\n *\n * // Logs:\n * // 10\n * // 20\n * // 30\n * ```\n *\n * ---\n *\n * ### Convert an infinite iterable (from a generator) to an Observable\n *\n * ```ts\n * import { from } from 'rxjs';\n * import { take } from 'rxjs/operators';\n *\n * function* generateDoubles(seed) {\n *    let i = seed;\n *    while (true) {\n *      yield i;\n *      i = 2 * i; // double it\n *    }\n * }\n *\n * const iterator = generateDoubles(3);\n * const result = from(iterator).pipe(take(10));\n *\n * result.subscribe(x => console.log(x));\n *\n * // Logs:\n * // 3\n * // 6\n * // 12\n * // 24\n * // 48\n * // 96\n * // 192\n * // 384\n * // 768\n * // 1536\n * ```\n *\n * ---\n *\n * ### With async scheduler\n *\n * ```ts\n * import { from, asyncScheduler } from 'rxjs';\n *\n * console.log('start');\n *\n * const array = [10, 20, 30];\n * const result = from(array, asyncScheduler);\n *\n * result.subscribe(x => console.log(x));\n *\n * console.log('end');\n *\n * // Logs:\n * // start\n * // end\n * // 10\n * // 20\n * // 30\n * ```\n *\n * @see {@link fromEvent}\n * @see {@link fromEventPattern}\n *\n * @param {ObservableInput<T>} A subscription object, a Promise, an Observable-like,\n * an Array, an iterable, or an array-like object to be converted.\n * @param {SchedulerLike} An optional {@link SchedulerLike} on which to schedule the emission of values.\n * @return {Observable<T>}\n * @name from\n * @owner Observable\n */\nexport function from<T>(input: ObservableInput<T>, scheduler?: SchedulerLike): Observable<T> {\n  if (!scheduler) {\n    if (input instanceof Observable) {\n      return input;\n    }\n    return new Observable<T>(subscribeTo(input));\n  } else {\n    return scheduled(input, scheduler);\n  }\n}\n","import { Observable } from '../Observable';\nimport { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { ObservableInput, OperatorFunction, ObservedValueOf } from '../types';\nimport { map } from './map';\nimport { from } from '../observable/from';\n\n/* tslint:disable:max-line-length */\nexport function mergeMap<T, O extends ObservableInput<any>>(project: (value: T, index: number) => O, concurrent?: number): OperatorFunction<T, ObservedValueOf<O>>;\n/** @deprecated resultSelector no longer supported, use inner map instead */\nexport function mergeMap<T, O extends ObservableInput<any>>(project: (value: T, index: number) => O, resultSelector: undefined, concurrent?: number): OperatorFunction<T, ObservedValueOf<O>>;\n/** @deprecated resultSelector no longer supported, use inner map instead */\nexport function mergeMap<T, R, O extends ObservableInput<any>>(project: (value: T, index: number) => O, resultSelector: (outerValue: T, innerValue: ObservedValueOf<O>, outerIndex: number, innerIndex: number) => R, concurrent?: number): OperatorFunction<T, R>;\n/* tslint:enable:max-line-length */\n\n/**\n * Projects each source value to an Observable which is merged in the output\n * Observable.\n *\n * <span class=\"informal\">Maps each value to an Observable, then flattens all of\n * these inner Observables using {@link mergeAll}.</span>\n *\n * ![](mergeMap.png)\n *\n * Returns an Observable that emits items based on applying a function that you\n * supply to each item emitted by the source Observable, where that function\n * returns an Observable, and then merging those resulting Observables and\n * emitting the results of this merger.\n *\n * ## Example\n * Map and flatten each letter to an Observable ticking every 1 second\n * ```ts\n * import { of, interval } from 'rxjs';\n * import { mergeMap, map } from 'rxjs/operators';\n *\n * const letters = of('a', 'b', 'c');\n * const result = letters.pipe(\n *   mergeMap(x => interval(1000).pipe(map(i => x+i))),\n * );\n * result.subscribe(x => console.log(x));\n *\n * // Results in the following:\n * // a0\n * // b0\n * // c0\n * // a1\n * // b1\n * // c1\n * // continues to list a,b,c with respective ascending integers\n * ```\n *\n * @see {@link concatMap}\n * @see {@link exhaustMap}\n * @see {@link merge}\n * @see {@link mergeAll}\n * @see {@link mergeMapTo}\n * @see {@link mergeScan}\n * @see {@link switchMap}\n *\n * @param {function(value: T, ?index: number): ObservableInput} project A function\n * that, when applied to an item emitted by the source Observable, returns an\n * Observable.\n * @param {number} [concurrent=Number.POSITIVE_INFINITY] Maximum number of input\n * Observables being subscribed to concurrently.\n * @return {Observable} An Observable that emits the result of applying the\n * projection function (and the optional deprecated `resultSelector`) to each item\n * emitted by the source Observable and merging the results of the Observables\n * obtained from this transformation.\n * @method mergeMap\n * @owner Observable\n */\nexport function mergeMap<T, R, O extends ObservableInput<any>>(\n  project: (value: T, index: number) => O,\n  resultSelector?: ((outerValue: T, innerValue: ObservedValueOf<O>, outerIndex: number, innerIndex: number) => R) | number,\n  concurrent: number = Number.POSITIVE_INFINITY\n): OperatorFunction<T, ObservedValueOf<O>|R> {\n  if (typeof resultSelector === 'function') {\n    // DEPRECATED PATH\n    return (source: Observable<T>) => source.pipe(\n      mergeMap((a, i) => from(project(a, i)).pipe(\n        map((b: any, ii: number) => resultSelector(a, b, i, ii)),\n      ), concurrent)\n    );\n  } else if (typeof resultSelector === 'number') {\n    concurrent = resultSelector;\n  }\n  return (source: Observable<T>) => source.lift(new MergeMapOperator(project, concurrent));\n}\n\nexport class MergeMapOperator<T, R> implements Operator<T, R> {\n  constructor(private project: (value: T, index: number) => ObservableInput<R>,\n              private concurrent: number = Number.POSITIVE_INFINITY) {\n  }\n\n  call(observer: Subscriber<R>, source: any): any {\n    return source.subscribe(new MergeMapSubscriber(\n      observer, this.project, this.concurrent\n    ));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nexport class MergeMapSubscriber<T, R> extends OuterSubscriber<T, R> {\n  private hasCompleted: boolean = false;\n  private buffer: T[] = [];\n  private active: number = 0;\n  protected index: number = 0;\n\n  constructor(destination: Subscriber<R>,\n              private project: (value: T, index: number) => ObservableInput<R>,\n              private concurrent: number = Number.POSITIVE_INFINITY) {\n    super(destination);\n  }\n\n  protected _next(value: T): void {\n    if (this.active < this.concurrent) {\n      this._tryNext(value);\n    } else {\n      this.buffer.push(value);\n    }\n  }\n\n  protected _tryNext(value: T) {\n    let result: ObservableInput<R>;\n    const index = this.index++;\n    try {\n      result = this.project(value, index);\n    } catch (err) {\n      this.destination.error(err);\n      return;\n    }\n    this.active++;\n    this._innerSub(result, value, index);\n  }\n\n  private _innerSub(ish: ObservableInput<R>, value: T, index: number): void {\n    const innerSubscriber = new InnerSubscriber(this, undefined, undefined);\n    const destination = this.destination as Subscription;\n    destination.add(innerSubscriber);\n    subscribeToResult<T, R>(this, ish, value, index, innerSubscriber);\n  }\n\n  protected _complete(): void {\n    this.hasCompleted = true;\n    if (this.active === 0 && this.buffer.length === 0) {\n      this.destination.complete();\n    }\n    this.unsubscribe();\n  }\n\n  notifyNext(outerValue: T, innerValue: R,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, R>): void {\n    this.destination.next(innerValue);\n  }\n\n  notifyComplete(innerSub: Subscription): void {\n    const buffer = this.buffer;\n    this.remove(innerSub);\n    this.active--;\n    if (buffer.length > 0) {\n      this._next(buffer.shift());\n    } else if (this.active === 0 && this.hasCompleted) {\n      this.destination.complete();\n    }\n  }\n}\n","\nimport { mergeMap } from './mergeMap';\nimport { identity } from '../util/identity';\nimport { OperatorFunction, ObservableInput } from '../types';\n\n/**\n * Converts a higher-order Observable into a first-order Observable which\n * concurrently delivers all values that are emitted on the inner Observables.\n *\n * <span class=\"informal\">Flattens an Observable-of-Observables.</span>\n *\n * ![](mergeAll.png)\n *\n * `mergeAll` subscribes to an Observable that emits Observables, also known as\n * a higher-order Observable. Each time it observes one of these emitted inner\n * Observables, it subscribes to that and delivers all the values from the\n * inner Observable on the output Observable. The output Observable only\n * completes once all inner Observables have completed. Any error delivered by\n * a inner Observable will be immediately emitted on the output Observable.\n *\n * ## Examples\n * Spawn a new interval Observable for each click event, and blend their outputs as one Observable\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { map, mergeAll } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const higherOrder = clicks.pipe(map((ev) => interval(1000)));\n * const firstOrder = higherOrder.pipe(mergeAll());\n * firstOrder.subscribe(x => console.log(x));\n * ```\n *\n * Count from 0 to 9 every second for each click, but only allow 2 concurrent timers\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { take, map, mergeAll } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const higherOrder = clicks.pipe(\n *   map((ev) => interval(1000).pipe(take(10))),\n * );\n * const firstOrder = higherOrder.pipe(mergeAll(2));\n * firstOrder.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link combineAll}\n * @see {@link concatAll}\n * @see {@link exhaust}\n * @see {@link merge}\n * @see {@link mergeMap}\n * @see {@link mergeMapTo}\n * @see {@link mergeScan}\n * @see {@link switchAll}\n * @see {@link switchMap}\n * @see {@link zipAll}\n *\n * @param {number} [concurrent=Number.POSITIVE_INFINITY] Maximum number of inner\n * Observables being subscribed to concurrently.\n * @return {Observable} An Observable that emits values coming from all the\n * inner Observables emitted by the source Observable.\n * @method mergeAll\n * @owner Observable\n */\nexport function mergeAll<T>(concurrent: number = Number.POSITIVE_INFINITY): OperatorFunction<ObservableInput<T>, T> {\n  return mergeMap(identity, concurrent);\n}\n","\nimport { mergeAll } from './mergeAll';\nimport { OperatorFunction, ObservableInput } from '../types';\n\nexport function concatAll<T>(): OperatorFunction<ObservableInput<T>, T>;\nexport function concatAll<R>(): OperatorFunction<any, R>;\n\n/**\n * Converts a higher-order Observable into a first-order Observable by\n * concatenating the inner Observables in order.\n *\n * <span class=\"informal\">Flattens an Observable-of-Observables by putting one\n * inner Observable after the other.</span>\n *\n * ![](concatAll.png)\n *\n * Joins every Observable emitted by the source (a higher-order Observable), in\n * a serial fashion. It subscribes to each inner Observable only after the\n * previous inner Observable has completed, and merges all of their values into\n * the returned observable.\n *\n * __Warning:__ If the source Observable emits Observables quickly and\n * endlessly, and the inner Observables it emits generally complete slower than\n * the source emits, you can run into memory issues as the incoming Observables\n * collect in an unbounded buffer.\n *\n * Note: `concatAll` is equivalent to `mergeAll` with concurrency parameter set\n * to `1`.\n *\n * ## Example\n *\n * For each click event, tick every second from 0 to 3, with no concurrency\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { map, take, concatAll } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const higherOrder = clicks.pipe(\n *   map(ev => interval(1000).pipe(take(4))),\n * );\n * const firstOrder = higherOrder.pipe(concatAll());\n * firstOrder.subscribe(x => console.log(x));\n *\n * // Results in the following:\n * // (results are not concurrent)\n * // For every click on the \"document\" it will emit values 0 to 3 spaced\n * // on a 1000ms interval\n * // one click = 1000ms-> 0 -1000ms-> 1 -1000ms-> 2 -1000ms-> 3\n * ```\n *\n * @see {@link combineAll}\n * @see {@link concat}\n * @see {@link concatMap}\n * @see {@link concatMapTo}\n * @see {@link exhaust}\n * @see {@link mergeAll}\n * @see {@link switchAll}\n * @see {@link switchMap}\n * @see {@link zipAll}\n *\n * @return {Observable} An Observable emitting values from all the inner\n * Observables concatenated.\n * @method concatAll\n * @owner Observable\n */\nexport function concatAll<T>(): OperatorFunction<ObservableInput<T>, T> {\n  return mergeAll<T>(1);\n}\n","import { Observable } from '../Observable';\nimport { ObservableInput, SchedulerLike, ObservedValueOf } from '../types';\nimport { isScheduler } from '../util/isScheduler';\nimport { of } from './of';\nimport { from } from './from';\nimport { concatAll } from '../operators/concatAll';\n\n/* tslint:disable:max-line-length */\n/** @deprecated Use {@link scheduled} and {@link concatAll} (e.g. `scheduled([o1, o2, o3], scheduler).pipe(concatAll())`) */\nexport function concat<O1 extends ObservableInput<any>>(v1: O1, scheduler: SchedulerLike): Observable<ObservedValueOf<O1>>;\n/** @deprecated Use {@link scheduled} and {@link concatAll} (e.g. `scheduled([o1, o2, o3], scheduler).pipe(concatAll())`) */\nexport function concat<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>>(v1: O1, v2: O2, scheduler: SchedulerLike): Observable<ObservedValueOf<O1> | ObservedValueOf<O2>>;\n/** @deprecated Use {@link scheduled} and {@link concatAll} (e.g. `scheduled([o1, o2, o3], scheduler).pipe(concatAll())`) */\nexport function concat<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>>(v1: O1, v2: O2, v3: O3, scheduler: SchedulerLike): Observable<ObservedValueOf<O1> | ObservedValueOf<O2> | ObservedValueOf<O3>>;\n/** @deprecated Use {@link scheduled} and {@link concatAll} (e.g. `scheduled([o1, o2, o3], scheduler).pipe(concatAll())`) */\nexport function concat<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>>(v1: O1, v2: O2, v3: O3, v4: O4, scheduler: SchedulerLike): Observable<ObservedValueOf<O1> | ObservedValueOf<O2> | ObservedValueOf<O3> | ObservedValueOf<O4>>;\n/** @deprecated Use {@link scheduled} and {@link concatAll} (e.g. `scheduled([o1, o2, o3], scheduler).pipe(concatAll())`) */\nexport function concat<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>>(v1: O1, v2: O2, v3: O3, v4: O4, v5: O5, scheduler: SchedulerLike): Observable<ObservedValueOf<O1> | ObservedValueOf<O2> | ObservedValueOf<O3> | ObservedValueOf<O4> | ObservedValueOf<O5>>;\n/** @deprecated Use {@link scheduled} and {@link concatAll} (e.g. `scheduled([o1, o2, o3], scheduler).pipe(concatAll())`) */\nexport function concat<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>, O6 extends ObservableInput<any>>(v1: O1, v2: O2, v3: O3, v4: O4, v5: O5, v6: O6, scheduler: SchedulerLike): Observable<ObservedValueOf<O1> | ObservedValueOf<O2> | ObservedValueOf<O3> | ObservedValueOf<O4> | ObservedValueOf<O5> | ObservedValueOf<O6>>;\n\nexport function concat<O1 extends ObservableInput<any>>(v1: O1): Observable<ObservedValueOf<O1>>;\nexport function concat<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>>(v1: O1, v2: O2): Observable<ObservedValueOf<O1> | ObservedValueOf<O2>>;\nexport function concat<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>>(v1: O1, v2: O2, v3: O3): Observable<ObservedValueOf<O1> | ObservedValueOf<O2> | ObservedValueOf<O3>>;\nexport function concat<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>>(v1: O1, v2: O2, v3: O3, v4: O4): Observable<ObservedValueOf<O1> | ObservedValueOf<O2> | ObservedValueOf<O3> | ObservedValueOf<O4>>;\nexport function concat<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>>(v1: O1, v2: O2, v3: O3, v4: O4, v5: O5): Observable<ObservedValueOf<O1> | ObservedValueOf<O2> | ObservedValueOf<O3> | ObservedValueOf<O4> | ObservedValueOf<O5>>;\nexport function concat<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>, O6 extends ObservableInput<any>>(v1: O1, v2: O2, v3: O3, v4: O4, v5: O5, v6: O6): Observable<ObservedValueOf<O1> | ObservedValueOf<O2> | ObservedValueOf<O3> | ObservedValueOf<O4> | ObservedValueOf<O5> | ObservedValueOf<O6>>;\nexport function concat<O extends ObservableInput<any>>(...observables: O[]): Observable<ObservedValueOf<O>>;\n/** @deprecated Use {@link scheduled} and {@link concatAll} (e.g. `scheduled([o1, o2, o3], scheduler).pipe(concatAll())`) */\nexport function concat<O extends ObservableInput<any>>(...observables: (O | SchedulerLike)[]): Observable<ObservedValueOf<O>>;\nexport function concat<R>(...observables: ObservableInput<any>[]): Observable<R>;\n/** @deprecated Use {@link scheduled} and {@link concatAll} (e.g. `scheduled([o1, o2, o3], scheduler).pipe(concatAll())`) */\nexport function concat<R>(...observables: (ObservableInput<any> | SchedulerLike)[]): Observable<R>;\n/* tslint:enable:max-line-length */\n/**\n * Creates an output Observable which sequentially emits all values from given\n * Observable and then moves on to the next.\n *\n * <span class=\"informal\">Concatenates multiple Observables together by\n * sequentially emitting their values, one Observable after the other.</span>\n *\n * ![](concat.png)\n *\n * `concat` joins multiple Observables together, by subscribing to them one at a time and\n * merging their results into the output Observable. You can pass either an array of\n * Observables, or put them directly as arguments. Passing an empty array will result\n * in Observable that completes immediately.\n *\n * `concat` will subscribe to first input Observable and emit all its values, without\n * changing or affecting them in any way. When that Observable completes, it will\n * subscribe to then next Observable passed and, again, emit its values. This will be\n * repeated, until the operator runs out of Observables. When last input Observable completes,\n * `concat` will complete as well. At any given moment only one Observable passed to operator\n * emits values. If you would like to emit values from passed Observables concurrently, check out\n * {@link merge} instead, especially with optional `concurrent` parameter. As a matter of fact,\n * `concat` is an equivalent of `merge` operator with `concurrent` parameter set to `1`.\n *\n * Note that if some input Observable never completes, `concat` will also never complete\n * and Observables following the one that did not complete will never be subscribed. On the other\n * hand, if some Observable simply completes immediately after it is subscribed, it will be\n * invisible for `concat`, which will just move on to the next Observable.\n *\n * If any Observable in chain errors, instead of passing control to the next Observable,\n * `concat` will error immediately as well. Observables that would be subscribed after\n * the one that emitted error, never will.\n *\n * If you pass to `concat` the same Observable many times, its stream of values\n * will be \"replayed\" on every subscription, which means you can repeat given Observable\n * as many times as you like. If passing the same Observable to `concat` 1000 times becomes tedious,\n * you can always use {@link repeat}.\n *\n * ## Examples\n * ### Concatenate a timer counting from 0 to 3 with a synchronous sequence from 1 to 10\n * ```ts\n * import { concat, interval, range } from 'rxjs';\n * import { take } from 'rxjs/operators';\n *\n * const timer = interval(1000).pipe(take(4));\n * const sequence = range(1, 10);\n * const result = concat(timer, sequence);\n * result.subscribe(x => console.log(x));\n *\n * // results in:\n * // 0 -1000ms-> 1 -1000ms-> 2 -1000ms-> 3 -immediate-> 1 ... 10\n * ```\n *\n * ### Concatenate 3 Observables\n * ```ts\n * import { concat, interval } from 'rxjs';\n * import { take } from 'rxjs/operators';\n *\n * const timer1 = interval(1000).pipe(take(10));\n * const timer2 = interval(2000).pipe(take(6));\n * const timer3 = interval(500).pipe(take(10));\n *\n * const result = concat(timer1, timer2, timer3);\n * result.subscribe(x => console.log(x));\n *\n * // results in the following:\n * // (Prints to console sequentially)\n * // -1000ms-> 0 -1000ms-> 1 -1000ms-> ... 9\n * // -2000ms-> 0 -2000ms-> 1 -2000ms-> ... 5\n * // -500ms-> 0 -500ms-> 1 -500ms-> ... 9\n * ```\n *\n * ### Concatenate the same Observable to repeat it\n * ```ts\n * import { concat, interval } from 'rxjs';\n * import { take } from 'rxjs/operators';\n *\n * const timer = interval(1000).pipe(take(2));\n *\n * concat(timer, timer) // concatenating the same Observable!\n * .subscribe(\n *   value => console.log(value),\n *   err => {},\n *   () => console.log('...and it is done!')\n * );\n *\n * // Logs:\n * // 0 after 1s\n * // 1 after 2s\n * // 0 after 3s\n * // 1 after 4s\n * // \"...and it is done!\" also after 4s\n * ```\n *\n * @see {@link concatAll}\n * @see {@link concatMap}\n * @see {@link concatMapTo}\n *\n * @param {ObservableInput} input1 An input Observable to concatenate with others.\n * @param {ObservableInput} input2 An input Observable to concatenate with others.\n * More than one input Observables may be given as argument.\n * @param {SchedulerLike} [scheduler=null] An optional {@link SchedulerLike} to schedule each\n * Observable subscription on.\n * @return {Observable} All values of each passed Observable merged into a\n * single Observable, in order, in serial fashion.\n * @static true\n * @name concat\n * @owner Observable\n */\nexport function concat<O extends ObservableInput<any>, R>(...observables: Array<O | SchedulerLike>): Observable<ObservedValueOf<O> | R> {\n  return concatAll<R>()(of(...observables));\n}\n","import { Observable } from '../Observable';\nimport { SubscribableOrPromise, ObservedValueOf, ObservableInput } from '../types';\nimport { from } from './from'; // lol\nimport { empty } from './empty';\n\n/**\n * Creates an Observable that, on subscribe, calls an Observable factory to\n * make an Observable for each new Observer.\n *\n * <span class=\"informal\">Creates the Observable lazily, that is, only when it\n * is subscribed.\n * </span>\n *\n * ![](defer.png)\n *\n * `defer` allows you to create the Observable only when the Observer\n * subscribes, and create a fresh Observable for each Observer. It waits until\n * an Observer subscribes to it, and then it generates an Observable,\n * typically with an Observable factory function. It does this afresh for each\n * subscriber, so although each subscriber may think it is subscribing to the\n * same Observable, in fact each subscriber gets its own individual\n * Observable.\n *\n * ## Example\n * ### Subscribe to either an Observable of clicks or an Observable of interval, at random\n * ```ts\n * import { defer, fromEvent, interval } from 'rxjs';\n *\n * const clicksOrInterval = defer(function () {\n *   return Math.random() > 0.5\n *     ? fromEvent(document, 'click')\n *     : interval(1000);\n * });\n * clicksOrInterval.subscribe(x => console.log(x));\n *\n * // Results in the following behavior:\n * // If the result of Math.random() is greater than 0.5 it will listen\n * // for clicks anywhere on the \"document\"; when document is clicked it\n * // will log a MouseEvent object to the console. If the result is less\n * // than 0.5 it will emit ascending numbers, one every second(1000ms).\n * ```\n *\n * @see {@link Observable}\n *\n * @param {function(): SubscribableOrPromise} observableFactory The Observable\n * factory function to invoke for each Observer that subscribes to the output\n * Observable. May also return a Promise, which will be converted on the fly\n * to an Observable.\n * @return {Observable} An Observable whose Observers' subscriptions trigger\n * an invocation of the given Observable factory function.\n * @static true\n * @name defer\n * @owner Observable\n */\nexport function defer<R extends ObservableInput<any> | void>(observableFactory: () => R): Observable<ObservedValueOf<R>> {\n  return new Observable<ObservedValueOf<R>>(subscriber => {\n    let input: R | void;\n    try {\n      input = observableFactory();\n    } catch (err) {\n      subscriber.error(err);\n      return undefined;\n    }\n    const source = input ? from(input as ObservableInput<ObservedValueOf<R>>) : empty();\n    return source.subscribe(subscriber);\n  });\n}\n","import { Observable } from '../Observable';\nimport { ObservableInput, ObservedValuesFromArray, ObservedValueOf, SubscribableOrPromise } from '../types';\nimport { isArray } from '../util/isArray';\nimport { map } from '../operators/map';\nimport { isObject } from '../util/isObject';\nimport { isObservable } from '../util/isObservable';\nimport { from } from './from';\n\n/* tslint:disable:max-line-length */\n\n// forkJoin(a$, b$, c$)\n/** @deprecated Use the version that takes an array of Observables instead */\nexport function forkJoin<T>(v1: SubscribableOrPromise<T>): Observable<[T]>;\n/** @deprecated Use the version that takes an array of Observables instead */\nexport function forkJoin<T, T2>(v1: ObservableInput<T>, v2: ObservableInput<T2>): Observable<[T, T2]>;\n/** @deprecated Use the version that takes an array of Observables instead */\nexport function forkJoin<T, T2, T3>(v1: ObservableInput<T>, v2: ObservableInput<T2>, v3: ObservableInput<T3>): Observable<[T, T2, T3]>;\n/** @deprecated Use the version that takes an array of Observables instead */\nexport function forkJoin<T, T2, T3, T4>(v1: ObservableInput<T>, v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>): Observable<[T, T2, T3, T4]>;\n/** @deprecated Use the version that takes an array of Observables instead */\nexport function forkJoin<T, T2, T3, T4, T5>(v1: ObservableInput<T>, v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>): Observable<[T, T2, T3, T4, T5]>;\n/** @deprecated Use the version that takes an array of Observables instead */\nexport function forkJoin<T, T2, T3, T4, T5, T6>(v1: ObservableInput<T>, v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, v6: ObservableInput<T6>): Observable<[T, T2, T3, T4, T5, T6]>;\n\n// forkJoin([a$, b$, c$]);\n// TODO(benlesh): Uncomment for TS 3.0\n// export function forkJoin(sources: []): Observable<never>;\nexport function forkJoin<A>(sources: [ObservableInput<A>]): Observable<[A]>;\nexport function forkJoin<A, B>(sources: [ObservableInput<A>, ObservableInput<B>]): Observable<[A, B]>;\nexport function forkJoin<A, B, C>(sources: [ObservableInput<A>, ObservableInput<B>, ObservableInput<C>]): Observable<[A, B, C]>;\nexport function forkJoin<A, B, C, D>(sources: [ObservableInput<A>, ObservableInput<B>, ObservableInput<C>, ObservableInput<D>]): Observable<[A, B, C, D]>;\nexport function forkJoin<A, B, C, D, E>(sources: [ObservableInput<A>, ObservableInput<B>, ObservableInput<C>, ObservableInput<D>, ObservableInput<E>]): Observable<[A, B, C, D, E]>;\nexport function forkJoin<A, B, C, D, E, F>(sources: [ObservableInput<A>, ObservableInput<B>, ObservableInput<C>, ObservableInput<D>, ObservableInput<E>, ObservableInput<F>]): Observable<[A, B, C, D, E, F]>;\nexport function forkJoin<A extends ObservableInput<any>[]>(sources: A): Observable<ObservedValuesFromArray<A>[]>;\n\n// forkJoin({})\nexport function forkJoin(sourcesObject: {}): Observable<never>;\nexport function forkJoin<T, K extends keyof T>(sourcesObject: T): Observable<{ [K in keyof T]: ObservedValueOf<T[K]> }>;\n\n/** @deprecated resultSelector is deprecated, pipe to map instead */\nexport function forkJoin(...args: Array<ObservableInput<any>|Function>): Observable<any>;\n/** @deprecated Use the version that takes an array of Observables instead */\nexport function forkJoin<T>(...sources: ObservableInput<T>[]): Observable<T[]>;\n/* tslint:enable:max-line-length */\n\n/**\n * Accepts an `Array` of {@link ObservableInput} or a dictionary `Object` of {@link ObservableInput} and returns\n * an {@link Observable} that emits either an array of values in the exact same order as the passed array,\n * or a dictionary of values in the same shape as the passed dictionary.\n *\n * <span class=\"informal\">Wait for Observables to complete and then combine last values they emitted.</span>\n *\n * ![](forkJoin.png)\n *\n * `forkJoin` is an operator that takes any number of input observables which can be passed either as an array\n * or a dictionary of input observables. If no input observables are provided, resulting stream will complete\n * immediately.\n *\n * `forkJoin` will wait for all passed observables to complete and then it will emit an array or an object with last\n * values from corresponding observables.\n *\n * If you pass an array of `n` observables to the operator, resulting\n * array will have `n` values, where first value is the last thing emitted by the first observable,\n * second value is the last thing emitted by the second observable and so on.\n *\n * If you pass a dictionary of observables to the operator, resulting\n * objects will have the same keys as the dictionary passed, with their last values they've emitted\n * located at the corresponding key.\n *\n * That means `forkJoin` will not emit more than once and it will complete after that. If you need to emit combined\n * values not only at the end of lifecycle of passed observables, but also throughout it, try out {@link combineLatest}\n * or {@link zip} instead.\n *\n * In order for resulting array to have the same length as the number of input observables, whenever any of\n * that observables completes without emitting any value, `forkJoin` will complete at that moment as well\n * and it will not emit anything either, even if it already has some last values from other observables.\n * Conversely, if there is an observable that never completes, `forkJoin` will never complete as well,\n * unless at any point some other observable completes without emitting value, which brings us back to\n * the previous case. Overall, in order for `forkJoin` to emit a value, all observables passed as arguments\n * have to emit something at least once and complete.\n *\n * If any input observable errors at some point, `forkJoin` will error as well and all other observables\n * will be immediately unsubscribed.\n *\n * Optionally `forkJoin` accepts project function, that will be called with values which normally\n * would land in emitted array. Whatever is returned by project function, will appear in output\n * observable instead. This means that default project can be thought of as a function that takes\n * all its arguments and puts them into an array. Note that project function will be called only\n * when output observable is supposed to emit a result.\n *\n * ## Examples\n *\n * ### Use forkJoin with a dictionary of observable inputs\n * ```ts\n * import { forkJoin, of, timer } from 'rxjs';\n *\n * const observable = forkJoin({\n *   foo: of(1, 2, 3, 4),\n *   bar: Promise.resolve(8),\n *   baz: timer(4000),\n * });\n * observable.subscribe({\n *  next: value => console.log(value),\n *  complete: () => console.log('This is how it ends!'),\n * });\n *\n * // Logs:\n * // { foo: 4, bar: 8, baz: 0 } after 4 seconds\n * // \"This is how it ends!\" immediately after\n * ```\n *\n * ### Use forkJoin with an array of observable inputs\n * ```ts\n * import { forkJoin, of } from 'rxjs';\n *\n * const observable = forkJoin([\n *   of(1, 2, 3, 4),\n *   Promise.resolve(8),\n *   timer(4000),\n * ]);\n * observable.subscribe({\n *  next: value => console.log(value),\n *  complete: () => console.log('This is how it ends!'),\n * });\n *\n * // Logs:\n * // [4, 8, 0] after 4 seconds\n * // \"This is how it ends!\" immediately after\n * ```\n *\n * @see {@link combineLatest}\n * @see {@link zip}\n *\n * @param {...ObservableInput} sources Any number of Observables provided either as an array or as an arguments\n * passed directly to the operator.\n * @param {function} [project] Function that takes values emitted by input Observables and returns value\n * that will appear in resulting Observable instead of default array.\n * @return {Observable} Observable emitting either an array of last values emitted by passed Observables\n * or value from project function.\n */\nexport function forkJoin(\n  ...sources: any[]\n): Observable<any> {\n  if (sources.length === 1) {\n    const first = sources[0];\n    if (isArray(first)) {\n      return forkJoinInternal(first, null);\n    }\n    // TODO(benlesh): isObservable check will not be necessary when deprecated path is removed.\n    if (isObject(first) && Object.getPrototypeOf(first) === Object.prototype) {\n      const keys = Object.keys(first);\n      return forkJoinInternal(keys.map(key => first[key]), keys);\n    }\n  }\n\n  // DEPRECATED PATHS BELOW HERE\n  if (typeof sources[sources.length - 1] === 'function') {\n    const resultSelector = sources.pop() as Function;\n    sources = (sources.length === 1 && isArray(sources[0])) ? sources[0] : sources;\n    return forkJoinInternal(sources, null).pipe(\n      map((args: any[]) => resultSelector(...args))\n    );\n  }\n\n  return forkJoinInternal(sources, null);\n}\n\nfunction forkJoinInternal(sources: ObservableInput<any>[], keys: string[] | null): Observable<any> {\n  return new Observable(subscriber => {\n    const len = sources.length;\n    if (len === 0) {\n      subscriber.complete();\n      return;\n    }\n    const values = new Array(len);\n    let completed = 0;\n    let emitted = 0;\n    for (let i = 0; i < len; i++) {\n      const source = from(sources[i]);\n      let hasValue = false;\n      subscriber.add(source.subscribe({\n        next: value => {\n          if (!hasValue) {\n            hasValue = true;\n            emitted++;\n          }\n          values[i] = value;\n        },\n        error: err => subscriber.error(err),\n        complete: () => {\n          completed++;\n          if (completed === len || !hasValue) {\n            if (emitted === len) {\n              subscriber.next(keys ?\n                keys.reduce((result, key, i) => (result[key] = values[i], result), {}) :\n                values);\n            }\n            subscriber.complete();\n          }\n        }\n      }));\n    }\n  });\n}\n","import { Observable } from '../Observable';\nimport { isArray } from '../util/isArray';\nimport { isFunction } from '../util/isFunction';\nimport { Subscriber } from '../Subscriber';\nimport { map } from '../operators/map';\n\nconst toString: Function = (() => Object.prototype.toString)();\n\nexport interface NodeStyleEventEmitter {\n  addListener: (eventName: string | symbol, handler: NodeEventHandler) => this;\n  removeListener: (eventName: string | symbol, handler: NodeEventHandler) => this;\n}\n\nexport type NodeEventHandler = (...args: any[]) => void;\n\n// For APIs that implement `addListener` and `removeListener` methods that may\n// not use the same arguments or return EventEmitter values\n// such as React Native\nexport interface NodeCompatibleEventEmitter {\n  addListener: (eventName: string, handler: NodeEventHandler) => void | {};\n  removeListener: (eventName: string, handler: NodeEventHandler) => void | {};\n}\n\nexport interface JQueryStyleEventEmitter {\n  on: (eventName: string, handler: Function) => void;\n  off: (eventName: string, handler: Function) => void;\n}\n\nexport interface HasEventTargetAddRemove<E> {\n  addEventListener(type: string, listener: ((evt: E) => void) | null, options?: boolean | AddEventListenerOptions): void;\n  removeEventListener(type: string, listener?: ((evt: E) => void) | null, options?: EventListenerOptions | boolean): void;\n}\n\nexport type EventTargetLike<T> = HasEventTargetAddRemove<T> | NodeStyleEventEmitter | NodeCompatibleEventEmitter | JQueryStyleEventEmitter;\n\nexport type FromEventTarget<T> = EventTargetLike<T> | ArrayLike<EventTargetLike<T>>;\n\nexport interface EventListenerOptions {\n  capture?: boolean;\n  passive?: boolean;\n  once?: boolean;\n}\n\nexport interface AddEventListenerOptions extends EventListenerOptions {\n  once?: boolean;\n  passive?: boolean;\n}\n\n/* tslint:disable:max-line-length */\nexport function fromEvent<T>(target: FromEventTarget<T>, eventName: string): Observable<T>;\n/** @deprecated resultSelector no longer supported, pipe to map instead */\nexport function fromEvent<T>(target: FromEventTarget<T>, eventName: string, resultSelector: (...args: any[]) => T): Observable<T>;\nexport function fromEvent<T>(target: FromEventTarget<T>, eventName: string, options: EventListenerOptions): Observable<T>;\n/** @deprecated resultSelector no longer supported, pipe to map instead */\nexport function fromEvent<T>(target: FromEventTarget<T>, eventName: string, options: EventListenerOptions, resultSelector: (...args: any[]) => T): Observable<T>;\n/* tslint:enable:max-line-length */\n\n/**\n * Creates an Observable that emits events of a specific type coming from the\n * given event target.\n *\n * <span class=\"informal\">Creates an Observable from DOM events, or Node.js\n * EventEmitter events or others.</span>\n *\n * ![](fromEvent.png)\n *\n * `fromEvent` accepts as a first argument event target, which is an object with methods\n * for registering event handler functions. As a second argument it takes string that indicates\n * type of event we want to listen for. `fromEvent` supports selected types of event targets,\n * which are described in detail below. If your event target does not match any of the ones listed,\n * you should use {@link fromEventPattern}, which can be used on arbitrary APIs.\n * When it comes to APIs supported by `fromEvent`, their methods for adding and removing event\n * handler functions have different names, but they all accept a string describing event type\n * and function itself, which will be called whenever said event happens.\n *\n * Every time resulting Observable is subscribed, event handler function will be registered\n * to event target on given event type. When that event fires, value\n * passed as a first argument to registered function will be emitted by output Observable.\n * When Observable is unsubscribed, function will be unregistered from event target.\n *\n * Note that if event target calls registered function with more than one argument, second\n * and following arguments will not appear in resulting stream. In order to get access to them,\n * you can pass to `fromEvent` optional project function, which will be called with all arguments\n * passed to event handler. Output Observable will then emit value returned by project function,\n * instead of the usual value.\n *\n * Remember that event targets listed below are checked via duck typing. It means that\n * no matter what kind of object you have and no matter what environment you work in,\n * you can safely use `fromEvent` on that object if it exposes described methods (provided\n * of course they behave as was described above). So for example if Node.js library exposes\n * event target which has the same method names as DOM EventTarget, `fromEvent` is still\n * a good choice.\n *\n * If the API you use is more callback then event handler oriented (subscribed\n * callback function fires only once and thus there is no need to manually\n * unregister it), you should use {@link bindCallback} or {@link bindNodeCallback}\n * instead.\n *\n * `fromEvent` supports following types of event targets:\n *\n * **DOM EventTarget**\n *\n * This is an object with `addEventListener` and `removeEventListener` methods.\n *\n * In the browser, `addEventListener` accepts - apart from event type string and event\n * handler function arguments - optional third parameter, which is either an object or boolean,\n * both used for additional configuration how and when passed function will be called. When\n * `fromEvent` is used with event target of that type, you can provide this values\n * as third parameter as well.\n *\n * **Node.js EventEmitter**\n *\n * An object with `addListener` and `removeListener` methods.\n *\n * **JQuery-style event target**\n *\n * An object with `on` and `off` methods\n *\n * **DOM NodeList**\n *\n * List of DOM Nodes, returned for example by `document.querySelectorAll` or `Node.childNodes`.\n *\n * Although this collection is not event target in itself, `fromEvent` will iterate over all Nodes\n * it contains and install event handler function in every of them. When returned Observable\n * is unsubscribed, function will be removed from all Nodes.\n *\n * **DOM HtmlCollection**\n *\n * Just as in case of NodeList it is a collection of DOM nodes. Here as well event handler function is\n * installed and removed in each of elements.\n *\n *\n * ## Examples\n * ### Emits clicks happening on the DOM document\n * ```ts\n * import { fromEvent } from 'rxjs';\n *\n * const clicks = fromEvent(document, 'click');\n * clicks.subscribe(x => console.log(x));\n *\n * // Results in:\n * // MouseEvent object logged to console every time a click\n * // occurs on the document.\n * ```\n *\n * ### Use addEventListener with capture option\n * ```ts\n * import { fromEvent } from 'rxjs';\n *\n * const clicksInDocument = fromEvent(document, 'click', true); // note optional configuration parameter\n *                                                              // which will be passed to addEventListener\n * const clicksInDiv = fromEvent(someDivInDocument, 'click');\n *\n * clicksInDocument.subscribe(() => console.log('document'));\n * clicksInDiv.subscribe(() => console.log('div'));\n *\n * // By default events bubble UP in DOM tree, so normally\n * // when we would click on div in document\n * // \"div\" would be logged first and then \"document\".\n * // Since we specified optional `capture` option, document\n * // will catch event when it goes DOWN DOM tree, so console\n * // will log \"document\" and then \"div\".\n * ```\n *\n * @see {@link bindCallback}\n * @see {@link bindNodeCallback}\n * @see {@link fromEventPattern}\n *\n * @param {FromEventTarget<T>} target The DOM EventTarget, Node.js\n * EventEmitter, JQuery-like event target, NodeList or HTMLCollection to attach the event handler to.\n * @param {string} eventName The event name of interest, being emitted by the\n * `target`.\n * @param {EventListenerOptions} [options] Options to pass through to addEventListener\n * @return {Observable<T>}\n * @name fromEvent\n */\nexport function fromEvent<T>(\n  target: FromEventTarget<T>,\n  eventName: string,\n  options?: EventListenerOptions | ((...args: any[]) => T),\n  resultSelector?: ((...args: any[]) => T)\n): Observable<T> {\n\n  if (isFunction(options)) {\n    // DEPRECATED PATH\n    resultSelector = options;\n    options = undefined;\n  }\n  if (resultSelector) {\n    // DEPRECATED PATH\n    return fromEvent<T>(target, eventName, <EventListenerOptions | undefined>options).pipe(\n      map(args => isArray(args) ? resultSelector(...args) : resultSelector(args))\n    );\n  }\n\n  return new Observable<T>(subscriber => {\n    function handler(e: T) {\n      if (arguments.length > 1) {\n        subscriber.next(Array.prototype.slice.call(arguments));\n      } else {\n        subscriber.next(e);\n      }\n    }\n    setupSubscription(target, eventName, handler, subscriber, options as EventListenerOptions);\n  });\n}\n\nfunction setupSubscription<T>(sourceObj: FromEventTarget<T>, eventName: string,\n                              handler: (...args: any[]) => void, subscriber: Subscriber<T>,\n                              options?: EventListenerOptions) {\n  let unsubscribe: () => void;\n  if (isEventTarget(sourceObj)) {\n    const source = sourceObj;\n    sourceObj.addEventListener(eventName, handler, options);\n    unsubscribe = () => source.removeEventListener(eventName, handler, options);\n  } else if (isJQueryStyleEventEmitter(sourceObj)) {\n    const source = sourceObj;\n    sourceObj.on(eventName, handler);\n    unsubscribe = () => source.off(eventName, handler);\n  } else if (isNodeStyleEventEmitter(sourceObj)) {\n    const source = sourceObj;\n    sourceObj.addListener(eventName, handler as NodeEventHandler);\n    unsubscribe = () => source.removeListener(eventName, handler as NodeEventHandler);\n  } else if (sourceObj && (sourceObj as any).length) {\n    for (let i = 0, len = (sourceObj as any).length; i < len; i++) {\n      setupSubscription(sourceObj[i], eventName, handler, subscriber, options);\n    }\n  } else {\n    throw new TypeError('Invalid event target');\n  }\n\n  subscriber.add(unsubscribe);\n}\n\nfunction isNodeStyleEventEmitter(sourceObj: any): sourceObj is NodeStyleEventEmitter {\n  return sourceObj && typeof sourceObj.addListener === 'function' && typeof sourceObj.removeListener === 'function';\n}\n\nfunction isJQueryStyleEventEmitter(sourceObj: any): sourceObj is JQueryStyleEventEmitter {\n  return sourceObj && typeof sourceObj.on === 'function' && typeof sourceObj.off === 'function';\n}\n\nfunction isEventTarget(sourceObj: any): sourceObj is HasEventTargetAddRemove<any> {\n  return sourceObj && typeof sourceObj.addEventListener === 'function' && typeof sourceObj.removeEventListener === 'function';\n}\n","import { Observable } from '../Observable';\nimport { isArray } from '../util/isArray';\nimport { isFunction } from '../util/isFunction';\nimport { NodeEventHandler } from './fromEvent';\nimport { map } from '../operators/map';\n\n/* tslint:disable:max-line-length */\nexport function fromEventPattern<T>(addHandler: (handler: NodeEventHandler) => any, removeHandler?: (handler: NodeEventHandler, signal?: any) => void): Observable<T>;\n/** @deprecated resultSelector no longer supported, pipe to map instead */\nexport function fromEventPattern<T>(addHandler: (handler: NodeEventHandler) => any, removeHandler?: (handler: NodeEventHandler, signal?: any) => void, resultSelector?: (...args: any[]) => T): Observable<T>;\n/* tslint:enable:max-line-length */\n\n/**\n * Creates an Observable from an arbitrary API for registering event handlers.\n *\n * <span class=\"informal\">When that method for adding event handler was something {@link fromEvent}\n * was not prepared for.</span>\n *\n * ![](fromEventPattern.png)\n *\n * `fromEventPattern` allows you to convert into an Observable any API that supports registering handler functions\n * for events. It is similar to {@link fromEvent}, but far\n * more flexible. In fact, all use cases of {@link fromEvent} could be easily handled by\n * `fromEventPattern` (although in slightly more verbose way).\n *\n * This operator accepts as a first argument an `addHandler` function, which will be injected with\n * handler parameter. That handler is actually an event handler function that you now can pass\n * to API expecting it. `addHandler` will be called whenever Observable\n * returned by the operator is subscribed, so registering handler in API will not\n * necessarily happen when `fromEventPattern` is called.\n *\n * After registration, every time an event that we listen to happens,\n * Observable returned by `fromEventPattern` will emit value that event handler\n * function was called with. Note that if event handler was called with more\n * then one argument, second and following arguments will not appear in the Observable.\n *\n * If API you are using allows to unregister event handlers as well, you can pass to `fromEventPattern`\n * another function - `removeHandler` - as a second parameter. It will be injected\n * with the same handler function as before, which now you can use to unregister\n * it from the API. `removeHandler` will be called when consumer of resulting Observable\n * unsubscribes from it.\n *\n * In some APIs unregistering is actually handled differently. Method registering an event handler\n * returns some kind of token, which is later used to identify which function should\n * be unregistered or it itself has method that unregisters event handler.\n * If that is the case with your API, make sure token returned\n * by registering method is returned by `addHandler`. Then it will be passed\n * as a second argument to `removeHandler`, where you will be able to use it.\n *\n * If you need access to all event handler parameters (not only the first one),\n * or you need to transform them in any way, you can call `fromEventPattern` with optional\n * third parameter - project function which will accept all arguments passed to\n * event handler when it is called. Whatever is returned from project function will appear on\n * resulting stream instead of usual event handlers first argument. This means\n * that default project can be thought of as function that takes its first parameter\n * and ignores the rest.\n *\n * ## Example\n * ### Emits clicks happening on the DOM document\n *\n * ```ts\n * import { fromEventPattern } from 'rxjs';\n *\n * function addClickHandler(handler) {\n *   document.addEventListener('click', handler);\n * }\n *\n * function removeClickHandler(handler) {\n *   document.removeEventListener('click', handler);\n * }\n *\n * const clicks = fromEventPattern(\n *   addClickHandler,\n *   removeClickHandler\n * );\n * clicks.subscribe(x => console.log(x));\n *\n * // Whenever you click anywhere in the browser, DOM MouseEvent\n * // object will be logged.\n * ```\n *\n * ## Example\n * ### Use with API that returns cancellation token\n *\n * ```ts\n * import { fromEventPattern } from 'rxjs';\n *\n * const token = someAPI.registerEventHandler(function() {});\n * someAPI.unregisterEventHandler(token); // this APIs cancellation method accepts\n *                                        // not handler itself, but special token.\n *\n * const someAPIObservable = fromEventPattern(\n *   function(handler) { return someAPI.registerEventHandler(handler); }, // Note that we return the token here...\n *   function(handler, token) { someAPI.unregisterEventHandler(token); }  // ...to then use it here.\n * );\n * ```\n *\n * ## Example\n * ### Use with project function\n *\n * ```ts\n * import { fromEventPattern } from 'rxjs';\n *\n * someAPI.registerEventHandler((eventType, eventMessage) => {\n *   console.log(eventType, eventMessage); // Logs \"EVENT_TYPE\" \"EVENT_MESSAGE\" to console.\n * });\n *\n * const someAPIObservable = fromEventPattern(\n *   handler => someAPI.registerEventHandler(handler),\n *   handler => someAPI.unregisterEventHandler(handler)\n *   (eventType, eventMessage) => eventType + \" --- \" + eventMessage // without that function only \"EVENT_TYPE\"\n * );                                                                // would be emitted by the Observable\n *\n * someAPIObservable.subscribe(value => console.log(value));\n *\n * // Logs:\n * // \"EVENT_TYPE --- EVENT_MESSAGE\"\n * ```\n *\n * @see {@link fromEvent}\n * @see {@link bindCallback}\n * @see {@link bindNodeCallback}\n *\n * @param {function(handler: Function): any} addHandler A function that takes\n * a `handler` function as argument and attaches it somehow to the actual\n * source of events.\n * @param {function(handler: Function, token?: any): void} [removeHandler] A function that\n * takes a `handler` function as an argument and removes it from the event source. If `addHandler`\n * returns some kind of token, `removeHandler` function will have it as a second parameter.\n * @param {function(...args: any): T} [project] A function to\n * transform results. It takes the arguments from the event handler and\n * should return a single value.\n * @return {Observable<T>} Observable which, when an event happens, emits first parameter\n * passed to registered event handler. Alternatively it emits whatever project function returns\n * at that moment.\n * @static true\n * @name fromEventPattern\n * @owner Observable\n */\n\nexport function fromEventPattern<T>(addHandler: (handler: NodeEventHandler) => any,\n                                    removeHandler?: (handler: NodeEventHandler, signal?: any) => void,\n                                    resultSelector?: (...args: any[]) => T): Observable<T | T[]> {\n\n  if (resultSelector) {\n    // DEPRECATED PATH\n    return fromEventPattern<T>(addHandler, removeHandler).pipe(\n      map(args => isArray(args) ? resultSelector(...args) : resultSelector(args))\n    );\n  }\n\n  return new Observable<T | T[]>(subscriber => {\n    const handler = (...e: T[]) => subscriber.next(e.length === 1 ? e[0] : e);\n\n    let retValue: any;\n    try {\n      retValue = addHandler(handler);\n    } catch (err) {\n      subscriber.error(err);\n      return undefined;\n    }\n\n    if (!isFunction(removeHandler)) {\n      return undefined;\n    }\n\n    return () => removeHandler(handler, retValue) ;\n  });\n}\n","import { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { identity } from '../util/identity';\nimport { SchedulerAction, SchedulerLike } from '../types';\nimport { isScheduler } from '../util/isScheduler';\n\nexport type ConditionFunc<S> = (state: S) => boolean;\nexport type IterateFunc<S> = (state: S) => S;\nexport type ResultFunc<S, T> = (state: S) => T;\n\ninterface SchedulerState<T, S> {\n  needIterate?: boolean;\n  state: S;\n  subscriber: Subscriber<T>;\n  condition?: ConditionFunc<S>;\n  iterate: IterateFunc<S>;\n  resultSelector: ResultFunc<S, T>;\n}\n\nexport interface GenerateBaseOptions<S> {\n  /**\n   * Initial state.\n   */\n  initialState: S;\n  /**\n   * Condition function that accepts state and returns boolean.\n   * When it returns false, the generator stops.\n   * If not specified, a generator never stops.\n   */\n  condition?: ConditionFunc<S>;\n  /**\n   * Iterate function that accepts state and returns new state.\n   */\n  iterate: IterateFunc<S>;\n  /**\n   * SchedulerLike to use for generation process.\n   * By default, a generator starts immediately.\n   */\n  scheduler?: SchedulerLike;\n}\n\nexport interface GenerateOptions<T, S> extends GenerateBaseOptions<S> {\n  /**\n   * Result selection function that accepts state and returns a value to emit.\n   */\n  resultSelector: ResultFunc<S, T>;\n}\n\n/**\n * Generates an observable sequence by running a state-driven loop\n * producing the sequence's elements, using the specified scheduler\n * to send out observer messages.\n *\n * ![](generate.png)\n *\n * @example <caption>Produces sequence of 0, 1, 2, ... 9, then completes.</caption>\n * const res = generate(0, x => x < 10, x => x + 1, x => x);\n *\n * @example <caption>Using asap scheduler, produces sequence of 2, 3, 5, then completes.</caption>\n * const res = generate(1, x => x < 5, x => x * 2, x => x + 1, asap);\n *\n * @see {@link from}\n * @see {@link Observable}\n *\n * @param {S} initialState Initial state.\n * @param {function (state: S): boolean} condition Condition to terminate generation (upon returning false).\n * @param {function (state: S): S} iterate Iteration step function.\n * @param {function (state: S): T} resultSelector Selector function for results produced in the sequence. (deprecated)\n * @param {SchedulerLike} [scheduler] A {@link SchedulerLike} on which to run the generator loop. If not provided, defaults to emit immediately.\n * @returns {Observable<T>} The generated sequence.\n */\n  export function generate<T, S>(initialState: S,\n                                 condition: ConditionFunc<S>,\n                                 iterate: IterateFunc<S>,\n                                 resultSelector: ResultFunc<S, T>,\n                                 scheduler?: SchedulerLike): Observable<T>;\n\n/**\n * Generates an Observable by running a state-driven loop\n * that emits an element on each iteration.\n *\n * <span class=\"informal\">Use it instead of nexting values in a for loop.</span>\n *\n * <img src=\"./img/generate.png\" width=\"100%\">\n *\n * `generate` allows you to create stream of values generated with a loop very similar to\n * traditional for loop. First argument of `generate` is a beginning value. Second argument\n * is a function that accepts this value and tests if some condition still holds. If it does,\n * loop continues, if not, it stops. Third value is a function which takes previously defined\n * value and modifies it in some way on each iteration. Note how these three parameters\n * are direct equivalents of three expressions in regular for loop: first expression\n * initializes some state (for example numeric index), second tests if loop can make next\n * iteration (for example if index is lower than 10) and third states how defined value\n * will be modified on every step (index will be incremented by one).\n *\n * Return value of a `generate` operator is an Observable that on each loop iteration\n * emits a value. First, condition function is ran. If it returned true, Observable\n * emits currently stored value (initial value at the first iteration) and then updates\n * that value with iterate function. If at some point condition returned false, Observable\n * completes at that moment.\n *\n * Optionally you can pass fourth parameter to `generate` - a result selector function which allows you\n * to immediately map value that would normally be emitted by an Observable.\n *\n * If you find three anonymous functions in `generate` call hard to read, you can provide\n * single object to the operator instead. That object has properties: `initialState`,\n * `condition`, `iterate` and `resultSelector`, which should have respective values that you\n * would normally pass to `generate`. `resultSelector` is still optional, but that form\n * of calling `generate` allows you to omit `condition` as well. If you omit it, that means\n * condition always holds, so output Observable will never complete.\n *\n * Both forms of `generate` can optionally accept a scheduler. In case of multi-parameter call,\n * scheduler simply comes as a last argument (no matter if there is resultSelector\n * function or not). In case of single-parameter call, you can provide it as a\n * `scheduler` property on object passed to the operator. In both cases scheduler decides when\n * next iteration of the loop will happen and therefore when next value will be emitted\n * by the Observable. For example to ensure that each value is pushed to the observer\n * on separate task in event loop, you could use `async` scheduler. Note that\n * by default (when no scheduler is passed) values are simply emitted synchronously.\n *\n *\n * @example <caption>Use with condition and iterate functions.</caption>\n * const generated = generate(0, x => x < 3, x => x + 1);\n *\n * generated.subscribe(\n *   value => console.log(value),\n *   err => {},\n *   () => console.log('Yo!')\n * );\n *\n * // Logs:\n * // 0\n * // 1\n * // 2\n * // \"Yo!\"\n *\n *\n * @example <caption>Use with condition, iterate and resultSelector functions.</caption>\n * const generated = generate(0, x => x < 3, x => x + 1, x => x * 1000);\n *\n * generated.subscribe(\n *   value => console.log(value),\n *   err => {},\n *   () => console.log('Yo!')\n * );\n *\n * // Logs:\n * // 0\n * // 1000\n * // 2000\n * // \"Yo!\"\n *\n *\n * @example <caption>Use with options object.</caption>\n * const generated = generate({\n *   initialState: 0,\n *   condition(value) { return value < 3; },\n *   iterate(value) { return value + 1; },\n *   resultSelector(value) { return value * 1000; }\n * });\n *\n * generated.subscribe(\n *   value => console.log(value),\n *   err => {},\n *   () => console.log('Yo!')\n * );\n *\n * // Logs:\n * // 0\n * // 1000\n * // 2000\n * // \"Yo!\"\n *\n * @example <caption>Use options object without condition function.</caption>\n * const generated = generate({\n *   initialState: 0,\n *   iterate(value) { return value + 1; },\n *   resultSelector(value) { return value * 1000; }\n * });\n *\n * generated.subscribe(\n *   value => console.log(value),\n *   err => {},\n *   () => console.log('Yo!') // This will never run.\n * );\n *\n * // Logs:\n * // 0\n * // 1000\n * // 2000\n * // 3000\n * // ...and never stops.\n *\n *\n * @see {@link from}\n * @see {@link index/Observable.create}\n *\n * @param {S} initialState Initial state.\n * @param {function (state: S): boolean} condition Condition to terminate generation (upon returning false).\n * @param {function (state: S): S} iterate Iteration step function.\n * @param {function (state: S): T} [resultSelector] Selector function for results produced in the sequence.\n * @param {Scheduler} [scheduler] A {@link Scheduler} on which to run the generator loop. If not provided, defaults to emitting immediately.\n * @return {Observable<T>} The generated sequence.\n */\nexport function generate<S>(initialState: S,\n                            condition: ConditionFunc<S>,\n                            iterate: IterateFunc<S>,\n                            scheduler?: SchedulerLike): Observable<S>;\n\n/**\n * Generates an observable sequence by running a state-driven loop\n * producing the sequence's elements, using the specified scheduler\n * to send out observer messages.\n * The overload accepts options object that might contain initial state, iterate,\n * condition and scheduler.\n *\n * ![](generate.png)\n *\n * @example <caption>Produces sequence of 0, 1, 2, ... 9, then completes.</caption>\n * const res = generate({\n *   initialState: 0,\n *   condition: x => x < 10,\n *   iterate: x => x + 1,\n * });\n *\n * @see {@link from}\n * @see {@link Observable}\n *\n * @param {GenerateBaseOptions<S>} options Object that must contain initialState, iterate and might contain condition and scheduler.\n * @returns {Observable<S>} The generated sequence.\n */\nexport function generate<S>(options: GenerateBaseOptions<S>): Observable<S>;\n\n/**\n * Generates an observable sequence by running a state-driven loop\n * producing the sequence's elements, using the specified scheduler\n * to send out observer messages.\n * The overload accepts options object that might contain initial state, iterate,\n * condition, result selector and scheduler.\n *\n * ![](generate.png)\n *\n * @example <caption>Produces sequence of 0, 1, 2, ... 9, then completes.</caption>\n * const res = generate({\n *   initialState: 0,\n *   condition: x => x < 10,\n *   iterate: x => x + 1,\n *   resultSelector: x => x,\n * });\n *\n * @see {@link from}\n * @see {@link Observable}\n *\n * @param {GenerateOptions<T, S>} options Object that must contain initialState, iterate, resultSelector and might contain condition and scheduler.\n * @returns {Observable<T>} The generated sequence.\n */\nexport function generate<T, S>(options: GenerateOptions<T, S>): Observable<T>;\n\nexport function generate<T, S>(initialStateOrOptions: S | GenerateOptions<T, S>,\n                               condition?: ConditionFunc<S>,\n                               iterate?: IterateFunc<S>,\n                               resultSelectorOrObservable?: (ResultFunc<S, T>) | SchedulerLike,\n                               scheduler?: SchedulerLike): Observable<T> {\n\n  let resultSelector: ResultFunc<S, T>;\n  let initialState: S;\n\n  if (arguments.length == 1) {\n    const options = initialStateOrOptions as GenerateOptions<T, S>;\n    initialState = options.initialState;\n    condition = options.condition;\n    iterate = options.iterate;\n    resultSelector = options.resultSelector || identity as ResultFunc<S, T>;\n    scheduler = options.scheduler;\n  } else if (resultSelectorOrObservable === undefined || isScheduler(resultSelectorOrObservable)) {\n    initialState = initialStateOrOptions as S;\n    resultSelector = identity as ResultFunc<S, T>;\n    scheduler = resultSelectorOrObservable as SchedulerLike;\n  } else {\n    initialState = initialStateOrOptions as S;\n    resultSelector = resultSelectorOrObservable as ResultFunc<S, T>;\n  }\n\n  return new Observable<T>(subscriber => {\n    let state = initialState;\n    if (scheduler) {\n      return scheduler.schedule<SchedulerState<T, S>>(dispatch, 0, {\n        subscriber,\n        iterate,\n        condition,\n        resultSelector,\n        state\n      });\n    }\n\n    do {\n      if (condition) {\n        let conditionResult: boolean;\n        try {\n          conditionResult = condition(state);\n        } catch (err) {\n          subscriber.error(err);\n          return undefined;\n        }\n        if (!conditionResult) {\n          subscriber.complete();\n          break;\n        }\n      }\n      let value: T;\n      try {\n        value = resultSelector(state);\n      } catch (err) {\n        subscriber.error(err);\n        return undefined;\n      }\n      subscriber.next(value);\n      if (subscriber.closed) {\n        break;\n      }\n      try {\n        state = iterate(state);\n      } catch (err) {\n        subscriber.error(err);\n        return undefined;\n      }\n    } while (true);\n\n    return undefined;\n  });\n}\n\nfunction dispatch<T, S>(this: SchedulerAction<SchedulerState<T, S>>, state: SchedulerState<T, S>) {\n  const { subscriber, condition } = state;\n  if (subscriber.closed) {\n    return undefined;\n  }\n  if (state.needIterate) {\n    try {\n      state.state = state.iterate(state.state);\n    } catch (err) {\n      subscriber.error(err);\n      return undefined;\n    }\n  } else {\n    state.needIterate = true;\n  }\n  if (condition) {\n    let conditionResult: boolean;\n    try {\n      conditionResult = condition(state.state);\n    } catch (err) {\n      subscriber.error(err);\n      return undefined;\n    }\n    if (!conditionResult) {\n      subscriber.complete();\n      return undefined;\n    }\n    if (subscriber.closed) {\n      return undefined;\n    }\n  }\n  let value: T;\n  try {\n    value = state.resultSelector(state.state);\n  } catch (err) {\n    subscriber.error(err);\n    return undefined;\n  }\n  if (subscriber.closed) {\n    return undefined;\n  }\n  subscriber.next(value);\n  if (subscriber.closed) {\n    return undefined;\n  }\n  return this.schedule(state);\n}\n","import { Observable } from '../Observable';\nimport { defer } from './defer';\nimport { EMPTY } from './empty';\nimport { SubscribableOrPromise } from '../types';\n\n/**\n * Decides at subscription time which Observable will actually be subscribed.\n *\n * <span class=\"informal\">`If` statement for Observables.</span>\n *\n * `iif` accepts a condition function and two Observables. When\n * an Observable returned by the operator is subscribed, condition function will be called.\n * Based on what boolean it returns at that moment, consumer will subscribe either to\n * the first Observable (if condition was true) or to the second (if condition was false). Condition\n * function may also not return anything - in that case condition will be evaluated as false and\n * second Observable will be subscribed.\n *\n * Note that Observables for both cases (true and false) are optional. If condition points to an Observable that\n * was left undefined, resulting stream will simply complete immediately. That allows you to, rather\n * than controlling which Observable will be subscribed, decide at runtime if consumer should have access\n * to given Observable or not.\n *\n * If you have more complex logic that requires decision between more than two Observables, {@link defer}\n * will probably be a better choice. Actually `iif` can be easily implemented with {@link defer}\n * and exists only for convenience and readability reasons.\n *\n *\n * ## Examples\n * ### Change at runtime which Observable will be subscribed\n * ```ts\n * import { iif, of } from 'rxjs';\n *\n * let subscribeToFirst;\n * const firstOrSecond = iif(\n *   () => subscribeToFirst,\n *   of('first'),\n *   of('second'),\n * );\n *\n * subscribeToFirst = true;\n * firstOrSecond.subscribe(value => console.log(value));\n *\n * // Logs:\n * // \"first\"\n *\n * subscribeToFirst = false;\n * firstOrSecond.subscribe(value => console.log(value));\n *\n * // Logs:\n * // \"second\"\n *\n * ```\n *\n * ### Control an access to an Observable\n * ```ts\n * let accessGranted;\n * const observableIfYouHaveAccess = iif(\n *   () => accessGranted,\n *   of('It seems you have an access...'), // Note that only one Observable is passed to the operator.\n * );\n *\n * accessGranted = true;\n * observableIfYouHaveAccess.subscribe(\n *   value => console.log(value),\n *   err => {},\n *   () => console.log('The end'),\n * );\n *\n * // Logs:\n * // \"It seems you have an access...\"\n * // \"The end\"\n *\n * accessGranted = false;\n * observableIfYouHaveAccess.subscribe(\n *   value => console.log(value),\n *   err => {},\n *   () => console.log('The end'),\n * );\n *\n * // Logs:\n * // \"The end\"\n * ```\n *\n * @see {@link defer}\n *\n * @param {function(): boolean} condition Condition which Observable should be chosen.\n * @param {Observable} [trueObservable] An Observable that will be subscribed if condition is true.\n * @param {Observable} [falseObservable] An Observable that will be subscribed if condition is false.\n * @return {Observable} Either first or second Observable, depending on condition.\n * @static true\n * @name iif\n * @owner Observable\n */\nexport function iif<T, F>(\n  condition: () => boolean,\n  trueResult: SubscribableOrPromise<T> = EMPTY,\n  falseResult: SubscribableOrPromise<F> = EMPTY\n): Observable<T|F> {\n  return defer(() => condition() ? trueResult : falseResult);\n}\n","import { isArray } from './isArray';\n\nexport function isNumeric(val: any): val is number | string {\n  // parseFloat NaNs numeric-cast false positives (null|true|false|\"\")\n  // ...but misinterprets leading-number strings, particularly hex literals (\"0x...\")\n  // subtraction forces infinities to NaN\n  // adding 1 corrects loss of precision from parseFloat (#15100)\n  return !isArray(val) && (val - parseFloat(val) + 1) >= 0;\n}\n","import { Observable } from '../Observable';\nimport { async } from '../scheduler/async';\nimport { SchedulerAction, SchedulerLike } from '../types';\nimport { isNumeric } from '../util/isNumeric';\nimport { Subscriber } from '../Subscriber';\n\n/**\n * Creates an Observable that emits sequential numbers every specified\n * interval of time, on a specified {@link SchedulerLike}.\n *\n * <span class=\"informal\">Emits incremental numbers periodically in time.\n * </span>\n *\n * ![](interval.png)\n *\n * `interval` returns an Observable that emits an infinite sequence of\n * ascending integers, with a constant interval of time of your choosing\n * between those emissions. The first emission is not sent immediately, but\n * only after the first period has passed. By default, this operator uses the\n * `async` {@link SchedulerLike} to provide a notion of time, but you may pass any\n * {@link SchedulerLike} to it.\n *\n * ## Example\n * Emits ascending numbers, one every second (1000ms) up to the number 3\n * ```ts\n * import { interval } from 'rxjs';\n * import { take } from 'rxjs/operators';\n *\n * const numbers = interval(1000);\n *\n * const takeFourNumbers = numbers.pipe(take(4));\n *\n * takeFourNumbers.subscribe(x => console.log('Next: ', x));\n *\n * // Logs:\n * // Next: 0\n * // Next: 1\n * // Next: 2\n * // Next: 3\n * ```\n *\n * @see {@link timer}\n * @see {@link delay}\n *\n * @param {number} [period=0] The interval size in milliseconds (by default)\n * or the time unit determined by the scheduler's clock.\n * @param {SchedulerLike} [scheduler=async] The {@link SchedulerLike} to use for scheduling\n * the emission of values, and providing a notion of \"time\".\n * @return {Observable} An Observable that emits a sequential number each time\n * interval.\n * @static true\n * @name interval\n * @owner Observable\n */\nexport function interval(period = 0,\n                         scheduler: SchedulerLike = async): Observable<number> {\n  if (!isNumeric(period) || period < 0) {\n    period = 0;\n  }\n\n  if (!scheduler || typeof scheduler.schedule !== 'function') {\n    scheduler = async;\n  }\n\n  return new Observable<number>(subscriber => {\n    subscriber.add(\n      scheduler.schedule(dispatch, period, { subscriber, counter: 0, period })\n    );\n    return subscriber;\n  });\n}\n\nfunction dispatch(this: SchedulerAction<IntervalState>, state: IntervalState) {\n  const { subscriber, counter, period } = state;\n  subscriber.next(counter);\n  this.schedule({ subscriber, counter: counter + 1, period }, period);\n}\n\ninterface IntervalState {\n  subscriber: Subscriber<number>;\n  counter: number;\n  period: number;\n}\n","import { Observable } from '../Observable';\nimport { ObservableInput, SchedulerLike} from '../types';\nimport { isScheduler } from '../util/isScheduler';\nimport { mergeAll } from '../operators/mergeAll';\nimport { fromArray } from './fromArray';\n\n/* tslint:disable:max-line-length */\n/** @deprecated use {@link scheduled} and {@link mergeAll} (e.g. `scheduled([ob1, ob2, ob3], scheduled).pipe(mergeAll())*/\nexport function merge<T>(v1: ObservableInput<T>, scheduler: SchedulerLike): Observable<T>;\n/** @deprecated use {@link scheduled} and {@link mergeAll} (e.g. `scheduled([ob1, ob2, ob3], scheduled).pipe(mergeAll())*/\nexport function merge<T>(v1: ObservableInput<T>, concurrent: number, scheduler: SchedulerLike): Observable<T>;\n/** @deprecated use {@link scheduled} and {@link mergeAll} (e.g. `scheduled([ob1, ob2, ob3], scheduled).pipe(mergeAll())*/\nexport function merge<T, T2>(v1: ObservableInput<T>, v2: ObservableInput<T2>, scheduler: SchedulerLike): Observable<T | T2>;\n/** @deprecated use {@link scheduled} and {@link mergeAll} (e.g. `scheduled([ob1, ob2, ob3], scheduled).pipe(mergeAll())*/\nexport function merge<T, T2>(v1: ObservableInput<T>, v2: ObservableInput<T2>, concurrent: number, scheduler: SchedulerLike): Observable<T | T2>;\n/** @deprecated use {@link scheduled} and {@link mergeAll} (e.g. `scheduled([ob1, ob2, ob3], scheduled).pipe(mergeAll())*/\nexport function merge<T, T2, T3>(v1: ObservableInput<T>, v2: ObservableInput<T2>, v3: ObservableInput<T3>, scheduler: SchedulerLike): Observable<T | T2 | T3>;\n/** @deprecated use {@link scheduled} and {@link mergeAll} (e.g. `scheduled([ob1, ob2, ob3], scheduled).pipe(mergeAll())*/\nexport function merge<T, T2, T3>(v1: ObservableInput<T>, v2: ObservableInput<T2>, v3: ObservableInput<T3>, concurrent: number, scheduler: SchedulerLike): Observable<T | T2 | T3>;\n/** @deprecated use {@link scheduled} and {@link mergeAll} (e.g. `scheduled([ob1, ob2, ob3], scheduled).pipe(mergeAll())*/\nexport function merge<T, T2, T3, T4>(v1: ObservableInput<T>, v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, scheduler: SchedulerLike): Observable<T | T2 | T3 | T4>;\n/** @deprecated use {@link scheduled} and {@link mergeAll} (e.g. `scheduled([ob1, ob2, ob3], scheduled).pipe(mergeAll())*/\nexport function merge<T, T2, T3, T4>(v1: ObservableInput<T>, v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, concurrent: number, scheduler: SchedulerLike): Observable<T | T2 | T3 | T4>;\n/** @deprecated use {@link scheduled} and {@link mergeAll} (e.g. `scheduled([ob1, ob2, ob3], scheduled).pipe(mergeAll())*/\nexport function merge<T, T2, T3, T4, T5>(v1: ObservableInput<T>, v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, scheduler: SchedulerLike): Observable<T | T2 | T3 | T4 | T5>;\n/** @deprecated use {@link scheduled} and {@link mergeAll} (e.g. `scheduled([ob1, ob2, ob3], scheduled).pipe(mergeAll())*/\nexport function merge<T, T2, T3, T4, T5>(v1: ObservableInput<T>, v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, concurrent: number, scheduler: SchedulerLike): Observable<T | T2 | T3 | T4 | T5>;\n/** @deprecated use {@link scheduled} and {@link mergeAll} (e.g. `scheduled([ob1, ob2, ob3], scheduled).pipe(mergeAll())*/\nexport function merge<T, T2, T3, T4, T5, T6>(v1: ObservableInput<T>, v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, v6: ObservableInput<T6>, scheduler: SchedulerLike): Observable<T | T2 | T3 | T4 | T5 | T6>;\n/** @deprecated use {@link scheduled} and {@link mergeAll} (e.g. `scheduled([ob1, ob2, ob3], scheduled).pipe(mergeAll())*/\nexport function merge<T, T2, T3, T4, T5, T6>(v1: ObservableInput<T>, v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, v6: ObservableInput<T6>, concurrent: number, scheduler: SchedulerLike): Observable<T | T2 | T3 | T4 | T5 | T6>;\n\nexport function merge<T>(v1: ObservableInput<T>): Observable<T>;\nexport function merge<T>(v1: ObservableInput<T>, concurrent?: number): Observable<T>;\nexport function merge<T, T2>(v1: ObservableInput<T>, v2: ObservableInput<T2>): Observable<T | T2>;\nexport function merge<T, T2>(v1: ObservableInput<T>, v2: ObservableInput<T2>, concurrent?: number): Observable<T | T2>;\nexport function merge<T, T2, T3>(v1: ObservableInput<T>, v2: ObservableInput<T2>, v3: ObservableInput<T3>): Observable<T | T2 | T3>;\nexport function merge<T, T2, T3>(v1: ObservableInput<T>, v2: ObservableInput<T2>, v3: ObservableInput<T3>, concurrent?: number): Observable<T | T2 | T3>;\nexport function merge<T, T2, T3, T4>(v1: ObservableInput<T>, v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>): Observable<T | T2 | T3 | T4>;\nexport function merge<T, T2, T3, T4>(v1: ObservableInput<T>, v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, concurrent?: number): Observable<T | T2 | T3 | T4>;\nexport function merge<T, T2, T3, T4, T5>(v1: ObservableInput<T>, v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>): Observable<T | T2 | T3 | T4 | T5>;\nexport function merge<T, T2, T3, T4, T5>(v1: ObservableInput<T>, v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, concurrent?: number): Observable<T | T2 | T3 | T4 | T5>;\nexport function merge<T, T2, T3, T4, T5, T6>(v1: ObservableInput<T>, v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, v6: ObservableInput<T6>): Observable<T | T2 | T3 | T4 | T5 | T6>;\nexport function merge<T, T2, T3, T4, T5, T6>(v1: ObservableInput<T>, v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, v6: ObservableInput<T6>, concurrent?: number): Observable<T | T2 | T3 | T4 | T5 | T6>;\nexport function merge<T>(...observables: (ObservableInput<T> | number)[]): Observable<T>;\n/** @deprecated use {@link scheduled} and {@link mergeAll} (e.g. `scheduled([ob1, ob2, ob3], scheduled).pipe(mergeAll())*/\nexport function merge<T>(...observables: (ObservableInput<T> | SchedulerLike | number)[]): Observable<T>;\nexport function merge<T, R>(...observables: (ObservableInput<any> | number)[]): Observable<R>;\n/** @deprecated use {@link scheduled} and {@link mergeAll} (e.g. `scheduled([ob1, ob2, ob3], scheduled).pipe(mergeAll())*/\nexport function merge<T, R>(...observables: (ObservableInput<any> | SchedulerLike | number)[]): Observable<R>;\n/* tslint:enable:max-line-length */\n/**\n * Creates an output Observable which concurrently emits all values from every\n * given input Observable.\n *\n * <span class=\"informal\">Flattens multiple Observables together by blending\n * their values into one Observable.</span>\n *\n * ![](merge.png)\n *\n * `merge` subscribes to each given input Observable (as arguments), and simply\n * forwards (without doing any transformation) all the values from all the input\n * Observables to the output Observable. The output Observable only completes\n * once all input Observables have completed. Any error delivered by an input\n * Observable will be immediately emitted on the output Observable.\n *\n * ## Examples\n * ### Merge together two Observables: 1s interval and clicks\n * ```ts\n * import { merge, fromEvent, interval } from 'rxjs';\n *\n * const clicks = fromEvent(document, 'click');\n * const timer = interval(1000);\n * const clicksOrTimer = merge(clicks, timer);\n * clicksOrTimer.subscribe(x => console.log(x));\n *\n * // Results in the following:\n * // timer will emit ascending values, one every second(1000ms) to console\n * // clicks logs MouseEvents to console everytime the \"document\" is clicked\n * // Since the two streams are merged you see these happening\n * // as they occur.\n * ```\n *\n * ### Merge together 3 Observables, but only 2 run concurrently\n * ```ts\n * import { merge, interval } from 'rxjs';\n * import { take } from 'rxjs/operators';\n *\n * const timer1 = interval(1000).pipe(take(10));\n * const timer2 = interval(2000).pipe(take(6));\n * const timer3 = interval(500).pipe(take(10));\n * const concurrent = 2; // the argument\n * const merged = merge(timer1, timer2, timer3, concurrent);\n * merged.subscribe(x => console.log(x));\n *\n * // Results in the following:\n * // - First timer1 and timer2 will run concurrently\n * // - timer1 will emit a value every 1000ms for 10 iterations\n * // - timer2 will emit a value every 2000ms for 6 iterations\n * // - after timer1 hits it's max iteration, timer2 will\n * //   continue, and timer3 will start to run concurrently with timer2\n * // - when timer2 hits it's max iteration it terminates, and\n * //   timer3 will continue to emit a value every 500ms until it is complete\n * ```\n *\n * @see {@link mergeAll}\n * @see {@link mergeMap}\n * @see {@link mergeMapTo}\n * @see {@link mergeScan}\n *\n * @param {...ObservableInput} observables Input Observables to merge together.\n * @param {number} [concurrent=Number.POSITIVE_INFINITY] Maximum number of input\n * Observables being subscribed to concurrently.\n * @param {SchedulerLike} [scheduler=null] The {@link SchedulerLike} to use for managing\n * concurrency of input Observables.\n * @return {Observable} an Observable that emits items that are the result of\n * every input Observable.\n * @static true\n * @name merge\n * @owner Observable\n */\nexport function merge<T, R>(...observables: Array<ObservableInput<any> | SchedulerLike | number>): Observable<R> {\n let concurrent = Number.POSITIVE_INFINITY;\n let scheduler: SchedulerLike = null;\n  let last: any = observables[observables.length - 1];\n  if (isScheduler(last)) {\n    scheduler = <SchedulerLike>observables.pop();\n    if (observables.length > 1 && typeof observables[observables.length - 1] === 'number') {\n      concurrent = <number>observables.pop();\n    }\n  } else if (typeof last === 'number') {\n    concurrent = <number>observables.pop();\n  }\n\n  if (scheduler === null && observables.length === 1 && observables[0] instanceof Observable) {\n    return <Observable<R>>observables[0];\n  }\n\n  return mergeAll<R>(concurrent)(fromArray<any>(observables, scheduler));\n}\n","import { Observable } from '../Observable';\nimport { noop } from '../util/noop';\n\n/**\n * An Observable that emits no items to the Observer and never completes.\n *\n * ![](never.png)\n *\n * A simple Observable that emits neither values nor errors nor the completion\n * notification. It can be used for testing purposes or for composing with other\n * Observables. Please note that by never emitting a complete notification, this\n * Observable keeps the subscription from being disposed automatically.\n * Subscriptions need to be manually disposed.\n *\n * ##  Example\n * ### Emit the number 7, then never emit anything else (not even complete)\n * ```ts\n * import { NEVER } from 'rxjs';\n * import { startWith } from 'rxjs/operators';\n *\n * function info() {\n *   console.log('Will not be called');\n * }\n * const result = NEVER.pipe(startWith(7));\n * result.subscribe(x => console.log(x), info, info);\n *\n * ```\n *\n * @see {@link Observable}\n * @see {@link index/EMPTY}\n * @see {@link of}\n * @see {@link throwError}\n */\nexport const NEVER = new Observable<never>(noop);\n\n/**\n * @deprecated Deprecated in favor of using {@link NEVER} constant.\n */\nexport function never () {\n  return NEVER;\n}\n","import { Observable } from '../Observable';\nimport { ObservableInput } from '../types';\nimport { from } from './from';\nimport { isArray } from '../util/isArray';\nimport { EMPTY } from './empty';\n\n/* tslint:disable:max-line-length */\nexport function onErrorResumeNext<R>(v: ObservableInput<R>): Observable<R>;\nexport function onErrorResumeNext<T2, T3, R>(v2: ObservableInput<T2>, v3: ObservableInput<T3>): Observable<R>;\nexport function onErrorResumeNext<T2, T3, T4, R>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>): Observable<R>;\nexport function onErrorResumeNext<T2, T3, T4, T5, R>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>): Observable<R>;\nexport function onErrorResumeNext<T2, T3, T4, T5, T6, R>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, v6: ObservableInput<T6>): Observable<R>;\n\nexport function onErrorResumeNext<R>(...observables: Array<ObservableInput<any> | ((...values: Array<any>) => R)>): Observable<R>;\nexport function onErrorResumeNext<R>(array: ObservableInput<any>[]): Observable<R>;\n/* tslint:enable:max-line-length */\n\n/**\n * When any of the provided Observable emits an complete or error notification, it immediately subscribes to the next one\n * that was passed.\n *\n * <span class=\"informal\">Execute series of Observables no matter what, even if it means swallowing errors.</span>\n *\n * ![](onErrorResumeNext.png)\n *\n * `onErrorResumeNext` Will subscribe to each observable source it is provided, in order.\n * If the source it's subscribed to emits an error or completes, it will move to the next source\n * without error.\n *\n * If `onErrorResumeNext` is provided no arguments, or a single, empty array, it will return {@link index/EMPTY}.\n *\n * `onErrorResumeNext` is basically {@link concat}, only it will continue, even if one of its\n * sources emits an error.\n *\n * Note that there is no way to handle any errors thrown by sources via the result of\n * `onErrorResumeNext`. If you want to handle errors thrown in any given source, you can\n * always use the {@link catchError} operator on them before passing them into `onErrorResumeNext`.\n *\n * ## Example\n * Subscribe to the next Observable after map fails</caption>\n * ```ts\n * import { onErrorResumeNext, of } from 'rxjs';\n * import { map } from 'rxjs/operators';\n *\n * onErrorResumeNext(\n *  of(1, 2, 3, 0).pipe(\n *    map(x => {\n *      if (x === 0) throw Error();\n *      return 10 / x;\n *    })\n *  ),\n *  of(1, 2, 3),\n * )\n * .subscribe(\n *   val => console.log(val),\n *   err => console.log(err),          // Will never be called.\n *   () => console.log('done'),\n * );\n *\n * // Logs:\n * // 10\n * // 5\n * // 3.3333333333333335\n * // 1\n * // 2\n * // 3\n * // \"done\"\n * ```\n *\n * @see {@link concat}\n * @see {@link catchError}\n *\n * @param {...ObservableInput} sources Observables (or anything that *is* observable) passed either directly or as an array.\n * @return {Observable} An Observable that concatenates all sources, one after the other,\n * ignoring all errors, such that any error causes it to move on to the next source.\n */\nexport function onErrorResumeNext<T, R>(...sources: Array<ObservableInput<any> |\n                                                              Array<ObservableInput<any>> |\n                                                              ((...values: Array<any>) => R)>): Observable<R> {\n\n  if (sources.length === 0) {\n    return EMPTY;\n  }\n\n  const [ first, ...remainder ] = sources;\n\n  if (sources.length === 1 && isArray(first)) {\n    return onErrorResumeNext(...first);\n  }\n\n  return new Observable(subscriber => {\n    const subNext = () => subscriber.add(\n      onErrorResumeNext(...remainder).subscribe(subscriber)\n    );\n\n    return from(first).subscribe({\n      next(value) { subscriber.next(value); },\n      error: subNext,\n      complete: subNext,\n    });\n  });\n}\n","import { Observable } from '../Observable';\nimport { SchedulerAction, SchedulerLike } from '../types';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\n\n/**\n * Convert an object into an Observable of `[key, value]` pairs.\n *\n * <span class=\"informal\">Turn entries of an object into a stream.</span>\n *\n * <img src=\"./img/pairs.png\" width=\"100%\">\n *\n * `pairs` takes an arbitrary object and returns an Observable that emits arrays. Each\n * emitted array has exactly two elements - the first is a key from the object\n * and the second is a value corresponding to that key. Keys are extracted from\n * an object via `Object.keys` function, which means that they will be only\n * enumerable keys that are present on an object directly - not ones inherited\n * via prototype chain.\n *\n * By default these arrays are emitted synchronously. To change that you can\n * pass a {@link SchedulerLike} as a second argument to `pairs`.\n *\n * @example <caption>Converts a javascript object to an Observable</caption>\n * ```ts\n * import { pairs } from 'rxjs';\n *\n * const obj = {\n *   foo: 42,\n *   bar: 56,\n *   baz: 78\n * };\n *\n * pairs(obj)\n * .subscribe(\n *   value => console.log(value),\n *   err => {},\n *   () => console.log('the end!')\n * );\n *\n * // Logs:\n * // [\"foo\", 42],\n * // [\"bar\", 56],\n * // [\"baz\", 78],\n * // \"the end!\"\n * ```\n *\n * @param {Object} obj The object to inspect and turn into an\n * Observable sequence.\n * @param {Scheduler} [scheduler] An optional IScheduler to schedule\n * when resulting Observable will emit values.\n * @returns {(Observable<Array<string|T>>)} An observable sequence of\n * [key, value] pairs from the object.\n */\nexport function pairs<T>(obj: Object, scheduler?: SchedulerLike): Observable<[string, T]> {\n  if (!scheduler) {\n    return new Observable<[string, T]>(subscriber => {\n      const keys = Object.keys(obj);\n      for (let i = 0; i < keys.length && !subscriber.closed; i++) {\n        const key = keys[i];\n        if (obj.hasOwnProperty(key)) {\n          subscriber.next([key, obj[key]]);\n        }\n      }\n      subscriber.complete();\n    });\n  } else {\n    return new Observable<[string, T]>(subscriber => {\n      const keys = Object.keys(obj);\n      const subscription = new Subscription();\n      subscription.add(\n        scheduler.schedule<{ keys: string[], index: number, subscriber: Subscriber<[string, T]>, subscription: Subscription, obj: Object }>\n          (dispatch, 0, { keys, index: 0, subscriber, subscription, obj }));\n      return subscription;\n    });\n  }\n}\n\n/** @internal */\nexport function dispatch<T>(this: SchedulerAction<any>,\n                            state: { keys: string[], index: number, subscriber: Subscriber<[string, T]>, subscription: Subscription, obj: Object }) {\n  const { keys, index, subscriber, subscription, obj } = state;\n  if (!subscriber.closed) {\n    if (index < keys.length) {\n      const key = keys[index];\n      subscriber.next([key, obj[key]]);\n      subscription.add(this.schedule({ keys, index: index + 1, subscriber, subscription, obj }));\n    } else {\n      subscriber.complete();\n    }\n  }\n}\n","export function not(pred: Function, thisArg: any): Function {\n  function notPred(): any {\n    return !((<any> notPred).pred.apply((<any> notPred).thisArg, arguments));\n  }\n  (<any> notPred).pred = pred;\n  (<any> notPred).thisArg = thisArg;\n  return notPred;\n}","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { OperatorFunction, MonoTypeOperatorFunction, TeardownLogic } from '../types';\n\n/* tslint:disable:max-line-length */\nexport function filter<T, S extends T>(predicate: (value: T, index: number) => value is S,\n                                       thisArg?: any): OperatorFunction<T, S>;\nexport function filter<T>(predicate: (value: T, index: number) => boolean,\n                          thisArg?: any): MonoTypeOperatorFunction<T>;\n/* tslint:enable:max-line-length */\n\n/**\n * Filter items emitted by the source Observable by only emitting those that\n * satisfy a specified predicate.\n *\n * <span class=\"informal\">Like\n * [Array.prototype.filter()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter),\n * it only emits a value from the source if it passes a criterion function.</span>\n *\n * ![](filter.png)\n *\n * Similar to the well-known `Array.prototype.filter` method, this operator\n * takes values from the source Observable, passes them through a `predicate`\n * function and only emits those values that yielded `true`.\n *\n * ## Example\n * Emit only click events whose target was a DIV element\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { filter } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const clicksOnDivs = clicks.pipe(filter(ev => ev.target.tagName === 'DIV'));\n * clicksOnDivs.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link distinct}\n * @see {@link distinctUntilChanged}\n * @see {@link distinctUntilKeyChanged}\n * @see {@link ignoreElements}\n * @see {@link partition}\n * @see {@link skip}\n *\n * @param {function(value: T, index: number): boolean} predicate A function that\n * evaluates each value emitted by the source Observable. If it returns `true`,\n * the value is emitted, if `false` the value is not passed to the output\n * Observable. The `index` parameter is the number `i` for the i-th source\n * emission that has happened since the subscription, starting from the number\n * `0`.\n * @param {any} [thisArg] An optional argument to determine the value of `this`\n * in the `predicate` function.\n * @return {Observable} An Observable of values from the source that were\n * allowed by the `predicate` function.\n * @method filter\n * @owner Observable\n */\nexport function filter<T>(predicate: (value: T, index: number) => boolean,\n                          thisArg?: any): MonoTypeOperatorFunction<T> {\n  return function filterOperatorFunction(source: Observable<T>): Observable<T> {\n    return source.lift(new FilterOperator(predicate, thisArg));\n  };\n}\n\nclass FilterOperator<T> implements Operator<T, T> {\n  constructor(private predicate: (value: T, index: number) => boolean,\n              private thisArg?: any) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new FilterSubscriber(subscriber, this.predicate, this.thisArg));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass FilterSubscriber<T> extends Subscriber<T> {\n\n  count: number = 0;\n\n  constructor(destination: Subscriber<T>,\n              private predicate: (value: T, index: number) => boolean,\n              private thisArg: any) {\n    super(destination);\n  }\n\n  // the try catch block below is left specifically for\n  // optimization and perf reasons. a tryCatcher is not necessary here.\n  protected _next(value: T) {\n    let result: any;\n    try {\n      result = this.predicate.call(this.thisArg, value, this.count++);\n    } catch (err) {\n      this.destination.error(err);\n      return;\n    }\n    if (result) {\n      this.destination.next(value);\n    }\n  }\n}\n","import { not } from '../util/not';\nimport { subscribeTo } from '../util/subscribeTo';\nimport { filter } from '../operators/filter';\nimport { ObservableInput } from '../types';\nimport { Observable } from '../Observable';\n\n/**\n * Splits the source Observable into two, one with values that satisfy a\n * predicate, and another with values that don't satisfy the predicate.\n *\n * <span class=\"informal\">It's like {@link filter}, but returns two Observables:\n * one like the output of {@link filter}, and the other with values that did not\n * pass the condition.</span>\n *\n * ![](partition.png)\n *\n * `partition` outputs an array with two Observables that partition the values\n * from the source Observable through the given `predicate` function. The first\n * Observable in that array emits source values for which the predicate argument\n * returns true. The second Observable emits source values for which the\n * predicate returns false. The first behaves like {@link filter} and the second\n * behaves like {@link filter} with the predicate negated.\n *\n * ## Example\n * Partition a set of numbers into odds and evens observables\n * ```ts\n * import { of, partition } from 'rxjs';\n *\n * const observableValues = of(1, 2, 3, 4, 5, 6);\n * const [evens$, odds$] = partition(observableValues, (value, index) => value % 2 === 0);\n *\n * odds$.subscribe(x => console.log('odds', x));\n * evens$.subscribe(x => console.log('evens', x));\n *\n * // Logs:\n * // odds 1\n * // odds 3\n * // odds 5\n * // evens 2\n * // evens 4\n * // evens 6\n * ```\n *\n * @see {@link filter}\n *\n * @param {function(value: T, index: number): boolean} predicate A function that\n * evaluates each value emitted by the source Observable. If it returns `true`,\n * the value is emitted on the first Observable in the returned array, if\n * `false` the value is emitted on the second Observable in the array. The\n * `index` parameter is the number `i` for the i-th source emission that has\n * happened since the subscription, starting from the number `0`.\n * @param {any} [thisArg] An optional argument to determine the value of `this`\n * in the `predicate` function.\n * @return {[Observable<T>, Observable<T>]} An array with two Observables: one\n * with values that passed the predicate, and another with values that did not\n * pass the predicate.\n */\nexport function partition<T>(\n  source: ObservableInput<T>,\n  predicate: (value: T, index: number) => boolean,\n  thisArg?: any\n): [Observable<T>, Observable<T>] {\n  return [\n    filter(predicate, thisArg)(new Observable<T>(subscribeTo(source))),\n    filter(not(predicate, thisArg) as any)(new Observable<T>(subscribeTo(source)))\n  ] as [Observable<T>, Observable<T>];\n}\n","import { Observable } from '../Observable';\nimport { isArray } from '../util/isArray';\nimport { fromArray } from './fromArray';\nimport { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { TeardownLogic, ObservableInput } from '../types';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\n\n// tslint:disable:max-line-length\nexport function race<A>(arg: [ObservableInput<A>]): Observable<A>;\nexport function race<A, B>(arg: [ObservableInput<A>, ObservableInput<B>]): Observable<A | B>;\nexport function race<A, B, C>(arg: [ObservableInput<A>, ObservableInput<B>, ObservableInput<C>]): Observable<A | B | C>;\nexport function race<A, B, C, D>(arg: [ObservableInput<A>, ObservableInput<B>, ObservableInput<C>, ObservableInput<D>]): Observable<A | B | C | D>;\nexport function race<A, B, C, D, E>(arg: [ObservableInput<A>, ObservableInput<B>, ObservableInput<C>, ObservableInput<D>, ObservableInput<E>]): Observable<A | B | C | D | E>;\nexport function race<T>(arg: ObservableInput<T>[]): Observable<T>;\nexport function race(arg: ObservableInput<any>[]): Observable<{}>;\n\nexport function race<A>(a: ObservableInput<A>): Observable<A>;\nexport function race<A, B>(a: ObservableInput<A>, b: ObservableInput<B>): Observable<A | B>;\nexport function race<A, B, C>(a: ObservableInput<A>, b: ObservableInput<B>, c: ObservableInput<C>): Observable<A | B | C>;\nexport function race<A, B, C, D>(a: ObservableInput<A>, b: ObservableInput<B>, c: ObservableInput<C>, d: ObservableInput<D>): Observable<A | B | C | D>;\nexport function race<A, B, C, D, E>(a: ObservableInput<A>, b: ObservableInput<B>, c: ObservableInput<C>, d: ObservableInput<D>, e: ObservableInput<E>): Observable<A | B | C | D | E>;\n// tslint:enable:max-line-length\n\nexport function race<T>(observables: ObservableInput<T>[]): Observable<T>;\nexport function race(observables: ObservableInput<any>[]): Observable<{}>;\nexport function race<T>(...observables: ObservableInput<T>[]): Observable<T>;\nexport function race(...observables: ObservableInput<any>[]): Observable<{}>;\n\n/**\n * Returns an Observable that mirrors the first source Observable to emit an item.\n *\n * ## Example\n * ### Subscribes to the observable that was the first to start emitting.\n *\n * ```ts\n * import { race, interval } from 'rxjs';\n * import { mapTo } from 'rxjs/operators';\n *\n * const obs1 = interval(1000).pipe(mapTo('fast one'));\n * const obs2 = interval(3000).pipe(mapTo('medium one'));\n * const obs3 = interval(5000).pipe(mapTo('slow one'));\n *\n * race(obs3, obs1, obs2)\n * .subscribe(\n *   winner => console.log(winner)\n * );\n *\n * // result:\n * // a series of 'fast one'\n * ```\n *\n * @param {...Observables} ...observables sources used to race for which Observable emits first.\n * @return {Observable} an Observable that mirrors the output of the first Observable to emit an item.\n * @static true\n * @name race\n * @owner Observable\n */\nexport function race<T>(...observables: ObservableInput<any>[]): Observable<T> {\n  // if the only argument is an array, it was most likely called with\n  // `race([obs1, obs2, ...])`\n  if (observables.length === 1) {\n    if (isArray(observables[0])) {\n      observables = observables[0] as Observable<any>[];\n    } else {\n      return observables[0] as Observable<T>;\n    }\n  }\n\n  return fromArray(observables, undefined).lift(new RaceOperator<T>());\n}\n\nexport class RaceOperator<T> implements Operator<T, T> {\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new RaceSubscriber(subscriber));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nexport class RaceSubscriber<T> extends OuterSubscriber<T, T> {\n  private hasFirst: boolean = false;\n  private observables: Observable<any>[] = [];\n  private subscriptions: Subscription[] = [];\n\n  constructor(destination: Subscriber<T>) {\n    super(destination);\n  }\n\n  protected _next(observable: any): void {\n    this.observables.push(observable);\n  }\n\n  protected _complete() {\n    const observables = this.observables;\n    const len = observables.length;\n\n    if (len === 0) {\n      this.destination.complete();\n    } else {\n      for (let i = 0; i < len && !this.hasFirst; i++) {\n        let observable = observables[i];\n        let subscription = subscribeToResult(this, observable, observable as any, i);\n\n        if (this.subscriptions) {\n          this.subscriptions.push(subscription);\n        }\n        this.add(subscription);\n      }\n      this.observables = null;\n    }\n  }\n\n  notifyNext(outerValue: T, innerValue: T,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, T>): void {\n    if (!this.hasFirst) {\n      this.hasFirst = true;\n\n      for (let i = 0; i < this.subscriptions.length; i++) {\n        if (i !== outerIndex) {\n          let subscription = this.subscriptions[i];\n\n          subscription.unsubscribe();\n          this.remove(subscription);\n        }\n      }\n\n      this.subscriptions = null;\n    }\n\n    this.destination.next(innerValue);\n  }\n}\n","import { SchedulerAction, SchedulerLike } from '../types';\nimport { Observable } from '../Observable';\n\n/**\n * Creates an Observable that emits a sequence of numbers within a specified\n * range.\n *\n * <span class=\"informal\">Emits a sequence of numbers in a range.</span>\n *\n * ![](range.png)\n *\n * `range` operator emits a range of sequential integers, in order, where you\n * select the `start` of the range and its `length`. By default, uses no\n * {@link SchedulerLike} and just delivers the notifications synchronously, but may use\n * an optional {@link SchedulerLike} to regulate those deliveries.\n *\n * ## Example\n * Emits the numbers 1 to 10</caption>\n * ```ts\n * import { range } from 'rxjs';\n *\n * const numbers = range(1, 10);\n * numbers.subscribe(x => console.log(x));\n * ```\n * @see {@link timer}\n * @see {@link index/interval}\n *\n * @param {number} [start=0] The value of the first integer in the sequence.\n * @param {number} count The number of sequential integers to generate.\n * @param {SchedulerLike} [scheduler] A {@link SchedulerLike} to use for scheduling\n * the emissions of the notifications.\n * @return {Observable} An Observable of numbers that emits a finite range of\n * sequential integers.\n * @static true\n * @name range\n * @owner Observable\n */\nexport function range(start: number = 0,\n                      count?: number,\n                      scheduler?: SchedulerLike): Observable<number> {\n  return new Observable<number>(subscriber => {\n    if (count === undefined) {\n      count = start;\n      start = 0;\n    }\n\n    let index = 0;\n    let current = start;\n\n    if (scheduler) {\n      return scheduler.schedule(dispatch, 0, {\n        index, count, start, subscriber\n      });\n    } else {\n      do {\n        if (index++ >= count) {\n          subscriber.complete();\n          break;\n        }\n        subscriber.next(current++);\n        if (subscriber.closed) {\n          break;\n        }\n      } while (true);\n    }\n\n    return undefined;\n  });\n}\n\n/** @internal */\nexport function dispatch(this: SchedulerAction<any>, state: any) {\n  const { start, index, count, subscriber } = state;\n\n  if (index >= count) {\n    subscriber.complete();\n    return;\n  }\n\n  subscriber.next(start);\n\n  if (subscriber.closed) {\n    return;\n  }\n\n  state.index = index + 1;\n  state.start = start + 1;\n\n  this.schedule(state);\n}\n","import { Observable } from '../Observable';\nimport { SchedulerAction, SchedulerLike } from '../types';\nimport { async } from '../scheduler/async';\nimport { isNumeric } from '../util/isNumeric';\nimport { isScheduler } from '../util/isScheduler';\nimport { Subscriber } from '../Subscriber';\n\n/**\n * Creates an Observable that starts emitting after an `dueTime` and\n * emits ever increasing numbers after each `period` of time thereafter.\n *\n * <span class=\"informal\">Its like {@link index/interval}, but you can specify when\n * should the emissions start.</span>\n *\n * ![](timer.png)\n *\n * `timer` returns an Observable that emits an infinite sequence of ascending\n * integers, with a constant interval of time, `period` of your choosing\n * between those emissions. The first emission happens after the specified\n * `dueTime`. The initial delay may be a `Date`. By default, this\n * operator uses the {@link asyncScheduler} {@link SchedulerLike} to provide a notion of time, but you\n * may pass any {@link SchedulerLike} to it. If `period` is not specified, the output\n * Observable emits only one value, `0`. Otherwise, it emits an infinite\n * sequence.\n *\n * ## Examples\n * ### Emits ascending numbers, one every second (1000ms), starting after 3 seconds\n * ```ts\n * import { timer } from 'rxjs';\n *\n * const numbers = timer(3000, 1000);\n * numbers.subscribe(x => console.log(x));\n * ```\n *\n * ### Emits one number after five seconds\n * ```ts\n * import { timer } from 'rxjs';\n *\n * const numbers = timer(5000);\n * numbers.subscribe(x => console.log(x));\n * ```\n * @see {@link index/interval}\n * @see {@link delay}\n *\n * @param {number|Date} [dueTime] The initial delay time specified as a Date object or as an integer denoting\n * milliseconds to wait before emitting the first value of 0`.\n * @param {number|SchedulerLike} [periodOrScheduler] The period of time between emissions of the\n * subsequent numbers.\n * @param {SchedulerLike} [scheduler=async] The {@link SchedulerLike} to use for scheduling\n * the emission of values, and providing a notion of \"time\".\n * @return {Observable} An Observable that emits a `0` after the\n * `dueTime` and ever increasing numbers after each `period` of time\n * thereafter.\n * @static true\n * @name timer\n * @owner Observable\n */\nexport function timer(dueTime: number | Date = 0,\n                      periodOrScheduler?: number | SchedulerLike,\n                      scheduler?: SchedulerLike): Observable<number> {\n  let period = -1;\n  if (isNumeric(periodOrScheduler)) {\n    period = Number(periodOrScheduler) < 1 && 1 || Number(periodOrScheduler);\n  } else if (isScheduler(periodOrScheduler)) {\n    scheduler = periodOrScheduler as any;\n  }\n\n  if (!isScheduler(scheduler)) {\n    scheduler = async;\n  }\n\n  return new Observable(subscriber => {\n    const due = isNumeric(dueTime)\n      ? (dueTime as number)\n      : (+dueTime - scheduler.now());\n\n    return scheduler.schedule(dispatch, due, {\n      index: 0, period, subscriber\n    });\n  });\n}\n\ninterface TimerState {\n  index: number;\n  period: number;\n  subscriber: Subscriber<number>;\n}\n\nfunction dispatch(this: SchedulerAction<TimerState>, state: TimerState) {\n  const { index, period, subscriber } = state;\n  subscriber.next(index);\n\n  if (subscriber.closed) {\n    return;\n  } else if (period === -1) {\n    return subscriber.complete();\n  }\n\n  state.index = index + 1;\n  this.schedule(state, period);\n}\n","import { Observable } from '../Observable';\nimport { Unsubscribable, ObservableInput } from '../types';\nimport { from } from './from'; // from from from! LAWL\nimport { EMPTY } from './empty';\n\n/**\n * Creates an Observable that uses a resource which will be disposed at the same time as the Observable.\n *\n * <span class=\"informal\">Use it when you catch yourself cleaning up after an Observable.</span>\n *\n * `using` is a factory operator, which accepts two functions. First function returns a disposable resource.\n * It can be an arbitrary object that implements `unsubscribe` method. Second function will be injected with\n * that object and should return an Observable. That Observable can use resource object during its execution.\n * Both functions passed to `using` will be called every time someone subscribes - neither an Observable nor\n * resource object will be shared in any way between subscriptions.\n *\n * When Observable returned by `using` is subscribed, Observable returned from the second function will be subscribed\n * as well. All its notifications (nexted values, completion and error events) will be emitted unchanged by the output\n * Observable. If however someone unsubscribes from the Observable or source Observable completes or errors by itself,\n * the `unsubscribe` method on resource object will be called. This can be used to do any necessary clean up, which\n * otherwise would have to be handled by hand. Note that complete or error notifications are not emitted when someone\n * cancels subscription to an Observable via `unsubscribe`, so `using` can be used as a hook, allowing you to make\n * sure that all resources which need to exist during an Observable execution will be disposed at appropriate time.\n *\n * @see {@link defer}\n *\n * @param {function(): ISubscription} resourceFactory A function which creates any resource object\n * that implements `unsubscribe` method.\n * @param {function(resource: ISubscription): Observable<T>} observableFactory A function which\n * creates an Observable, that can use injected resource object.\n * @return {Observable<T>} An Observable that behaves the same as Observable returned by `observableFactory`, but\n * which - when completed, errored or unsubscribed - will also call `unsubscribe` on created resource object.\n */\nexport function using<T>(resourceFactory: () => Unsubscribable | void,\n                         observableFactory: (resource: Unsubscribable | void) => ObservableInput<T> | void): Observable<T> {\n  return new Observable<T>(subscriber => {\n    let resource: Unsubscribable | void;\n\n    try {\n      resource = resourceFactory();\n    } catch (err) {\n      subscriber.error(err);\n      return undefined;\n    }\n\n    let result: ObservableInput<T> | void;\n    try {\n      result = observableFactory(resource);\n    } catch (err) {\n      subscriber.error(err);\n      return undefined;\n    }\n\n    const source = result ? from(result) : EMPTY;\n    const subscription = source.subscribe(subscriber);\n    return () => {\n      subscription.unsubscribe();\n      if (resource) {\n        resource.unsubscribe();\n      }\n    };\n  });\n}\n","import { Observable } from '../Observable';\nimport { fromArray } from './fromArray';\nimport { isArray } from '../util/isArray';\nimport { Operator } from '../Operator';\nimport { ObservableInput, PartialObserver, ObservedValueOf } from '../types';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { iterator as Symbol_iterator } from '../../internal/symbol/iterator';\n\n/* tslint:disable:max-line-length */\n/** @deprecated resultSelector is no longer supported, pipe to map instead */\nexport function zip<O1 extends ObservableInput<any>, R>(v1: O1, resultSelector: (v1: ObservedValueOf<O1>) => R): Observable<R>;\n/** @deprecated resultSelector is no longer supported, pipe to map instead */\nexport function zip<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, R>(v1: O1, v2: O2, resultSelector: (v1: ObservedValueOf<O1>, v2: ObservedValueOf<O2>) => R): Observable<R>;\n/** @deprecated resultSelector is no longer supported, pipe to map instead */\nexport function zip<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, R>(v1: O1, v2: O2, v3: O3, resultSelector: (v1: ObservedValueOf<O1>, v2: ObservedValueOf<O2>, v3: ObservedValueOf<O3>) => R): Observable<R>;\n/** @deprecated resultSelector is no longer supported, pipe to map instead */\nexport function zip<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, R>(v1: O1, v2: O2, v3: O3, v4: O4, resultSelector: (v1: ObservedValueOf<O1>, v2: ObservedValueOf<O2>, v3: ObservedValueOf<O3>, v4: ObservedValueOf<O4>) => R): Observable<R>;\n/** @deprecated resultSelector is no longer supported, pipe to map instead */\nexport function zip<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>, R>(v1: O1, v2: O2, v3: O3, v4: O4, v5: O5, resultSelector: (v1: ObservedValueOf<O1>, v2: ObservedValueOf<O2>, v3: ObservedValueOf<O3>, v4: ObservedValueOf<O4>, v5: ObservedValueOf<O5>) => R): Observable<R>;\n/** @deprecated resultSelector is no longer supported, pipe to map instead */\nexport function zip<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>, O6 extends ObservableInput<any>, R>(v1: O1, v2: O2, v3: O3, v4: O4, v5: O5, v6: O6, resultSelector: (v1: ObservedValueOf<O1>, v2: ObservedValueOf<O2>, v3: ObservedValueOf<O3>, v4: ObservedValueOf<O4>, v5: ObservedValueOf<O5>, v6: ObservedValueOf<O6>) => R): Observable<R>;\n\nexport function zip<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>>(v1: O1, v2: O2): Observable<[ObservedValueOf<O1>, ObservedValueOf<O2>]>;\nexport function zip<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>>(v1: O1, v2: O2, v3: O3): Observable<[ObservedValueOf<O1>, ObservedValueOf<O2>, ObservedValueOf<O3>]>;\nexport function zip<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>>(v1: O1, v2: O2, v3: O3, v4: O4): Observable<[ObservedValueOf<O1>, ObservedValueOf<O2>, ObservedValueOf<O3>, ObservedValueOf<O4>]>;\nexport function zip<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>>(v1: O1, v2: O2, v3: O3, v4: O4, v5: O5): Observable<[ObservedValueOf<O1>, ObservedValueOf<O2>, ObservedValueOf<O3>, ObservedValueOf<O4>, ObservedValueOf<O5>]>;\nexport function zip<O1 extends ObservableInput<any>, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>, O6 extends ObservableInput<any>>(v1: O1, v2: O2, v3: O3, v4: O4, v5: O5, v6: O6): Observable<[ObservedValueOf<O1>, ObservedValueOf<O2>, ObservedValueOf<O3>, ObservedValueOf<O4>, ObservedValueOf<O5>, ObservedValueOf<O6>]>;\n\nexport function zip<O extends ObservableInput<any>>(array: O[]): Observable<ObservedValueOf<O>[]>;\nexport function zip<R>(array: ObservableInput<any>[]): Observable<R>;\n/** @deprecated resultSelector is no longer supported, pipe to map instead */\nexport function zip<O extends ObservableInput<any>, R>(array: O[], resultSelector: (...values: ObservedValueOf<O>[]) => R): Observable<R>;\n/** @deprecated resultSelector is no longer supported, pipe to map instead */\nexport function zip<R>(array: ObservableInput<any>[], resultSelector: (...values: any[]) => R): Observable<R>;\n\nexport function zip<O extends ObservableInput<any>>(...observables: O[]): Observable<ObservedValueOf<O>[]>;\nexport function zip<O extends ObservableInput<any>, R>(...observables: Array<O | ((...values: ObservedValueOf<O>[]) => R)>): Observable<R>;\nexport function zip<R>(...observables: Array<ObservableInput<any> | ((...values: Array<any>) => R)>): Observable<R>;\n/* tslint:enable:max-line-length */\n\n/**\n * Combines multiple Observables to create an Observable whose values are calculated from the values, in order, of each\n * of its input Observables.\n *\n * If the last parameter is a function, this function is used to compute the created value from the input values.\n * Otherwise, an array of the input values is returned.\n *\n * ## Example\n * Combine age and name from different sources\n * ```ts\n * import { zip, of } from 'rxjs';\n * import { map } from 'rxjs/operators';\n *\n * let age$ = of<number>(27, 25, 29);\n * let name$ = of<string>('Foo', 'Bar', 'Beer');\n * let isDev$ = of<boolean>(true, true, false);\n *\n * zip(age$, name$, isDev$).pipe(\n *   map(([age, name, isDev]) => ({ age, name, isDev })),\n * )\n * .subscribe(x => console.log(x));\n *\n * // outputs\n * // { age: 27, name: 'Foo', isDev: true }\n * // { age: 25, name: 'Bar', isDev: true }\n * // { age: 29, name: 'Beer', isDev: false }\n * ```\n * @param observables\n * @return {Observable<R>}\n * @static true\n * @name zip\n * @owner Observable\n */\nexport function zip<O extends ObservableInput<any>, R>(\n  ...observables: Array<O | ((...values: ObservedValueOf<O>[]) => R)>\n): Observable<ObservedValueOf<O>[]|R> {\n  const resultSelector = <((...ys: Array<any>) => R)> observables[observables.length - 1];\n  if (typeof resultSelector === 'function') {\n    observables.pop();\n  }\n  return fromArray(observables, undefined).lift(new ZipOperator(resultSelector));\n}\n\nexport class ZipOperator<T, R> implements Operator<T, R> {\n\n  resultSelector: (...values: Array<any>) => R;\n\n  constructor(resultSelector?: (...values: Array<any>) => R) {\n    this.resultSelector = resultSelector;\n  }\n\n  call(subscriber: Subscriber<R>, source: any): any {\n    return source.subscribe(new ZipSubscriber(subscriber, this.resultSelector));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nexport class ZipSubscriber<T, R> extends Subscriber<T> {\n  private values: any;\n  private resultSelector: (...values: Array<any>) => R;\n  private iterators: LookAheadIterator<any>[] = [];\n  private active = 0;\n\n  constructor(destination: Subscriber<R>,\n              resultSelector?: (...values: Array<any>) => R,\n              values: any = Object.create(null)) {\n    super(destination);\n    this.resultSelector = (typeof resultSelector === 'function') ? resultSelector : null;\n    this.values = values;\n  }\n\n  protected _next(value: any) {\n    const iterators = this.iterators;\n    if (isArray(value)) {\n      iterators.push(new StaticArrayIterator(value));\n    } else if (typeof value[Symbol_iterator] === 'function') {\n      iterators.push(new StaticIterator(value[Symbol_iterator]()));\n    } else {\n      iterators.push(new ZipBufferIterator(this.destination, this, value));\n    }\n  }\n\n  protected _complete() {\n    const iterators = this.iterators;\n    const len = iterators.length;\n\n    this.unsubscribe();\n\n    if (len === 0) {\n      this.destination.complete();\n      return;\n    }\n\n    this.active = len;\n    for (let i = 0; i < len; i++) {\n      let iterator: ZipBufferIterator<any, any> = <any>iterators[i];\n      if (iterator.stillUnsubscribed) {\n        const destination = this.destination as Subscription;\n        destination.add(iterator.subscribe(iterator, i));\n      } else {\n        this.active--; // not an observable\n      }\n    }\n  }\n\n  notifyInactive() {\n    this.active--;\n    if (this.active === 0) {\n      this.destination.complete();\n    }\n  }\n\n  checkIterators() {\n    const iterators = this.iterators;\n    const len = iterators.length;\n    const destination = this.destination;\n\n    // abort if not all of them have values\n    for (let i = 0; i < len; i++) {\n      let iterator = iterators[i];\n      if (typeof iterator.hasValue === 'function' && !iterator.hasValue()) {\n        return;\n      }\n    }\n\n    let shouldComplete = false;\n    const args: any[] = [];\n    for (let i = 0; i < len; i++) {\n      let iterator = iterators[i];\n      let result = iterator.next();\n\n      // check to see if it's completed now that you've gotten\n      // the next value.\n      if (iterator.hasCompleted()) {\n        shouldComplete = true;\n      }\n\n      if (result.done) {\n        destination.complete();\n        return;\n      }\n\n      args.push(result.value);\n    }\n\n    if (this.resultSelector) {\n      this._tryresultSelector(args);\n    } else {\n      destination.next(args);\n    }\n\n    if (shouldComplete) {\n      destination.complete();\n    }\n  }\n\n  protected _tryresultSelector(args: any[]) {\n    let result: any;\n    try {\n      result = this.resultSelector.apply(this, args);\n    } catch (err) {\n      this.destination.error(err);\n      return;\n    }\n    this.destination.next(result);\n  }\n}\n\ninterface LookAheadIterator<T> extends Iterator<T> {\n  hasValue(): boolean;\n  hasCompleted(): boolean;\n}\n\nclass StaticIterator<T> implements LookAheadIterator<T> {\n  private nextResult: IteratorResult<T>;\n\n  constructor(private iterator: Iterator<T>) {\n    this.nextResult = iterator.next();\n  }\n\n  hasValue() {\n    return true;\n  }\n\n  next(): IteratorResult<T> {\n    const result = this.nextResult;\n    this.nextResult = this.iterator.next();\n    return result;\n  }\n\n  hasCompleted() {\n    const nextResult = this.nextResult;\n    return nextResult && nextResult.done;\n  }\n}\n\nclass StaticArrayIterator<T> implements LookAheadIterator<T> {\n  private index = 0;\n  private length = 0;\n\n  constructor(private array: T[]) {\n    this.length = array.length;\n  }\n\n  [Symbol_iterator]() {\n    return this;\n  }\n\n  next(value?: any): IteratorResult<T> {\n    const i = this.index++;\n    const array = this.array;\n    return i < this.length ? { value: array[i], done: false } : { value: null, done: true };\n  }\n\n  hasValue() {\n    return this.array.length > this.index;\n  }\n\n  hasCompleted() {\n    return this.array.length === this.index;\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass ZipBufferIterator<T, R> extends OuterSubscriber<T, R> implements LookAheadIterator<T> {\n  stillUnsubscribed = true;\n  buffer: T[] = [];\n  isComplete = false;\n\n  constructor(destination: PartialObserver<T>,\n              private parent: ZipSubscriber<T, R>,\n              private observable: Observable<T>) {\n    super(destination);\n  }\n\n  [Symbol_iterator]() {\n    return this;\n  }\n\n  // NOTE: there is actually a name collision here with Subscriber.next and Iterator.next\n  //    this is legit because `next()` will never be called by a subscription in this case.\n  next(): IteratorResult<T> {\n    const buffer = this.buffer;\n    if (buffer.length === 0 && this.isComplete) {\n      return { value: null, done: true };\n    } else {\n      return { value: buffer.shift(), done: false };\n    }\n  }\n\n  hasValue() {\n    return this.buffer.length > 0;\n  }\n\n  hasCompleted() {\n    return this.buffer.length === 0 && this.isComplete;\n  }\n\n  notifyComplete() {\n    if (this.buffer.length > 0) {\n      this.isComplete = true;\n      this.parent.notifyInactive();\n    } else {\n      this.destination.complete();\n    }\n  }\n\n  notifyNext(outerValue: T, innerValue: any,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, R>): void {\n    this.buffer.push(innerValue);\n    this.parent.checkIterators();\n  }\n\n  subscribe(value: any, index: number) {\n    return subscribeToResult<any, any>(this, this.observable, this, index);\n  }\n}\n","/* Observable */\nexport { Observable } from './internal/Observable';\nexport { ConnectableObservable } from './internal/observable/ConnectableObservable';\nexport { GroupedObservable } from './internal/operators/groupBy';\nexport { Operator } from './internal/Operator';\nexport { observable } from './internal/symbol/observable';\n\n/* Subjects */\nexport { Subject } from './internal/Subject';\nexport { BehaviorSubject } from './internal/BehaviorSubject';\nexport { ReplaySubject } from './internal/ReplaySubject';\nexport { AsyncSubject } from './internal/AsyncSubject';\n\n/* Schedulers */\nexport { asap as asapScheduler } from './internal/scheduler/asap';\nexport { async as asyncScheduler } from './internal/scheduler/async';\nexport { queue as queueScheduler } from './internal/scheduler/queue';\nexport { animationFrame as animationFrameScheduler } from './internal/scheduler/animationFrame';\nexport { VirtualTimeScheduler, VirtualAction } from './internal/scheduler/VirtualTimeScheduler';\nexport { Scheduler } from './internal/Scheduler';\n\n/* Subscription */\nexport { Subscription } from './internal/Subscription';\nexport { Subscriber } from './internal/Subscriber';\n\n/* Notification */\nexport { Notification, NotificationKind } from './internal/Notification';\n\n/* Utils */\nexport { pipe } from './internal/util/pipe';\nexport { noop } from './internal/util/noop';\nexport { identity } from './internal/util/identity';\nexport { isObservable } from './internal/util/isObservable';\n\n/* Error types */\nexport { ArgumentOutOfRangeError } from './internal/util/ArgumentOutOfRangeError';\nexport { EmptyError } from './internal/util/EmptyError';\nexport { ObjectUnsubscribedError } from './internal/util/ObjectUnsubscribedError';\nexport { UnsubscriptionError } from './internal/util/UnsubscriptionError';\nexport { TimeoutError } from './internal/util/TimeoutError';\n\n/* Static observable creation exports */\nexport { bindCallback } from './internal/observable/bindCallback';\nexport { bindNodeCallback } from './internal/observable/bindNodeCallback';\nexport { combineLatest } from './internal/observable/combineLatest';\nexport { concat } from './internal/observable/concat';\nexport { defer } from './internal/observable/defer';\nexport { empty } from './internal/observable/empty';\nexport { forkJoin } from './internal/observable/forkJoin';\nexport { from } from './internal/observable/from';\nexport { fromEvent } from './internal/observable/fromEvent';\nexport { fromEventPattern } from './internal/observable/fromEventPattern';\nexport { generate } from './internal/observable/generate';\nexport { iif } from './internal/observable/iif';\nexport { interval } from './internal/observable/interval';\nexport { merge } from './internal/observable/merge';\nexport { never } from './internal/observable/never';\nexport { of } from './internal/observable/of';\nexport { onErrorResumeNext } from './internal/observable/onErrorResumeNext';\nexport { pairs } from './internal/observable/pairs';\nexport { partition } from './internal/observable/partition';\nexport { race } from './internal/observable/race';\nexport { range } from './internal/observable/range';\nexport { throwError } from './internal/observable/throwError';\nexport { timer } from './internal/observable/timer';\nexport { using } from './internal/observable/using';\nexport { zip } from './internal/observable/zip';\nexport { scheduled } from './internal/scheduled/scheduled';\n\n/* Constants */\nexport { EMPTY } from './internal/observable/empty';\nexport { NEVER } from './internal/observable/never';\n\n/* Types */\nexport * from './internal/types';\n\n/* Config */\nexport { config } from './internal/config';\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { Subscription } from '../Subscription';\nimport { MonoTypeOperatorFunction, SubscribableOrPromise, TeardownLogic } from '../types';\n\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\n\n/**\n * Ignores source values for a duration determined by another Observable, then\n * emits the most recent value from the source Observable, then repeats this\n * process.\n *\n * <span class=\"informal\">It's like {@link auditTime}, but the silencing\n * duration is determined by a second Observable.</span>\n *\n * ![](audit.png)\n *\n * `audit` is similar to `throttle`, but emits the last value from the silenced\n * time window, instead of the first value. `audit` emits the most recent value\n * from the source Observable on the output Observable as soon as its internal\n * timer becomes disabled, and ignores source values while the timer is enabled.\n * Initially, the timer is disabled. As soon as the first source value arrives,\n * the timer is enabled by calling the `durationSelector` function with the\n * source value, which returns the \"duration\" Observable. When the duration\n * Observable emits a value or completes, the timer is disabled, then the most\n * recent source value is emitted on the output Observable, and this process\n * repeats for the next source value.\n *\n * ## Example\n *\n * Emit clicks at a rate of at most one click per second\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { audit } from 'rxjs/operators'\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(audit(ev => interval(1000)));\n * result.subscribe(x => console.log(x));\n * ```\n * @see {@link auditTime}\n * @see {@link debounce}\n * @see {@link delayWhen}\n * @see {@link sample}\n * @see {@link throttle}\n *\n * @param {function(value: T): SubscribableOrPromise} durationSelector A function\n * that receives a value from the source Observable, for computing the silencing\n * duration, returned as an Observable or a Promise.\n * @return {Observable<T>} An Observable that performs rate-limiting of\n * emissions from the source Observable.\n * @method audit\n * @owner Observable\n */\nexport function audit<T>(durationSelector: (value: T) => SubscribableOrPromise<any>): MonoTypeOperatorFunction<T> {\n  return function auditOperatorFunction(source: Observable<T>) {\n    return source.lift(new AuditOperator(durationSelector));\n  };\n}\n\nclass AuditOperator<T> implements Operator<T, T> {\n  constructor(private durationSelector: (value: T) => SubscribableOrPromise<any>) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new AuditSubscriber<T, T>(subscriber, this.durationSelector));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass AuditSubscriber<T, R> extends OuterSubscriber<T, R> {\n\n  private value: T;\n  private hasValue: boolean = false;\n  private throttled: Subscription;\n\n  constructor(destination: Subscriber<T>,\n              private durationSelector: (value: T) => SubscribableOrPromise<any>) {\n    super(destination);\n  }\n\n  protected _next(value: T): void {\n    this.value = value;\n    this.hasValue = true;\n    if (!this.throttled) {\n      let duration;\n      try {\n        const { durationSelector } = this;\n        duration = durationSelector(value);\n      } catch (err) {\n        return this.destination.error(err);\n      }\n      const innerSubscription = subscribeToResult(this, duration);\n      if (!innerSubscription || innerSubscription.closed) {\n        this.clearThrottle();\n      } else {\n        this.add(this.throttled = innerSubscription);\n      }\n    }\n  }\n\n  clearThrottle() {\n    const { value, hasValue, throttled } = this;\n    if (throttled) {\n      this.remove(throttled);\n      this.throttled = null;\n      throttled.unsubscribe();\n    }\n    if (hasValue) {\n      this.value = null;\n      this.hasValue = false;\n      this.destination.next(value);\n    }\n  }\n\n  notifyNext(outerValue: T, innerValue: R, outerIndex: number, innerIndex: number): void {\n    this.clearThrottle();\n  }\n\n  notifyComplete(): void {\n    this.clearThrottle();\n  }\n}\n","import { async } from '../scheduler/async';\nimport { audit } from './audit';\nimport { timer } from '../observable/timer';\nimport { MonoTypeOperatorFunction, SchedulerLike } from '../types';\n\n/**\n * Ignores source values for `duration` milliseconds, then emits the most recent\n * value from the source Observable, then repeats this process.\n *\n * <span class=\"informal\">When it sees a source value, it ignores that plus\n * the next ones for `duration` milliseconds, and then it emits the most recent\n * value from the source.</span>\n *\n * ![](auditTime.png)\n *\n * `auditTime` is similar to `throttleTime`, but emits the last value from the\n * silenced time window, instead of the first value. `auditTime` emits the most\n * recent value from the source Observable on the output Observable as soon as\n * its internal timer becomes disabled, and ignores source values while the\n * timer is enabled. Initially, the timer is disabled. As soon as the first\n * source value arrives, the timer is enabled. After `duration` milliseconds (or\n * the time unit determined internally by the optional `scheduler`) has passed,\n * the timer is disabled, then the most recent source value is emitted on the\n * output Observable, and this process repeats for the next source value.\n * Optionally takes a {@link SchedulerLike} for managing timers.\n *\n * ## Example\n *\n * Emit clicks at a rate of at most one click per second\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { auditTime } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(auditTime(1000));\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link audit}\n * @see {@link debounceTime}\n * @see {@link delay}\n * @see {@link sampleTime}\n * @see {@link throttleTime}\n *\n * @param {number} duration Time to wait before emitting the most recent source\n * value, measured in milliseconds or the time unit determined internally\n * by the optional `scheduler`.\n * @param {SchedulerLike} [scheduler=async] The {@link SchedulerLike} to use for\n * managing the timers that handle the rate-limiting behavior.\n * @return {Observable<T>} An Observable that performs rate-limiting of\n * emissions from the source Observable.\n * @method auditTime\n * @owner Observable\n */\nexport function auditTime<T>(duration: number, scheduler: SchedulerLike = async): MonoTypeOperatorFunction<T> {\n  return audit(() => timer(duration, scheduler));\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { OperatorFunction } from '../types';\n\n/**\n * Buffers the source Observable values until `closingNotifier` emits.\n *\n * <span class=\"informal\">Collects values from the past as an array, and emits\n * that array only when another Observable emits.</span>\n *\n * ![](content/img/buffer.png)\n *\n * Buffers the incoming Observable values until the given `closingNotifier`\n * Observable emits a value, at which point it emits the buffer on the output\n * Observable and starts a new buffer internally, awaiting the next time\n * `closingNotifier` emits.\n *\n * ## Example\n *\n * On every click, emit array of most recent interval events\n *\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { buffer } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const intervalEvents = interval(1000);\n * const buffered = intervalEvents.pipe(buffer(clicks));\n * buffered.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link bufferCount}\n * @see {@link bufferTime}\n * @see {@link bufferToggle}\n * @see {@link bufferWhen}\n * @see {@link window}\n *\n * @param {Observable<any>} closingNotifier An Observable that signals the\n * buffer to be emitted on the output Observable.\n * @return {Observable<T[]>} An Observable of buffers, which are arrays of\n * values.\n * @method buffer\n * @owner Observable\n */\nexport function buffer<T>(closingNotifier: Observable<any>): OperatorFunction<T, T[]> {\n  return function bufferOperatorFunction(source: Observable<T>) {\n    return source.lift(new BufferOperator<T>(closingNotifier));\n  };\n}\n\nclass BufferOperator<T> implements Operator<T, T[]> {\n\n  constructor(private closingNotifier: Observable<any>) {\n  }\n\n  call(subscriber: Subscriber<T[]>, source: any): any {\n    return source.subscribe(new BufferSubscriber(subscriber, this.closingNotifier));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass BufferSubscriber<T> extends OuterSubscriber<T, any> {\n  private buffer: T[] = [];\n\n  constructor(destination: Subscriber<T[]>, closingNotifier: Observable<any>) {\n    super(destination);\n    this.add(subscribeToResult(this, closingNotifier));\n  }\n\n  protected _next(value: T) {\n    this.buffer.push(value);\n  }\n\n  notifyNext(outerValue: T, innerValue: any,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, any>): void {\n    const buffer = this.buffer;\n    this.buffer = [];\n    this.destination.next(buffer);\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { OperatorFunction, TeardownLogic } from '../types';\n\n/**\n * Buffers the source Observable values until the size hits the maximum\n * `bufferSize` given.\n *\n * <span class=\"informal\">Collects values from the past as an array, and emits\n * that array only when its size reaches `bufferSize`.</span>\n *\n * ![](bufferCount.png)\n *\n * Buffers a number of values from the source Observable by `bufferSize` then\n * emits the buffer and clears it, and starts a new buffer each\n * `startBufferEvery` values. If `startBufferEvery` is not provided or is\n * `null`, then new buffers are started immediately at the start of the source\n * and when each buffer closes and is emitted.\n *\n * ## Examples\n *\n * Emit the last two click events as an array\n *\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { bufferCount } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const buffered = clicks.pipe(bufferCount(2));\n * buffered.subscribe(x => console.log(x));\n * ```\n *\n * On every click, emit the last two click events as an array\n *\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { bufferCount } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const buffered = clicks.pipe(bufferCount(2, 1));\n * buffered.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link buffer}\n * @see {@link bufferTime}\n * @see {@link bufferToggle}\n * @see {@link bufferWhen}\n * @see {@link pairwise}\n * @see {@link windowCount}\n *\n * @param {number} bufferSize The maximum size of the buffer emitted.\n * @param {number} [startBufferEvery] Interval at which to start a new buffer.\n * For example if `startBufferEvery` is `2`, then a new buffer will be started\n * on every other value from the source. A new buffer is started at the\n * beginning of the source by default.\n * @return {Observable<T[]>} An Observable of arrays of buffered values.\n * @method bufferCount\n * @owner Observable\n */\nexport function bufferCount<T>(bufferSize: number, startBufferEvery: number = null): OperatorFunction<T, T[]> {\n  return function bufferCountOperatorFunction(source: Observable<T>) {\n    return source.lift(new BufferCountOperator<T>(bufferSize, startBufferEvery));\n  };\n}\n\nclass BufferCountOperator<T> implements Operator<T, T[]> {\n  private subscriberClass: any;\n\n  constructor(private bufferSize: number, private startBufferEvery: number) {\n    if (!startBufferEvery || bufferSize === startBufferEvery) {\n      this.subscriberClass = BufferCountSubscriber;\n    } else {\n      this.subscriberClass = BufferSkipCountSubscriber;\n    }\n  }\n\n  call(subscriber: Subscriber<T[]>, source: any): TeardownLogic {\n    return source.subscribe(new this.subscriberClass(subscriber, this.bufferSize, this.startBufferEvery));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass BufferCountSubscriber<T> extends Subscriber<T> {\n  private buffer: T[] = [];\n\n  constructor(destination: Subscriber<T[]>, private bufferSize: number) {\n    super(destination);\n  }\n\n  protected _next(value: T): void {\n    const buffer = this.buffer;\n\n    buffer.push(value);\n\n    if (buffer.length == this.bufferSize) {\n      this.destination.next(buffer);\n      this.buffer = [];\n    }\n  }\n\n  protected _complete(): void {\n    const buffer = this.buffer;\n    if (buffer.length > 0) {\n      this.destination.next(buffer);\n    }\n    super._complete();\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass BufferSkipCountSubscriber<T> extends Subscriber<T> {\n  private buffers: Array<T[]> = [];\n  private count: number = 0;\n\n  constructor(destination: Subscriber<T[]>, private bufferSize: number, private startBufferEvery: number) {\n    super(destination);\n  }\n\n  protected _next(value: T): void {\n    const { bufferSize, startBufferEvery, buffers, count } = this;\n\n    this.count++;\n    if (count % startBufferEvery === 0) {\n      buffers.push([]);\n    }\n\n    for (let i = buffers.length; i--; ) {\n      const buffer = buffers[i];\n      buffer.push(value);\n      if (buffer.length === bufferSize) {\n        buffers.splice(i, 1);\n        this.destination.next(buffer);\n      }\n    }\n  }\n\n  protected _complete(): void {\n    const { buffers, destination } = this;\n\n    while (buffers.length > 0) {\n      let buffer = buffers.shift();\n      if (buffer.length > 0) {\n        destination.next(buffer);\n      }\n    }\n    super._complete();\n  }\n\n}\n","import { Operator } from '../Operator';\nimport { async } from '../scheduler/async';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { isScheduler } from '../util/isScheduler';\nimport { OperatorFunction, SchedulerAction, SchedulerLike } from '../types';\n\n/* tslint:disable:max-line-length */\nexport function bufferTime<T>(bufferTimeSpan: number, scheduler?: SchedulerLike): OperatorFunction<T, T[]>;\nexport function bufferTime<T>(bufferTimeSpan: number, bufferCreationInterval: number | null | undefined, scheduler?: SchedulerLike): OperatorFunction<T, T[]>;\nexport function bufferTime<T>(bufferTimeSpan: number, bufferCreationInterval: number | null | undefined, maxBufferSize: number, scheduler?: SchedulerLike): OperatorFunction<T, T[]>;\n/* tslint:enable:max-line-length */\n\n/**\n * Buffers the source Observable values for a specific time period.\n *\n * <span class=\"informal\">Collects values from the past as an array, and emits\n * those arrays periodically in time.</span>\n *\n * ![](bufferTime.png)\n *\n * Buffers values from the source for a specific time duration `bufferTimeSpan`.\n * Unless the optional argument `bufferCreationInterval` is given, it emits and\n * resets the buffer every `bufferTimeSpan` milliseconds. If\n * `bufferCreationInterval` is given, this operator opens the buffer every\n * `bufferCreationInterval` milliseconds and closes (emits and resets) the\n * buffer every `bufferTimeSpan` milliseconds. When the optional argument\n * `maxBufferSize` is specified, the buffer will be closed either after\n * `bufferTimeSpan` milliseconds or when it contains `maxBufferSize` elements.\n *\n * ## Examples\n *\n * Every second, emit an array of the recent click events\n *\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { bufferTime } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const buffered = clicks.pipe(bufferTime(1000));\n * buffered.subscribe(x => console.log(x));\n * ```\n *\n * Every 5 seconds, emit the click events from the next 2 seconds\n *\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { bufferTime } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const buffered = clicks.pipe(bufferTime(2000, 5000));\n * buffered.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link buffer}\n * @see {@link bufferCount}\n * @see {@link bufferToggle}\n * @see {@link bufferWhen}\n * @see {@link windowTime}\n *\n * @param {number} bufferTimeSpan The amount of time to fill each buffer array.\n * @param {number} [bufferCreationInterval] The interval at which to start new\n * buffers.\n * @param {number} [maxBufferSize] The maximum buffer size.\n * @param {SchedulerLike} [scheduler=async] The scheduler on which to schedule the\n * intervals that determine buffer boundaries.\n * @return {Observable<T[]>} An observable of arrays of buffered values.\n * @method bufferTime\n * @owner Observable\n */\nexport function bufferTime<T>(bufferTimeSpan: number): OperatorFunction<T, T[]> {\n  let length: number = arguments.length;\n\n  let scheduler: SchedulerLike = async;\n  if (isScheduler(arguments[arguments.length - 1])) {\n    scheduler = arguments[arguments.length - 1];\n    length--;\n  }\n\n  let bufferCreationInterval: number = null;\n  if (length >= 2) {\n    bufferCreationInterval = arguments[1];\n  }\n\n  let maxBufferSize: number = Number.POSITIVE_INFINITY;\n  if (length >= 3) {\n    maxBufferSize = arguments[2];\n  }\n\n  return function bufferTimeOperatorFunction(source: Observable<T>) {\n    return source.lift(new BufferTimeOperator<T>(bufferTimeSpan, bufferCreationInterval, maxBufferSize, scheduler));\n  };\n}\n\nclass BufferTimeOperator<T> implements Operator<T, T[]> {\n  constructor(private bufferTimeSpan: number,\n              private bufferCreationInterval: number,\n              private maxBufferSize: number,\n              private scheduler: SchedulerLike) {\n  }\n\n  call(subscriber: Subscriber<T[]>, source: any): any {\n    return source.subscribe(new BufferTimeSubscriber(\n      subscriber, this.bufferTimeSpan, this.bufferCreationInterval, this.maxBufferSize, this.scheduler\n    ));\n  }\n}\n\nclass Context<T> {\n  buffer: T[] = [];\n  closeAction: Subscription;\n}\n\ninterface DispatchCreateArg<T> {\n  bufferTimeSpan: number;\n  bufferCreationInterval: number;\n  subscriber: BufferTimeSubscriber<T>;\n  scheduler: SchedulerLike;\n}\n\ninterface DispatchCloseArg<T> {\n  subscriber: BufferTimeSubscriber<T>;\n  context: Context<T>;\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass BufferTimeSubscriber<T> extends Subscriber<T> {\n  private contexts: Array<Context<T>> = [];\n  private timespanOnly: boolean;\n\n  constructor(destination: Subscriber<T[]>,\n              private bufferTimeSpan: number,\n              private bufferCreationInterval: number,\n              private maxBufferSize: number,\n              private scheduler: SchedulerLike) {\n    super(destination);\n    const context = this.openContext();\n    this.timespanOnly = bufferCreationInterval == null || bufferCreationInterval < 0;\n    if (this.timespanOnly) {\n      const timeSpanOnlyState = { subscriber: this, context, bufferTimeSpan };\n      this.add(context.closeAction = scheduler.schedule(dispatchBufferTimeSpanOnly, bufferTimeSpan, timeSpanOnlyState));\n    } else {\n      const closeState = { subscriber: this, context };\n      const creationState: DispatchCreateArg<T> = { bufferTimeSpan, bufferCreationInterval, subscriber: this, scheduler };\n      this.add(context.closeAction = scheduler.schedule<DispatchCloseArg<T>>(dispatchBufferClose, bufferTimeSpan, closeState));\n      this.add(scheduler.schedule<DispatchCreateArg<T>>(dispatchBufferCreation, bufferCreationInterval, creationState));\n    }\n  }\n\n  protected _next(value: T) {\n    const contexts = this.contexts;\n    const len = contexts.length;\n    let filledBufferContext: Context<T>;\n    for (let i = 0; i < len; i++) {\n      const context = contexts[i];\n      const buffer = context.buffer;\n      buffer.push(value);\n      if (buffer.length == this.maxBufferSize) {\n        filledBufferContext = context;\n      }\n    }\n\n    if (filledBufferContext) {\n      this.onBufferFull(filledBufferContext);\n    }\n  }\n\n  protected _error(err: any) {\n    this.contexts.length = 0;\n    super._error(err);\n  }\n\n  protected _complete() {\n    const { contexts, destination } = this;\n    while (contexts.length > 0) {\n      const context = contexts.shift();\n      destination.next(context.buffer);\n    }\n    super._complete();\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _unsubscribe() {\n    this.contexts = null;\n  }\n\n  protected onBufferFull(context: Context<T>) {\n    this.closeContext(context);\n    const closeAction = context.closeAction;\n    closeAction.unsubscribe();\n    this.remove(closeAction);\n\n    if (!this.closed && this.timespanOnly) {\n      context = this.openContext();\n      const bufferTimeSpan = this.bufferTimeSpan;\n      const timeSpanOnlyState = { subscriber: this, context, bufferTimeSpan };\n      this.add(context.closeAction = this.scheduler.schedule(dispatchBufferTimeSpanOnly, bufferTimeSpan, timeSpanOnlyState));\n    }\n  }\n\n  openContext(): Context<T> {\n    const context: Context<T> = new Context<T>();\n    this.contexts.push(context);\n    return context;\n  }\n\n  closeContext(context: Context<T>) {\n    this.destination.next(context.buffer);\n    const contexts = this.contexts;\n\n    const spliceIndex = contexts ? contexts.indexOf(context) : -1;\n    if (spliceIndex >= 0) {\n      contexts.splice(contexts.indexOf(context), 1);\n    }\n  }\n}\n\nfunction dispatchBufferTimeSpanOnly(this: SchedulerAction<any>, state: any) {\n  const subscriber: BufferTimeSubscriber<any> = state.subscriber;\n\n  const prevContext = state.context;\n  if (prevContext) {\n    subscriber.closeContext(prevContext);\n  }\n\n  if (!subscriber.closed) {\n    state.context = subscriber.openContext();\n    state.context.closeAction = this.schedule(state, state.bufferTimeSpan);\n  }\n}\n\nfunction dispatchBufferCreation<T>(this: SchedulerAction<DispatchCreateArg<T>>, state: DispatchCreateArg<T>) {\n  const { bufferCreationInterval, bufferTimeSpan, subscriber, scheduler } = state;\n  const context = subscriber.openContext();\n  const action = <SchedulerAction<DispatchCreateArg<T>>>this;\n  if (!subscriber.closed) {\n    subscriber.add(context.closeAction = scheduler.schedule<DispatchCloseArg<T>>(dispatchBufferClose, bufferTimeSpan, { subscriber, context }));\n    action.schedule(state, bufferCreationInterval);\n  }\n}\n\nfunction dispatchBufferClose<T>(arg: DispatchCloseArg<T>) {\n  const { subscriber, context } = arg;\n  subscriber.closeContext(context);\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { Subscription } from '../Subscription';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { OperatorFunction, SubscribableOrPromise } from '../types';\n\n/**\n * Buffers the source Observable values starting from an emission from\n * `openings` and ending when the output of `closingSelector` emits.\n *\n * <span class=\"informal\">Collects values from the past as an array. Starts\n * collecting only when `opening` emits, and calls the `closingSelector`\n * function to get an Observable that tells when to close the buffer.</span>\n *\n * ![](bufferToggle.png)\n *\n * Buffers values from the source by opening the buffer via signals from an\n * Observable provided to `openings`, and closing and sending the buffers when\n * a Subscribable or Promise returned by the `closingSelector` function emits.\n *\n * ## Example\n *\n * Every other second, emit the click events from the next 500ms\n *\n * ```ts\n * import { fromEvent, interval, EMPTY } from 'rxjs';\n * import { bufferToggle } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const openings = interval(1000);\n * const buffered = clicks.pipe(bufferToggle(openings, i =>\n *   i % 2 ? interval(500) : EMPTY\n * ));\n * buffered.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link buffer}\n * @see {@link bufferCount}\n * @see {@link bufferTime}\n * @see {@link bufferWhen}\n * @see {@link windowToggle}\n *\n * @param {SubscribableOrPromise<O>} openings A Subscribable or Promise of notifications to start new\n * buffers.\n * @param {function(value: O): SubscribableOrPromise} closingSelector A function that takes\n * the value emitted by the `openings` observable and returns a Subscribable or Promise,\n * which, when it emits, signals that the associated buffer should be emitted\n * and cleared.\n * @return {Observable<T[]>} An observable of arrays of buffered values.\n * @method bufferToggle\n * @owner Observable\n */\nexport function bufferToggle<T, O>(\n  openings: SubscribableOrPromise<O>,\n  closingSelector: (value: O) => SubscribableOrPromise<any>\n): OperatorFunction<T, T[]> {\n  return function bufferToggleOperatorFunction(source: Observable<T>) {\n    return source.lift(new BufferToggleOperator<T, O>(openings, closingSelector));\n  };\n}\n\nclass BufferToggleOperator<T, O> implements Operator<T, T[]> {\n\n  constructor(private openings: SubscribableOrPromise<O>,\n              private closingSelector: (value: O) => SubscribableOrPromise<any>) {\n  }\n\n  call(subscriber: Subscriber<T[]>, source: any): any {\n    return source.subscribe(new BufferToggleSubscriber(subscriber, this.openings, this.closingSelector));\n  }\n}\n\ninterface BufferContext<T> {\n  buffer: T[];\n  subscription: Subscription;\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass BufferToggleSubscriber<T, O> extends OuterSubscriber<T, O> {\n  private contexts: Array<BufferContext<T>> = [];\n\n  constructor(destination: Subscriber<T[]>,\n              private openings: SubscribableOrPromise<O>,\n              private closingSelector: (value: O) => SubscribableOrPromise<any> | void) {\n    super(destination);\n    this.add(subscribeToResult(this, openings));\n  }\n\n  protected _next(value: T): void {\n    const contexts = this.contexts;\n    const len = contexts.length;\n    for (let i = 0; i < len; i++) {\n      contexts[i].buffer.push(value);\n    }\n  }\n\n  protected _error(err: any): void {\n    const contexts = this.contexts;\n    while (contexts.length > 0) {\n      const context = contexts.shift();\n      context.subscription.unsubscribe();\n      context.buffer = null;\n      context.subscription = null;\n    }\n    this.contexts = null;\n    super._error(err);\n  }\n\n  protected _complete(): void {\n    const contexts = this.contexts;\n    while (contexts.length > 0) {\n      const context = contexts.shift();\n      this.destination.next(context.buffer);\n      context.subscription.unsubscribe();\n      context.buffer = null;\n      context.subscription = null;\n    }\n    this.contexts = null;\n    super._complete();\n  }\n\n  notifyNext(outerValue: any, innerValue: O,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, O>): void {\n    outerValue ? this.closeBuffer(outerValue) : this.openBuffer(innerValue);\n  }\n\n  notifyComplete(innerSub: InnerSubscriber<T, O>): void {\n    this.closeBuffer((<any> innerSub).context);\n  }\n\n  private openBuffer(value: O): void {\n    try {\n      const closingSelector = this.closingSelector;\n      const closingNotifier = closingSelector.call(this, value);\n      if (closingNotifier) {\n        this.trySubscribe(closingNotifier);\n      }\n    } catch (err) {\n      this._error(err);\n    }\n  }\n\n  private closeBuffer(context: BufferContext<T>): void {\n    const contexts = this.contexts;\n\n    if (contexts && context) {\n      const { buffer, subscription } = context;\n      this.destination.next(buffer);\n      contexts.splice(contexts.indexOf(context), 1);\n      this.remove(subscription);\n      subscription.unsubscribe();\n    }\n  }\n\n  private trySubscribe(closingNotifier: any): void {\n    const contexts = this.contexts;\n\n    const buffer: Array<T> = [];\n    const subscription = new Subscription();\n    const context = { buffer, subscription };\n    contexts.push(context);\n\n    const innerSubscription = subscribeToResult(this, closingNotifier, <any>context);\n\n    if (!innerSubscription || innerSubscription.closed) {\n      this.closeBuffer(context);\n    } else {\n      (<any> innerSubscription).context = context;\n\n      this.add(innerSubscription);\n      subscription.add(innerSubscription);\n    }\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { Subscription } from '../Subscription';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { OperatorFunction } from '../types';\n\n/**\n * Buffers the source Observable values, using a factory function of closing\n * Observables to determine when to close, emit, and reset the buffer.\n *\n * <span class=\"informal\">Collects values from the past as an array. When it\n * starts collecting values, it calls a function that returns an Observable that\n * tells when to close the buffer and restart collecting.</span>\n *\n * ![](bufferWhen.png)\n *\n * Opens a buffer immediately, then closes the buffer when the observable\n * returned by calling `closingSelector` function emits a value. When it closes\n * the buffer, it immediately opens a new buffer and repeats the process.\n *\n * ## Example\n *\n * Emit an array of the last clicks every [1-5] random seconds\n *\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { bufferWhen } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const buffered = clicks.pipe(bufferWhen(() =>\n *   interval(1000 + Math.random() * 4000)\n * ));\n * buffered.subscribe(x => console.log(x));\n * ```\n *\n *\n * @see {@link buffer}\n * @see {@link bufferCount}\n * @see {@link bufferTime}\n * @see {@link bufferToggle}\n * @see {@link windowWhen}\n *\n * @param {function(): Observable} closingSelector A function that takes no\n * arguments and returns an Observable that signals buffer closure.\n * @return {Observable<T[]>} An observable of arrays of buffered values.\n * @method bufferWhen\n * @owner Observable\n */\nexport function bufferWhen<T>(closingSelector: () => Observable<any>): OperatorFunction<T, T[]> {\n  return function (source: Observable<T>) {\n    return source.lift(new BufferWhenOperator(closingSelector));\n  };\n}\n\nclass BufferWhenOperator<T> implements Operator<T, T[]> {\n\n  constructor(private closingSelector: () => Observable<any>) {\n  }\n\n  call(subscriber: Subscriber<T[]>, source: any): any {\n    return source.subscribe(new BufferWhenSubscriber(subscriber, this.closingSelector));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass BufferWhenSubscriber<T> extends OuterSubscriber<T, any> {\n  private buffer: T[];\n  private subscribing: boolean = false;\n  private closingSubscription: Subscription;\n\n  constructor(destination: Subscriber<T[]>, private closingSelector: () => Observable<any>) {\n    super(destination);\n    this.openBuffer();\n  }\n\n  protected _next(value: T) {\n    this.buffer.push(value);\n  }\n\n  protected _complete() {\n    const buffer = this.buffer;\n    if (buffer) {\n      this.destination.next(buffer);\n    }\n    super._complete();\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _unsubscribe() {\n    this.buffer = null;\n    this.subscribing = false;\n  }\n\n  notifyNext(outerValue: T, innerValue: any,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, any>): void {\n    this.openBuffer();\n  }\n\n  notifyComplete(): void {\n    if (this.subscribing) {\n      this.complete();\n    } else {\n      this.openBuffer();\n    }\n  }\n\n  openBuffer() {\n    let { closingSubscription } = this;\n\n    if (closingSubscription) {\n      this.remove(closingSubscription);\n      closingSubscription.unsubscribe();\n    }\n\n    const buffer = this.buffer;\n    if (this.buffer) {\n      this.destination.next(buffer);\n    }\n\n    this.buffer = [];\n\n    let closingNotifier;\n    try {\n      const { closingSelector } = this;\n      closingNotifier = closingSelector();\n    } catch (err) {\n      return this.error(err);\n    }\n    closingSubscription = new Subscription();\n    this.closingSubscription = closingSubscription;\n    this.add(closingSubscription);\n    this.subscribing = true;\n    closingSubscription.add(subscribeToResult(this, closingNotifier));\n    this.subscribing = false;\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\n\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { ObservableInput, OperatorFunction, ObservedValueOf } from '../types';\n\n/* tslint:disable:max-line-length */\nexport function catchError<T, O extends ObservableInput<any>>(selector: (err: any, caught: Observable<T>) => O): OperatorFunction<T, T | ObservedValueOf<O>>;\n/* tslint:enable:max-line-length */\n\n/**\n * Catches errors on the observable to be handled by returning a new observable or throwing an error.\n *\n * ![](catch.png)\n *\n * ## Examples\n * Continues with a different Observable when there's an error\n *\n * ```ts\n * import { of } from 'rxjs';\n * import { map, catchError } from 'rxjs/operators';\n *\n * of(1, 2, 3, 4, 5).pipe(\n *     map(n => {\n *   \t   if (n === 4) {\n * \t       throw 'four!';\n *       }\n *\t     return n;\n *     }),\n *     catchError(err => of('I', 'II', 'III', 'IV', 'V')),\n *   )\n *   .subscribe(x => console.log(x));\n *   // 1, 2, 3, I, II, III, IV, V\n * ```\n *\n * Retries the caught source Observable again in case of error, similar to retry() operator\n *\n * ```ts\n * import { of } from 'rxjs';\n * import { map, catchError, take } from 'rxjs/operators';\n *\n * of(1, 2, 3, 4, 5).pipe(\n *     map(n => {\n *   \t   if (n === 4) {\n *   \t     throw 'four!';\n *       }\n * \t     return n;\n *     }),\n *     catchError((err, caught) => caught),\n *     take(30),\n *   )\n *   .subscribe(x => console.log(x));\n *   // 1, 2, 3, 1, 2, 3, ...\n * ```\n *\n * Throws a new error when the source Observable throws an error\n *\n * ```ts\n * import { of } from 'rxjs';\n * import { map, catchError } from 'rxjs/operators';\n *\n * of(1, 2, 3, 4, 5).pipe(\n *     map(n => {\n *       if (n === 4) {\n *         throw 'four!';\n *       }\n *       return n;\n *     }),\n *     catchError(err => {\n *       throw 'error in source. Details: ' + err;\n *     }),\n *   )\n *   .subscribe(\n *     x => console.log(x),\n *     err => console.log(err)\n *   );\n *   // 1, 2, 3, error in source. Details: four!\n * ```\n *\n *  @param {function} selector a function that takes as arguments `err`, which is the error, and `caught`, which\n *  is the source observable, in case you'd like to \"retry\" that observable by returning it again. Whatever observable\n *  is returned by the `selector` will be used to continue the observable chain.\n * @return {Observable} An observable that originates from either the source or the observable returned by the\n *  catch `selector` function.\n * @name catchError\n */\nexport function catchError<T, O extends ObservableInput<any>>(\n  selector: (err: any, caught: Observable<T>) => O\n): OperatorFunction<T, T | ObservedValueOf<O>> {\n  return function catchErrorOperatorFunction(source: Observable<T>): Observable<T | ObservedValueOf<O>> {\n    const operator = new CatchOperator(selector);\n    const caught = source.lift(operator);\n    return (operator.caught = caught as Observable<T>);\n  };\n}\n\nclass CatchOperator<T, R> implements Operator<T, T | R> {\n  caught: Observable<T>;\n\n  constructor(private selector: (err: any, caught: Observable<T>) => ObservableInput<T | R>) {\n  }\n\n  call(subscriber: Subscriber<R>, source: any): any {\n    return source.subscribe(new CatchSubscriber(subscriber, this.selector, this.caught));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass CatchSubscriber<T, R> extends OuterSubscriber<T, T | R> {\n  constructor(destination: Subscriber<any>,\n              private selector: (err: any, caught: Observable<T>) => ObservableInput<T | R>,\n              private caught: Observable<T>) {\n    super(destination);\n  }\n\n  // NOTE: overriding `error` instead of `_error` because we don't want\n  // to have this flag this subscriber as `isStopped`. We can mimic the\n  // behavior of the RetrySubscriber (from the `retry` operator), where\n  // we unsubscribe from our source chain, reset our Subscriber flags,\n  // then subscribe to the selector result.\n  error(err: any) {\n    if (!this.isStopped) {\n      let result: any;\n      try {\n        result = this.selector(err, this.caught);\n      } catch (err2) {\n        super.error(err2);\n        return;\n      }\n      this._unsubscribeAndRecycle();\n      const innerSubscriber = new InnerSubscriber(this, undefined, undefined);\n      this.add(innerSubscriber);\n      subscribeToResult(this, result, undefined, undefined, innerSubscriber);\n    }\n  }\n}\n","import { CombineLatestOperator } from '../observable/combineLatest';\nimport { Observable } from '../Observable';\nimport { OperatorFunction, ObservableInput } from '../types';\n\nexport function combineAll<T>(): OperatorFunction<ObservableInput<T>, T[]>;\nexport function combineAll<T>(): OperatorFunction<any, T[]>;\nexport function combineAll<T, R>(project: (...values: T[]) => R): OperatorFunction<ObservableInput<T>, R>;\nexport function combineAll<R>(project: (...values: Array<any>) => R): OperatorFunction<any, R>;\n/**\n * Flattens an Observable-of-Observables by applying {@link combineLatest} when the Observable-of-Observables completes.\n *\n * ![](combineAll.png)\n *\n * `combineAll` takes an Observable of Observables, and collects all Observables from it. Once the outer Observable completes,\n * it subscribes to all collected Observables and combines their values using the {@link combineLatest}</a> strategy, such that:\n *\n * * Every time an inner Observable emits, the output Observable emits\n * * When the returned observable emits, it emits all of the latest values by:\n *    * If a `project` function is provided, it is called with each recent value from each inner Observable in whatever order they\n *      arrived, and the result of the `project` function is what is emitted by the output Observable.\n *    * If there is no `project` function, an array of all the most recent values is emitted by the output Observable.\n *\n * ---\n *\n * ## Examples\n *\n * ### Map two click events to a finite interval Observable, then apply `combineAll`\n *\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { map, combineAll, take } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const higherOrder = clicks.pipe(\n *   map(ev =>\n *      interval(Math.random() * 2000).pipe(take(3))\n *   ),\n *   take(2)\n * );\n * const result = higherOrder.pipe(\n *   combineAll()\n * );\n *\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link combineLatest}\n * @see {@link mergeAll}\n *\n * @param {function(...values: Array<any>)} An optional function to map the most recent values from each inner Observable into a new result.\n * Takes each of the most recent values from each collected inner Observable as arguments, in order.\n * @return {Observable<T>}\n * @name combineAll\n */\nexport function combineAll<T, R>(project?: (...values: Array<any>) => R): OperatorFunction<T, R> {\n  return (source: Observable<T>) => source.lift(new CombineLatestOperator(project));\n}\n","\nimport { isArray } from '../util/isArray';\nimport { CombineLatestOperator } from '../observable/combineLatest';\nimport { from } from '../observable/from';\nimport { Observable } from '../Observable';\nimport { ObservableInput, OperatorFunction } from '../types';\n\nconst none = {};\n\n/* tslint:disable:max-line-length */\n/** @deprecated Deprecated in favor of static combineLatest. */\nexport function combineLatest<T, R>(project: (v1: T) => R): OperatorFunction<T, R>;\n/** @deprecated Deprecated in favor of static combineLatest. */\nexport function combineLatest<T, T2, R>(v2: ObservableInput<T2>, project: (v1: T, v2: T2) => R): OperatorFunction<T, R>;\n/** @deprecated Deprecated in favor of static combineLatest. */\nexport function combineLatest<T, T2, T3, R>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, project: (v1: T, v2: T2, v3: T3) => R): OperatorFunction<T, R>;\n/** @deprecated Deprecated in favor of static combineLatest. */\nexport function combineLatest<T, T2, T3, T4, R>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, project: (v1: T, v2: T2, v3: T3, v4: T4) => R): OperatorFunction<T, R>;\n/** @deprecated Deprecated in favor of static combineLatest. */\nexport function combineLatest<T, T2, T3, T4, T5, R>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, project: (v1: T, v2: T2, v3: T3, v4: T4, v5: T5) => R): OperatorFunction<T, R>;\n/** @deprecated Deprecated in favor of static combineLatest. */\nexport function combineLatest<T, T2, T3, T4, T5, T6, R>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, v6: ObservableInput<T6>, project: (v1: T, v2: T2, v3: T3, v4: T4, v5: T5, v6: T6) => R): OperatorFunction<T, R> ;\n/** @deprecated Deprecated in favor of static combineLatest. */\nexport function combineLatest<T, T2>(v2: ObservableInput<T2>): OperatorFunction<T, [T, T2]>;\n/** @deprecated Deprecated in favor of static combineLatest. */\nexport function combineLatest<T, T2, T3>(v2: ObservableInput<T2>, v3: ObservableInput<T3>): OperatorFunction<T, [T, T2, T3]>;\n/** @deprecated Deprecated in favor of static combineLatest. */\nexport function combineLatest<T, T2, T3, T4>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>): OperatorFunction<T, [T, T2, T3, T4]>;\n/** @deprecated Deprecated in favor of static combineLatest. */\nexport function combineLatest<T, T2, T3, T4, T5>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>): OperatorFunction<T, [T, T2, T3, T4, T5]>;\n/** @deprecated Deprecated in favor of static combineLatest. */\nexport function combineLatest<T, T2, T3, T4, T5, T6>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, v6: ObservableInput<T6>): OperatorFunction<T, [T, T2, T3, T4, T5, T6]> ;\n/** @deprecated Deprecated in favor of static combineLatest. */\nexport function combineLatest<T, R>(...observables: Array<ObservableInput<T> | ((...values: Array<T>) => R)>): OperatorFunction<T, R>;\n/** @deprecated Deprecated in favor of static combineLatest. */\nexport function combineLatest<T, R>(array: ObservableInput<T>[]): OperatorFunction<T, Array<T>>;\n/** @deprecated Deprecated in favor of static combineLatest. */\nexport function combineLatest<T, TOther, R>(array: ObservableInput<TOther>[], project: (v1: T, ...values: Array<TOther>) => R): OperatorFunction<T, R>;\n/* tslint:enable:max-line-length */\n\n/**\n * @deprecated Deprecated in favor of static {@link combineLatest}.\n */\nexport function combineLatest<T, R>(...observables: Array<ObservableInput<any> |\n                                                    Array<ObservableInput<any>> |\n                                                    ((...values: Array<any>) => R)>): OperatorFunction<T, R> {\n  let project: (...values: Array<any>) => R = null;\n  if (typeof observables[observables.length - 1] === 'function') {\n    project = <(...values: Array<any>) => R>observables.pop();\n  }\n\n  // if the first and only other argument besides the resultSelector is an array\n  // assume it's been called with `combineLatest([obs1, obs2, obs3], project)`\n  if (observables.length === 1 && isArray(observables[0])) {\n    observables = (<any>observables[0]).slice();\n  }\n\n  return (source: Observable<T>) => source.lift.call(from([source, ...observables]), new CombineLatestOperator(project));\n}\n","import {  concat as concatStatic } from '../observable/concat';\nimport { Observable } from '../Observable';\nimport { ObservableInput, OperatorFunction, MonoTypeOperatorFunction, SchedulerLike } from '../types';\n\n/* tslint:disable:max-line-length */\n/** @deprecated Deprecated in favor of static concat. */\nexport function concat<T>(scheduler?: SchedulerLike): MonoTypeOperatorFunction<T>;\n/** @deprecated Deprecated in favor of static concat. */\nexport function concat<T, T2>(v2: ObservableInput<T2>, scheduler?: SchedulerLike): OperatorFunction<T, T | T2>;\n/** @deprecated Deprecated in favor of static concat. */\nexport function concat<T, T2, T3>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, scheduler?: SchedulerLike): OperatorFunction<T, T | T2 | T3>;\n/** @deprecated Deprecated in favor of static concat. */\nexport function concat<T, T2, T3, T4>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, scheduler?: SchedulerLike): OperatorFunction<T, T | T2 | T3 | T4>;\n/** @deprecated Deprecated in favor of static concat. */\nexport function concat<T, T2, T3, T4, T5>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, scheduler?: SchedulerLike): OperatorFunction<T, T | T2 | T3 | T4 | T5>;\n/** @deprecated Deprecated in favor of static concat. */\nexport function concat<T, T2, T3, T4, T5, T6>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, v6: ObservableInput<T6>, scheduler?: SchedulerLike): OperatorFunction<T, T | T2 | T3 | T4 | T5 | T6>;\n/** @deprecated Deprecated in favor of static concat. */\nexport function concat<T>(...observables: Array<ObservableInput<T> | SchedulerLike>): MonoTypeOperatorFunction<T>;\n/** @deprecated Deprecated in favor of static concat. */\nexport function concat<T, R>(...observables: Array<ObservableInput<any> | SchedulerLike>): OperatorFunction<T, R>;\n/* tslint:enable:max-line-length */\n\n/**\n * @deprecated Deprecated in favor of static {@link concat}.\n */\nexport function concat<T, R>(...observables: Array<ObservableInput<any> | SchedulerLike>): OperatorFunction<T, R> {\n  return (source: Observable<T>) => source.lift.call(concatStatic(source, ...observables));\n}\n","import { mergeMap } from './mergeMap';\nimport { ObservableInput, OperatorFunction, ObservedValueOf } from '../types';\n\n/* tslint:disable:max-line-length */\nexport function concatMap<T, O extends ObservableInput<any>>(project: (value: T, index: number) =>  O): OperatorFunction<T, ObservedValueOf<O>>;\n/** @deprecated resultSelector no longer supported, use inner map instead */\nexport function concatMap<T, O extends ObservableInput<any>>(project: (value: T, index: number) => O, resultSelector: undefined): OperatorFunction<T, ObservedValueOf<O>>;\n/** @deprecated resultSelector no longer supported, use inner map instead */\nexport function concatMap<T, R, O extends ObservableInput<any>>(project: (value: T, index: number) =>  O, resultSelector: (outerValue: T, innerValue: ObservedValueOf<O>, outerIndex: number, innerIndex: number) => R): OperatorFunction<T, R>;\n/* tslint:enable:max-line-length */\n\n/**\n * Projects each source value to an Observable which is merged in the output\n * Observable, in a serialized fashion waiting for each one to complete before\n * merging the next.\n *\n * <span class=\"informal\">Maps each value to an Observable, then flattens all of\n * these inner Observables using {@link concatAll}.</span>\n *\n * ![](concatMap.png)\n *\n * Returns an Observable that emits items based on applying a function that you\n * supply to each item emitted by the source Observable, where that function\n * returns an (so-called \"inner\") Observable. Each new inner Observable is\n * concatenated with the previous inner Observable.\n *\n * __Warning:__ if source values arrive endlessly and faster than their\n * corresponding inner Observables can complete, it will result in memory issues\n * as inner Observables amass in an unbounded buffer waiting for their turn to\n * be subscribed to.\n *\n * Note: `concatMap` is equivalent to `mergeMap` with concurrency parameter set\n * to `1`.\n *\n * ## Example\n * For each click event, tick every second from 0 to 3, with no concurrency\n *\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { concatMap, take } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(\n *   concatMap(ev => interval(1000).pipe(take(4)))\n * );\n * result.subscribe(x => console.log(x));\n *\n * // Results in the following:\n * // (results are not concurrent)\n * // For every click on the \"document\" it will emit values 0 to 3 spaced\n * // on a 1000ms interval\n * // one click = 1000ms-> 0 -1000ms-> 1 -1000ms-> 2 -1000ms-> 3\n * ```\n *\n * @see {@link concat}\n * @see {@link concatAll}\n * @see {@link concatMapTo}\n * @see {@link exhaustMap}\n * @see {@link mergeMap}\n * @see {@link switchMap}\n *\n * @param {function(value: T, ?index: number): ObservableInput} project A function\n * that, when applied to an item emitted by the source Observable, returns an\n * Observable.\n * @return {Observable} An Observable that emits the result of applying the\n * projection function (and the optional deprecated `resultSelector`) to each item emitted\n * by the source Observable and taking values from each projected inner\n * Observable sequentially.\n * @method concatMap\n * @owner Observable\n */\nexport function concatMap<T, R, O extends ObservableInput<any>>(\n  project: (value: T, index: number) => O,\n  resultSelector?: (outerValue: T, innerValue: ObservedValueOf<O>, outerIndex: number, innerIndex: number) => R\n): OperatorFunction<T, ObservedValueOf<O>|R> {\n  return mergeMap(project, resultSelector, 1);\n}\n","import { concatMap } from './concatMap';\nimport { ObservableInput, OperatorFunction, ObservedValueOf } from '../types';\n\n/* tslint:disable:max-line-length */\nexport function concatMapTo<T, O extends ObservableInput<any>>(observable: O): OperatorFunction<T, ObservedValueOf<O>>;\n/** @deprecated */\nexport function concatMapTo<T, O extends ObservableInput<any>>(observable: O, resultSelector: undefined): OperatorFunction<T, ObservedValueOf<O>>;\n/** @deprecated */\nexport function concatMapTo<T, R, O extends ObservableInput<any>>(observable: O, resultSelector: (outerValue: T, innerValue: ObservedValueOf<O>, outerIndex: number, innerIndex: number) => R): OperatorFunction<T, R>;\n/* tslint:enable:max-line-length */\n\n/**\n * Projects each source value to the same Observable which is merged multiple\n * times in a serialized fashion on the output Observable.\n *\n * <span class=\"informal\">It's like {@link concatMap}, but maps each value\n * always to the same inner Observable.</span>\n *\n * ![](concatMapTo.png)\n *\n * Maps each source value to the given Observable `innerObservable` regardless\n * of the source value, and then flattens those resulting Observables into one\n * single Observable, which is the output Observable. Each new `innerObservable`\n * instance emitted on the output Observable is concatenated with the previous\n * `innerObservable` instance.\n *\n * __Warning:__ if source values arrive endlessly and faster than their\n * corresponding inner Observables can complete, it will result in memory issues\n * as inner Observables amass in an unbounded buffer waiting for their turn to\n * be subscribed to.\n *\n * Note: `concatMapTo` is equivalent to `mergeMapTo` with concurrency parameter\n * set to `1`.\n *\n * ## Example\n * For each click event, tick every second from 0 to 3, with no concurrency\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { concatMapTo, take } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(\n *   concatMapTo(interval(1000).pipe(take(4))),\n * );\n * result.subscribe(x => console.log(x));\n *\n * // Results in the following:\n * // (results are not concurrent)\n * // For every click on the \"document\" it will emit values 0 to 3 spaced\n * // on a 1000ms interval\n * // one click = 1000ms-> 0 -1000ms-> 1 -1000ms-> 2 -1000ms-> 3\n * ```\n *\n * @see {@link concat}\n * @see {@link concatAll}\n * @see {@link concatMap}\n * @see {@link mergeMapTo}\n * @see {@link switchMapTo}\n *\n * @param {ObservableInput} innerObservable An Observable to replace each value from\n * the source Observable.\n * @return {Observable} An observable of values merged together by joining the\n * passed observable with itself, one after the other, for each value emitted\n * from the source.\n * @method concatMapTo\n * @owner Observable\n */\nexport function concatMapTo<T, R, O extends ObservableInput<any>>(\n  innerObservable: O,\n  resultSelector?: (outerValue: T, innerValue: ObservedValueOf<O>, outerIndex: number, innerIndex: number) => R\n): OperatorFunction<T, ObservedValueOf<O>|R> {\n  return concatMap(() => innerObservable, resultSelector);\n}\n","import { Observable } from '../Observable';\nimport { Operator } from '../Operator';\nimport { Observer, OperatorFunction } from '../types';\nimport { Subscriber } from '../Subscriber';\n/**\n * Counts the number of emissions on the source and emits that number when the\n * source completes.\n *\n * <span class=\"informal\">Tells how many values were emitted, when the source\n * completes.</span>\n *\n * ![](count.png)\n *\n * `count` transforms an Observable that emits values into an Observable that\n * emits a single value that represents the number of values emitted by the\n * source Observable. If the source Observable terminates with an error, `count`\n * will pass this error notification along without emitting a value first. If\n * the source Observable does not terminate at all, `count` will neither emit\n * a value nor terminate. This operator takes an optional `predicate` function\n * as argument, in which case the output emission will represent the number of\n * source values that matched `true` with the `predicate`.\n *\n * ## Examples\n *\n * Counts how many seconds have passed before the first click happened\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { count, takeUntil } from 'rxjs/operators';\n *\n * const seconds = interval(1000);\n * const clicks = fromEvent(document, 'click');\n * const secondsBeforeClick = seconds.pipe(takeUntil(clicks));\n * const result = secondsBeforeClick.pipe(count());\n * result.subscribe(x => console.log(x));\n * ```\n *\n * Counts how many odd numbers are there between 1 and 7\n * ```ts\n * import { range } from 'rxjs';\n * import { count } from 'rxjs/operators';\n *\n * const numbers = range(1, 7);\n * const result = numbers.pipe(count(i => i % 2 === 1));\n * result.subscribe(x => console.log(x));\n * // Results in:\n * // 4\n * ```\n *\n * @see {@link max}\n * @see {@link min}\n * @see {@link reduce}\n *\n * @param {function(value: T, i: number, source: Observable<T>): boolean} [predicate] A\n * boolean function to select what values are to be counted. It is provided with\n * arguments of:\n * - `value`: the value from the source Observable.\n * - `index`: the (zero-based) \"index\" of the value from the source Observable.\n * - `source`: the source Observable instance itself.\n * @return {Observable} An Observable of one number that represents the count as\n * described above.\n * @method count\n * @owner Observable\n */\n\nexport function count<T>(predicate?: (value: T, index: number, source: Observable<T>) => boolean): OperatorFunction<T, number> {\n  return (source: Observable<T>) => source.lift(new CountOperator(predicate, source));\n}\n\nclass CountOperator<T> implements Operator<T, number> {\n  constructor(private predicate?: (value: T, index: number, source: Observable<T>) => boolean,\n              private source?: Observable<T>) {\n  }\n\n  call(subscriber: Subscriber<number>, source: any): any {\n    return source.subscribe(new CountSubscriber(subscriber, this.predicate, this.source));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass CountSubscriber<T> extends Subscriber<T> {\n  private count: number = 0;\n  private index: number = 0;\n\n  constructor(destination: Observer<number>,\n              private predicate?: (value: T, index: number, source: Observable<T>) => boolean,\n              private source?: Observable<T>) {\n    super(destination);\n  }\n\n  protected _next(value: T): void {\n    if (this.predicate) {\n      this._tryPredicate(value);\n    } else {\n      this.count++;\n    }\n  }\n\n  private _tryPredicate(value: T) {\n    let result: any;\n\n    try {\n      result = this.predicate(value, this.index++, this.source);\n    } catch (err) {\n      this.destination.error(err);\n      return;\n    }\n\n    if (result) {\n      this.count++;\n    }\n  }\n\n  protected _complete(): void {\n    this.destination.next(this.count);\n    this.destination.complete();\n  }\n}\n","import { Operator } from '../Operator';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { MonoTypeOperatorFunction, SubscribableOrPromise, TeardownLogic } from '../types';\n\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\n\n/**\n * Emits a value from the source Observable only after a particular time span\n * determined by another Observable has passed without another source emission.\n *\n * <span class=\"informal\">It's like {@link debounceTime}, but the time span of\n * emission silence is determined by a second Observable.</span>\n *\n * ![](debounce.png)\n *\n * `debounce` delays values emitted by the source Observable, but drops previous\n * pending delayed emissions if a new value arrives on the source Observable.\n * This operator keeps track of the most recent value from the source\n * Observable, and spawns a duration Observable by calling the\n * `durationSelector` function. The value is emitted only when the duration\n * Observable emits a value or completes, and if no other value was emitted on\n * the source Observable since the duration Observable was spawned. If a new\n * value appears before the duration Observable emits, the previous value will\n * be dropped and will not be emitted on the output Observable.\n *\n * Like {@link debounceTime}, this is a rate-limiting operator, and also a\n * delay-like operator since output emissions do not necessarily occur at the\n * same time as they did on the source Observable.\n *\n * ## Example\n * Emit the most recent click after a burst of clicks\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { debounce } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(debounce(() => interval(1000)));\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link audit}\n * @see {@link debounceTime}\n * @see {@link delayWhen}\n * @see {@link throttle}\n *\n * @param {function(value: T): SubscribableOrPromise} durationSelector A function\n * that receives a value from the source Observable, for computing the timeout\n * duration for each source value, returned as an Observable or a Promise.\n * @return {Observable} An Observable that delays the emissions of the source\n * Observable by the specified duration Observable returned by\n * `durationSelector`, and may drop some values if they occur too frequently.\n * @method debounce\n * @owner Observable\n */\nexport function debounce<T>(durationSelector: (value: T) => SubscribableOrPromise<any>): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => source.lift(new DebounceOperator(durationSelector));\n}\n\nclass DebounceOperator<T> implements Operator<T, T> {\n  constructor(private durationSelector: (value: T) => SubscribableOrPromise<any>) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new DebounceSubscriber(subscriber, this.durationSelector));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass DebounceSubscriber<T, R> extends OuterSubscriber<T, R> {\n  private value: T;\n  private hasValue: boolean = false;\n  private durationSubscription: Subscription = null;\n\n  constructor(destination: Subscriber<R>,\n              private durationSelector: (value: T) => SubscribableOrPromise<any>) {\n    super(destination);\n  }\n\n  protected _next(value: T): void {\n    try {\n      const result = this.durationSelector.call(this, value);\n\n      if (result) {\n        this._tryNext(value, result);\n      }\n    } catch (err) {\n      this.destination.error(err);\n    }\n  }\n\n  protected _complete(): void {\n    this.emitValue();\n    this.destination.complete();\n  }\n\n  private _tryNext(value: T, duration: SubscribableOrPromise<any>): void {\n    let subscription = this.durationSubscription;\n    this.value = value;\n    this.hasValue = true;\n    if (subscription) {\n      subscription.unsubscribe();\n      this.remove(subscription);\n    }\n\n    subscription = subscribeToResult(this, duration);\n    if (subscription && !subscription.closed) {\n      this.add(this.durationSubscription = subscription);\n    }\n  }\n\n  notifyNext(outerValue: T, innerValue: R,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, R>): void {\n    this.emitValue();\n  }\n\n  notifyComplete(): void {\n    this.emitValue();\n  }\n\n  emitValue(): void {\n    if (this.hasValue) {\n      const value = this.value;\n      const subscription = this.durationSubscription;\n      if (subscription) {\n        this.durationSubscription = null;\n        subscription.unsubscribe();\n        this.remove(subscription);\n      }\n      // This must be done *before* passing the value\n      // along to the destination because it's possible for\n      // the value to synchronously re-enter this operator\n      // recursively if the duration selector Observable\n      // emits synchronously\n      this.value = null;\n      this.hasValue = false;\n      super._next(value);\n    }\n  }\n}\n","import { Operator } from '../Operator';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { async } from '../scheduler/async';\nimport { MonoTypeOperatorFunction, SchedulerLike, TeardownLogic } from '../types';\n\n/**\n * Emits a value from the source Observable only after a particular time span\n * has passed without another source emission.\n *\n * <span class=\"informal\">It's like {@link delay}, but passes only the most\n * recent value from each burst of emissions.</span>\n *\n * ![](debounceTime.png)\n *\n * `debounceTime` delays values emitted by the source Observable, but drops\n * previous pending delayed emissions if a new value arrives on the source\n * Observable. This operator keeps track of the most recent value from the\n * source Observable, and emits that only when `dueTime` enough time has passed\n * without any other value appearing on the source Observable. If a new value\n * appears before `dueTime` silence occurs, the previous value will be dropped\n * and will not be emitted on the output Observable.\n *\n * This is a rate-limiting operator, because it is impossible for more than one\n * value to be emitted in any time window of duration `dueTime`, but it is also\n * a delay-like operator since output emissions do not occur at the same time as\n * they did on the source Observable. Optionally takes a {@link SchedulerLike} for\n * managing timers.\n *\n * ## Example\n * Emit the most recent click after a burst of clicks\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { debounceTime } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(debounceTime(1000));\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link auditTime}\n * @see {@link debounce}\n * @see {@link delay}\n * @see {@link sampleTime}\n * @see {@link throttleTime}\n *\n * @param {number} dueTime The timeout duration in milliseconds (or the time\n * unit determined internally by the optional `scheduler`) for the window of\n * time required to wait for emission silence before emitting the most recent\n * source value.\n * @param {SchedulerLike} [scheduler=async] The {@link SchedulerLike} to use for\n * managing the timers that handle the timeout for each value.\n * @return {Observable} An Observable that delays the emissions of the source\n * Observable by the specified `dueTime`, and may drop some values if they occur\n * too frequently.\n * @method debounceTime\n * @owner Observable\n */\nexport function debounceTime<T>(dueTime: number, scheduler: SchedulerLike = async): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => source.lift(new DebounceTimeOperator(dueTime, scheduler));\n}\n\nclass DebounceTimeOperator<T> implements Operator<T, T> {\n  constructor(private dueTime: number, private scheduler: SchedulerLike) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new DebounceTimeSubscriber(subscriber, this.dueTime, this.scheduler));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass DebounceTimeSubscriber<T> extends Subscriber<T> {\n  private debouncedSubscription: Subscription = null;\n  private lastValue: T = null;\n  private hasValue: boolean = false;\n\n  constructor(destination: Subscriber<T>,\n              private dueTime: number,\n              private scheduler: SchedulerLike) {\n    super(destination);\n  }\n\n  protected _next(value: T) {\n    this.clearDebounce();\n    this.lastValue = value;\n    this.hasValue = true;\n    this.add(this.debouncedSubscription = this.scheduler.schedule(dispatchNext, this.dueTime, this));\n  }\n\n  protected _complete() {\n    this.debouncedNext();\n    this.destination.complete();\n  }\n\n  debouncedNext(): void {\n    this.clearDebounce();\n\n    if (this.hasValue) {\n      const { lastValue } = this;\n      // This must be done *before* passing the value\n      // along to the destination because it's possible for\n      // the value to synchronously re-enter this operator\n      // recursively when scheduled with things like\n      // VirtualScheduler/TestScheduler.\n      this.lastValue = null;\n      this.hasValue = false;\n      this.destination.next(lastValue);\n    }\n  }\n\n  private clearDebounce(): void {\n    const debouncedSubscription = this.debouncedSubscription;\n\n    if (debouncedSubscription !== null) {\n      this.remove(debouncedSubscription);\n      debouncedSubscription.unsubscribe();\n      this.debouncedSubscription = null;\n    }\n  }\n}\n\nfunction dispatchNext(subscriber: DebounceTimeSubscriber<any>) {\n  subscriber.debouncedNext();\n}\n","import { Operator } from '../Operator';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { OperatorFunction, MonoTypeOperatorFunction } from '../types';\n\n/* tslint:disable:max-line-length */\nexport function defaultIfEmpty<T>(defaultValue?: T): MonoTypeOperatorFunction<T>;\nexport function defaultIfEmpty<T, R>(defaultValue?: R): OperatorFunction<T, T | R>;\n/* tslint:enable:max-line-length */\n\n/**\n * Emits a given value if the source Observable completes without emitting any\n * `next` value, otherwise mirrors the source Observable.\n *\n * <span class=\"informal\">If the source Observable turns out to be empty, then\n * this operator will emit a default value.</span>\n *\n * ![](defaultIfEmpty.png)\n *\n * `defaultIfEmpty` emits the values emitted by the source Observable or a\n * specified default value if the source Observable is empty (completes without\n * having emitted any `next` value).\n *\n * ## Example\n * If no clicks happen in 5 seconds, then emit \"no clicks\"\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { defaultIfEmpty, takeUntil } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const clicksBeforeFive = clicks.pipe(takeUntil(interval(5000)));\n * const result = clicksBeforeFive.pipe(defaultIfEmpty('no clicks'));\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link empty}\n * @see {@link last}\n *\n * @param {any} [defaultValue=null] The default value used if the source\n * Observable is empty.\n * @return {Observable} An Observable that emits either the specified\n * `defaultValue` if the source Observable emits no items, or the values emitted\n * by the source Observable.\n * @method defaultIfEmpty\n * @owner Observable\n */\nexport function defaultIfEmpty<T, R>(defaultValue: R = null): OperatorFunction<T, T | R> {\n  return (source: Observable<T>) => source.lift(new DefaultIfEmptyOperator(defaultValue)) as Observable<T | R>;\n}\n\nclass DefaultIfEmptyOperator<T, R> implements Operator<T, T | R> {\n\n  constructor(private defaultValue: R) {\n  }\n\n  call(subscriber: Subscriber<T | R>, source: any): any {\n    return source.subscribe(new DefaultIfEmptySubscriber(subscriber, this.defaultValue));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass DefaultIfEmptySubscriber<T, R> extends Subscriber<T> {\n  private isEmpty: boolean = true;\n\n  constructor(destination: Subscriber<T | R>, private defaultValue: R) {\n    super(destination);\n  }\n\n  protected _next(value: T): void {\n    this.isEmpty = false;\n    this.destination.next(value);\n  }\n\n  protected _complete(): void {\n    if (this.isEmpty) {\n      this.destination.next(this.defaultValue);\n    }\n    this.destination.complete();\n  }\n}\n","export function isDate(value: any): value is Date {\n  return value instanceof Date && !isNaN(+value);\n}\n","import { async } from '../scheduler/async';\nimport { isDate } from '../util/isDate';\nimport { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { Notification } from '../Notification';\nimport { Observable } from '../Observable';\nimport { MonoTypeOperatorFunction, PartialObserver, SchedulerAction, SchedulerLike, TeardownLogic } from '../types';\n\n/**\n * Delays the emission of items from the source Observable by a given timeout or\n * until a given Date.\n *\n * <span class=\"informal\">Time shifts each item by some specified amount of\n * milliseconds.</span>\n *\n * ![](delay.png)\n *\n * If the delay argument is a Number, this operator time shifts the source\n * Observable by that amount of time expressed in milliseconds. The relative\n * time intervals between the values are preserved.\n *\n * If the delay argument is a Date, this operator time shifts the start of the\n * Observable execution until the given date occurs.\n *\n * ## Examples\n * Delay each click by one second\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { delay } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const delayedClicks = clicks.pipe(delay(1000)); // each click emitted after 1 second\n * delayedClicks.subscribe(x => console.log(x));\n * ```\n *\n * Delay all clicks until a future date happens\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { delay } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const date = new Date('March 15, 2050 12:00:00'); // in the future\n * const delayedClicks = clicks.pipe(delay(date)); // click emitted only after that date\n * delayedClicks.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link debounceTime}\n * @see {@link delayWhen}\n *\n * @param {number|Date} delay The delay duration in milliseconds (a `number`) or\n * a `Date` until which the emission of the source items is delayed.\n * @param {SchedulerLike} [scheduler=async] The {@link SchedulerLike} to use for\n * managing the timers that handle the time-shift for each item.\n * @return {Observable} An Observable that delays the emissions of the source\n * Observable by the specified timeout or Date.\n * @method delay\n * @owner Observable\n */\nexport function delay<T>(delay: number|Date,\n                         scheduler: SchedulerLike = async): MonoTypeOperatorFunction<T> {\n  const absoluteDelay = isDate(delay);\n  const delayFor = absoluteDelay ? (+delay - scheduler.now()) : Math.abs(<number>delay);\n  return (source: Observable<T>) => source.lift(new DelayOperator(delayFor, scheduler));\n}\n\nclass DelayOperator<T> implements Operator<T, T> {\n  constructor(private delay: number,\n              private scheduler: SchedulerLike) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new DelaySubscriber(subscriber, this.delay, this.scheduler));\n  }\n}\n\ninterface DelayState<T> {\n  source: DelaySubscriber<T>;\n  destination: PartialObserver<T>;\n  scheduler: SchedulerLike;\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass DelaySubscriber<T> extends Subscriber<T> {\n  private queue: Array<DelayMessage<T>> = [];\n  private active: boolean = false;\n  private errored: boolean = false;\n\n  private static dispatch<T>(this: SchedulerAction<DelayState<T>>, state: DelayState<T>): void {\n    const source = state.source;\n    const queue = source.queue;\n    const scheduler = state.scheduler;\n    const destination = state.destination;\n\n    while (queue.length > 0 && (queue[0].time - scheduler.now()) <= 0) {\n      queue.shift().notification.observe(destination);\n    }\n\n    if (queue.length > 0) {\n      const delay = Math.max(0, queue[0].time - scheduler.now());\n      this.schedule(state, delay);\n    } else {\n      this.unsubscribe();\n      source.active = false;\n    }\n  }\n\n  constructor(destination: Subscriber<T>,\n              private delay: number,\n              private scheduler: SchedulerLike) {\n    super(destination);\n  }\n\n  private _schedule(scheduler: SchedulerLike): void {\n    this.active = true;\n    const destination = this.destination as Subscription;\n    destination.add(scheduler.schedule<DelayState<T>>(DelaySubscriber.dispatch, this.delay, {\n      source: this, destination: this.destination, scheduler: scheduler\n    }));\n  }\n\n  private scheduleNotification(notification: Notification<T>): void {\n    if (this.errored === true) {\n      return;\n    }\n\n    const scheduler = this.scheduler;\n    const message = new DelayMessage(scheduler.now() + this.delay, notification);\n    this.queue.push(message);\n\n    if (this.active === false) {\n      this._schedule(scheduler);\n    }\n  }\n\n  protected _next(value: T) {\n    this.scheduleNotification(Notification.createNext(value));\n  }\n\n  protected _error(err: any) {\n    this.errored = true;\n    this.queue = [];\n    this.destination.error(err);\n    this.unsubscribe();\n  }\n\n  protected _complete() {\n    this.scheduleNotification(Notification.createComplete());\n    this.unsubscribe();\n  }\n}\n\nclass DelayMessage<T> {\n  constructor(public readonly time: number,\n              public readonly notification: Notification<T>) {\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { Subscription } from '../Subscription';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { MonoTypeOperatorFunction, TeardownLogic } from '../types';\n\n/* tslint:disable:max-line-length */\n/** @deprecated In future versions, empty notifiers will no longer re-emit the source value on the output observable. */\nexport function delayWhen<T>(delayDurationSelector: (value: T, index: number) => Observable<never>, subscriptionDelay?: Observable<any>): MonoTypeOperatorFunction<T>;\nexport function delayWhen<T>(delayDurationSelector: (value: T, index: number) => Observable<any>, subscriptionDelay?: Observable<any>): MonoTypeOperatorFunction<T>;\n/* tslint:disable:max-line-length */\n\n/**\n * Delays the emission of items from the source Observable by a given time span\n * determined by the emissions of another Observable.\n *\n * <span class=\"informal\">It's like {@link delay}, but the time span of the\n * delay duration is determined by a second Observable.</span>\n *\n * ![](delayWhen.png)\n *\n * `delayWhen` time shifts each emitted value from the source Observable by a\n * time span determined by another Observable. When the source emits a value,\n * the `delayDurationSelector` function is called with the source value as\n * argument, and should return an Observable, called the \"duration\" Observable.\n * The source value is emitted on the output Observable only when the duration\n * Observable emits a value or completes.\n * The completion of the notifier triggering the emission of the source value\n * is deprecated behavior and will be removed in future versions.\n *\n * Optionally, `delayWhen` takes a second argument, `subscriptionDelay`, which\n * is an Observable. When `subscriptionDelay` emits its first value or\n * completes, the source Observable is subscribed to and starts behaving like\n * described in the previous paragraph. If `subscriptionDelay` is not provided,\n * `delayWhen` will subscribe to the source Observable as soon as the output\n * Observable is subscribed.\n *\n * ## Example\n * Delay each click by a random amount of time, between 0 and 5 seconds\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { delayWhen } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const delayedClicks = clicks.pipe(\n *   delayWhen(event => interval(Math.random() * 5000)),\n * );\n * delayedClicks.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link delay}\n * @see {@link throttle}\n * @see {@link throttleTime}\n * @see {@link debounce}\n * @see {@link debounceTime}\n * @see {@link sample}\n * @see {@link sampleTime}\n * @see {@link audit}\n * @see {@link auditTime}\n *\n * @param {function(value: T, index: number): Observable} delayDurationSelector A function that\n * returns an Observable for each value emitted by the source Observable, which\n * is then used to delay the emission of that item on the output Observable\n * until the Observable returned from this function emits a value.\n * @param {Observable} subscriptionDelay An Observable that triggers the\n * subscription to the source Observable once it emits any value.\n * @return {Observable} An Observable that delays the emissions of the source\n * Observable by an amount of time specified by the Observable returned by\n * `delayDurationSelector`.\n * @method delayWhen\n * @owner Observable\n */\nexport function delayWhen<T>(delayDurationSelector: (value: T, index: number) => Observable<any>,\n                             subscriptionDelay?: Observable<any>): MonoTypeOperatorFunction<T> {\n  if (subscriptionDelay) {\n    return (source: Observable<T>) =>\n      new SubscriptionDelayObservable(source, subscriptionDelay)\n        .lift(new DelayWhenOperator(delayDurationSelector));\n  }\n  return (source: Observable<T>) => source.lift(new DelayWhenOperator(delayDurationSelector));\n}\n\nclass DelayWhenOperator<T> implements Operator<T, T> {\n  constructor(private delayDurationSelector: (value: T, index: number) => Observable<any>) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new DelayWhenSubscriber(subscriber, this.delayDurationSelector));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass DelayWhenSubscriber<T, R> extends OuterSubscriber<T, R> {\n  private completed: boolean = false;\n  private delayNotifierSubscriptions: Array<Subscription> = [];\n  private index: number = 0;\n\n  constructor(destination: Subscriber<T>,\n              private delayDurationSelector: (value: T, index: number) => Observable<any>) {\n    super(destination);\n  }\n\n  notifyNext(outerValue: T, innerValue: any,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, R>): void {\n    this.destination.next(outerValue);\n    this.removeSubscription(innerSub);\n    this.tryComplete();\n  }\n\n  notifyError(error: any, innerSub: InnerSubscriber<T, R>): void {\n    this._error(error);\n  }\n\n  notifyComplete(innerSub: InnerSubscriber<T, R>): void {\n    const value = this.removeSubscription(innerSub);\n    if (value) {\n      this.destination.next(value);\n    }\n    this.tryComplete();\n  }\n\n  protected _next(value: T): void {\n    const index = this.index++;\n    try {\n      const delayNotifier = this.delayDurationSelector(value, index);\n      if (delayNotifier) {\n        this.tryDelay(delayNotifier, value);\n      }\n    } catch (err) {\n      this.destination.error(err);\n    }\n  }\n\n  protected _complete(): void {\n    this.completed = true;\n    this.tryComplete();\n    this.unsubscribe();\n  }\n\n  private removeSubscription(subscription: InnerSubscriber<T, R>): T {\n    subscription.unsubscribe();\n\n    const subscriptionIdx = this.delayNotifierSubscriptions.indexOf(subscription);\n    if (subscriptionIdx !== -1) {\n      this.delayNotifierSubscriptions.splice(subscriptionIdx, 1);\n    }\n\n    return subscription.outerValue;\n  }\n\n  private tryDelay(delayNotifier: Observable<any>, value: T): void {\n    const notifierSubscription = subscribeToResult(this, delayNotifier, value);\n\n    if (notifierSubscription && !notifierSubscription.closed) {\n      const destination = this.destination as Subscription;\n      destination.add(notifierSubscription);\n      this.delayNotifierSubscriptions.push(notifierSubscription);\n    }\n  }\n\n  private tryComplete(): void {\n    if (this.completed && this.delayNotifierSubscriptions.length === 0) {\n      this.destination.complete();\n    }\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass SubscriptionDelayObservable<T> extends Observable<T> {\n  constructor(public source: Observable<T>, private subscriptionDelay: Observable<any>) {\n    super();\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _subscribe(subscriber: Subscriber<T>) {\n    this.subscriptionDelay.subscribe(new SubscriptionDelaySubscriber(subscriber, this.source));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass SubscriptionDelaySubscriber<T> extends Subscriber<T> {\n  private sourceSubscribed: boolean = false;\n\n  constructor(private parent: Subscriber<T>, private source: Observable<T>) {\n    super();\n  }\n\n  protected _next(unused: any) {\n    this.subscribeToSource();\n  }\n\n  protected _error(err: any) {\n    this.unsubscribe();\n    this.parent.error(err);\n  }\n\n  protected _complete() {\n    this.unsubscribe();\n    this.subscribeToSource();\n  }\n\n  private subscribeToSource(): void {\n    if (!this.sourceSubscribed) {\n      this.sourceSubscribed = true;\n      this.unsubscribe();\n      this.source.subscribe(this.parent);\n    }\n  }\n}\n","import { Operator } from '../Operator';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { Notification } from '../Notification';\nimport { OperatorFunction } from '../types';\n\n/**\n * Converts an Observable of {@link Notification} objects into the emissions\n * that they represent.\n *\n * <span class=\"informal\">Unwraps {@link Notification} objects as actual `next`,\n * `error` and `complete` emissions. The opposite of {@link materialize}.</span>\n *\n * ![](dematerialize.png)\n *\n * `dematerialize` is assumed to operate an Observable that only emits\n * {@link Notification} objects as `next` emissions, and does not emit any\n * `error`. Such Observable is the output of a `materialize` operation. Those\n * notifications are then unwrapped using the metadata they contain, and emitted\n * as `next`, `error`, and `complete` on the output Observable.\n *\n * Use this operator in conjunction with {@link materialize}.\n *\n * ## Example\n * Convert an Observable of Notifications to an actual Observable\n * ```ts\n * import { of, Notification } from 'rxjs';\n * import { dematerialize } from 'rxjs/operators';\n *\n * const notifA = new Notification('N', 'A');\n * const notifB = new Notification('N', 'B');\n * const notifE = new Notification('E', undefined,\n *   new TypeError('x.toUpperCase is not a function')\n * );\n * const materialized = of(notifA, notifB, notifE);\n * const upperCase = materialized.pipe(dematerialize());\n * upperCase.subscribe(x => console.log(x), e => console.error(e));\n *\n * // Results in:\n * // A\n * // B\n * // TypeError: x.toUpperCase is not a function\n * ```\n *\n * @see {@link Notification}\n * @see {@link materialize}\n *\n * @return {Observable} An Observable that emits items and notifications\n * embedded in Notification objects emitted by the source Observable.\n * @method dematerialize\n * @owner Observable\n */\nexport function dematerialize<T>(): OperatorFunction<Notification<T>, T> {\n  return function dematerializeOperatorFunction(source: Observable<Notification<T>>) {\n    return source.lift(new DeMaterializeOperator());\n  };\n}\n\nclass DeMaterializeOperator<T extends Notification<any>, R> implements Operator<T, R> {\n  call(subscriber: Subscriber<any>, source: any): any {\n    return source.subscribe(new DeMaterializeSubscriber(subscriber));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass DeMaterializeSubscriber<T extends Notification<any>> extends Subscriber<T> {\n  constructor(destination: Subscriber<any>) {\n    super(destination);\n  }\n\n  protected _next(value: T) {\n    value.observe(this.destination);\n  }\n}\n","import { Observable } from '../Observable';\nimport { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { MonoTypeOperatorFunction, TeardownLogic } from '../types';\n\n/**\n * Returns an Observable that emits all items emitted by the source Observable that are distinct by comparison from previous items.\n *\n * If a keySelector function is provided, then it will project each value from the source observable into a new value that it will\n * check for equality with previously projected values. If a keySelector function is not provided, it will use each value from the\n * source observable directly with an equality check against previous values.\n *\n * In JavaScript runtimes that support `Set`, this operator will use a `Set` to improve performance of the distinct value checking.\n *\n * In other runtimes, this operator will use a minimal implementation of `Set` that relies on an `Array` and `indexOf` under the\n * hood, so performance will degrade as more values are checked for distinction. Even in newer browsers, a long-running `distinct`\n * use might result in memory leaks. To help alleviate this in some scenarios, an optional `flushes` parameter is also provided so\n * that the internal `Set` can be \"flushed\", basically clearing it of values.\n *\n * ## Examples\n * A simple example with numbers\n * ```ts\n * import { of } from 'rxjs';\n * import { distinct } from 'rxjs/operators';\n *\n * of(1, 1, 2, 2, 2, 1, 2, 3, 4, 3, 2, 1).pipe(\n *     distinct(),\n *   )\n *   .subscribe(x => console.log(x)); // 1, 2, 3, 4\n * ```\n *\n * An example using a keySelector function\n * ```typescript\n * import { of } from 'rxjs';\n * import { distinct } from 'rxjs/operators';\n *\n * interface Person {\n *    age: number,\n *    name: string\n * }\n *\n * of<Person>(\n *     { age: 4, name: 'Foo'},\n *     { age: 7, name: 'Bar'},\n *     { age: 5, name: 'Foo'},\n *   ).pipe(\n *     distinct((p: Person) => p.name),\n *   )\n *   .subscribe(x => console.log(x));\n *\n * // displays:\n * // { age: 4, name: 'Foo' }\n * // { age: 7, name: 'Bar' }\n * ```\n * @see {@link distinctUntilChanged}\n * @see {@link distinctUntilKeyChanged}\n *\n * @param {function} [keySelector] Optional function to select which value you want to check as distinct.\n * @param {Observable} [flushes] Optional Observable for flushing the internal HashSet of the operator.\n * @return {Observable} An Observable that emits items from the source Observable with distinct values.\n * @method distinct\n * @owner Observable\n */\nexport function distinct<T, K>(keySelector?: (value: T) => K,\n                               flushes?: Observable<any>): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => source.lift(new DistinctOperator(keySelector, flushes));\n}\n\nclass DistinctOperator<T, K> implements Operator<T, T> {\n  constructor(private keySelector: (value: T) => K, private flushes: Observable<any>) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new DistinctSubscriber(subscriber, this.keySelector, this.flushes));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nexport class DistinctSubscriber<T, K> extends OuterSubscriber<T, T> {\n  private values = new Set<K>();\n\n  constructor(destination: Subscriber<T>, private keySelector: (value: T) => K, flushes: Observable<any>) {\n    super(destination);\n\n    if (flushes) {\n      this.add(subscribeToResult(this, flushes));\n    }\n  }\n\n  notifyNext(outerValue: T, innerValue: T,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, T>): void {\n    this.values.clear();\n  }\n\n  notifyError(error: any, innerSub: InnerSubscriber<T, T>): void {\n    this._error(error);\n  }\n\n  protected _next(value: T): void {\n    if (this.keySelector) {\n      this._useKeySelector(value);\n    } else {\n      this._finalizeNext(value, value);\n    }\n  }\n\n  private _useKeySelector(value: T): void {\n    let key: K;\n    const { destination } = this;\n    try {\n      key = this.keySelector(value);\n    } catch (err) {\n      destination.error(err);\n      return;\n    }\n    this._finalizeNext(key, value);\n  }\n\n  private _finalizeNext(key: K|T, value: T) {\n    const { values } = this;\n    if (!values.has(<K>key)) {\n      values.add(<K>key);\n      this.destination.next(value);\n    }\n  }\n\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { MonoTypeOperatorFunction, TeardownLogic } from '../types';\n\n/* tslint:disable:max-line-length */\nexport function distinctUntilChanged<T>(compare?: (x: T, y: T) => boolean): MonoTypeOperatorFunction<T>;\nexport function distinctUntilChanged<T, K>(compare: (x: K, y: K) => boolean, keySelector: (x: T) => K): MonoTypeOperatorFunction<T>;\n/* tslint:enable:max-line-length */\n\n/**\n * Returns an Observable that emits all items emitted by the source Observable that are distinct by comparison from the previous item.\n *\n * If a comparator function is provided, then it will be called for each item to test for whether or not that value should be emitted.\n *\n * If a comparator function is not provided, an equality check is used by default.\n *\n * ## Example\n * A simple example with numbers\n * ```ts\n * import { of } from 'rxjs';\n * import { distinctUntilChanged } from 'rxjs/operators';\n *\n * of(1, 1, 2, 2, 2, 1, 1, 2, 3, 3, 4).pipe(\n *     distinctUntilChanged(),\n *   )\n *   .subscribe(x => console.log(x)); // 1, 2, 1, 2, 3, 4\n * ```\n *\n * An example using a compare function\n * ```typescript\n * import { of } from 'rxjs';\n * import { distinctUntilChanged } from 'rxjs/operators';\n *\n * interface Person {\n *    age: number,\n *    name: string\n * }\n *\n * of<Person>(\n *     { age: 4, name: 'Foo'},\n *     { age: 7, name: 'Bar'},\n *     { age: 5, name: 'Foo'},\n *     { age: 6, name: 'Foo'},\n *   ).pipe(\n *     distinctUntilChanged((p: Person, q: Person) => p.name === q.name),\n *   )\n *   .subscribe(x => console.log(x));\n *\n * // displays:\n * // { age: 4, name: 'Foo' }\n * // { age: 7, name: 'Bar' }\n * // { age: 5, name: 'Foo' }\n * ```\n *\n * @see {@link distinct}\n * @see {@link distinctUntilKeyChanged}\n *\n * @param {function} [compare] Optional comparison function called to test if an item is distinct from the previous item in the source.\n * @return {Observable} An Observable that emits items from the source Observable with distinct values.\n * @method distinctUntilChanged\n * @owner Observable\n */\nexport function distinctUntilChanged<T, K>(compare?: (x: K, y: K) => boolean, keySelector?: (x: T) => K): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => source.lift(new DistinctUntilChangedOperator<T, K>(compare, keySelector));\n}\n\nclass DistinctUntilChangedOperator<T, K> implements Operator<T, T> {\n  constructor(private compare: (x: K, y: K) => boolean,\n              private keySelector: (x: T) => K) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new DistinctUntilChangedSubscriber(subscriber, this.compare, this.keySelector));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass DistinctUntilChangedSubscriber<T, K> extends Subscriber<T> {\n  private key: K;\n  private hasKey: boolean = false;\n\n  constructor(destination: Subscriber<T>,\n              compare: (x: K, y: K) => boolean,\n              private keySelector: (x: T) => K) {\n    super(destination);\n    if (typeof compare === 'function') {\n      this.compare = compare;\n    }\n  }\n\n  private compare(x: any, y: any): boolean {\n    return x === y;\n  }\n\n  protected _next(value: T): void {\n    let key: any;\n    try {\n      const { keySelector } = this;\n      key = keySelector ? keySelector(value) : value;\n    } catch (err) {\n      return this.destination.error(err);\n    }\n    let result = false;\n    if (this.hasKey) {\n      try {\n        const { compare } = this;\n        result = compare(this.key, key);\n      } catch (err) {\n        return this.destination.error(err);\n      }\n    } else {\n      this.hasKey = true;\n    }\n    if (!result) {\n      this.key = key;\n      this.destination.next(value);\n    }\n  }\n}\n","import { distinctUntilChanged } from './distinctUntilChanged';\nimport { MonoTypeOperatorFunction } from '../types';\n\n/* tslint:disable:max-line-length */\nexport function distinctUntilKeyChanged<T>(key: keyof T): MonoTypeOperatorFunction<T>;\nexport function distinctUntilKeyChanged<T, K extends keyof T>(key: K, compare: (x: T[K], y: T[K]) => boolean): MonoTypeOperatorFunction<T>;\n/* tslint:enable:max-line-length */\n\n/**\n * Returns an Observable that emits all items emitted by the source Observable that are distinct by comparison from the previous item,\n * using a property accessed by using the key provided to check if the two items are distinct.\n *\n * If a comparator function is provided, then it will be called for each item to test for whether or not that value should be emitted.\n *\n * If a comparator function is not provided, an equality check is used by default.\n *\n * ## Examples\n * An example comparing the name of persons\n * ```typescript\n * import { of } from 'rxjs';\n * import { distinctUntilKeyChanged } from 'rxjs/operators';\n *\n *  interface Person {\n *     age: number,\n *     name: string\n *  }\n *\n * of<Person>(\n *     { age: 4, name: 'Foo'},\n *     { age: 7, name: 'Bar'},\n *     { age: 5, name: 'Foo'},\n *     { age: 6, name: 'Foo'},\n *   ).pipe(\n *     distinctUntilKeyChanged('name'),\n *   )\n *   .subscribe(x => console.log(x));\n *\n * // displays:\n * // { age: 4, name: 'Foo' }\n * // { age: 7, name: 'Bar' }\n * // { age: 5, name: 'Foo' }\n * ```\n *\n * An example comparing the first letters of the name\n * ```typescript\n * import { of } from 'rxjs';\n * import { distinctUntilKeyChanged } from 'rxjs/operators';\n *\n * interface Person {\n *     age: number,\n *     name: string\n *  }\n *\n * of<Person>(\n *     { age: 4, name: 'Foo1'},\n *     { age: 7, name: 'Bar'},\n *     { age: 5, name: 'Foo2'},\n *     { age: 6, name: 'Foo3'},\n *   ).pipe(\n *     distinctUntilKeyChanged('name', (x: string, y: string) => x.substring(0, 3) === y.substring(0, 3)),\n *   )\n *   .subscribe(x => console.log(x));\n *\n * // displays:\n * // { age: 4, name: 'Foo1' }\n * // { age: 7, name: 'Bar' }\n * // { age: 5, name: 'Foo2' }\n * ```\n *\n * @see {@link distinct}\n * @see {@link distinctUntilChanged}\n *\n * @param {string} key String key for object property lookup on each item.\n * @param {function} [compare] Optional comparison function called to test if an item is distinct from the previous item in the source.\n * @return {Observable} An Observable that emits items from the source Observable with distinct values based on the key specified.\n * @method distinctUntilKeyChanged\n * @owner Observable\n */\nexport function distinctUntilKeyChanged<T, K extends keyof T>(key: K, compare?: (x: T[K], y: T[K]) => boolean): MonoTypeOperatorFunction<T> {\n  return distinctUntilChanged((x: T, y: T) => compare ? compare(x[key], y[key]) : x[key] === y[key]);\n}\n","import { EmptyError } from '../util/EmptyError';\nimport { Observable } from '../Observable';\nimport { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { TeardownLogic, MonoTypeOperatorFunction } from '../types';\n\n/**\n * If the source observable completes without emitting a value, it will emit\n * an error. The error will be created at that time by the optional\n * `errorFactory` argument, otherwise, the error will be {@link EmptyError}.\n *\n * ![](throwIfEmpty.png)\n *\n * ## Example\n * ```ts\n * import { fromEvent, timer } from 'rxjs';\n * import { throwIfEmpty, takeUntil } from 'rxjs/operators';\n *\n * const click$ = fromEvent(document, 'click');\n *\n * click$.pipe(\n *   takeUntil(timer(1000)),\n *   throwIfEmpty(\n *     () => new Error('the document was not clicked within 1 second')\n *   ),\n * )\n * .subscribe({\n *   next() { console.log('The button was clicked'); },\n *   error(err) { console.error(err); }\n * });\n * ```\n *\n * @param errorFactory A factory function called to produce the\n * error to be thrown when the source observable completes without emitting a\n * value.\n */\nexport function throwIfEmpty <T>(errorFactory: (() => any) = defaultErrorFactory): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => {\n    return source.lift(new ThrowIfEmptyOperator(errorFactory));\n  };\n}\n\nclass ThrowIfEmptyOperator<T> implements Operator<T, T> {\n  constructor(private errorFactory: () => any) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new ThrowIfEmptySubscriber(subscriber, this.errorFactory));\n  }\n}\n\nclass ThrowIfEmptySubscriber<T> extends Subscriber<T> {\n  private hasValue: boolean = false;\n\n  constructor(destination: Subscriber<T>, private errorFactory: () => any) {\n    super(destination);\n  }\n\n  protected _next(value: T): void {\n    this.hasValue = true;\n    this.destination.next(value);\n  }\n\n  protected _complete() {\n    if (!this.hasValue) {\n      let err: any;\n      try {\n        err = this.errorFactory();\n      } catch (e) {\n        err = e;\n      }\n      this.destination.error(err);\n    } else {\n        return this.destination.complete();\n    }\n  }\n}\n\nfunction defaultErrorFactory() {\n  return new EmptyError();\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { ArgumentOutOfRangeError } from '../util/ArgumentOutOfRangeError';\nimport { empty } from '../observable/empty';\nimport { Observable } from '../Observable';\nimport { MonoTypeOperatorFunction, TeardownLogic } from '../types';\n\n/**\n * Emits only the first `count` values emitted by the source Observable.\n *\n * <span class=\"informal\">Takes the first `count` values from the source, then\n * completes.</span>\n *\n * ![](take.png)\n *\n * `take` returns an Observable that emits only the first `count` values emitted\n * by the source Observable. If the source emits fewer than `count` values then\n * all of its values are emitted. After that, it completes, regardless if the\n * source completes.\n *\n * ## Example\n * Take the first 5 seconds of an infinite 1-second interval Observable\n * ```ts\n * import { interval } from 'rxjs';\n * import { take } from 'rxjs/operators';\n *\n * const intervalCount = interval(1000);\n * const takeFive = intervalCount.pipe(take(5));\n * takeFive.subscribe(x => console.log(x));\n *\n * // Logs:\n * // 0\n * // 1\n * // 2\n * // 3\n * // 4\n * ```\n *\n * @see {@link takeLast}\n * @see {@link takeUntil}\n * @see {@link takeWhile}\n * @see {@link skip}\n *\n * @throws {ArgumentOutOfRangeError} When using `take(i)`, it delivers an\n * ArgumentOutOrRangeError to the Observer's `error` callback if `i < 0`.\n *\n * @param {number} count The maximum number of `next` values to emit.\n * @return {Observable<T>} An Observable that emits only the first `count`\n * values emitted by the source Observable, or all of the values from the source\n * if the source emits fewer than `count` values.\n * @method take\n * @owner Observable\n */\nexport function take<T>(count: number): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => {\n    if (count === 0) {\n      return empty();\n    } else {\n      return source.lift(new TakeOperator(count));\n    }\n  };\n}\n\nclass TakeOperator<T> implements Operator<T, T> {\n  constructor(private total: number) {\n    if (this.total < 0) {\n      throw new ArgumentOutOfRangeError;\n    }\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new TakeSubscriber(subscriber, this.total));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass TakeSubscriber<T> extends Subscriber<T> {\n  private count: number = 0;\n\n  constructor(destination: Subscriber<T>, private total: number) {\n    super(destination);\n  }\n\n  protected _next(value: T): void {\n    const total = this.total;\n    const count = ++this.count;\n    if (count <= total) {\n      this.destination.next(value);\n      if (count === total) {\n        this.destination.complete();\n        this.unsubscribe();\n      }\n    }\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { ArgumentOutOfRangeError } from '../util/ArgumentOutOfRangeError';\nimport { Observable } from '../Observable';\nimport { MonoTypeOperatorFunction, TeardownLogic } from '../types';\nimport { filter } from './filter';\nimport { throwIfEmpty } from './throwIfEmpty';\nimport { defaultIfEmpty } from './defaultIfEmpty';\nimport { take } from './take';\n\n/**\n * Emits the single value at the specified `index` in a sequence of emissions\n * from the source Observable.\n *\n * <span class=\"informal\">Emits only the i-th value, then completes.</span>\n *\n * ![](elementAt.png)\n *\n * `elementAt` returns an Observable that emits the item at the specified\n * `index` in the source Observable, or a default value if that `index` is out\n * of range and the `default` argument is provided. If the `default` argument is\n * not given and the `index` is out of range, the output Observable will emit an\n * `ArgumentOutOfRangeError` error.\n *\n * ## Example\n * Emit only the third click event\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { elementAt } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(elementAt(2));\n * result.subscribe(x => console.log(x));\n *\n * // Results in:\n * // click 1 = nothing\n * // click 2 = nothing\n * // click 3 = MouseEvent object logged to console\n * ```\n *\n * @see {@link first}\n * @see {@link last}\n * @see {@link skip}\n * @see {@link single}\n * @see {@link take}\n *\n * @throws {ArgumentOutOfRangeError} When using `elementAt(i)`, it delivers an\n * ArgumentOutOrRangeError to the Observer's `error` callback if `i < 0` or the\n * Observable has completed before emitting the i-th `next` notification.\n *\n * @param {number} index Is the number `i` for the i-th source emission that has\n * happened since the subscription, starting from the number `0`.\n * @param {T} [defaultValue] The default value returned for missing indices.\n * @return {Observable} An Observable that emits a single item, if it is found.\n * Otherwise, will emit the default value if given. If not, then emits an error.\n * @method elementAt\n * @owner Observable\n */\nexport function elementAt<T>(index: number, defaultValue?: T): MonoTypeOperatorFunction<T> {\n  if (index < 0) { throw new ArgumentOutOfRangeError(); }\n  const hasDefaultValue = arguments.length >= 2;\n  return (source: Observable<T>) => source.pipe(\n    filter((v, i) => i === index),\n    take(1),\n    hasDefaultValue\n      ? defaultIfEmpty(defaultValue)\n      : throwIfEmpty(() => new ArgumentOutOfRangeError()),\n  );\n}\n","import { Observable } from '../Observable';\nimport { concat } from '../observable/concat';\nimport { of } from '../observable/of';\nimport { MonoTypeOperatorFunction, SchedulerLike, OperatorFunction } from '../types';\n\n/* tslint:disable:max-line-length */\n/** @deprecated use {@link scheduled} and {@link concatAll} (e.g. `scheduled([source, [a, b, c]], scheduler).pipe(concatAll())`) */\nexport function endWith<T>(scheduler: SchedulerLike): MonoTypeOperatorFunction<T>;\n/** @deprecated use {@link scheduled} and {@link concatAll} (e.g. `scheduled([source, [a, b, c]], scheduler).pipe(concatAll())`) */\nexport function endWith<T, A>(v1: A, scheduler: SchedulerLike): OperatorFunction<T, T | A>;\n/** @deprecated use {@link scheduled} and {@link concatAll} (e.g. `scheduled([source, [a, b, c]], scheduler).pipe(concatAll())`) */\nexport function endWith<T, A, B>(v1: A, v2: B, scheduler: SchedulerLike): OperatorFunction<T, T | A | B>;\n/** @deprecated use {@link scheduled} and {@link concatAll} (e.g. `scheduled([source, [a, b, c]], scheduler).pipe(concatAll())`) */\nexport function endWith<T, A, B, C>(v1: A, v2: B, v3: C, scheduler: SchedulerLike): OperatorFunction<T, T | A | B | C>;\n/** @deprecated use {@link scheduled} and {@link concatAll} (e.g. `scheduled([source, [a, b, c]], scheduler).pipe(concatAll())`) */\nexport function endWith<T, A, B, C, D>(v1: A, v2: B, v3: C, v4: D, scheduler: SchedulerLike): OperatorFunction<T, T | A | B | C | D>;\n/** @deprecated use {@link scheduled} and {@link concatAll} (e.g. `scheduled([source, [a, b, c]], scheduler).pipe(concatAll())`) */\nexport function endWith<T, A, B, C, D, E>(v1: A, v2: B, v3: C, v4: D, v5: E, scheduler: SchedulerLike): OperatorFunction<T, T | A | B | C | D | E>;\n/** @deprecated use {@link scheduled} and {@link concatAll} (e.g. `scheduled([source, [a, b, c]], scheduler).pipe(concatAll())`) */\nexport function endWith<T, A, B, C, D, E, F>(v1: A, v2: B, v3: C, v4: D, v5: E, v6: F, scheduler: SchedulerLike): OperatorFunction<T, T | A | B | C | D | E | F>;\n\nexport function endWith<T, A>(v1: A): OperatorFunction<T, T | A>;\nexport function endWith<T, A, B>(v1: A, v2: B): OperatorFunction<T, T | A | B>;\nexport function endWith<T, A, B, C>(v1: A, v2: B, v3: C): OperatorFunction<T, T | A | B | C>;\nexport function endWith<T, A, B, C, D>(v1: A, v2: B, v3: C, v4: D): OperatorFunction<T, T | A | B | C | D>;\nexport function endWith<T, A, B, C, D, E>(v1: A, v2: B, v3: C, v4: D, v5: E): OperatorFunction<T, T | A | B | C | D | E>;\nexport function endWith<T, A, B, C, D, E, F>(v1: A, v2: B, v3: C, v4: D, v5: E, v6: F): OperatorFunction<T, T | A | B | C | D | E | F>;\nexport function endWith<T, Z = T>(...array: Z[]): OperatorFunction<T, T | Z>;\n/** @deprecated use {@link scheduled} and {@link concatAll} (e.g. `scheduled([source, [a, b, c]], scheduler).pipe(concatAll())`) */\nexport function endWith<T, Z = T>(...array: Array<Z | SchedulerLike>): OperatorFunction<T, T | Z>;\n/* tslint:enable:max-line-length */\n\n/**\n * Returns an Observable that emits the items you specify as arguments after it finishes emitting\n * items emitted by the source Observable.\n *\n * ![](endWith.png)\n *\n * ## Example\n * ### After the source observable completes, appends an emission and then completes too.\n *\n * ```ts\n * import { of } from 'rxjs';\n * import { endWith } from 'rxjs/operators';\n *\n * of('hi', 'how are you?', 'sorry, I have to go now').pipe(\n *   endWith('goodbye!'),\n * )\n * .subscribe(word => console.log(word));\n * // result:\n * // 'hi'\n * // 'how are you?'\n * // 'sorry, I have to go now'\n * // 'goodbye!'\n * ```\n *\n * @param {...T} values - Items you want the modified Observable to emit last.\n * @param {SchedulerLike} [scheduler] - A {@link SchedulerLike} to use for scheduling\n * the emissions of the `next` notifications.\n * @return {Observable} An Observable that emits the items emitted by the source Observable\n *  and then emits the items in the specified Iterable.\n * @method endWith\n * @owner Observable\n */\nexport function endWith<T>(...array: Array<T | SchedulerLike>): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => concat(source, of(...array)) as Observable<T>;\n}\n","import { Operator } from '../Operator';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { Observer, OperatorFunction } from '../types';\n\n/**\n * Returns an Observable that emits whether or not every item of the source satisfies the condition specified.\n *\n * ## Example\n * A simple example emitting true if all elements are less than 5, false otherwise\n * ```ts\n * import { of } from 'rxjs';\n * import { every } from 'rxjs/operators';\n *\n *  of(1, 2, 3, 4, 5, 6).pipe(\n *     every(x => x < 5),\n * )\n * .subscribe(x => console.log(x)); // -> false\n * ```\n *\n * @param {function} predicate A function for determining if an item meets a specified condition.\n * @param {any} [thisArg] Optional object to use for `this` in the callback.\n * @return {Observable} An Observable of booleans that determines if all items of the source Observable meet the condition specified.\n * @method every\n * @owner Observable\n */\nexport function every<T>(predicate: (value: T, index: number, source: Observable<T>) => boolean,\n                         thisArg?: any): OperatorFunction<T, boolean> {\n  return (source: Observable<T>) => source.lift(new EveryOperator(predicate, thisArg, source));\n}\n\nclass EveryOperator<T> implements Operator<T, boolean> {\n  constructor(private predicate: (value: T, index: number, source: Observable<T>) => boolean,\n              private thisArg?: any,\n              private source?: Observable<T>) {\n  }\n\n  call(observer: Subscriber<boolean>, source: any): any {\n    return source.subscribe(new EverySubscriber(observer, this.predicate, this.thisArg, this.source));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass EverySubscriber<T> extends Subscriber<T> {\n  private index: number = 0;\n\n  constructor(destination: Observer<boolean>,\n              private predicate: (value: T, index: number, source: Observable<T>) => boolean,\n              private thisArg: any,\n              private source?: Observable<T>) {\n    super(destination);\n    this.thisArg = thisArg || this;\n  }\n\n  private notifyComplete(everyValueMatch: boolean): void {\n    this.destination.next(everyValueMatch);\n    this.destination.complete();\n  }\n\n  protected _next(value: T): void {\n    let result = false;\n    try {\n      result = this.predicate.call(this.thisArg, value, this.index++, this.source);\n    } catch (err) {\n      this.destination.error(err);\n      return;\n    }\n\n    if (!result) {\n      this.notifyComplete(false);\n    }\n  }\n\n  protected _complete(): void {\n    this.notifyComplete(true);\n  }\n}\n","import { Operator } from '../Operator';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { ObservableInput, OperatorFunction, TeardownLogic } from '../types';\n\nexport function exhaust<T>(): OperatorFunction<ObservableInput<T>, T>;\nexport function exhaust<R>(): OperatorFunction<any, R>;\n\n/**\n * Converts a higher-order Observable into a first-order Observable by dropping\n * inner Observables while the previous inner Observable has not yet completed.\n *\n * <span class=\"informal\">Flattens an Observable-of-Observables by dropping the\n * next inner Observables while the current inner is still executing.</span>\n *\n * ![](exhaust.png)\n *\n * `exhaust` subscribes to an Observable that emits Observables, also known as a\n * higher-order Observable. Each time it observes one of these emitted inner\n * Observables, the output Observable begins emitting the items emitted by that\n * inner Observable. So far, it behaves like {@link mergeAll}. However,\n * `exhaust` ignores every new inner Observable if the previous Observable has\n * not yet completed. Once that one completes, it will accept and flatten the\n * next inner Observable and repeat this process.\n *\n * ## Example\n * Run a finite timer for each click, only if there is no currently active timer\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { exhaust, map, take } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const higherOrder = clicks.pipe(\n *   map((ev) => interval(1000).pipe(take(5))),\n * );\n * const result = higherOrder.pipe(exhaust());\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link combineAll}\n * @see {@link concatAll}\n * @see {@link switchAll}\n * @see {@link switchMap}\n * @see {@link mergeAll}\n * @see {@link exhaustMap}\n * @see {@link zipAll}\n *\n * @return {Observable} An Observable that takes a source of Observables and propagates the first observable\n * exclusively until it completes before subscribing to the next.\n * @method exhaust\n * @owner Observable\n */\nexport function exhaust<T>(): OperatorFunction<any, T> {\n  return (source: Observable<T>) => source.lift(new SwitchFirstOperator<T>());\n}\n\nclass SwitchFirstOperator<T> implements Operator<T, T> {\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new SwitchFirstSubscriber(subscriber));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass SwitchFirstSubscriber<T> extends OuterSubscriber<T, T> {\n  private hasCompleted: boolean = false;\n  private hasSubscription: boolean = false;\n\n  constructor(destination: Subscriber<T>) {\n    super(destination);\n  }\n\n  protected _next(value: T): void {\n    if (!this.hasSubscription) {\n      this.hasSubscription = true;\n      this.add(subscribeToResult(this, value));\n    }\n  }\n\n  protected _complete(): void {\n    this.hasCompleted = true;\n    if (!this.hasSubscription) {\n      this.destination.complete();\n    }\n  }\n\n  notifyComplete(innerSub: Subscription): void {\n    this.remove(innerSub);\n    this.hasSubscription = false;\n    if (this.hasCompleted) {\n      this.destination.complete();\n    }\n  }\n}\n","import { Operator } from '../Operator';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { ObservableInput, OperatorFunction, ObservedValueOf } from '../types';\nimport { map } from './map';\nimport { from } from '../observable/from';\n\n/* tslint:disable:max-line-length */\nexport function exhaustMap<T, O extends ObservableInput<any>>(project: (value: T, index: number) => O): OperatorFunction<T, ObservedValueOf<O>>;\n/** @deprecated resultSelector is no longer supported. Use inner map instead. */\nexport function exhaustMap<T, O extends ObservableInput<any>>(project: (value: T, index: number) => O, resultSelector: undefined): OperatorFunction<T, ObservedValueOf<O>>;\n/** @deprecated resultSelector is no longer supported. Use inner map instead. */\nexport function exhaustMap<T, I, R>(project: (value: T, index: number) => ObservableInput<I>, resultSelector: (outerValue: T, innerValue: I, outerIndex: number, innerIndex: number) => R): OperatorFunction<T, R>;\n/* tslint:enable:max-line-length */\n\n/**\n * Projects each source value to an Observable which is merged in the output\n * Observable only if the previous projected Observable has completed.\n *\n * <span class=\"informal\">Maps each value to an Observable, then flattens all of\n * these inner Observables using {@link exhaust}.</span>\n *\n * ![](exhaustMap.png)\n *\n * Returns an Observable that emits items based on applying a function that you\n * supply to each item emitted by the source Observable, where that function\n * returns an (so-called \"inner\") Observable. When it projects a source value to\n * an Observable, the output Observable begins emitting the items emitted by\n * that projected Observable. However, `exhaustMap` ignores every new projected\n * Observable if the previous projected Observable has not yet completed. Once\n * that one completes, it will accept and flatten the next projected Observable\n * and repeat this process.\n *\n * ## Example\n * Run a finite timer for each click, only if there is no currently active timer\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { exhaustMap, take } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(\n *   exhaustMap(ev => interval(1000).pipe(take(5)))\n * );\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link concatMap}\n * @see {@link exhaust}\n * @see {@link mergeMap}\n * @see {@link switchMap}\n *\n * @param {function(value: T, ?index: number): ObservableInput} project A function\n * that, when applied to an item emitted by the source Observable, returns an\n * Observable.\n * @return {Observable} An Observable containing projected Observables\n * of each item of the source, ignoring projected Observables that start before\n * their preceding Observable has completed.\n * @method exhaustMap\n * @owner Observable\n */\nexport function exhaustMap<T, R, O extends ObservableInput<any>>(\n  project: (value: T, index: number) => O,\n  resultSelector?: (outerValue: T, innerValue: ObservedValueOf<O>, outerIndex: number, innerIndex: number) => R,\n): OperatorFunction<T, ObservedValueOf<O>|R> {\n  if (resultSelector) {\n    // DEPRECATED PATH\n    return (source: Observable<T>) => source.pipe(\n      exhaustMap((a, i) => from(project(a, i)).pipe(\n        map((b: any, ii: any) => resultSelector(a, b, i, ii)),\n      )),\n    );\n  }\n  return (source: Observable<T>) =>\n    source.lift(new ExhaustMapOperator(project));\n}\n\nclass ExhaustMapOperator<T, R> implements Operator<T, R> {\n  constructor(private project: (value: T, index: number) => ObservableInput<R>) {\n  }\n\n  call(subscriber: Subscriber<R>, source: any): any {\n    return source.subscribe(new ExhaustMapSubscriber(subscriber, this.project));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass ExhaustMapSubscriber<T, R> extends OuterSubscriber<T, R> {\n  private hasSubscription = false;\n  private hasCompleted = false;\n  private index = 0;\n\n  constructor(destination: Subscriber<R>,\n              private project: (value: T, index: number) => ObservableInput<R>) {\n    super(destination);\n  }\n\n  protected _next(value: T): void {\n    if (!this.hasSubscription) {\n      this.tryNext(value);\n    }\n  }\n\n  private tryNext(value: T): void {\n    let result: ObservableInput<R>;\n    const index = this.index++;\n    try {\n      result = this.project(value, index);\n    } catch (err) {\n      this.destination.error(err);\n      return;\n    }\n    this.hasSubscription = true;\n    this._innerSub(result, value, index);\n  }\n\n  private _innerSub(result: ObservableInput<R>, value: T, index: number): void {\n    const innerSubscriber = new InnerSubscriber(this, undefined, undefined);\n    const destination = this.destination as Subscription;\n    destination.add(innerSubscriber);\n    subscribeToResult<T, R>(this, result, value, index, innerSubscriber);\n  }\n\n  protected _complete(): void {\n    this.hasCompleted = true;\n    if (!this.hasSubscription) {\n      this.destination.complete();\n    }\n    this.unsubscribe();\n  }\n\n  notifyNext(outerValue: T, innerValue: R,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, R>): void {\n    this.destination.next(innerValue);\n  }\n\n  notifyError(err: any): void {\n    this.destination.error(err);\n  }\n\n  notifyComplete(innerSub: Subscription): void {\n    const destination = this.destination as Subscription;\n    destination.remove(innerSub);\n\n    this.hasSubscription = false;\n    if (this.hasCompleted) {\n      this.destination.complete();\n    }\n  }\n}\n","import { Observable } from '../Observable';\nimport { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { MonoTypeOperatorFunction, OperatorFunction, ObservableInput, SchedulerLike } from '../types';\n\n/* tslint:disable:max-line-length */\nexport function expand<T, R>(project: (value: T, index: number) => ObservableInput<R>, concurrent?: number, scheduler?: SchedulerLike): OperatorFunction<T, R>;\nexport function expand<T>(project: (value: T, index: number) => ObservableInput<T>, concurrent?: number, scheduler?: SchedulerLike): MonoTypeOperatorFunction<T>;\n/* tslint:enable:max-line-length */\n\n/**\n * Recursively projects each source value to an Observable which is merged in\n * the output Observable.\n *\n * <span class=\"informal\">It's similar to {@link mergeMap}, but applies the\n * projection function to every source value as well as every output value.\n * It's recursive.</span>\n *\n * ![](expand.png)\n *\n * Returns an Observable that emits items based on applying a function that you\n * supply to each item emitted by the source Observable, where that function\n * returns an Observable, and then merging those resulting Observables and\n * emitting the results of this merger. *Expand* will re-emit on the output\n * Observable every source value. Then, each output value is given to the\n * `project` function which returns an inner Observable to be merged on the\n * output Observable. Those output values resulting from the projection are also\n * given to the `project` function to produce new output values. This is how\n * *expand* behaves recursively.\n *\n * ## Example\n * Start emitting the powers of two on every click, at most 10 of them\n * ```ts\n * import { fromEvent, of } from 'rxjs';\n * import { expand, mapTo, delay, take } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const powersOfTwo = clicks.pipe(\n *   mapTo(1),\n *   expand(x => of(2 * x).pipe(delay(1000))),\n *   take(10),\n * );\n * powersOfTwo.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link mergeMap}\n * @see {@link mergeScan}\n *\n * @param {function(value: T, index: number) => Observable} project A function\n * that, when applied to an item emitted by the source or the output Observable,\n * returns an Observable.\n * @param {number} [concurrent=Number.POSITIVE_INFINITY] Maximum number of input\n * Observables being subscribed to concurrently.\n * @param {SchedulerLike} [scheduler=null] The {@link SchedulerLike} to use for subscribing to\n * each projected inner Observable.\n * @return {Observable} An Observable that emits the source values and also\n * result of applying the projection function to each value emitted on the\n * output Observable and and merging the results of the Observables obtained\n * from this transformation.\n * @method expand\n * @owner Observable\n */\nexport function expand<T, R>(project: (value: T, index: number) => ObservableInput<R>,\n                             concurrent: number = Number.POSITIVE_INFINITY,\n                             scheduler: SchedulerLike = undefined): OperatorFunction<T, R> {\n  concurrent = (concurrent || 0) < 1 ? Number.POSITIVE_INFINITY : concurrent;\n\n  return (source: Observable<T>) => source.lift(new ExpandOperator(project, concurrent, scheduler));\n}\n\nexport class ExpandOperator<T, R> implements Operator<T, R> {\n  constructor(private project: (value: T, index: number) => ObservableInput<R>,\n              private concurrent: number,\n              private scheduler: SchedulerLike) {\n  }\n\n  call(subscriber: Subscriber<R>, source: any): any {\n    return source.subscribe(new ExpandSubscriber(subscriber, this.project, this.concurrent, this.scheduler));\n  }\n}\n\ninterface DispatchArg<T, R> {\n  subscriber: ExpandSubscriber<T, R>;\n  result: ObservableInput<R>;\n  value: any;\n  index: number;\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nexport class ExpandSubscriber<T, R> extends OuterSubscriber<T, R> {\n  private index: number = 0;\n  private active: number = 0;\n  private hasCompleted: boolean = false;\n  private buffer: any[];\n\n  constructor(destination: Subscriber<R>,\n              private project: (value: T, index: number) => ObservableInput<R>,\n              private concurrent: number,\n              private scheduler: SchedulerLike) {\n    super(destination);\n    if (concurrent < Number.POSITIVE_INFINITY) {\n      this.buffer = [];\n    }\n  }\n\n  private static dispatch<T, R>(arg: DispatchArg<T, R>): void {\n    const {subscriber, result, value, index} = arg;\n    subscriber.subscribeToProjection(result, value, index);\n  }\n\n  protected _next(value: any): void {\n    const destination = this.destination;\n\n    if (destination.closed) {\n      this._complete();\n      return;\n    }\n\n    const index = this.index++;\n    if (this.active < this.concurrent) {\n      destination.next(value);\n      try {\n        const { project } = this;\n        const result = project(value, index);\n        if (!this.scheduler) {\n          this.subscribeToProjection(result, value, index);\n        } else {\n          const state: DispatchArg<T, R> = { subscriber: this, result, value, index };\n          const destination = this.destination as Subscription;\n          destination.add(this.scheduler.schedule<DispatchArg<T, R>>(ExpandSubscriber.dispatch, 0, state));\n        }\n      } catch (e) {\n        destination.error(e);\n      }\n    } else {\n      this.buffer.push(value);\n    }\n  }\n\n  private subscribeToProjection(result: any, value: T, index: number): void {\n    this.active++;\n    const destination = this.destination as Subscription;\n    destination.add(subscribeToResult<T, R>(this, result, value, index));\n  }\n\n  protected _complete(): void {\n    this.hasCompleted = true;\n    if (this.hasCompleted && this.active === 0) {\n      this.destination.complete();\n    }\n    this.unsubscribe();\n  }\n\n  notifyNext(outerValue: T, innerValue: R,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, R>): void {\n    this._next(innerValue);\n  }\n\n  notifyComplete(innerSub: Subscription): void {\n    const buffer = this.buffer;\n    const destination = this.destination as Subscription;\n    destination.remove(innerSub);\n    this.active--;\n    if (buffer && buffer.length > 0) {\n      this._next(buffer.shift());\n    }\n    if (this.hasCompleted && this.active === 0) {\n      this.destination.complete();\n    }\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { Observable } from '../Observable';\nimport { MonoTypeOperatorFunction, TeardownLogic } from '../types';\n\n/**\n * Returns an Observable that mirrors the source Observable, but will call a specified function when\n * the source terminates on complete or error.\n * @param {function} callback Function to be called when source terminates.\n * @return {Observable} An Observable that mirrors the source, but will call the specified function on termination.\n * @method finally\n * @owner Observable\n */\nexport function finalize<T>(callback: () => void): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => source.lift(new FinallyOperator(callback));\n}\n\nclass FinallyOperator<T> implements Operator<T, T> {\n  constructor(private callback: () => void) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new FinallySubscriber(subscriber, this.callback));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass FinallySubscriber<T> extends Subscriber<T> {\n  constructor(destination: Subscriber<T>, callback: () => void) {\n    super(destination);\n    this.add(new Subscription(callback));\n  }\n}\n","import {Observable} from '../Observable';\nimport {Operator} from '../Operator';\nimport {Subscriber} from '../Subscriber';\nimport {OperatorFunction} from '../types';\n\nexport function find<T, S extends T>(predicate: (value: T, index: number, source: Observable<T>) => value is S,\n                                     thisArg?: any): OperatorFunction<T, S | undefined>;\nexport function find<T>(predicate: (value: T, index: number, source: Observable<T>) => boolean,\n                        thisArg?: any): OperatorFunction<T, T | undefined>;\n/**\n * Emits only the first value emitted by the source Observable that meets some\n * condition.\n *\n * <span class=\"informal\">Finds the first value that passes some test and emits\n * that.</span>\n *\n * ![](find.png)\n *\n * `find` searches for the first item in the source Observable that matches the\n * specified condition embodied by the `predicate`, and returns the first\n * occurrence in the source. Unlike {@link first}, the `predicate` is required\n * in `find`, and does not emit an error if a valid value is not found.\n *\n * ## Example\n * Find and emit the first click that happens on a DIV element\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { find } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(find(ev => ev.target.tagName === 'DIV'));\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link filter}\n * @see {@link first}\n * @see {@link findIndex}\n * @see {@link take}\n *\n * @param {function(value: T, index: number, source: Observable<T>): boolean} predicate\n * A function called with each item to test for condition matching.\n * @param {any} [thisArg] An optional argument to determine the value of `this`\n * in the `predicate` function.\n * @return {Observable<T>} An Observable of the first item that matches the\n * condition.\n * @method find\n * @owner Observable\n */\nexport function find<T>(predicate: (value: T, index: number, source: Observable<T>) => boolean,\n                        thisArg?: any): OperatorFunction<T, T | undefined> {\n  if (typeof predicate !== 'function') {\n    throw new TypeError('predicate is not a function');\n  }\n  return (source: Observable<T>) => source.lift(new FindValueOperator(predicate, source, false, thisArg)) as Observable<T | undefined>;\n}\n\nexport class FindValueOperator<T> implements Operator<T, T | number | undefined> {\n  constructor(private predicate: (value: T, index: number, source: Observable<T>) => boolean,\n              private source: Observable<T>,\n              private yieldIndex: boolean,\n              private thisArg?: any) {\n  }\n\n  call(observer: Subscriber<T>, source: any): any {\n    return source.subscribe(new FindValueSubscriber(observer, this.predicate, this.source, this.yieldIndex, this.thisArg));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nexport class FindValueSubscriber<T> extends Subscriber<T> {\n  private index: number = 0;\n\n  constructor(destination: Subscriber<T>,\n              private predicate: (value: T, index: number, source: Observable<T>) => boolean,\n              private source: Observable<T>,\n              private yieldIndex: boolean,\n              private thisArg?: any) {\n    super(destination);\n  }\n\n  private notifyComplete(value: any): void {\n    const destination = this.destination;\n\n    destination.next(value);\n    destination.complete();\n    this.unsubscribe();\n  }\n\n  protected _next(value: T): void {\n    const {predicate, thisArg} = this;\n    const index = this.index++;\n    try {\n      const result = predicate.call(thisArg || this, value, index, this.source);\n      if (result) {\n        this.notifyComplete(this.yieldIndex ? index : value);\n      }\n    } catch (err) {\n      this.destination.error(err);\n    }\n  }\n\n  protected _complete(): void {\n    this.notifyComplete(this.yieldIndex ? -1 : undefined);\n  }\n}\n","import { Observable } from '../Observable';\nimport { FindValueOperator } from '../operators/find';\nimport { OperatorFunction } from '../types';\n/**\n * Emits only the index of the first value emitted by the source Observable that\n * meets some condition.\n *\n * <span class=\"informal\">It's like {@link find}, but emits the index of the\n * found value, not the value itself.</span>\n *\n * ![](findIndex.png)\n *\n * `findIndex` searches for the first item in the source Observable that matches\n * the specified condition embodied by the `predicate`, and returns the\n * (zero-based) index of the first occurrence in the source. Unlike\n * {@link first}, the `predicate` is required in `findIndex`, and does not emit\n * an error if a valid value is not found.\n *\n * ## Example\n * Emit the index of first click that happens on a DIV element\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { findIndex } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(findIndex(ev => ev.target.tagName === 'DIV'));\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link filter}\n * @see {@link find}\n * @see {@link first}\n * @see {@link take}\n *\n * @param {function(value: T, index: number, source: Observable<T>): boolean} predicate\n * A function called with each item to test for condition matching.\n * @param {any} [thisArg] An optional argument to determine the value of `this`\n * in the `predicate` function.\n * @return {Observable} An Observable of the index of the first item that\n * matches the condition.\n * @method find\n * @owner Observable\n */\nexport function findIndex<T>(predicate: (value: T, index: number, source: Observable<T>) => boolean,\n                             thisArg?: any): OperatorFunction<T, number> {\n  return (source: Observable<T>) => source.lift(new FindValueOperator(predicate, source, true, thisArg)) as Observable<any>;\n}\n","import { Observable } from '../Observable';\nimport { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { EmptyError } from '../util/EmptyError';\nimport { OperatorFunction } from '../../internal/types';\nimport { filter } from './filter';\nimport { take } from './take';\nimport { defaultIfEmpty } from './defaultIfEmpty';\nimport { throwIfEmpty } from './throwIfEmpty';\nimport { identity } from '../util/identity';\n\n/* tslint:disable:max-line-length */\nexport function first<T, D = T>(\n  predicate?: null,\n  defaultValue?: D\n): OperatorFunction<T, T | D>;\nexport function first<T, S extends T>(\n  predicate: (value: T, index: number, source: Observable<T>) => value is S,\n  defaultValue?: S\n): OperatorFunction<T, S>;\nexport function first<T, D = T>(\n  predicate: (value: T, index: number, source: Observable<T>) => boolean,\n  defaultValue?: D\n): OperatorFunction<T, T | D>;\n/* tslint:enable:max-line-length */\n\n/**\n * Emits only the first value (or the first value that meets some condition)\n * emitted by the source Observable.\n *\n * <span class=\"informal\">Emits only the first value. Or emits only the first\n * value that passes some test.</span>\n *\n * ![](first.png)\n *\n * If called with no arguments, `first` emits the first value of the source\n * Observable, then completes. If called with a `predicate` function, `first`\n * emits the first value of the source that matches the specified condition. It\n * may also take a deprecated `resultSelector` function to produce the output\n * value from the input value, and a `defaultValue` to emit in case the source\n * completes before it is able to emit a valid value. Throws an error if\n * `defaultValue` was not provided and a matching element is not found.\n *\n * ## Examples\n * Emit only the first click that happens on the DOM\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { first } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(first());\n * result.subscribe(x => console.log(x));\n * ```\n *\n * Emits the first click that happens on a DIV\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { first } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(first(ev => ev.target.tagName === 'DIV'));\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link filter}\n * @see {@link find}\n * @see {@link take}\n *\n * @throws {EmptyError} Delivers an EmptyError to the Observer's `error`\n * callback if the Observable completes before any `next` notification was sent.\n *\n * @param {function(value: T, index: number, source: Observable<T>): boolean} [predicate]\n * An optional function called with each item to test for condition matching.\n * @param {R} [defaultValue] The default value emitted in case no valid value\n * was found on the source.\n * @return {Observable<T|R>} An Observable of the first item that matches the\n * condition.\n * @method first\n * @owner Observable\n */\nexport function first<T, D>(\n  predicate?: ((value: T, index: number, source: Observable<T>) => boolean) | null,\n  defaultValue?: D\n): OperatorFunction<T, T | D> {\n  const hasDefaultValue = arguments.length >= 2;\n  return (source: Observable<T>) => source.pipe(\n    predicate ? filter((v, i) => predicate(v, i, source)) : identity,\n    take(1),\n    hasDefaultValue ? defaultIfEmpty<T | D>(defaultValue) : throwIfEmpty(() => new EmptyError()),\n  );\n}\n","import { Observable } from '../Observable';\nimport { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { OperatorFunction } from '../types';\n\n/**\n * Ignores all items emitted by the source Observable and only passes calls of `complete` or `error`.\n *\n * ![](ignoreElements.png)\n *\n * ## Examples\n * ### Ignores emitted values, reacts to observable's completion.\n * ```ts\n * import { of } from 'rxjs';\n * import { ignoreElements } from 'rxjs/operators';\n *\n * of('you', 'talking', 'to', 'me').pipe(\n *   ignoreElements(),\n * )\n * .subscribe(\n *   word => console.log(word),\n *   err => console.log('error:', err),\n *   () => console.log('the end'),\n * );\n * // result:\n * // 'the end'\n * ```\n * @return {Observable} An empty Observable that only calls `complete`\n * or `error`, based on which one is called by the source Observable.\n * @method ignoreElements\n * @owner Observable\n */\nexport function ignoreElements(): OperatorFunction<any, never> {\n  return function ignoreElementsOperatorFunction(source: Observable<any>) {\n    return source.lift(new IgnoreElementsOperator());\n  };\n}\n\nclass IgnoreElementsOperator<T, R> implements Operator<T, R> {\n  call(subscriber: Subscriber<R>, source: any): any {\n    return source.subscribe(new IgnoreElementsSubscriber(subscriber));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass IgnoreElementsSubscriber<T> extends Subscriber<T> {\n  protected _next(unused: T): void {\n    // Do nothing\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { OperatorFunction } from '../types';\n\n/**\n * Emits false if the input observable emits any values, or emits true if the\n * input observable completes without emitting any values.\n *\n * <span class=\"informal\">Tells whether any values are emitted by an observable</span>\n *\n * ![](isEmpty.png)\n *\n * `isEmpty` transforms an Observable that emits values into an Observable that\n * emits a single boolean value representing whether or not any values were\n * emitted by the source Observable. As soon as the source Observable emits a\n * value, `isEmpty` will emit a `false` and complete.  If the source Observable\n * completes having not emitted anything, `isEmpty` will emit a `true` and\n * complete.\n *\n * A similar effect could be achieved with {@link count}, but `isEmpty` can emit\n * a `false` value sooner.\n *\n * ## Examples\n *\n * Emit `false` for a non-empty Observable\n * ```javascript\n * import { Subject } from 'rxjs';\n * import { isEmpty } from 'rxjs/operators';\n *\n * const source = new Subject<string>();\n * const result = source.pipe(isEmpty());\n * source.subscribe(x => console.log(x));\n * result.subscribe(x => console.log(x));\n * source.next('a');\n * source.next('b');\n * source.next('c');\n * source.complete();\n *\n * // Results in:\n * // a\n * // false\n * // b\n * // c\n * ```\n *\n * Emit `true` for an empty Observable\n * ```javascript\n * import { EMPTY } from 'rxjs';\n * import { isEmpty } from 'rxjs/operators';\n *\n * const result = EMPTY.pipe(isEmpty());\n * result.subscribe(x => console.log(x));\n * // Results in:\n * // true\n * ```\n *\n * @see {@link count}\n * @see {@link EMPTY}\n *\n * @return {OperatorFunction<T, boolean>} An Observable of a boolean value indicating whether observable was empty or not\n * @method isEmpty\n * @owner Observable\n */\n\nexport function isEmpty<T>(): OperatorFunction<T, boolean> {\n  return (source: Observable<T>) => source.lift(new IsEmptyOperator());\n}\n\nclass IsEmptyOperator implements Operator<any, boolean> {\n  call (observer: Subscriber<boolean>, source: any): any {\n    return source.subscribe(new IsEmptySubscriber(observer));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass IsEmptySubscriber extends Subscriber<any> {\n  constructor(destination: Subscriber<boolean>) {\n    super(destination);\n  }\n\n  private notifyComplete(isEmpty: boolean): void {\n    const destination = this.destination;\n\n    destination.next(isEmpty);\n    destination.complete();\n  }\n\n  protected _next(value: boolean) {\n    this.notifyComplete(false);\n  }\n\n  protected _complete() {\n    this.notifyComplete(true);\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { ArgumentOutOfRangeError } from '../util/ArgumentOutOfRangeError';\nimport { empty } from '../observable/empty';\nimport { Observable } from '../Observable';\nimport { MonoTypeOperatorFunction, TeardownLogic } from '../types';\n\n/**\n * Emits only the last `count` values emitted by the source Observable.\n *\n * <span class=\"informal\">Remembers the latest `count` values, then emits those\n * only when the source completes.</span>\n *\n * ![](takeLast.png)\n *\n * `takeLast` returns an Observable that emits at most the last `count` values\n * emitted by the source Observable. If the source emits fewer than `count`\n * values then all of its values are emitted. This operator must wait until the\n * `complete` notification emission from the source in order to emit the `next`\n * values on the output Observable, because otherwise it is impossible to know\n * whether or not more values will be emitted on the source. For this reason,\n * all values are emitted synchronously, followed by the complete notification.\n *\n * ## Example\n * Take the last 3 values of an Observable with many values\n * ```ts\n * import { range } from 'rxjs';\n * import { takeLast } from 'rxjs/operators';\n *\n * const many = range(1, 100);\n * const lastThree = many.pipe(takeLast(3));\n * lastThree.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link take}\n * @see {@link takeUntil}\n * @see {@link takeWhile}\n * @see {@link skip}\n *\n * @throws {ArgumentOutOfRangeError} When using `takeLast(i)`, it delivers an\n * ArgumentOutOrRangeError to the Observer's `error` callback if `i < 0`.\n *\n * @param {number} count The maximum number of values to emit from the end of\n * the sequence of values emitted by the source Observable.\n * @return {Observable<T>} An Observable that emits at most the last count\n * values emitted by the source Observable.\n * @method takeLast\n * @owner Observable\n */\nexport function takeLast<T>(count: number): MonoTypeOperatorFunction<T> {\n  return function takeLastOperatorFunction(source: Observable<T>): Observable<T> {\n    if (count === 0) {\n      return empty();\n    } else {\n      return source.lift(new TakeLastOperator(count));\n    }\n  };\n}\n\nclass TakeLastOperator<T> implements Operator<T, T> {\n  constructor(private total: number) {\n    if (this.total < 0) {\n      throw new ArgumentOutOfRangeError;\n    }\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new TakeLastSubscriber(subscriber, this.total));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass TakeLastSubscriber<T> extends Subscriber<T> {\n  private ring: Array<T> = new Array();\n  private count: number = 0;\n\n  constructor(destination: Subscriber<T>, private total: number) {\n    super(destination);\n  }\n\n  protected _next(value: T): void {\n    const ring = this.ring;\n    const total = this.total;\n    const count = this.count++;\n\n    if (ring.length < total) {\n      ring.push(value);\n    } else {\n      const index = count % total;\n      ring[index] = value;\n    }\n  }\n\n  protected _complete(): void {\n    const destination = this.destination;\n    let count = this.count;\n\n    if (count > 0) {\n      const total = this.count >= this.total ? this.total : this.count;\n      const ring  = this.ring;\n\n      for (let i = 0; i < total; i++) {\n        const idx = (count++) % total;\n        destination.next(ring[idx]);\n      }\n    }\n\n    destination.complete();\n  }\n}\n","import { Observable } from '../Observable';\nimport { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { EmptyError } from '../util/EmptyError';\nimport { OperatorFunction } from '../../internal/types';\nimport { filter } from './filter';\nimport { takeLast } from './takeLast';\nimport { throwIfEmpty } from './throwIfEmpty';\nimport { defaultIfEmpty } from './defaultIfEmpty';\nimport { identity } from '../util/identity';\n\n/* tslint:disable:max-line-length */\nexport function last<T, D = T>(\n  predicate?: null,\n  defaultValue?: D\n): OperatorFunction<T, T | D>;\nexport function last<T, S extends T>(\n  predicate: (value: T, index: number, source: Observable<T>) => value is S,\n  defaultValue?: S\n): OperatorFunction<T, S>;\nexport function last<T, D = T>(\n  predicate: (value: T, index: number, source: Observable<T>) => boolean,\n  defaultValue?: D\n): OperatorFunction<T, T | D>;\n/* tslint:enable:max-line-length */\n\n/**\n * Returns an Observable that emits only the last item emitted by the source Observable.\n * It optionally takes a predicate function as a parameter, in which case, rather than emitting\n * the last item from the source Observable, the resulting Observable will emit the last item\n * from the source Observable that satisfies the predicate.\n *\n * ![](last.png)\n *\n * @throws {EmptyError} Delivers an EmptyError to the Observer's `error`\n * callback if the Observable completes before any `next` notification was sent.\n * @param {function} [predicate] - The condition any source emitted item has to satisfy.\n * @param {any} [defaultValue] - An optional default value to provide if last\n * predicate isn't met or no values were emitted.\n * @return {Observable} An Observable that emits only the last item satisfying the given condition\n * from the source, or an NoSuchElementException if no such items are emitted.\n * @throws - Throws if no items that match the predicate are emitted by the source Observable.\n */\nexport function last<T, D>(\n  predicate?: ((value: T, index: number, source: Observable<T>) => boolean) | null,\n  defaultValue?: D\n): OperatorFunction<T, T | D> {\n  const hasDefaultValue = arguments.length >= 2;\n  return (source: Observable<T>) => source.pipe(\n    predicate ? filter((v, i) => predicate(v, i, source)) : identity,\n    takeLast(1),\n    hasDefaultValue ? defaultIfEmpty<T | D>(defaultValue) : throwIfEmpty(() => new EmptyError()),\n  );\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { OperatorFunction } from '../types';\n\n/**\n * Emits the given constant value on the output Observable every time the source\n * Observable emits a value.\n *\n * <span class=\"informal\">Like {@link map}, but it maps every source value to\n * the same output value every time.</span>\n *\n * ![](mapTo.png)\n *\n * Takes a constant `value` as argument, and emits that whenever the source\n * Observable emits a value. In other words, ignores the actual source value,\n * and simply uses the emission moment to know when to emit the given `value`.\n *\n * ## Example\n * Map every click to the string 'Hi'\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { mapTo } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const greetings = clicks.pipe(mapTo('Hi'));\n * greetings.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link map}\n *\n * @param {any} value The value to map each source value to.\n * @return {Observable} An Observable that emits the given `value` every time\n * the source Observable emits something.\n * @method mapTo\n * @owner Observable\n */\nexport function mapTo<T, R>(value: R): OperatorFunction<T, R> {\n  return (source: Observable<T>) => source.lift(new MapToOperator(value));\n}\n\nclass MapToOperator<T, R> implements Operator<T, R> {\n\n  value: R;\n\n  constructor(value: R) {\n    this.value = value;\n  }\n\n  call(subscriber: Subscriber<R>, source: any): any {\n    return source.subscribe(new MapToSubscriber(subscriber, this.value));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass MapToSubscriber<T, R> extends Subscriber<T> {\n\n  value: R;\n\n  constructor(destination: Subscriber<R>, value: R) {\n    super(destination);\n    this.value = value;\n  }\n\n  protected _next(x: T) {\n    this.destination.next(this.value);\n  }\n}\n","import { Operator } from '../Operator';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { Notification } from '../Notification';\nimport { OperatorFunction } from '../types';\n\n/**\n * Represents all of the notifications from the source Observable as `next`\n * emissions marked with their original types within {@link Notification}\n * objects.\n *\n * <span class=\"informal\">Wraps `next`, `error` and `complete` emissions in\n * {@link Notification} objects, emitted as `next` on the output Observable.\n * </span>\n *\n * ![](materialize.png)\n *\n * `materialize` returns an Observable that emits a `next` notification for each\n * `next`, `error`, or `complete` emission of the source Observable. When the\n * source Observable emits `complete`, the output Observable will emit `next` as\n * a Notification of type \"complete\", and then it will emit `complete` as well.\n * When the source Observable emits `error`, the output will emit `next` as a\n * Notification of type \"error\", and then `complete`.\n *\n * This operator is useful for producing metadata of the source Observable, to\n * be consumed as `next` emissions. Use it in conjunction with\n * {@link dematerialize}.\n *\n * ## Example\n * Convert a faulty Observable to an Observable of Notifications\n * ```ts\n * import { of } from 'rxjs';\n * import { materialize, map } from 'rxjs/operators';\n *\n * const letters = of('a', 'b', 13, 'd');\n * const upperCase = letters.pipe(map(x => x.toUpperCase()));\n * const materialized = upperCase.pipe(materialize());\n * materialized.subscribe(x => console.log(x));\n *\n * // Results in the following:\n * // - Notification {kind: \"N\", value: \"A\", error: undefined, hasValue: true}\n * // - Notification {kind: \"N\", value: \"B\", error: undefined, hasValue: true}\n * // - Notification {kind: \"E\", value: undefined, error: TypeError:\n * //   x.toUpperCase is not a function at MapSubscriber.letters.map.x\n * //   [as project] (http://1, hasValue: false}\n * ```\n *\n * @see {@link Notification}\n * @see {@link dematerialize}\n *\n * @return {Observable<Notification<T>>} An Observable that emits\n * {@link Notification} objects that wrap the original emissions from the source\n * Observable with metadata.\n * @method materialize\n * @owner Observable\n */\nexport function materialize<T>(): OperatorFunction<T, Notification<T>> {\n  return function materializeOperatorFunction(source: Observable<T>) {\n    return source.lift(new MaterializeOperator());\n  };\n}\n\nclass MaterializeOperator<T> implements Operator<T, Notification<T>> {\n  call(subscriber: Subscriber<Notification<T>>, source: any): any {\n    return source.subscribe(new MaterializeSubscriber(subscriber));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass MaterializeSubscriber<T> extends Subscriber<T> {\n  constructor(destination: Subscriber<Notification<T>>) {\n    super(destination);\n  }\n\n  protected _next(value: T) {\n    this.destination.next(Notification.createNext(value));\n  }\n\n  protected _error(err: any) {\n    const destination = this.destination;\n    destination.next(Notification.createError(err));\n    destination.complete();\n  }\n\n  protected _complete() {\n    const destination = this.destination;\n    destination.next(Notification.createComplete());\n    destination.complete();\n  }\n}\n","import { Operator } from '../Operator';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { OperatorFunction, MonoTypeOperatorFunction } from '../types';\n\n/* tslint:disable:max-line-length */\nexport function scan<T, R>(accumulator: (acc: R, value: T, index: number) => R, seed: R): OperatorFunction<T, R>;\nexport function scan<T>(accumulator: (acc: T, value: T, index: number) => T, seed?: T): MonoTypeOperatorFunction<T>;\nexport function scan<T, R>(accumulator: (acc: R, value: T, index: number) => R): OperatorFunction<T, R>;\n/* tslint:enable:max-line-length */\n\n/**\n * Applies an accumulator function over the source Observable, and returns each\n * intermediate result, with an optional seed value.\n *\n * <span class=\"informal\">It's like {@link reduce}, but emits the current\n * accumulation whenever the source emits a value.</span>\n *\n * ![](scan.png)\n *\n * Combines together all values emitted on the source, using an accumulator\n * function that knows how to join a new source value into the accumulation from\n * the past. Is similar to {@link reduce}, but emits the intermediate\n * accumulations.\n *\n * Returns an Observable that applies a specified `accumulator` function to each\n * item emitted by the source Observable. If a `seed` value is specified, then\n * that value will be used as the initial value for the accumulator. If no seed\n * value is specified, the first item of the source is used as the seed.\n *\n * ## Example\n * Count the number of click events\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { scan, mapTo } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const ones = clicks.pipe(mapTo(1));\n * const seed = 0;\n * const count = ones.pipe(scan((acc, one) => acc + one, seed));\n * count.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link expand}\n * @see {@link mergeScan}\n * @see {@link reduce}\n *\n * @param {function(acc: R, value: T, index: number): R} accumulator\n * The accumulator function called on each source value.\n * @param {T|R} [seed] The initial accumulation value.\n * @return {Observable<R>} An observable of the accumulated values.\n * @method scan\n * @owner Observable\n */\nexport function scan<T, R>(accumulator: (acc: R, value: T, index: number) => R, seed?: T | R): OperatorFunction<T, R> {\n  let hasSeed = false;\n  // providing a seed of `undefined` *should* be valid and trigger\n  // hasSeed! so don't use `seed !== undefined` checks!\n  // For this reason, we have to check it here at the original call site\n  // otherwise inside Operator/Subscriber we won't know if `undefined`\n  // means they didn't provide anything or if they literally provided `undefined`\n  if (arguments.length >= 2) {\n    hasSeed = true;\n  }\n\n  return function scanOperatorFunction(source: Observable<T>): Observable<R> {\n    return source.lift(new ScanOperator(accumulator, seed, hasSeed));\n  };\n}\n\nclass ScanOperator<T, R> implements Operator<T, R> {\n  constructor(private accumulator: (acc: R, value: T, index: number) => R, private seed?: T | R, private hasSeed: boolean = false) {}\n\n  call(subscriber: Subscriber<R>, source: any): any {\n    return source.subscribe(new ScanSubscriber(subscriber, this.accumulator, this.seed, this.hasSeed));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass ScanSubscriber<T, R> extends Subscriber<T> {\n  private index: number = 0;\n\n  get seed(): T | R {\n    return this._seed;\n  }\n\n  set seed(value: T | R) {\n    this.hasSeed = true;\n    this._seed = value;\n  }\n\n  constructor(destination: Subscriber<R>, private accumulator: (acc: R, value: T, index: number) => R, private _seed: T | R,\n              private hasSeed: boolean) {\n    super(destination);\n  }\n\n  protected _next(value: T): void {\n    if (!this.hasSeed) {\n      this.seed = value;\n      this.destination.next(value);\n    } else {\n      return this._tryNext(value);\n    }\n  }\n\n  private _tryNext(value: T): void {\n    const index = this.index++;\n    let result: any;\n    try {\n      result = this.accumulator(<R>this.seed, value, index);\n    } catch (err) {\n      this.destination.error(err);\n    }\n    this.seed = result;\n    this.destination.next(result);\n  }\n}\n","import { Observable } from '../Observable';\nimport { scan } from './scan';\nimport { takeLast } from './takeLast';\nimport { defaultIfEmpty } from './defaultIfEmpty';\nimport { OperatorFunction, MonoTypeOperatorFunction } from '../types';\nimport { pipe } from '../util/pipe';\n\n/* tslint:disable:max-line-length */\nexport function reduce<T, R>(accumulator: (acc: R, value: T, index: number) => R, seed: R): OperatorFunction<T, R>;\nexport function reduce<T>(accumulator: (acc: T, value: T, index: number) => T, seed?: T): MonoTypeOperatorFunction<T>;\nexport function reduce<T, R>(accumulator: (acc: R, value: T, index: number) => R): OperatorFunction<T, R>;\n/* tslint:enable:max-line-length */\n\n/**\n * Applies an accumulator function over the source Observable, and returns the\n * accumulated result when the source completes, given an optional seed value.\n *\n * <span class=\"informal\">Combines together all values emitted on the source,\n * using an accumulator function that knows how to join a new source value into\n * the accumulation from the past.</span>\n *\n * ![](reduce.png)\n *\n * Like\n * [Array.prototype.reduce()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce),\n * `reduce` applies an `accumulator` function against an accumulation and each\n * value of the source Observable (from the past) to reduce it to a single\n * value, emitted on the output Observable. Note that `reduce` will only emit\n * one value, only when the source Observable completes. It is equivalent to\n * applying operator {@link scan} followed by operator {@link last}.\n *\n * Returns an Observable that applies a specified `accumulator` function to each\n * item emitted by the source Observable. If a `seed` value is specified, then\n * that value will be used as the initial value for the accumulator. If no seed\n * value is specified, the first item of the source is used as the seed.\n *\n * ## Example\n * Count the number of click events that happened in 5 seconds\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { reduce, takeUntil, mapTo } from 'rxjs/operators';\n *\n * const clicksInFiveSeconds = fromEvent(document, 'click').pipe(\n *   takeUntil(interval(5000)),\n * );\n * const ones = clicksInFiveSeconds.pipe(mapTo(1));\n * const seed = 0;\n * const count = ones.pipe(reduce((acc, one) => acc + one, seed));\n * count.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link count}\n * @see {@link expand}\n * @see {@link mergeScan}\n * @see {@link scan}\n *\n * @param {function(acc: R, value: T, index: number): R} accumulator The accumulator function\n * called on each source value.\n * @param {R} [seed] The initial accumulation value.\n * @return {Observable<R>} An Observable that emits a single value that is the\n * result of accumulating the values emitted by the source Observable.\n * @method reduce\n * @owner Observable\n */\nexport function reduce<T, R>(accumulator: (acc: T | R, value: T, index?: number) => T | R, seed?: T | R): OperatorFunction<T, T | R> {\n  // providing a seed of `undefined` *should* be valid and trigger\n  // hasSeed! so don't use `seed !== undefined` checks!\n  // For this reason, we have to check it here at the original call site\n  // otherwise inside Operator/Subscriber we won't know if `undefined`\n  // means they didn't provide anything or if they literally provided `undefined`\n  if (arguments.length >= 2) {\n    return function reduceOperatorFunctionWithSeed(source: Observable<T>): Observable<T | R> {\n      return pipe(scan(accumulator, seed), takeLast(1), defaultIfEmpty(seed))(source);\n    };\n  }\n  return function reduceOperatorFunction(source: Observable<T>): Observable<T | R> {\n    return pipe(\n      scan<T, T | R>((acc, value, index) => accumulator(acc, value, index + 1)),\n      takeLast(1),\n    )(source);\n  };\n}\n","import { reduce } from './reduce';\nimport { MonoTypeOperatorFunction } from '../types';\n\n/**\n * The Max operator operates on an Observable that emits numbers (or items that can be compared with a provided function),\n * and when source Observable completes it emits a single item: the item with the largest value.\n *\n * ![](max.png)\n *\n * ## Examples\n * Get the maximal value of a series of numbers\n * ```ts\n * import { of } from 'rxjs';\n * import { max } from 'rxjs/operators';\n *\n * of(5, 4, 7, 2, 8).pipe(\n *   max(),\n * )\n * .subscribe(x => console.log(x)); // -> 8\n * ```\n *\n * Use a comparer function to get the maximal item\n * ```typescript\n * import { of } from 'rxjs';\n * import { max } from 'rxjs/operators';\n *\n * interface Person {\n *   age: number,\n *   name: string\n * }\n * of<Person>(\n *   {age: 7, name: 'Foo'},\n *   {age: 5, name: 'Bar'},\n *   {age: 9, name: 'Beer'},\n * ).pipe(\n *   max<Person>((a: Person, b: Person) => a.age < b.age ? -1 : 1),\n * )\n * .subscribe((x: Person) => console.log(x.name)); // -> 'Beer'\n * ```\n *\n * @see {@link min}\n *\n * @param {Function} [comparer] - Optional comparer function that it will use instead of its default to compare the\n * value of two items.\n * @return {Observable} An Observable that emits item with the largest value.\n * @method max\n * @owner Observable\n */\nexport function max<T>(comparer?: (x: T, y: T) => number): MonoTypeOperatorFunction<T> {\n  const max: (x: T, y: T) => T = (typeof comparer === 'function')\n    ? (x, y) => comparer(x, y) > 0 ? x : y\n    : (x, y) => x > y ? x : y;\n\n  return reduce(max);\n}\n","import { merge as mergeStatic } from '../observable/merge';\nimport { Observable } from '../Observable';\nimport { ObservableInput, OperatorFunction, MonoTypeOperatorFunction, SchedulerLike } from '../types';\n\n/* tslint:disable:max-line-length */\n/** @deprecated Deprecated in favor of static merge. */\nexport function merge<T>(scheduler?: SchedulerLike): MonoTypeOperatorFunction<T>;\n/** @deprecated Deprecated in favor of static merge. */\nexport function merge<T>(concurrent?: number, scheduler?: SchedulerLike): MonoTypeOperatorFunction<T>;\n/** @deprecated Deprecated in favor of static merge. */\nexport function merge<T, T2>(v2: ObservableInput<T2>, scheduler?: SchedulerLike): OperatorFunction<T, T | T2>;\n/** @deprecated Deprecated in favor of static merge. */\nexport function merge<T, T2>(v2: ObservableInput<T2>, concurrent?: number, scheduler?: SchedulerLike): OperatorFunction<T, T | T2>;\n/** @deprecated Deprecated in favor of static merge. */\nexport function merge<T, T2, T3>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, scheduler?: SchedulerLike): OperatorFunction<T, T | T2 | T3>;\n/** @deprecated Deprecated in favor of static merge. */\nexport function merge<T, T2, T3>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, concurrent?: number, scheduler?: SchedulerLike): OperatorFunction<T, T | T2 | T3>;\n/** @deprecated Deprecated in favor of static merge. */\nexport function merge<T, T2, T3, T4>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, scheduler?: SchedulerLike): OperatorFunction<T, T | T2 | T3 | T4>;\n/** @deprecated Deprecated in favor of static merge. */\nexport function merge<T, T2, T3, T4>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, concurrent?: number, scheduler?: SchedulerLike): OperatorFunction<T, T | T2 | T3 | T4>;\n/** @deprecated Deprecated in favor of static merge. */\nexport function merge<T, T2, T3, T4, T5>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, scheduler?: SchedulerLike): OperatorFunction<T, T | T2 | T3 | T4 | T5>;\n/** @deprecated Deprecated in favor of static merge. */\nexport function merge<T, T2, T3, T4, T5>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, concurrent?: number, scheduler?: SchedulerLike): OperatorFunction<T, T | T2 | T3 | T4 | T5>;\n/** @deprecated Deprecated in favor of static merge. */\nexport function merge<T, T2, T3, T4, T5, T6>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, v6: ObservableInput<T6>, scheduler?: SchedulerLike): OperatorFunction<T, T | T2 | T3 | T4 | T5 | T6>;\n/** @deprecated Deprecated in favor of static merge. */\nexport function merge<T, T2, T3, T4, T5, T6>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, v6: ObservableInput<T6>, concurrent?: number, scheduler?: SchedulerLike): OperatorFunction<T, T | T2 | T3 | T4 | T5 | T6>;\n/** @deprecated Deprecated in favor of static merge. */\nexport function merge<T>(...observables: Array<ObservableInput<T> | SchedulerLike | number>): MonoTypeOperatorFunction<T>;\n/** @deprecated Deprecated in favor of static merge. */\nexport function merge<T, R>(...observables: Array<ObservableInput<any> | SchedulerLike | number>): OperatorFunction<T, R>;\n/* tslint:enable:max-line-length */\n\n/**\n * @deprecated Deprecated in favor of static {@link merge}.\n */\nexport function merge<T, R>(...observables: Array<ObservableInput<any> | SchedulerLike | number>): OperatorFunction<T, R> {\n  return (source: Observable<T>) => source.lift.call(mergeStatic(source, ...observables));\n}\n","import { Observable } from '../Observable';\nimport { OperatorFunction, ObservedValueOf } from '../../internal/types';\nimport { mergeMap } from './mergeMap';\nimport { ObservableInput } from '../types';\n\n/* tslint:disable:max-line-length */\nexport function mergeMapTo<T, O extends ObservableInput<any>>(innerObservable: O, concurrent?: number): OperatorFunction<any, ObservedValueOf<O>>;\n/** @deprecated */\nexport function mergeMapTo<T, R, O extends ObservableInput<any>>(innerObservable: O, resultSelector: (outerValue: T, innerValue: ObservedValueOf<O>, outerIndex: number, innerIndex: number) => R, concurrent?: number): OperatorFunction<T, R>;\n/* tslint:enable:max-line-length */\n\n/**\n * Projects each source value to the same Observable which is merged multiple\n * times in the output Observable.\n *\n * <span class=\"informal\">It's like {@link mergeMap}, but maps each value always\n * to the same inner Observable.</span>\n *\n * ![](mergeMapTo.png)\n *\n * Maps each source value to the given Observable `innerObservable` regardless\n * of the source value, and then merges those resulting Observables into one\n * single Observable, which is the output Observable.\n *\n * ## Example\n * For each click event, start an interval Observable ticking every 1 second\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { mergeMapTo } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(mergeMapTo(interval(1000)));\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link concatMapTo}\n * @see {@link merge}\n * @see {@link mergeAll}\n * @see {@link mergeMap}\n * @see {@link mergeScan}\n * @see {@link switchMapTo}\n *\n * @param {ObservableInput} innerObservable An Observable to replace each value from\n * the source Observable.\n * @param {number} [concurrent=Number.POSITIVE_INFINITY] Maximum number of input\n * Observables being subscribed to concurrently.\n * @return {Observable} An Observable that emits items from the given\n * `innerObservable`\n * @method mergeMapTo\n * @owner Observable\n */\nexport function mergeMapTo<T, R, O extends ObservableInput<any>>(\n  innerObservable: O,\n  resultSelector?: ((outerValue: T, innerValue: ObservedValueOf<O>, outerIndex: number, innerIndex: number) => R) | number,\n  concurrent: number = Number.POSITIVE_INFINITY\n): OperatorFunction<T, ObservedValueOf<O>|R> {\n  if (typeof resultSelector === 'function') {\n    return mergeMap(() => innerObservable, resultSelector, concurrent);\n  }\n  if (typeof resultSelector === 'number') {\n    concurrent = resultSelector;\n  }\n  return mergeMap(() => innerObservable, concurrent);\n}\n","import { Operator } from '../Operator';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { ObservableInput, OperatorFunction } from '../types';\n\n/**\n * Applies an accumulator function over the source Observable where the\n * accumulator function itself returns an Observable, then each intermediate\n * Observable returned is merged into the output Observable.\n *\n * <span class=\"informal\">It's like {@link scan}, but the Observables returned\n * by the accumulator are merged into the outer Observable.</span>\n *\n * ## Example\n * Count the number of click events\n * ```ts\n * import { fromEvent, of } from 'rxjs';\n * import { mapTo, mergeScan } from 'rxjs/operators';\n *\n * const click$ = fromEvent(document, 'click');\n * const one$ = click$.pipe(mapTo(1));\n * const seed = 0;\n * const count$ = one$.pipe(\n *   mergeScan((acc, one) => of(acc + one), seed),\n * );\n * count$.subscribe(x => console.log(x));\n *\n * // Results:\n * // 1\n * // 2\n * // 3\n * // 4\n * // ...and so on for each click\n * ```\n *\n * @param {function(acc: R, value: T): Observable<R>} accumulator\n * The accumulator function called on each source value.\n * @param seed The initial accumulation value.\n * @param {number} [concurrent=Number.POSITIVE_INFINITY] Maximum number of\n * input Observables being subscribed to concurrently.\n * @return {Observable<R>} An observable of the accumulated values.\n * @method mergeScan\n * @owner Observable\n */\nexport function mergeScan<T, R>(accumulator: (acc: R, value: T, index: number) => ObservableInput<R>,\n                                seed: R,\n                                concurrent: number = Number.POSITIVE_INFINITY): OperatorFunction<T, R> {\n  return (source: Observable<T>) => source.lift(new MergeScanOperator(accumulator, seed, concurrent));\n}\n\nexport class MergeScanOperator<T, R> implements Operator<T, R> {\n  constructor(private accumulator: (acc: R, value: T, index: number) => ObservableInput<R>,\n              private seed: R,\n              private concurrent: number) {\n  }\n\n  call(subscriber: Subscriber<R>, source: any): any {\n    return source.subscribe(new MergeScanSubscriber(\n      subscriber, this.accumulator, this.seed, this.concurrent\n    ));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nexport class MergeScanSubscriber<T, R> extends OuterSubscriber<T, R> {\n  private hasValue: boolean = false;\n  private hasCompleted: boolean = false;\n  private buffer: Observable<any>[] = [];\n  private active: number = 0;\n  protected index: number = 0;\n\n  constructor(destination: Subscriber<R>,\n              private accumulator: (acc: R, value: T, index: number) => ObservableInput<R>,\n              private acc: R,\n              private concurrent: number) {\n    super(destination);\n  }\n\n  protected _next(value: any): void {\n    if (this.active < this.concurrent) {\n      const index = this.index++;\n      const destination = this.destination;\n      let ish;\n      try {\n        const { accumulator } = this;\n        ish = accumulator(this.acc, value, index);\n      } catch (e) {\n        return destination.error(e);\n      }\n      this.active++;\n      this._innerSub(ish, value, index);\n    } else {\n      this.buffer.push(value);\n    }\n  }\n\n  private _innerSub(ish: any, value: T, index: number): void {\n    const innerSubscriber = new InnerSubscriber(this, undefined, undefined);\n    const destination = this.destination as Subscription;\n    destination.add(innerSubscriber);\n    subscribeToResult<T, R>(this, ish, value, index, innerSubscriber);\n  }\n\n  protected _complete(): void {\n    this.hasCompleted = true;\n    if (this.active === 0 && this.buffer.length === 0) {\n      if (this.hasValue === false) {\n        this.destination.next(this.acc);\n      }\n      this.destination.complete();\n    }\n    this.unsubscribe();\n  }\n\n  notifyNext(outerValue: T, innerValue: R,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, R>): void {\n    const { destination } = this;\n    this.acc = innerValue;\n    this.hasValue = true;\n    destination.next(innerValue);\n  }\n\n  notifyComplete(innerSub: Subscription): void {\n    const buffer = this.buffer;\n    const destination = this.destination as Subscription;\n    destination.remove(innerSub);\n    this.active--;\n    if (buffer.length > 0) {\n      this._next(buffer.shift());\n    } else if (this.active === 0 && this.hasCompleted) {\n      if (this.hasValue === false) {\n        this.destination.next(this.acc);\n      }\n      this.destination.complete();\n    }\n  }\n}\n","import { reduce } from './reduce';\nimport { MonoTypeOperatorFunction } from '../types';\n\n/**\n * The Min operator operates on an Observable that emits numbers (or items that can be compared with a provided function),\n * and when source Observable completes it emits a single item: the item with the smallest value.\n *\n * ![](min.png)\n *\n * ## Examples\n * Get the minimal value of a series of numbers\n * ```ts\n * import { of } from 'rxjs';\n * import { min } from 'rxjs/operators';\n *\n * of(5, 4, 7, 2, 8).pipe(\n *   min(),\n * )\n * .subscribe(x => console.log(x)); // -> 2\n * ```\n *\n * Use a comparer function to get the minimal item\n * ```typescript\n * import { of } from 'rxjs';\n * import { min } from 'rxjs/operators';\n *\n * interface Person {\n *   age: number,\n *   name: string\n * }\n * of<Person>(\n *   {age: 7, name: 'Foo'},\n *   {age: 5, name: 'Bar'},\n *   {age: 9, name: 'Beer'},\n * ).pipe(\n *   min<Person>( (a: Person, b: Person) => a.age < b.age ? -1 : 1),\n * )\n * .subscribe((x: Person) => console.log(x.name)); // -> 'Bar'\n * ```\n * @see {@link max}\n *\n * @param {Function} [comparer] - Optional comparer function that it will use instead of its default to compare the\n * value of two items.\n * @return {Observable<R>} An Observable that emits item with the smallest value.\n * @method min\n * @owner Observable\n */\nexport function min<T>(comparer?: (x: T, y: T) => number): MonoTypeOperatorFunction<T> {\n  const min: (x: T, y: T) => T = (typeof comparer === 'function')\n    ? (x, y) => comparer(x, y) < 0 ? x : y\n    : (x, y) => x < y ? x : y;\n  return reduce(min);\n}\n","import { Subject } from '../Subject';\nimport { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { ConnectableObservable, connectableObservableDescriptor } from '../observable/ConnectableObservable';\nimport { MonoTypeOperatorFunction, OperatorFunction, UnaryFunction, ObservedValueOf, ObservableInput } from '../types';\n\n/* tslint:disable:max-line-length */\nexport function multicast<T>(subject: Subject<T>): UnaryFunction<Observable<T>, ConnectableObservable<T>>;\nexport function multicast<T, O extends ObservableInput<any>>(subject: Subject<T>, selector: (shared: Observable<T>) => O): UnaryFunction<Observable<T>, ConnectableObservable<ObservedValueOf<O>>>;\nexport function multicast<T>(subjectFactory: (this: Observable<T>) => Subject<T>): UnaryFunction<Observable<T>, ConnectableObservable<T>>;\nexport function multicast<T, O extends ObservableInput<any>>(SubjectFactory: (this: Observable<T>) => Subject<T>, selector: (shared: Observable<T>) => O): OperatorFunction<T, ObservedValueOf<O>>;\n/* tslint:enable:max-line-length */\n\n/**\n * Returns an Observable that emits the results of invoking a specified selector on items\n * emitted by a ConnectableObservable that shares a single subscription to the underlying stream.\n *\n * ![](multicast.png)\n *\n * @param {Function|Subject} subjectOrSubjectFactory - Factory function to create an intermediate subject through\n * which the source sequence's elements will be multicast to the selector function\n * or Subject to push source elements into.\n * @param {Function} [selector] - Optional selector function that can use the multicasted source stream\n * as many times as needed, without causing multiple subscriptions to the source stream.\n * Subscribers to the given source will receive all notifications of the source from the\n * time of the subscription forward.\n * @return {Observable} An Observable that emits the results of invoking the selector\n * on the items emitted by a `ConnectableObservable` that shares a single subscription to\n * the underlying stream.\n * @method multicast\n * @owner Observable\n */\nexport function multicast<T, R>(subjectOrSubjectFactory: Subject<T> | (() => Subject<T>),\n                                selector?: (source: Observable<T>) => Observable<R>): OperatorFunction<T, R> {\n  return function multicastOperatorFunction(source: Observable<T>): Observable<R> {\n    let subjectFactory: () => Subject<T>;\n    if (typeof subjectOrSubjectFactory === 'function') {\n      subjectFactory = <() => Subject<T>>subjectOrSubjectFactory;\n    } else {\n      subjectFactory = function subjectFactory() {\n        return <Subject<T>>subjectOrSubjectFactory;\n      };\n    }\n\n    if (typeof selector === 'function') {\n      return source.lift(new MulticastOperator(subjectFactory, selector));\n    }\n\n    const connectable: any = Object.create(source, connectableObservableDescriptor);\n    connectable.source = source;\n    connectable.subjectFactory = subjectFactory;\n\n    return <ConnectableObservable<R>> connectable;\n  };\n}\n\nexport class MulticastOperator<T, R> implements Operator<T, R> {\n  constructor(private subjectFactory: () => Subject<T>,\n              private selector: (source: Observable<T>) => Observable<R>) {\n  }\n  call(subscriber: Subscriber<R>, source: any): any {\n    const { selector } = this;\n    const subject = this.subjectFactory();\n    const subscription = selector(subject).subscribe(subscriber);\n    subscription.add(source.subscribe(subject));\n    return subscription;\n  }\n}\n","import { Observable } from '../Observable';\nimport { from } from '../observable/from';\nimport { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { isArray } from '../util/isArray';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { ObservableInput, OperatorFunction } from '../types';\n\n/* tslint:disable:max-line-length */\nexport function onErrorResumeNext<T>(): OperatorFunction<T, T>;\nexport function onErrorResumeNext<T, T2>(v: ObservableInput<T2>): OperatorFunction<T, T | T2>;\nexport function onErrorResumeNext<T, T2, T3>(v: ObservableInput<T2>, v2: ObservableInput<T3>): OperatorFunction<T, T | T2 | T3>;\nexport function onErrorResumeNext<T, T2, T3, T4>(v: ObservableInput<T2>, v2: ObservableInput<T3>, v3: ObservableInput<T4>): OperatorFunction<T, T | T2 | T3 | T4>;\nexport function onErrorResumeNext<T, T2, T3, T4, T5>(v: ObservableInput<T2>, v2: ObservableInput<T3>, v3: ObservableInput<T4>, v4: ObservableInput<T5>): OperatorFunction<T, T | T2 | T3 | T4 | T5>;\nexport function onErrorResumeNext<T, T2, T3, T4, T5, T6>(v: ObservableInput<T2>, v2: ObservableInput<T3>, v3: ObservableInput<T4>, v4: ObservableInput<T5>, v5: ObservableInput<T6>): OperatorFunction<T, T | T2 | T3 | T4 | T5 | T6>;\nexport function onErrorResumeNext<T, T2, T3, T4, T5, T6, T7>(v: ObservableInput<T2>, v2: ObservableInput<T3>, v3: ObservableInput<T4>, v4: ObservableInput<T5>, v5: ObservableInput<T6>, v6: ObservableInput<T7>): OperatorFunction<T, T | T2 | T3 | T4 | T5 | T6 | T7>;\nexport function onErrorResumeNext<T, R>(...observables: Array<ObservableInput<any>>): OperatorFunction<T, T | R>;\nexport function onErrorResumeNext<T, R>(array: ObservableInput<any>[]): OperatorFunction<T, T | R>;\n/* tslint:enable:max-line-length */\n\n/**\n * When any of the provided Observable emits an complete or error notification, it immediately subscribes to the next one\n * that was passed.\n *\n * <span class=\"informal\">Execute series of Observables no matter what, even if it means swallowing errors.</span>\n *\n * ![](onErrorResumeNext.png)\n *\n * `onErrorResumeNext` is an operator that accepts a series of Observables, provided either directly as\n * arguments or as an array. If no single Observable is provided, returned Observable will simply behave the same\n * as the source.\n *\n * `onErrorResumeNext` returns an Observable that starts by subscribing and re-emitting values from the source Observable.\n * When its stream of values ends - no matter if Observable completed or emitted an error - `onErrorResumeNext`\n * will subscribe to the first Observable that was passed as an argument to the method. It will start re-emitting\n * its values as well and - again - when that stream ends, `onErrorResumeNext` will proceed to subscribing yet another\n * Observable in provided series, no matter if previous Observable completed or ended with an error. This will\n * be happening until there is no more Observables left in the series, at which point returned Observable will\n * complete - even if the last subscribed stream ended with an error.\n *\n * `onErrorResumeNext` can be therefore thought of as version of {@link concat} operator, which is more permissive\n * when it comes to the errors emitted by its input Observables. While `concat` subscribes to the next Observable\n * in series only if previous one successfully completed, `onErrorResumeNext` subscribes even if it ended with\n * an error.\n *\n * Note that you do not get any access to errors emitted by the Observables. In particular do not\n * expect these errors to appear in error callback passed to {@link Observable#subscribe}. If you want to take\n * specific actions based on what error was emitted by an Observable, you should try out {@link catchError} instead.\n *\n *\n * ## Example\n * Subscribe to the next Observable after map fails\n * ```ts\n * import { of } from 'rxjs';\n * import { onErrorResumeNext, map } from 'rxjs/operators';\n *\n * of(1, 2, 3, 0).pipe(\n *   map(x => {\n *       if (x === 0) { throw Error(); }\n *        return 10 / x;\n *   }),\n *   onErrorResumeNext(of(1, 2, 3)),\n * )\n * .subscribe(\n *   val => console.log(val),\n *   err => console.log(err),          // Will never be called.\n *   () => console.log('that\\'s it!')\n * );\n *\n * // Logs:\n * // 10\n * // 5\n * // 3.3333333333333335\n * // 1\n * // 2\n * // 3\n * // \"that's it!\"\n * ```\n *\n * @see {@link concat}\n * @see {@link catchError}\n *\n * @param {...ObservableInput} observables Observables passed either directly or as an array.\n * @return {Observable} An Observable that emits values from source Observable, but - if it errors - subscribes\n * to the next passed Observable and so on, until it completes or runs out of Observables.\n * @method onErrorResumeNext\n * @owner Observable\n */\n\nexport function onErrorResumeNext<T, R>(...nextSources: Array<ObservableInput<any> |\n                                                       Array<ObservableInput<any>>>): OperatorFunction<T, R> {\n  if (nextSources.length === 1 && isArray(nextSources[0])) {\n    nextSources = <Array<Observable<any>>>nextSources[0];\n  }\n\n  return (source: Observable<T>) => source.lift(new OnErrorResumeNextOperator<T, R>(nextSources));\n}\n\n/* tslint:disable:max-line-length */\nexport function onErrorResumeNextStatic<R>(v: ObservableInput<R>): Observable<R>;\nexport function onErrorResumeNextStatic<T2, T3, R>(v2: ObservableInput<T2>, v3: ObservableInput<T3>): Observable<R>;\nexport function onErrorResumeNextStatic<T2, T3, T4, R>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>): Observable<R>;\nexport function onErrorResumeNextStatic<T2, T3, T4, T5, R>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>): Observable<R>;\nexport function onErrorResumeNextStatic<T2, T3, T4, T5, T6, R>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, v6: ObservableInput<T6>): Observable<R>;\n\nexport function onErrorResumeNextStatic<R>(...observables: Array<ObservableInput<any> | ((...values: Array<any>) => R)>): Observable<R>;\nexport function onErrorResumeNextStatic<R>(array: ObservableInput<any>[]): Observable<R>;\n/* tslint:enable:max-line-length */\n\nexport function onErrorResumeNextStatic<T, R>(...nextSources: Array<ObservableInput<any> |\n  Array<ObservableInput<any>> |\n  ((...values: Array<any>) => R)>): Observable<R> {\n  let source: ObservableInput<any> = null;\n\n  if (nextSources.length === 1 && isArray(nextSources[0])) {\n    nextSources = <Array<ObservableInput<any>>>nextSources[0];\n  }\n  source = nextSources.shift();\n\n  return from(source, null).lift(new OnErrorResumeNextOperator<T, R>(nextSources));\n}\n\nclass OnErrorResumeNextOperator<T, R> implements Operator<T, R> {\n  constructor(private nextSources: Array<ObservableInput<any>>) {\n  }\n\n  call(subscriber: Subscriber<R>, source: any): any {\n    return source.subscribe(new OnErrorResumeNextSubscriber(subscriber, this.nextSources));\n  }\n}\n\nclass OnErrorResumeNextSubscriber<T, R> extends OuterSubscriber<T, R> {\n  constructor(protected destination: Subscriber<T>,\n              private nextSources: Array<ObservableInput<any>>) {\n    super(destination);\n  }\n\n  notifyError(error: any, innerSub: InnerSubscriber<T, any>): void {\n    this.subscribeToNextSource();\n  }\n\n  notifyComplete(innerSub: InnerSubscriber<T, any>): void {\n    this.subscribeToNextSource();\n  }\n\n  protected _error(err: any): void {\n    this.subscribeToNextSource();\n    this.unsubscribe();\n  }\n\n  protected _complete(): void {\n    this.subscribeToNextSource();\n    this.unsubscribe();\n  }\n\n  private subscribeToNextSource(): void {\n    const next = this.nextSources.shift();\n    if (!!next) {\n      const innerSubscriber = new InnerSubscriber(this, undefined, undefined);\n      const destination = this.destination as Subscription;\n      destination.add(innerSubscriber);\n      subscribeToResult(this, next, undefined, undefined, innerSubscriber);\n    } else {\n      this.destination.complete();\n    }\n  }\n}\n","import { Operator } from '../Operator';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { OperatorFunction } from '../types';\n\n/**\n * Groups pairs of consecutive emissions together and emits them as an array of\n * two values.\n *\n * <span class=\"informal\">Puts the current value and previous value together as\n * an array, and emits that.</span>\n *\n * ![](pairwise.png)\n *\n * The Nth emission from the source Observable will cause the output Observable\n * to emit an array [(N-1)th, Nth] of the previous and the current value, as a\n * pair. For this reason, `pairwise` emits on the second and subsequent\n * emissions from the source Observable, but not on the first emission, because\n * there is no previous value in that case.\n *\n * ## Example\n * On every click (starting from the second), emit the relative distance to the previous click\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { pairwise, map } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const pairs = clicks.pipe(pairwise());\n * const distance = pairs.pipe(\n *   map(pair => {\n *     const x0 = pair[0].clientX;\n *     const y0 = pair[0].clientY;\n *     const x1 = pair[1].clientX;\n *     const y1 = pair[1].clientY;\n *     return Math.sqrt(Math.pow(x0 - x1, 2) + Math.pow(y0 - y1, 2));\n *   }),\n * );\n * distance.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link buffer}\n * @see {@link bufferCount}\n *\n * @return {Observable<Array<T>>} An Observable of pairs (as arrays) of\n * consecutive values from the source Observable.\n * @method pairwise\n * @owner Observable\n */\nexport function pairwise<T>(): OperatorFunction<T, [T, T]> {\n  return (source: Observable<T>) => source.lift(new PairwiseOperator());\n}\n\nclass PairwiseOperator<T> implements Operator<T, [T, T]> {\n  call(subscriber: Subscriber<[T, T]>, source: any): any {\n    return source.subscribe(new PairwiseSubscriber(subscriber));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass PairwiseSubscriber<T> extends Subscriber<T> {\n  private prev: T;\n  private hasPrev: boolean = false;\n\n  constructor(destination: Subscriber<[T, T]>) {\n    super(destination);\n  }\n\n  _next(value: T): void {\n    let pair: [T, T] | undefined;\n\n    if (this.hasPrev) {\n      pair = [this.prev, value];\n    } else {\n      this.hasPrev = true;\n    }\n\n    this.prev = value;\n\n    if (pair) {\n      this.destination.next(pair);\n    }\n  }\n}\n","import { not } from '../util/not';\nimport { filter } from './filter';\nimport { Observable } from '../Observable';\nimport { UnaryFunction } from '../types';\n\n/**\n * Splits the source Observable into two, one with values that satisfy a\n * predicate, and another with values that don't satisfy the predicate.\n *\n * <span class=\"informal\">It's like {@link filter}, but returns two Observables:\n * one like the output of {@link filter}, and the other with values that did not\n * pass the condition.</span>\n *\n * ![](partition.png)\n *\n * `partition` outputs an array with two Observables that partition the values\n * from the source Observable through the given `predicate` function. The first\n * Observable in that array emits source values for which the predicate argument\n * returns true. The second Observable emits source values for which the\n * predicate returns false. The first behaves like {@link filter} and the second\n * behaves like {@link filter} with the predicate negated.\n *\n * ## Example\n * Partition click events into those on DIV elements and those elsewhere\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { partition } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const parts = clicks.pipe(partition(ev => ev.target.tagName === 'DIV'));\n * const clicksOnDivs = parts[0];\n * const clicksElsewhere = parts[1];\n * clicksOnDivs.subscribe(x => console.log('DIV clicked: ', x));\n * clicksElsewhere.subscribe(x => console.log('Other clicked: ', x));\n * ```\n *\n * @see {@link filter}\n *\n * @param {function(value: T, index: number): boolean} predicate A function that\n * evaluates each value emitted by the source Observable. If it returns `true`,\n * the value is emitted on the first Observable in the returned array, if\n * `false` the value is emitted on the second Observable in the array. The\n * `index` parameter is the number `i` for the i-th source emission that has\n * happened since the subscription, starting from the number `0`.\n * @param {any} [thisArg] An optional argument to determine the value of `this`\n * in the `predicate` function.\n * @return {[Observable<T>, Observable<T>]} An array with two Observables: one\n * with values that passed the predicate, and another with values that did not\n * pass the predicate.\n * @method partition\n * @owner Observable\n * @deprecated use `partition` static creation function instead\n */\nexport function partition<T>(predicate: (value: T, index: number) => boolean,\n                             thisArg?: any): UnaryFunction<Observable<T>, [Observable<T>, Observable<T>]> {\n  return (source: Observable<T>) => [\n    filter(predicate, thisArg)(source),\n    filter(not(predicate, thisArg) as any)(source)\n  ] as [Observable<T>, Observable<T>];\n}\n","import { Observable } from '../Observable';\nimport { map } from './map';\nimport { OperatorFunction } from '../types';\n\n/* tslint:disable:max-line-length */\nexport function pluck<T, K1 extends keyof T>(k1: K1): OperatorFunction<T, T[K1]>;\nexport function pluck<T, K1 extends keyof T, K2 extends keyof T[K1]>(k1: K1, k2: K2): OperatorFunction<T, T[K1][K2]>;\nexport function pluck<T, K1 extends keyof T, K2 extends keyof T[K1], K3 extends keyof T[K1][K2]>(k1: K1, k2: K2, k3: K3): OperatorFunction<T, T[K1][K2][K3]>;\nexport function pluck<T, K1 extends keyof T, K2 extends keyof T[K1], K3 extends keyof T[K1][K2], K4 extends keyof T[K1][K2][K3]>(k1: K1, k2: K2, k3: K3, k4: K4): OperatorFunction<T, T[K1][K2][K3][K4]>;\nexport function pluck<T, K1 extends keyof T, K2 extends keyof T[K1], K3 extends keyof T[K1][K2], K4 extends keyof T[K1][K2][K3], K5 extends keyof T[K1][K2][K3][K4]>(k1: K1, k2: K2, k3: K3, k4: K4, k5: K5): OperatorFunction<T, T[K1][K2][K3][K4][K5]>;\nexport function pluck<T, K1 extends keyof T, K2 extends keyof T[K1], K3 extends keyof T[K1][K2], K4 extends keyof T[K1][K2][K3], K5 extends keyof T[K1][K2][K3][K4], K6 extends keyof T[K1][K2][K3][K4][K5]>(k1: K1, k2: K2, k3: K3, k4: K4, k5: K5, k6: K6): OperatorFunction<T, T[K1][K2][K3][K4][K5][K6]>;\nexport function pluck<T, R>(...properties: string[]): OperatorFunction<T, R>;\n/* tslint:enable:max-line-length */\n\n/**\n * Maps each source value (an object) to its specified nested property.\n *\n * <span class=\"informal\">Like {@link map}, but meant only for picking one of\n * the nested properties of every emitted object.</span>\n *\n * ![](pluck.png)\n *\n * Given a list of strings describing a path to an object property, retrieves\n * the value of a specified nested property from all values in the source\n * Observable. If a property can't be resolved, it will return `undefined` for\n * that value.\n *\n * ## Example\n * Map every click to the tagName of the clicked target element\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { pluck } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const tagNames = clicks.pipe(pluck('target', 'tagName'));\n * tagNames.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link map}\n *\n * @param {...string} properties The nested properties to pluck from each source\n * value (an object).\n * @return {Observable} A new Observable of property values from the source values.\n * @method pluck\n * @owner Observable\n */\nexport function pluck<T, R>(...properties: string[]): OperatorFunction<T, R> {\n  const length = properties.length;\n  if (length === 0) {\n    throw new Error('list of properties cannot be empty.');\n  }\n  return (source: Observable<T>) => map(plucker(properties, length))(source as any);\n}\n\nfunction plucker(props: string[], length: number): (x: string) => any {\n  const mapper = (x: string) => {\n    let currentProp = x;\n    for (let i = 0; i < length; i++) {\n      const p = currentProp[props[i]];\n      if (typeof p !== 'undefined') {\n        currentProp = p;\n      } else {\n        return undefined;\n      }\n    }\n    return currentProp;\n  };\n\n  return mapper;\n}\n","import { Observable } from '../Observable';\nimport { Subject } from '../Subject';\nimport { multicast } from './multicast';\nimport { ConnectableObservable } from '../observable/ConnectableObservable';\nimport { MonoTypeOperatorFunction, OperatorFunction, UnaryFunction, ObservableInput, ObservedValueOf } from '../types';\n\n/* tslint:disable:max-line-length */\nexport function publish<T>(): UnaryFunction<Observable<T>, ConnectableObservable<T>>;\nexport function publish<T, O extends ObservableInput<any>>(selector: (shared: Observable<T>) => O): OperatorFunction<T, ObservedValueOf<O>>;\nexport function publish<T>(selector: MonoTypeOperatorFunction<T>): MonoTypeOperatorFunction<T>;\n/* tslint:enable:max-line-length */\n\n/**\n * Returns a ConnectableObservable, which is a variety of Observable that waits until its connect method is called\n * before it begins emitting items to those Observers that have subscribed to it.\n *\n * <span class=\"informal\">Makes a cold Observable hot</span>\n *\n * ![](publish.png)\n *\n * ## Examples\n * Make source$ hot by applying publish operator, then merge each inner observable into a single one\n * and subscribe.\n * ```ts\n * import { of, zip, interval, merge } from \"rxjs\";\n * import { map, publish, tap } from \"rxjs/operators\";\n *\n * const source$ = zip(interval(2000), of(1, 2, 3, 4, 5, 6, 7, 8, 9)).pipe(\n *   map(values => values[1])\n * );\n *\n * source$\n *   .pipe(\n *     publish(multicasted$ =>\n *       merge(\n *         multicasted$.pipe(tap(x => console.log('Stream 1:', x))),\n *         multicasted$.pipe(tap(x => console.log('Stream 2:', x))),\n *         multicasted$.pipe(tap(x => console.log('Stream 3:', x))),\n *       )\n *     )\n *   )\n *   .subscribe();\n *\n * // Results every two seconds\n * // Stream 1: 1\n * // Stream 2: 1\n * // Stream 3: 1\n * // ...\n * // Stream 1: 9\n * // Stream 2: 9\n * // Stream 3: 9\n * ```\n *\n * @param {Function} [selector] - Optional selector function which can use the multicasted source sequence as many times\n * as needed, without causing multiple subscriptions to the source sequence.\n * Subscribers to the given source will receive all notifications of the source from the time of the subscription on.\n * @return A ConnectableObservable that upon connection causes the source Observable to emit items to its Observers.\n * @method publish\n * @owner Observable\n *\n *\n */\nexport function publish<T, R>(selector?: OperatorFunction<T, R>): MonoTypeOperatorFunction<T> | OperatorFunction<T, R> {\n  return selector ?\n    multicast(() => new Subject<T>(), selector) :\n    multicast(new Subject<T>());\n}\n","import { Observable } from '../Observable';\nimport { BehaviorSubject } from '../BehaviorSubject';\nimport { multicast } from './multicast';\nimport { ConnectableObservable } from '../observable/ConnectableObservable';\nimport { UnaryFunction } from '../types';\n\n/**\n * @param value\n * @return {ConnectableObservable<T>}\n * @method publishBehavior\n * @owner Observable\n */\nexport function publishBehavior<T>(value: T):  UnaryFunction<Observable<T>, ConnectableObservable<T>> {\n  return (source: Observable<T>) => multicast(new BehaviorSubject<T>(value))(source) as ConnectableObservable<T>;\n}\n","import { Observable } from '../Observable';\nimport { AsyncSubject } from '../AsyncSubject';\nimport { multicast } from './multicast';\nimport { ConnectableObservable } from '../observable/ConnectableObservable';\nimport { UnaryFunction } from '../types';\n\n/**\n * Returns a connectable observable sequence that shares a single subscription to the\n * underlying sequence containing only the last notification.\n *\n * ![](publishLast.png)\n *\n * Similar to {@link publish}, but it waits until the source observable completes and stores\n * the last emitted value.\n * Similarly to {@link publishReplay} and {@link publishBehavior}, this keeps storing the last\n * value even if it has no more subscribers. If subsequent subscriptions happen, they will\n * immediately get that last stored value and complete.\n *\n * ## Example\n *\n * ```ts\n * import { interval } from 'rxjs';\n * import { publishLast, tap, take } from 'rxjs/operators';\n *\n * const connectable =\n *   interval(1000)\n *     .pipe(\n *       tap(x => console.log(\"side effect\", x)),\n *       take(3),\n *       publishLast());\n *\n * connectable.subscribe(\n *   x => console.log(  \"Sub. A\", x),\n *   err => console.log(\"Sub. A Error\", err),\n *   () => console.log( \"Sub. A Complete\"));\n *\n * connectable.subscribe(\n *   x => console.log(  \"Sub. B\", x),\n *   err => console.log(\"Sub. B Error\", err),\n *   () => console.log( \"Sub. B Complete\"));\n *\n * connectable.connect();\n *\n * // Results:\n * //    \"side effect 0\"\n * //    \"side effect 1\"\n * //    \"side effect 2\"\n * //    \"Sub. A 2\"\n * //    \"Sub. B 2\"\n * //    \"Sub. A Complete\"\n * //    \"Sub. B Complete\"\n * ```\n *\n * @see {@link ConnectableObservable}\n * @see {@link publish}\n * @see {@link publishReplay}\n * @see {@link publishBehavior}\n *\n * @return {ConnectableObservable} An observable sequence that contains the elements of a\n * sequence produced by multicasting the source sequence.\n * @method publishLast\n * @owner Observable\n */\n\nexport function publishLast<T>(): UnaryFunction<Observable<T>, ConnectableObservable<T>> {\n  return (source: Observable<T>) => multicast(new AsyncSubject<T>())(source);\n}\n","import { Observable } from '../Observable';\nimport { ReplaySubject } from '../ReplaySubject';\nimport { multicast } from './multicast';\nimport { ConnectableObservable } from '../observable/ConnectableObservable';\nimport { UnaryFunction, MonoTypeOperatorFunction, OperatorFunction, SchedulerLike, ObservableInput, ObservedValueOf } from '../types';\n\n/* tslint:disable:max-line-length */\nexport function publishReplay<T>(bufferSize?: number, windowTime?: number, scheduler?: SchedulerLike): MonoTypeOperatorFunction<T>;\nexport function publishReplay<T, O extends ObservableInput<any>>(bufferSize?: number, windowTime?: number, selector?: (shared: Observable<T>) => O, scheduler?: SchedulerLike): OperatorFunction<T, ObservedValueOf<O>>;\n/* tslint:enable:max-line-length */\n\nexport function publishReplay<T, R>(bufferSize?: number,\n                                    windowTime?: number,\n                                    selectorOrScheduler?: SchedulerLike | OperatorFunction<T, R>,\n                                    scheduler?: SchedulerLike): UnaryFunction<Observable<T>, ConnectableObservable<R>> {\n\n  if (selectorOrScheduler && typeof selectorOrScheduler !== 'function') {\n    scheduler = selectorOrScheduler;\n  }\n\n  const selector = typeof selectorOrScheduler === 'function' ? selectorOrScheduler : undefined;\n  const subject = new ReplaySubject<T>(bufferSize, windowTime, scheduler);\n\n  return (source: Observable<T>) => multicast(() => subject, selector)(source) as ConnectableObservable<R>;\n}\n","import { Observable } from '../Observable';\nimport { isArray } from '../util/isArray';\nimport { MonoTypeOperatorFunction, OperatorFunction } from '../types';\nimport { race as raceStatic } from '../observable/race';\n\n/* tslint:disable:max-line-length */\n/** @deprecated Deprecated in favor of static race. */\nexport function race<T>(observables: Array<Observable<T>>): MonoTypeOperatorFunction<T>;\n/** @deprecated Deprecated in favor of static race. */\nexport function race<T, R>(observables: Array<Observable<T>>): OperatorFunction<T, R>;\n/** @deprecated Deprecated in favor of static race. */\nexport function race<T>(...observables: Array<Observable<T> | Array<Observable<T>>>): MonoTypeOperatorFunction<T>;\n/** @deprecated Deprecated in favor of static race. */\nexport function race<T, R>(...observables: Array<Observable<any> | Array<Observable<any>>>): OperatorFunction<T, R>;\n/* tslint:enable:max-line-length */\n\n/**\n * Returns an Observable that mirrors the first source Observable to emit a next,\n * error or complete notification from the combination of this Observable and supplied Observables.\n * @param {...Observables} ...observables Sources used to race for which Observable emits first.\n * @return {Observable} An Observable that mirrors the output of the first Observable to emit an item.\n * @method race\n * @owner Observable\n * @deprecated Deprecated in favor of static {@link race}.\n */\nexport function race<T>(...observables: (Observable<T> | Observable<T>[])[]): MonoTypeOperatorFunction<T> {\n  return function raceOperatorFunction(source: Observable<T>) {\n    // if the only argument is an array, it was most likely called with\n    // `pair([obs1, obs2, ...])`\n    if (observables.length === 1 && isArray(observables[0])) {\n      observables = observables[0] as Observable<T>[];\n    }\n\n    return source.lift.call(raceStatic(source, ...(observables as Observable<T>[])));\n  };\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { empty } from '../observable/empty';\nimport { MonoTypeOperatorFunction, TeardownLogic } from '../types';\n\n/**\n * Returns an Observable that will resubscribe to the source stream when the source stream completes, at most count times.\n *\n * <span class=\"informal\">Repeats all values emitted on the source. It's like {@link retry}, but for non error cases.</span>\n *\n * ![](repeat.png)\n *\n * Similar to {@link retry}, this operator repeats the stream of items emitted by the source for non error cases.\n * Repeat can be useful for creating observables that are meant to have some repeated pattern or rhythm.\n *\n * Note: `repeat(0)` returns an empty observable and `repeat()` will repeat forever\n *\n * ## Example\n * Repeat a message stream\n * ```ts\n * import { of } from 'rxjs';\n * import { repeat, delay } from 'rxjs/operators';\n *\n * const source = of('Repeat message');\n * const example = source.pipe(repeat(3));\n * example.subscribe(x => console.log(x));\n *\n * // Results\n * // Repeat message\n * // Repeat message\n * // Repeat message\n * ```\n *\n * Repeat 3 values, 2 times\n * ```ts\n * import { interval } from 'rxjs';\n * import { repeat, take } from 'rxjs/operators';\n *\n * const source = interval(1000);\n * const example = source.pipe(take(3), repeat(2));\n * example.subscribe(x => console.log(x));\n *\n * // Results every second\n * // 0\n * // 1\n * // 2\n * // 0\n * // 1\n * // 2\n * ```\n *\n * @see {@link repeatWhen}\n * @see {@link retry}\n *\n * @param {number} [count] The number of times the source Observable items are repeated, a count of 0 will yield\n * an empty Observable.\n * @return {Observable} An Observable that will resubscribe to the source stream when the source stream completes\n * , at most count times.\n * @method repeat\n * @owner Observable\n */\nexport function repeat<T>(count: number = -1): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => {\n    if (count === 0) {\n      return empty();\n    } else if (count < 0) {\n      return source.lift(new RepeatOperator(-1, source));\n    } else {\n      return source.lift(new RepeatOperator(count - 1, source));\n    }\n  };\n}\n\nclass RepeatOperator<T> implements Operator<T, T> {\n  constructor(private count: number,\n              private source: Observable<T>) {\n  }\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new RepeatSubscriber(subscriber, this.count, this.source));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass RepeatSubscriber<T> extends Subscriber<T> {\n  constructor(destination: Subscriber<any>,\n              private count: number,\n              private source: Observable<T>) {\n    super(destination);\n  }\n  complete() {\n    if (!this.isStopped) {\n      const { source, count } = this;\n      if (count === 0) {\n        return super.complete();\n      } else if (count > -1) {\n        this.count = count - 1;\n      }\n      source.subscribe(this._unsubscribeAndRecycle());\n    }\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { Subject } from '../Subject';\nimport { Subscription } from '../Subscription';\n\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\n\nimport { MonoTypeOperatorFunction, TeardownLogic } from '../types';\n\n/**\n * Returns an Observable that mirrors the source Observable with the exception of a `complete`. If the source\n * Observable calls `complete`, this method will emit to the Observable returned from `notifier`. If that Observable\n * calls `complete` or `error`, then this method will call `complete` or `error` on the child subscription. Otherwise\n * this method will resubscribe to the source Observable.\n *\n * ![](repeatWhen.png)\n *\n * ## Example\n * Repeat a message stream on click\n * ```ts\n * import { of, fromEvent } from 'rxjs';\n * import { repeatWhen } from 'rxjs/operators';\n *\n * const source = of('Repeat message');\n * const documentClick$ = fromEvent(document, 'click');\n *\n * source.pipe(repeatWhen(() => documentClick$)\n * ).subscribe(data => console.log(data))\n * ```\n * @see {@link repeat}\n * @see {@link retry}\n * @see {@link retryWhen}\n *\n * @param {function(notifications: Observable): Observable} notifier - Receives an Observable of notifications with\n * which a user can `complete` or `error`, aborting the repetition.\n * @return {Observable} The source Observable modified with repeat logic.\n * @method repeatWhen\n * @owner Observable\n */\nexport function repeatWhen<T>(notifier: (notifications: Observable<any>) => Observable<any>): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => source.lift(new RepeatWhenOperator(notifier));\n}\n\nclass RepeatWhenOperator<T> implements Operator<T, T> {\n  constructor(protected notifier: (notifications: Observable<any>) => Observable<any>) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new RepeatWhenSubscriber(subscriber, this.notifier, source));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass RepeatWhenSubscriber<T, R> extends OuterSubscriber<T, R> {\n\n  private notifications: Subject<any>;\n  private retries: Observable<any>;\n  private retriesSubscription: Subscription;\n  private sourceIsBeingSubscribedTo: boolean = true;\n\n  constructor(destination: Subscriber<R>,\n              private notifier: (notifications: Observable<any>) => Observable<any>,\n              private source: Observable<T>) {\n    super(destination);\n  }\n\n  notifyNext(outerValue: T, innerValue: R,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, R>): void {\n    this.sourceIsBeingSubscribedTo = true;\n    this.source.subscribe(this);\n  }\n\n  notifyComplete(innerSub: InnerSubscriber<T, R>): void {\n    if (this.sourceIsBeingSubscribedTo === false) {\n      return super.complete();\n    }\n  }\n\n  complete() {\n    this.sourceIsBeingSubscribedTo = false;\n\n    if (!this.isStopped) {\n      if (!this.retries) {\n        this.subscribeToRetries();\n      }\n      if (!this.retriesSubscription || this.retriesSubscription.closed) {\n        return super.complete();\n      }\n\n      this._unsubscribeAndRecycle();\n      this.notifications.next();\n    }\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _unsubscribe() {\n    const { notifications, retriesSubscription } = this;\n    if (notifications) {\n      notifications.unsubscribe();\n      this.notifications = null;\n    }\n    if (retriesSubscription) {\n      retriesSubscription.unsubscribe();\n      this.retriesSubscription = null;\n    }\n    this.retries = null;\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _unsubscribeAndRecycle(): Subscriber<T> {\n    const { _unsubscribe } = this;\n\n    this._unsubscribe = null;\n    super._unsubscribeAndRecycle();\n    this._unsubscribe = _unsubscribe;\n\n    return this;\n  }\n\n  private subscribeToRetries() {\n    this.notifications = new Subject();\n    let retries;\n    try {\n      const { notifier } = this;\n      retries = notifier(this.notifications);\n    } catch (e) {\n      return super.complete();\n    }\n    this.retries = retries;\n    this.retriesSubscription = subscribeToResult(this, retries);\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\n\nimport { MonoTypeOperatorFunction, TeardownLogic } from '../types';\n\n/**\n * Returns an Observable that mirrors the source Observable with the exception of an `error`. If the source Observable\n * calls `error`, this method will resubscribe to the source Observable for a maximum of `count` resubscriptions (given\n * as a number parameter) rather than propagating the `error` call.\n *\n * ![](retry.png)\n *\n * Any and all items emitted by the source Observable will be emitted by the resulting Observable, even those emitted\n * during failed subscriptions. For example, if an Observable fails at first but emits [1, 2] then succeeds the second\n * time and emits: [1, 2, 3, 4, 5] then the complete stream of emissions and notifications\n * would be: [1, 2, 1, 2, 3, 4, 5, `complete`].\n *\n * ## Example\n * ```ts\n * import { interval, of, throwError } from 'rxjs';\n * import { mergeMap, retry } from 'rxjs/operators';\n *\n * const source = interval(1000);\n * const example = source.pipe(\n *   mergeMap(val => {\n *     if(val > 5){\n *       return throwError('Error!');\n *     }\n *     return of(val);\n *   }),\n *   //retry 2 times on error\n *   retry(2)\n * );\n *\n * const subscribe = example.subscribe({\n *   next: val => console.log(val),\n *   error: val => console.log(`${val}: Retried 2 times then quit!`)\n * });\n *\n * // Output:\n * // 0..1..2..3..4..5..\n * // 0..1..2..3..4..5..\n * // 0..1..2..3..4..5..\n * // \"Error!: Retried 2 times then quit!\"\n * ```\n *\n * @param {number} count - Number of retry attempts before failing.\n * @return {Observable} The source Observable modified with the retry logic.\n * @method retry\n * @owner Observable\n */\nexport function retry<T>(count: number = -1): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => source.lift(new RetryOperator(count, source));\n}\n\nclass RetryOperator<T> implements Operator<T, T> {\n  constructor(private count: number,\n              private source: Observable<T>) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new RetrySubscriber(subscriber, this.count, this.source));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass RetrySubscriber<T> extends Subscriber<T> {\n  constructor(destination: Subscriber<any>,\n              private count: number,\n              private source: Observable<T>) {\n    super(destination);\n  }\n  error(err: any) {\n    if (!this.isStopped) {\n      const { source, count } = this;\n      if (count === 0) {\n        return super.error(err);\n      } else if (count > -1) {\n        this.count = count - 1;\n      }\n      source.subscribe(this._unsubscribeAndRecycle());\n    }\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { Subject } from '../Subject';\nimport { Subscription } from '../Subscription';\n\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\n\nimport { MonoTypeOperatorFunction, TeardownLogic } from '../types';\n\n/**\n * Returns an Observable that mirrors the source Observable with the exception of an `error`. If the source Observable\n * calls `error`, this method will emit the Throwable that caused the error to the Observable returned from `notifier`.\n * If that Observable calls `complete` or `error` then this method will call `complete` or `error` on the child\n * subscription. Otherwise this method will resubscribe to the source Observable.\n *\n * ![](retryWhen.png)\n *\n * @param {function(errors: Observable): Observable} notifier - Receives an Observable of notifications with which a\n * user can `complete` or `error`, aborting the retry.\n * @return {Observable} The source Observable modified with retry logic.\n * @method retryWhen\n * @owner Observable\n */\nexport function retryWhen<T>(notifier: (errors: Observable<any>) => Observable<any>): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => source.lift(new RetryWhenOperator(notifier, source));\n}\n\nclass RetryWhenOperator<T> implements Operator<T, T> {\n  constructor(protected notifier: (errors: Observable<any>) => Observable<any>,\n              protected source: Observable<T>) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new RetryWhenSubscriber(subscriber, this.notifier, this.source));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass RetryWhenSubscriber<T, R> extends OuterSubscriber<T, R> {\n\n  private errors: Subject<any>;\n  private retries: Observable<any>;\n  private retriesSubscription: Subscription;\n\n  constructor(destination: Subscriber<R>,\n              private notifier: (errors: Observable<any>) => Observable<any>,\n              private source: Observable<T>) {\n    super(destination);\n  }\n\n  error(err: any) {\n    if (!this.isStopped) {\n\n      let errors = this.errors;\n      let retries: any = this.retries;\n      let retriesSubscription = this.retriesSubscription;\n\n      if (!retries) {\n        errors = new Subject();\n        try {\n          const { notifier } = this;\n          retries = notifier(errors);\n        } catch (e) {\n          return super.error(e);\n        }\n        retriesSubscription = subscribeToResult(this, retries);\n      } else {\n        this.errors = null;\n        this.retriesSubscription = null;\n      }\n\n      this._unsubscribeAndRecycle();\n\n      this.errors = errors;\n      this.retries = retries;\n      this.retriesSubscription = retriesSubscription;\n\n      errors.next(err);\n    }\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _unsubscribe() {\n    const { errors, retriesSubscription } = this;\n    if (errors) {\n      errors.unsubscribe();\n      this.errors = null;\n    }\n    if (retriesSubscription) {\n      retriesSubscription.unsubscribe();\n      this.retriesSubscription = null;\n    }\n    this.retries = null;\n  }\n\n  notifyNext(outerValue: T, innerValue: R,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, R>): void {\n    const { _unsubscribe } = this;\n\n    this._unsubscribe = null;\n    this._unsubscribeAndRecycle();\n    this._unsubscribe = _unsubscribe;\n\n    this.source.subscribe(this);\n  }\n}\n","import { Operator } from '../Operator';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\n\nimport { MonoTypeOperatorFunction, TeardownLogic } from '../types';\n\n/**\n * Emits the most recently emitted value from the source Observable whenever\n * another Observable, the `notifier`, emits.\n *\n * <span class=\"informal\">It's like {@link sampleTime}, but samples whenever\n * the `notifier` Observable emits something.</span>\n *\n * ![](sample.png)\n *\n * Whenever the `notifier` Observable emits a value or completes, `sample`\n * looks at the source Observable and emits whichever value it has most recently\n * emitted since the previous sampling, unless the source has not emitted\n * anything since the previous sampling. The `notifier` is subscribed to as soon\n * as the output Observable is subscribed.\n *\n * ## Example\n * On every click, sample the most recent \"seconds\" timer\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { sample } from 'rxjs/operators';\n *\n * const seconds = interval(1000);\n * const clicks = fromEvent(document, 'click');\n * const result = seconds.pipe(sample(clicks));\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link audit}\n * @see {@link debounce}\n * @see {@link sampleTime}\n * @see {@link throttle}\n *\n * @param {Observable<any>} notifier The Observable to use for sampling the\n * source Observable.\n * @return {Observable<T>} An Observable that emits the results of sampling the\n * values emitted by the source Observable whenever the notifier Observable\n * emits value or completes.\n * @method sample\n * @owner Observable\n */\nexport function sample<T>(notifier: Observable<any>): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => source.lift(new SampleOperator(notifier));\n}\n\nclass SampleOperator<T> implements Operator<T, T> {\n  constructor(private notifier: Observable<any>) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    const sampleSubscriber = new SampleSubscriber(subscriber);\n    const subscription = source.subscribe(sampleSubscriber);\n    subscription.add(subscribeToResult(sampleSubscriber, this.notifier));\n    return subscription;\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass SampleSubscriber<T, R> extends OuterSubscriber<T, R> {\n  private value: T;\n  private hasValue: boolean = false;\n\n  protected _next(value: T) {\n    this.value = value;\n    this.hasValue = true;\n  }\n\n  notifyNext(outerValue: T, innerValue: R,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, R>): void {\n    this.emitValue();\n  }\n\n  notifyComplete(): void {\n    this.emitValue();\n  }\n\n  emitValue() {\n    if (this.hasValue) {\n      this.hasValue = false;\n      this.destination.next(this.value);\n    }\n  }\n}\n","import { Observable } from '../Observable';\nimport { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { async } from '../scheduler/async';\nimport { MonoTypeOperatorFunction, SchedulerAction, SchedulerLike, TeardownLogic } from '../types';\n\n/**\n * Emits the most recently emitted value from the source Observable within\n * periodic time intervals.\n *\n * <span class=\"informal\">Samples the source Observable at periodic time\n * intervals, emitting what it samples.</span>\n *\n * ![](sampleTime.png)\n *\n * `sampleTime` periodically looks at the source Observable and emits whichever\n * value it has most recently emitted since the previous sampling, unless the\n * source has not emitted anything since the previous sampling. The sampling\n * happens periodically in time every `period` milliseconds (or the time unit\n * defined by the optional `scheduler` argument). The sampling starts as soon as\n * the output Observable is subscribed.\n *\n * ## Example\n * Every second, emit the most recent click at most once\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { sampleTime } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(sampleTime(1000));\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link auditTime}\n * @see {@link debounceTime}\n * @see {@link delay}\n * @see {@link sample}\n * @see {@link throttleTime}\n *\n * @param {number} period The sampling period expressed in milliseconds or the\n * time unit determined internally by the optional `scheduler`.\n * @param {SchedulerLike} [scheduler=async] The {@link SchedulerLike} to use for\n * managing the timers that handle the sampling.\n * @return {Observable<T>} An Observable that emits the results of sampling the\n * values emitted by the source Observable at the specified time interval.\n * @method sampleTime\n * @owner Observable\n */\nexport function sampleTime<T>(period: number, scheduler: SchedulerLike = async): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => source.lift(new SampleTimeOperator(period, scheduler));\n}\n\nclass SampleTimeOperator<T> implements Operator<T, T> {\n  constructor(private period: number,\n              private scheduler: SchedulerLike) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new SampleTimeSubscriber(subscriber, this.period, this.scheduler));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass SampleTimeSubscriber<T> extends Subscriber<T> {\n  lastValue: T;\n  hasValue: boolean = false;\n\n  constructor(destination: Subscriber<T>,\n              private period: number,\n              private scheduler: SchedulerLike) {\n    super(destination);\n    this.add(scheduler.schedule(dispatchNotification, period, { subscriber: this, period }));\n  }\n\n  protected _next(value: T) {\n    this.lastValue = value;\n    this.hasValue = true;\n  }\n\n  notifyNext() {\n    if (this.hasValue) {\n      this.hasValue = false;\n      this.destination.next(this.lastValue);\n    }\n  }\n}\n\nfunction dispatchNotification<T>(this: SchedulerAction<any>, state: any) {\n  let { subscriber, period } = state;\n  subscriber.notifyNext();\n  this.schedule(state, period);\n}\n","import { Operator } from '../Operator';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\n\nimport { Observer, OperatorFunction } from '../types';\n\n/**\n * Compares all values of two observables in sequence using an optional comparator function\n * and returns an observable of a single boolean value representing whether or not the two sequences\n * are equal.\n *\n * <span class=\"informal\">Checks to see of all values emitted by both observables are equal, in order.</span>\n *\n * ![](sequenceEqual.png)\n *\n * `sequenceEqual` subscribes to two observables and buffers incoming values from each observable. Whenever either\n * observable emits a value, the value is buffered and the buffers are shifted and compared from the bottom\n * up; If any value pair doesn't match, the returned observable will emit `false` and complete. If one of the\n * observables completes, the operator will wait for the other observable to complete; If the other\n * observable emits before completing, the returned observable will emit `false` and complete. If one observable never\n * completes or emits after the other complets, the returned observable will never complete.\n *\n * ## Example\n * figure out if the Konami code matches\n * ```ts\n * import { from, fromEvent } from 'rxjs';\n * import { sequenceEqual, bufferCount, mergeMap, map } from 'rxjs/operators';\n *\n * const codes = from([\n *   'ArrowUp',\n *   'ArrowUp',\n *   'ArrowDown',\n *   'ArrowDown',\n *   'ArrowLeft',\n *   'ArrowRight',\n *   'ArrowLeft',\n *   'ArrowRight',\n *   'KeyB',\n *   'KeyA',\n *   'Enter', // no start key, clearly.\n * ]);\n *\n * const keys = fromEvent(document, 'keyup').pipe(map(e => e.code));\n * const matches = keys.pipe(\n *   bufferCount(11, 1),\n *   mergeMap(\n *     last11 => from(last11).pipe(sequenceEqual(codes)),\n *   ),\n * );\n * matches.subscribe(matched => console.log('Successful cheat at Contra? ', matched));\n * ```\n *\n * @see {@link combineLatest}\n * @see {@link zip}\n * @see {@link withLatestFrom}\n *\n * @param {Observable} compareTo The observable sequence to compare the source sequence to.\n * @param {function} [comparator] An optional function to compare each value pair\n * @return {Observable} An Observable of a single boolean value representing whether or not\n * the values emitted by both observables were equal in sequence.\n * @method sequenceEqual\n * @owner Observable\n */\nexport function sequenceEqual<T>(compareTo: Observable<T>,\n                                 comparator?: (a: T, b: T) => boolean): OperatorFunction<T, boolean> {\n  return (source: Observable<T>) => source.lift(new SequenceEqualOperator(compareTo, comparator));\n}\n\nexport class SequenceEqualOperator<T> implements Operator<T, boolean> {\n  constructor(private compareTo: Observable<T>,\n              private comparator: (a: T, b: T) => boolean) {\n  }\n\n  call(subscriber: Subscriber<boolean>, source: any): any {\n    return source.subscribe(new SequenceEqualSubscriber(subscriber, this.compareTo, this.comparator));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nexport class SequenceEqualSubscriber<T, R> extends Subscriber<T> {\n  private _a: T[] = [];\n  private _b: T[] = [];\n  private _oneComplete = false;\n\n  constructor(destination: Observer<R>,\n              private compareTo: Observable<T>,\n              private comparator: (a: T, b: T) => boolean) {\n    super(destination);\n    (this.destination as Subscription).add(compareTo.subscribe(new SequenceEqualCompareToSubscriber(destination, this)));\n  }\n\n  protected _next(value: T): void {\n    if (this._oneComplete && this._b.length === 0) {\n      this.emit(false);\n    } else {\n      this._a.push(value);\n      this.checkValues();\n    }\n  }\n\n  public _complete(): void {\n    if (this._oneComplete) {\n      this.emit(this._a.length === 0 && this._b.length === 0);\n    } else {\n      this._oneComplete = true;\n    }\n    this.unsubscribe();\n  }\n\n  checkValues() {\n    const { _a, _b, comparator } = this;\n    while (_a.length > 0 && _b.length > 0) {\n      let a = _a.shift();\n      let b = _b.shift();\n      let areEqual = false;\n      try {\n        areEqual = comparator ? comparator(a, b) : a === b;\n      } catch (e) {\n        this.destination.error(e);\n      }\n      if (!areEqual) {\n        this.emit(false);\n      }\n    }\n  }\n\n  emit(value: boolean) {\n    const { destination } = this;\n    destination.next(value);\n    destination.complete();\n  }\n\n  nextB(value: T) {\n    if (this._oneComplete && this._a.length === 0) {\n      this.emit(false);\n    } else {\n      this._b.push(value);\n      this.checkValues();\n    }\n  }\n\n  completeB() {\n    if (this._oneComplete) {\n      this.emit(this._a.length === 0 && this._b.length === 0);\n    } else {\n      this._oneComplete = true;\n    }\n  }\n}\n\nclass SequenceEqualCompareToSubscriber<T, R> extends Subscriber<T> {\n  constructor(destination: Observer<R>, private parent: SequenceEqualSubscriber<T, R>) {\n    super(destination);\n  }\n\n  protected _next(value: T): void {\n    this.parent.nextB(value);\n  }\n\n  protected _error(err: any): void {\n    this.parent.error(err);\n    this.unsubscribe();\n  }\n\n  protected _complete(): void {\n    this.parent.completeB();\n    this.unsubscribe();\n  }\n}\n","import { Observable } from '../Observable';\nimport { multicast } from './multicast';\nimport { refCount } from './refCount';\nimport { Subject } from '../Subject';\n\nimport { MonoTypeOperatorFunction } from '../types';\n\nfunction shareSubjectFactory() {\n  return new Subject();\n}\n\n/**\n * Returns a new Observable that multicasts (shares) the original Observable. As long as there is at least one\n * Subscriber this Observable will be subscribed and emitting data. When all subscribers have unsubscribed it will\n * unsubscribe from the source Observable. Because the Observable is multicasting it makes the stream `hot`.\n * This is an alias for `multicast(() => new Subject()), refCount()`.\n *\n * ![](share.png)\n *\n * @return {Observable<T>} An Observable that upon connection causes the source Observable to emit items to its Observers.\n * @method share\n * @owner Observable\n */\nexport function share<T>(): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => refCount()(multicast(shareSubjectFactory)(source)) as Observable<T>;\n}\n","import { Observable } from '../Observable';\nimport { ReplaySubject } from '../ReplaySubject';\nimport { Subscription } from '../Subscription';\nimport { MonoTypeOperatorFunction, SchedulerLike } from '../types';\nimport { Subscriber } from '../Subscriber';\n\nexport interface ShareReplayConfig {\n  bufferSize?: number;\n  windowTime?: number;\n  refCount: boolean;\n  scheduler?: SchedulerLike;\n}\n\n/**\n * Share source and replay specified number of emissions on subscription.\n *\n * This operator is a specialization of `replay` that connects to a source observable\n * and multicasts through a `ReplaySubject` constructed with the specified arguments.\n * A successfully completed source will stay cached in the `shareReplayed observable` forever,\n * but an errored source can be retried.\n *\n * ## Why use shareReplay?\n * You generally want to use `shareReplay` when you have side-effects or taxing computations\n * that you do not wish to be executed amongst multiple subscribers.\n * It may also be valuable in situations where you know you will have late subscribers to\n * a stream that need access to previously emitted values.\n * This ability to replay values on subscription is what differentiates {@link share} and `shareReplay`.\n *\n * ![](shareReplay.png)\n *\n * ## Example\n * ```ts\n * import { interval } from 'rxjs';\n * import { shareReplay, take } from 'rxjs/operators';\n *\n * const obs$ = interval(1000);\n * const shared$ = obs$.pipe(\n *   take(4),\n *   shareReplay(3)\n * );\n * shared$.subscribe(x => console.log('source A: ', x));\n * shared$.subscribe(y => console.log('source B: ', y));\n *\n * ```\n *\n * @see {@link publish}\n * @see {@link share}\n * @see {@link publishReplay}\n *\n * @param {Number} [bufferSize=Number.POSITIVE_INFINITY] Maximum element count of the replay buffer.\n * @param {Number} [windowTime=Number.POSITIVE_INFINITY] Maximum time length of the replay buffer in milliseconds.\n * @param {Scheduler} [scheduler] Scheduler where connected observers within the selector function\n * will be invoked on.\n * @return {Observable} An observable sequence that contains the elements of a sequence produced\n * by multicasting the source sequence within a selector function.\n * @method shareReplay\n * @owner Observable\n */\nexport function shareReplay<T>(config: ShareReplayConfig): MonoTypeOperatorFunction<T>;\nexport function shareReplay<T>(bufferSize?: number, windowTime?: number, scheduler?: SchedulerLike): MonoTypeOperatorFunction<T>;\nexport function shareReplay<T>(\n  configOrBufferSize?: ShareReplayConfig | number,\n  windowTime?: number,\n  scheduler?: SchedulerLike\n): MonoTypeOperatorFunction<T> {\n  let config: ShareReplayConfig;\n  if (configOrBufferSize && typeof configOrBufferSize === 'object') {\n    config = configOrBufferSize as ShareReplayConfig;\n  } else {\n    config = {\n      bufferSize: configOrBufferSize as number | undefined,\n      windowTime,\n      refCount: false,\n      scheduler\n    };\n  }\n  return (source: Observable<T>) => source.lift(shareReplayOperator(config));\n}\n\nfunction shareReplayOperator<T>({\n  bufferSize = Number.POSITIVE_INFINITY,\n  windowTime = Number.POSITIVE_INFINITY,\n  refCount: useRefCount,\n  scheduler\n}: ShareReplayConfig) {\n  let subject: ReplaySubject<T> | undefined;\n  let refCount = 0;\n  let subscription: Subscription | undefined;\n  let hasError = false;\n  let isComplete = false;\n\n  return function shareReplayOperation(this: Subscriber<T>, source: Observable<T>) {\n    refCount++;\n    if (!subject || hasError) {\n      hasError = false;\n      subject = new ReplaySubject<T>(bufferSize, windowTime, scheduler);\n      subscription = source.subscribe({\n        next(value) { subject.next(value); },\n        error(err) {\n          hasError = true;\n          subject.error(err);\n        },\n        complete() {\n          isComplete = true;\n          subject.complete();\n        },\n      });\n    }\n\n    const innerSub = subject.subscribe(this);\n    this.add(() => {\n      refCount--;\n      innerSub.unsubscribe();\n      if (subscription && !isComplete && useRefCount && refCount === 0) {\n        subscription.unsubscribe();\n        subscription = undefined;\n        subject = undefined;\n      }\n    });\n  };\n}\n","import { Observable } from '../Observable';\nimport { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { EmptyError } from '../util/EmptyError';\n\nimport { Observer, MonoTypeOperatorFunction, TeardownLogic } from '../types';\n\n/**\n * Returns an Observable that emits the single item emitted by the source Observable that matches a specified\n * predicate, if that Observable emits one such item. If the source Observable emits more than one such item or no\n * items, notify of an IllegalArgumentException or NoSuchElementException respectively. If the source Observable\n * emits items but none match the specified predicate then `undefined` is emitted.\n *\n * <span class=\"informal\">Like {@link first}, but emit with error notification if there is more than one value.</span>\n * ![](single.png)\n *\n * ## Example\n * emits 'error'\n * ```ts\n * import { range } from 'rxjs';\n * import { single } from 'rxjs/operators';\n *\n * const numbers = range(1,5).pipe(single());\n * numbers.subscribe(x => console.log('never get called'), e => console.log('error'));\n * // result\n * // 'error'\n * ```\n *\n * emits 'undefined'\n * ```ts\n * import { range } from 'rxjs';\n * import { single } from 'rxjs/operators';\n *\n * const numbers = range(1,5).pipe(single(x => x === 10));\n * numbers.subscribe(x => console.log(x));\n * // result\n * // 'undefined'\n * ```\n *\n * @see {@link first}\n * @see {@link find}\n * @see {@link findIndex}\n * @see {@link elementAt}\n *\n * @throws {EmptyError} Delivers an EmptyError to the Observer's `error`\n * callback if the Observable completes before any `next` notification was sent.\n * @param {Function} predicate - A predicate function to evaluate items emitted by the source Observable.\n * @return {Observable<T>} An Observable that emits the single item emitted by the source Observable that matches\n * the predicate or `undefined` when no items match.\n *\n * @method single\n * @owner Observable\n */\nexport function single<T>(predicate?: (value: T, index: number, source: Observable<T>) => boolean): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => source.lift(new SingleOperator(predicate, source));\n}\n\nclass SingleOperator<T> implements Operator<T, T> {\n  constructor(private predicate?: (value: T, index: number, source: Observable<T>) => boolean,\n              private source?: Observable<T>) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new SingleSubscriber(subscriber, this.predicate, this.source));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass SingleSubscriber<T> extends Subscriber<T> {\n  private seenValue: boolean = false;\n  private singleValue: T;\n  private index: number = 0;\n\n  constructor(destination: Observer<T>,\n              private predicate?: (value: T, index: number, source: Observable<T>) => boolean,\n              private source?: Observable<T>) {\n    super(destination);\n  }\n\n  private applySingleValue(value: T): void {\n    if (this.seenValue) {\n      this.destination.error('Sequence contains more than one element');\n    } else {\n      this.seenValue = true;\n      this.singleValue = value;\n    }\n  }\n\n  protected _next(value: T): void {\n    const index = this.index++;\n\n    if (this.predicate) {\n      this.tryNext(value, index);\n    } else {\n      this.applySingleValue(value);\n    }\n  }\n\n  private tryNext(value: T, index: number): void {\n    try {\n      if (this.predicate(value, index, this.source)) {\n        this.applySingleValue(value);\n      }\n    } catch (err) {\n      this.destination.error(err);\n    }\n  }\n\n  protected _complete(): void {\n    const destination = this.destination;\n\n    if (this.index > 0) {\n      destination.next(this.seenValue ? this.singleValue : undefined);\n      destination.complete();\n    } else {\n      destination.error(new EmptyError);\n    }\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { MonoTypeOperatorFunction, TeardownLogic } from '../types';\n\n/**\n * Returns an Observable that skips the first `count` items emitted by the source Observable.\n *\n * ![](skip.png)\n *\n * @param {Number} count - The number of times, items emitted by source Observable should be skipped.\n * @return {Observable} An Observable that skips values emitted by the source Observable.\n *\n * @method skip\n * @owner Observable\n */\nexport function skip<T>(count: number): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => source.lift(new SkipOperator(count));\n}\n\nclass SkipOperator<T> implements Operator<T, T> {\n  constructor(private total: number) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new SkipSubscriber(subscriber, this.total));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass SkipSubscriber<T> extends Subscriber<T> {\n  count: number = 0;\n\n  constructor(destination: Subscriber<T>, private total: number) {\n    super(destination);\n  }\n\n  protected _next(x: T) {\n    if (++this.count > this.total) {\n      this.destination.next(x);\n    }\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { ArgumentOutOfRangeError } from '../util/ArgumentOutOfRangeError';\nimport { Observable } from '../Observable';\nimport { MonoTypeOperatorFunction, TeardownLogic } from '../types';\n\n/**\n * Skip the last `count` values emitted by the source Observable.\n *\n * ![](skipLast.png)\n *\n * `skipLast` returns an Observable that accumulates a queue with a length\n * enough to store the first `count` values. As more values are received,\n * values are taken from the front of the queue and produced on the result\n * sequence. This causes values to be delayed.\n *\n * ## Example\n * Skip the last 2 values of an Observable with many values\n * ```ts\n * import { range } from 'rxjs';\n * import { skipLast } from 'rxjs/operators';\n *\n * const many = range(1, 5);\n * const skipLastTwo = many.pipe(skipLast(2));\n * skipLastTwo.subscribe(x => console.log(x));\n *\n * // Results in:\n * // 1 2 3\n * ```\n *\n * @see {@link skip}\n * @see {@link skipUntil}\n * @see {@link skipWhile}\n * @see {@link take}\n *\n * @throws {ArgumentOutOfRangeError} When using `skipLast(i)`, it throws\n * ArgumentOutOrRangeError if `i < 0`.\n *\n * @param {number} count Number of elements to skip from the end of the source Observable.\n * @returns {Observable<T>} An Observable that skips the last count values\n * emitted by the source Observable.\n * @method skipLast\n * @owner Observable\n */\nexport function skipLast<T>(count: number): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => source.lift(new SkipLastOperator(count));\n}\n\nclass SkipLastOperator<T> implements Operator<T, T> {\n  constructor(private _skipCount: number) {\n    if (this._skipCount < 0) {\n      throw new ArgumentOutOfRangeError;\n    }\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    if (this._skipCount === 0) {\n      // If we don't want to skip any values then just subscribe\n      // to Subscriber without any further logic.\n      return source.subscribe(new Subscriber(subscriber));\n    } else {\n      return source.subscribe(new SkipLastSubscriber(subscriber, this._skipCount));\n    }\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass SkipLastSubscriber<T> extends Subscriber<T> {\n  private _ring: T[];\n  private _count: number = 0;\n\n  constructor(destination: Subscriber<T>, private _skipCount: number) {\n    super(destination);\n    this._ring = new Array<T>(_skipCount);\n  }\n\n  protected _next(value: T): void {\n    const skipCount = this._skipCount;\n    const count = this._count++;\n\n    if (count < skipCount) {\n      this._ring[count] = value;\n    } else {\n      const currentIndex = count % skipCount;\n      const ring = this._ring;\n      const oldValue = ring[currentIndex];\n\n      ring[currentIndex] = value;\n      this.destination.next(oldValue);\n    }\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { MonoTypeOperatorFunction, TeardownLogic, ObservableInput } from '../types';\nimport { Subscription } from '../Subscription';\n\n/**\n * Returns an Observable that skips items emitted by the source Observable until a second Observable emits an item.\n *\n * The `skipUntil` operator causes the observable stream to skip the emission of values until the passed in observable emits the first value.\n * This can be particularly useful in combination with user interactions, responses of http requests or waiting for specific times to pass by.\n *\n * ![](skipUntil.png)\n *\n * Internally the `skipUntil` operator subscribes to the passed in observable (in the following called *notifier*) in order to recognize the emission\n * of its first value. When this happens, the operator unsubscribes from the *notifier* and starts emitting the values of the *source*\n * observable. It will never let the *source* observable emit any values if the *notifier* completes or throws an error without emitting\n * a value before.\n *\n * ## Example\n *\n * In the following example, all emitted values of the interval observable are skipped until the user clicks anywhere within the page.\n *\n * ```ts\n * import { interval, fromEvent } from 'rxjs';\n * import { skipUntil } from 'rxjs/operators';\n *\n * const intervalObservable = interval(1000);\n * const click = fromEvent(document, 'click');\n *\n * const emitAfterClick = intervalObservable.pipe(\n *   skipUntil(click)\n * );\n * // clicked at 4.6s. output: 5...6...7...8........ or\n * // clicked at 7.3s. output: 8...9...10..11.......\n * const subscribe = emitAfterClick.subscribe(value => console.log(value));\n * ```\n *\n * @param {Observable} notifier - The second Observable that has to emit an item before the source Observable's elements begin to\n * be mirrored by the resulting Observable.\n * @return {Observable<T>} An Observable that skips items from the source Observable until the second Observable emits\n * an item, then emits the remaining items.\n * @method skipUntil\n * @owner Observable\n */\nexport function skipUntil<T>(notifier: Observable<any>): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => source.lift(new SkipUntilOperator(notifier));\n}\n\nclass SkipUntilOperator<T> implements Operator<T, T> {\n  constructor(private notifier: Observable<any>) {\n  }\n\n  call(destination: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new SkipUntilSubscriber(destination, this.notifier));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass SkipUntilSubscriber<T, R> extends OuterSubscriber<T, R> {\n\n  private hasValue: boolean = false;\n  private innerSubscription: Subscription;\n\n  constructor(destination: Subscriber<R>, notifier: ObservableInput<any>) {\n    super(destination);\n    const innerSubscriber = new InnerSubscriber(this, undefined, undefined);\n    this.add(innerSubscriber);\n    this.innerSubscription = innerSubscriber;\n    subscribeToResult(this, notifier, undefined, undefined, innerSubscriber);\n  }\n\n  protected _next(value: T) {\n    if (this.hasValue) {\n      super._next(value);\n    }\n  }\n\n  notifyNext(outerValue: T, innerValue: R,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, R>): void {\n    this.hasValue = true;\n    if (this.innerSubscription) {\n      this.innerSubscription.unsubscribe();\n    }\n  }\n\n  notifyComplete() {\n    /* do nothing */\n  }\n}\n","import { Observable } from '../Observable';\nimport { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { MonoTypeOperatorFunction, TeardownLogic } from '../types';\n\n/**\n * Returns an Observable that skips all items emitted by the source Observable as long as a specified condition holds\n * true, but emits all further source items as soon as the condition becomes false.\n *\n * ![](skipWhile.png)\n *\n * @param {Function} predicate - A function to test each item emitted from the source Observable.\n * @return {Observable<T>} An Observable that begins emitting items emitted by the source Observable when the\n * specified predicate becomes false.\n * @method skipWhile\n * @owner Observable\n */\nexport function skipWhile<T>(predicate: (value: T, index: number) => boolean): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => source.lift(new SkipWhileOperator(predicate));\n}\n\nclass SkipWhileOperator<T> implements Operator<T, T> {\n  constructor(private predicate: (value: T, index: number) => boolean) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new SkipWhileSubscriber(subscriber, this.predicate));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass SkipWhileSubscriber<T> extends Subscriber<T> {\n  private skipping: boolean = true;\n  private index: number = 0;\n\n  constructor(destination: Subscriber<T>,\n              private predicate: (value: T, index: number) => boolean) {\n    super(destination);\n  }\n\n  protected _next(value: T): void {\n    const destination = this.destination;\n    if (this.skipping) {\n      this.tryCallPredicate(value);\n    }\n\n    if (!this.skipping) {\n      destination.next(value);\n    }\n  }\n\n  private tryCallPredicate(value: T): void {\n    try {\n      const result = this.predicate(value, this.index++);\n      this.skipping = Boolean(result);\n    } catch (err) {\n      this.destination.error(err);\n    }\n  }\n}\n","import { Observable } from '../Observable';\nimport { concat } from '../observable/concat';\nimport { isScheduler } from '../util/isScheduler';\nimport { MonoTypeOperatorFunction, OperatorFunction, SchedulerLike } from '../types';\n\n/* tslint:disable:max-line-length */\n/** @deprecated use {@link scheduled} and {@link concatAll} (e.g. `scheduled([[a, b, c], source], scheduler).pipe(concatAll())`) */\nexport function startWith<T>(scheduler: SchedulerLike): MonoTypeOperatorFunction<T>;\n/** @deprecated use {@link scheduled} and {@link concatAll} (e.g. `scheduled([[a, b, c], source], scheduler).pipe(concatAll())`) */\nexport function startWith<T, D>(v1: D, scheduler: SchedulerLike): OperatorFunction<T, T | D>;\n/** @deprecated use {@link scheduled} and {@link concatAll} (e.g. `scheduled([[a, b, c], source], scheduler).pipe(concatAll())`) */\nexport function startWith<T, D, E>(v1: D, v2: E, scheduler: SchedulerLike): OperatorFunction<T, T | D | E>;\n/** @deprecated use {@link scheduled} and {@link concatAll} (e.g. `scheduled([[a, b, c], source], scheduler).pipe(concatAll())`) */\nexport function startWith<T, D, E, F>(v1: D, v2: E, v3: F, scheduler: SchedulerLike): OperatorFunction<T, T | D | E | F>;\n/** @deprecated use {@link scheduled} and {@link concatAll} (e.g. `scheduled([[a, b, c], source], scheduler).pipe(concatAll())`) */\nexport function startWith<T, D, E, F, G>(v1: D, v2:  E, v3: F, v4: G, scheduler: SchedulerLike): OperatorFunction<T, T | D | E | F | G>;\n/** @deprecated use {@link scheduled} and {@link concatAll} (e.g. `scheduled([[a, b, c], source], scheduler).pipe(concatAll())`) */\nexport function startWith<T, D, E, F, G, H>(v1: D, v2: E, v3: F, v4: G, v5: H, scheduler: SchedulerLike): OperatorFunction<T, T | D | E | F | G | H>;\n/** @deprecated use {@link scheduled} and {@link concatAll} (e.g. `scheduled([[a, b, c], source], scheduler).pipe(concatAll())`) */\nexport function startWith<T, D, E, F, G, H, I>(v1: D, v2: E, v3: F, v4: G, v5: H, v6: I, scheduler: SchedulerLike): OperatorFunction<T, T | D | E | F | G | H | I>;\n\nexport function startWith<T, D>(v1: D): OperatorFunction<T, T | D>;\nexport function startWith<T, D, E>(v1: D, v2: E): OperatorFunction<T, T | D | E>;\nexport function startWith<T, D, E, F>(v1: D, v2: E, v3: F): OperatorFunction<T, T | D | E | F>;\nexport function startWith<T, D, E, F, G>(v1: D, v2:  E, v3: F, v4: G): OperatorFunction<T, T | D | E | F | G>;\nexport function startWith<T, D, E, F, G, H>(v1: D, v2: E, v3: F, v4: G, v5: H): OperatorFunction<T, T | D | E | F | G | H>;\nexport function startWith<T, D, E, F, G, H, I>(v1: D, v2: E, v3: F, v4: G, v5: H, v6: I): OperatorFunction<T, T | D | E | F | G | H | I>;\nexport function startWith<T, D = T>(...array: D[]): OperatorFunction<T, T | D>;\n/** @deprecated use {@link scheduled} and {@link concatAll} (e.g. `scheduled([[a, b, c], source], scheduler).pipe(concatAll())`) */\nexport function startWith<T, D = T>(...array: Array<D | SchedulerLike>): OperatorFunction<T, T | D>;\n/* tslint:enable:max-line-length */\n\n/**\n * Returns an Observable that emits the items you specify as arguments before it begins to emit\n * items emitted by the source Observable.\n *\n * <span class=\"informal\">First emits its arguments in order, and then any\n * emissions from the source.</span>\n *\n * ![](startWith.png)\n *\n * ## Examples\n *\n * Start the chain of emissions with `\"first\"`, `\"second\"`\n *\n * ```ts\n * import { of } from 'rxjs';\n * import { startWith } from 'rxjs/operators';\n *\n * of(\"from source\")\n *   .pipe(startWith(\"first\", \"second\"))\n *   .subscribe(x => console.log(x));\n *\n * // results:\n * //   \"first\"\n * //   \"second\"\n * //   \"from source\"\n * ```\n *\n * @param {...T} values - Items you want the modified Observable to emit first.\n * @param {SchedulerLike} [scheduler] - A {@link SchedulerLike} to use for scheduling\n * the emissions of the `next` notifications.\n * @return {Observable} An Observable that emits the items in the specified Iterable and then emits the items\n * emitted by the source Observable.\n * @method startWith\n * @owner Observable\n */\nexport function startWith<T, D>(...array: Array<T | SchedulerLike>): OperatorFunction<T, T | D> {\n  const scheduler = array[array.length - 1] as SchedulerLike;\n  if (isScheduler(scheduler)) {\n    // deprecated path\n    array.pop();\n    return (source: Observable<T>) => concat(array as T[], source, scheduler);\n  } else {\n    return (source: Observable<T>) => concat(array as T[], source);\n  }\n}\n","import { SchedulerLike, SchedulerAction } from '../types';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { Observable } from '../Observable';\nimport { asap } from '../scheduler/asap';\nimport { isNumeric } from '../util/isNumeric';\n\nexport interface DispatchArg<T> {\n  source: Observable<T>;\n  subscriber: Subscriber<T>;\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @extends {Ignored}\n * @hide true\n */\nexport class SubscribeOnObservable<T> extends Observable<T> {\n  /** @nocollapse */\n  static create<T>(source: Observable<T>, delay: number = 0, scheduler: SchedulerLike = asap): Observable<T> {\n    return new SubscribeOnObservable(source, delay, scheduler);\n  }\n\n  /** @nocollapse */\n  static dispatch<T>(this: SchedulerAction<T>, arg: DispatchArg<T>): Subscription {\n    const { source, subscriber } = arg;\n    return this.add(source.subscribe(subscriber));\n  }\n\n  constructor(public source: Observable<T>,\n              private delayTime: number = 0,\n              private scheduler: SchedulerLike = asap) {\n    super();\n    if (!isNumeric(delayTime) || delayTime < 0) {\n      this.delayTime = 0;\n    }\n    if (!scheduler || typeof scheduler.schedule !== 'function') {\n      this.scheduler = asap;\n    }\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _subscribe(subscriber: Subscriber<T>) {\n    const delay = this.delayTime;\n    const source = this.source;\n    const scheduler = this.scheduler;\n\n    return scheduler.schedule<DispatchArg<any>>(SubscribeOnObservable.dispatch, delay, {\n      source, subscriber\n    });\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { SubscribeOnObservable } from '../observable/SubscribeOnObservable';\nimport { MonoTypeOperatorFunction, SchedulerLike, TeardownLogic } from '../types';\n\n/**\n * Asynchronously subscribes Observers to this Observable on the specified {@link SchedulerLike}.\n *\n * With `subscribeOn` you can decide what type of scheduler a specific Observable will be using when it is subscribed to.\n *\n * Schedulers control the speed and order of emissions to observers from an Observable stream.\n *\n * ![](subscribeOn.png)\n *\n * ## Example\n * Given the following code:\n * ```javascript\n * import { of, merge } from 'rxjs';\n *\n * const a = of(1, 2, 3, 4);\n * const b = of(5, 6, 7, 8, 9);\n * merge(a, b).subscribe(console.log);\n * ```\n *\n * Both Observable `a` and `b` will emit their values directly and synchronously once they are subscribed to.\n * This will result in the output of `1 2 3 4 5 6 7 8 9`.\n *\n * But if we instead us the `subscribeOn` operator declaring that we want to use the {@link asyncScheduler} for values emited by Observable `a`:\n * ```javascript\n * import { of, merge, asyncScheduler } from 'rxjs';\n * import { subscribeOn } from 'rxjs/operators';\n *\n * const a = of(1, 2, 3, 4).pipe(subscribeOn(asyncScheduler));\n * const b = of(5, 6, 7, 8, 9);\n * merge(a, b).subscribe(console.log);\n * ```\n *\n * The output will instead be `5 6 7 8 9 1 2 3 4`.\n * The reason for this is that Observable `b` emits its values directly and synchronously like before\n * but the emissions from `a` are scheduled on the event loop because we are now using the {@link asyncScheduler} for that specific Observable.\n *\n * @param {SchedulerLike} scheduler - The {@link SchedulerLike} to perform subscription actions on.\n * @return {Observable<T>} The source Observable modified so that its subscriptions happen on the specified {@link SchedulerLike}.\n .\n * @method subscribeOn\n * @owner Observable\n */\nexport function subscribeOn<T>(scheduler: SchedulerLike, delay: number = 0): MonoTypeOperatorFunction<T> {\n  return function subscribeOnOperatorFunction(source: Observable<T>): Observable<T> {\n    return source.lift(new SubscribeOnOperator<T>(scheduler, delay));\n  };\n}\n\nclass SubscribeOnOperator<T> implements Operator<T, T> {\n  constructor(private scheduler: SchedulerLike,\n              private delay: number) {\n  }\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return new SubscribeOnObservable<T>(\n      source, this.delay, this.scheduler\n    ).subscribe(subscriber);\n  }\n}\n","import { Operator } from '../Operator';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { ObservableInput, OperatorFunction, ObservedValueOf } from '../types';\nimport { map } from './map';\nimport { from } from '../observable/from';\n\n/* tslint:disable:max-line-length */\nexport function switchMap<T, O extends ObservableInput<any>>(project: (value: T, index: number) => O): OperatorFunction<T, ObservedValueOf<O>>;\n/** @deprecated resultSelector is no longer supported, use inner map instead */\nexport function switchMap<T, O extends ObservableInput<any>>(project: (value: T, index: number) => O, resultSelector: undefined): OperatorFunction<T, ObservedValueOf<O>>;\n/** @deprecated resultSelector is no longer supported, use inner map instead */\nexport function switchMap<T, R, O extends ObservableInput<any>>(project: (value: T, index: number) => O, resultSelector: (outerValue: T, innerValue: ObservedValueOf<O>, outerIndex: number, innerIndex: number) => R): OperatorFunction<T, R>;\n/* tslint:enable:max-line-length */\n\n/**\n * Projects each source value to an Observable which is merged in the output\n * Observable, emitting values only from the most recently projected Observable.\n *\n * <span class=\"informal\">Maps each value to an Observable, then flattens all of\n * these inner Observables.</span>\n *\n * ![](switchMap.png)\n *\n * Returns an Observable that emits items based on applying a function that you\n * supply to each item emitted by the source Observable, where that function\n * returns an (so-called \"inner\") Observable. Each time it observes one of these\n * inner Observables, the output Observable begins emitting the items emitted by\n * that inner Observable. When a new inner Observable is emitted, `switchMap`\n * stops emitting items from the earlier-emitted inner Observable and begins\n * emitting items from the new one. It continues to behave like this for\n * subsequent inner Observables.\n *\n * ## Example\n * Generate new Observable according to source Observable values\n * ```typescript\n * import { of } from 'rxjs';\n * import { switchMap } from 'rxjs/operators';\n *\n * const switched = of(1, 2, 3).pipe(switchMap((x: number) => of(x, x ** 2, x ** 3)));\n * switched.subscribe(x => console.log(x));\n * // outputs\n * // 1\n * // 1\n * // 1\n * // 2\n * // 4\n * // 8\n * // ... and so on\n * ```\n *\n * Rerun an interval Observable on every click event\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { switchMap } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(switchMap((ev) => interval(1000)));\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link concatMap}\n * @see {@link exhaustMap}\n * @see {@link mergeMap}\n * @see {@link switchAll}\n * @see {@link switchMapTo}\n *\n * @param {function(value: T, ?index: number): ObservableInput} project A function\n * that, when applied to an item emitted by the source Observable, returns an\n * Observable.\n * @return {Observable} An Observable that emits the result of applying the\n * projection function (and the optional deprecated `resultSelector`) to each item\n * emitted by the source Observable and taking only the values from the most recently\n * projected inner Observable.\n * @method switchMap\n * @owner Observable\n */\nexport function switchMap<T, R, O extends ObservableInput<any>>(\n  project: (value: T, index: number) => O,\n  resultSelector?: (outerValue: T, innerValue: ObservedValueOf<O>, outerIndex: number, innerIndex: number) => R,\n): OperatorFunction<T, ObservedValueOf<O>|R> {\n  if (typeof resultSelector === 'function') {\n    return (source: Observable<T>) => source.pipe(\n      switchMap((a, i) => from(project(a, i)).pipe(\n        map((b, ii) => resultSelector(a, b, i, ii))\n      ))\n    );\n  }\n  return (source: Observable<T>) => source.lift(new SwitchMapOperator(project));\n}\n\nclass SwitchMapOperator<T, R> implements Operator<T, R> {\n  constructor(private project: (value: T, index: number) => ObservableInput<R>) {\n  }\n\n  call(subscriber: Subscriber<R>, source: any): any {\n    return source.subscribe(new SwitchMapSubscriber(subscriber, this.project));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass SwitchMapSubscriber<T, R> extends OuterSubscriber<T, R> {\n  private index: number = 0;\n  private innerSubscription: Subscription;\n\n  constructor(destination: Subscriber<R>,\n              private project: (value: T, index: number) => ObservableInput<R>) {\n    super(destination);\n  }\n\n  protected _next(value: T) {\n    let result: ObservableInput<R>;\n    const index = this.index++;\n    try {\n      result = this.project(value, index);\n    } catch (error) {\n      this.destination.error(error);\n      return;\n    }\n    this._innerSub(result, value, index);\n  }\n\n  private _innerSub(result: ObservableInput<R>, value: T, index: number) {\n    const innerSubscription = this.innerSubscription;\n    if (innerSubscription) {\n      innerSubscription.unsubscribe();\n    }\n    const innerSubscriber = new InnerSubscriber(this, undefined, undefined);\n    const destination = this.destination as Subscription;\n    destination.add(innerSubscriber);\n    this.innerSubscription = subscribeToResult(this, result, value, index, innerSubscriber);\n  }\n\n  protected _complete(): void {\n    const {innerSubscription} = this;\n    if (!innerSubscription || innerSubscription.closed) {\n      super._complete();\n    }\n    this.unsubscribe();\n  }\n\n  protected _unsubscribe() {\n    this.innerSubscription = null;\n  }\n\n  notifyComplete(innerSub: Subscription): void {\n    const destination = this.destination as Subscription;\n    destination.remove(innerSub);\n    this.innerSubscription = null;\n    if (this.isStopped) {\n      super._complete();\n    }\n  }\n\n  notifyNext(outerValue: T, innerValue: R,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, R>): void {\n      this.destination.next(innerValue);\n  }\n}\n","import {OperatorFunction, ObservableInput} from '../types';\nimport { switchMap } from './switchMap';\nimport { identity } from '../util/identity';\n\nexport function switchAll<T>(): OperatorFunction<ObservableInput<T>, T>;\nexport function switchAll<R>(): OperatorFunction<any, R>;\n\n/**\n * Converts a higher-order Observable into a first-order Observable\n * producing values only from the most recent observable sequence\n *\n * <span class=\"informal\">Flattens an Observable-of-Observables.</span>\n *\n * ![](switchAll.png)\n *\n * `switchAll` subscribes to a source that is an observable of observables, also known as a\n * \"higher-order observable\" (or `Observable<Observable<T>>`). It subscribes to the most recently\n * provided \"inner observable\" emitted by the source, unsubscribing from any previously subscribed\n * to inner observable, such that only the most recent inner observable may be subscribed to at\n * any point in time. The resulting observable returned by `switchAll` will only complete if the\n * source observable completes, *and* any currently subscribed to inner observable also has completed,\n * if there are any.\n *\n * ## Examples\n * Spawn a new interval observable for each click event, but for every new\n * click, cancel the previous interval and subscribe to the new one.\n *\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { switchAll, map, tap } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click').pipe(tap(() => console.log('click')));\n * const source = clicks.pipe(map((ev) => interval(1000)));\n *\n * source.pipe(\n *   switchAll()\n * ).subscribe(x => console.log(x));\n *\n /* Output\n *  click\n *  1\n *  2\n *  3\n *  4\n *  ...\n *  click\n *  1\n *  2\n *  3\n *  ...\n *  click\n *  ...\n * ```\n *\n * @see {@link combineAll}\n * @see {@link concatAll}\n * @see {@link exhaust}\n * @see {@link switchMap}\n * @see {@link switchMapTo}\n * @see {@link mergeAll}\n */\n\nexport function switchAll<T>(): OperatorFunction<ObservableInput<T>, T> {\n  return switchMap(identity);\n}\n","import { Operator } from '../Operator';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { ObservableInput, OperatorFunction } from '../types';\nimport { switchMap } from './switchMap';\n\n/* tslint:disable:max-line-length */\nexport function switchMapTo<R>(observable: ObservableInput<R>): OperatorFunction<any, R>;\n/** @deprecated resultSelector is no longer supported. Switch to using switchMap with an inner map */\nexport function switchMapTo<T, R>(observable: ObservableInput<R>, resultSelector: undefined): OperatorFunction<T, R>;\n/** @deprecated resultSelector is no longer supported. Switch to using switchMap with an inner map */\nexport function switchMapTo<T, I, R>(observable: ObservableInput<I>, resultSelector: (outerValue: T, innerValue: I, outerIndex: number, innerIndex: number) => R): OperatorFunction<T, R>;\n/* tslint:enable:max-line-length */\n\n/**\n * Projects each source value to the same Observable which is flattened multiple\n * times with {@link switchMap} in the output Observable.\n *\n * <span class=\"informal\">It's like {@link switchMap}, but maps each value\n * always to the same inner Observable.</span>\n *\n * ![](switchMapTo.png)\n *\n * Maps each source value to the given Observable `innerObservable` regardless\n * of the source value, and then flattens those resulting Observables into one\n * single Observable, which is the output Observable. The output Observables\n * emits values only from the most recently emitted instance of\n * `innerObservable`.\n *\n * ## Example\n * Rerun an interval Observable on every click event\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { switchMapTo } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(switchMapTo(interval(1000)));\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link concatMapTo}\n * @see {@link switchAll}\n * @see {@link switchMap}\n * @see {@link mergeMapTo}\n *\n * @param {ObservableInput} innerObservable An Observable to replace each value from\n * the source Observable.\n * @return {Observable} An Observable that emits items from the given\n * `innerObservable` (and optionally transformed through the deprecated `resultSelector`)\n * every time a value is emitted on the source Observable, and taking only the values\n * from the most recently projected inner Observable.\n * @method switchMapTo\n * @owner Observable\n */\nexport function switchMapTo<T, I, R>(\n  innerObservable: ObservableInput<I>,\n  resultSelector?: (outerValue: T, innerValue: I, outerIndex: number, innerIndex: number) => R\n): OperatorFunction<T, I|R> {\n  return resultSelector ? switchMap(() => innerObservable, resultSelector) : switchMap(() => innerObservable);\n}\n","import { Operator } from '../Operator';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\n\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\n\nimport { MonoTypeOperatorFunction, TeardownLogic } from '../types';\n\n/**\n * Emits the values emitted by the source Observable until a `notifier`\n * Observable emits a value.\n *\n * <span class=\"informal\">Lets values pass until a second Observable,\n * `notifier`, emits a value. Then, it completes.</span>\n *\n * ![](takeUntil.png)\n *\n * `takeUntil` subscribes and begins mirroring the source Observable. It also\n * monitors a second Observable, `notifier` that you provide. If the `notifier`\n * emits a value, the output Observable stops mirroring the source Observable\n * and completes. If the `notifier` doesn't emit any value and completes\n * then `takeUntil` will pass all values.\n *\n * ## Example\n * Tick every second until the first click happens\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { takeUntil } from 'rxjs/operators';\n *\n * const source = interval(1000);\n * const clicks = fromEvent(document, 'click');\n * const result = source.pipe(takeUntil(clicks));\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link take}\n * @see {@link takeLast}\n * @see {@link takeWhile}\n * @see {@link skip}\n *\n * @param {Observable} notifier The Observable whose first emitted value will\n * cause the output Observable of `takeUntil` to stop emitting values from the\n * source Observable.\n * @return {Observable<T>} An Observable that emits the values from the source\n * Observable until such time as `notifier` emits its first value.\n * @method takeUntil\n * @owner Observable\n */\nexport function takeUntil<T>(notifier: Observable<any>): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => source.lift(new TakeUntilOperator(notifier));\n}\n\nclass TakeUntilOperator<T> implements Operator<T, T> {\n  constructor(private notifier: Observable<any>) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    const takeUntilSubscriber = new TakeUntilSubscriber(subscriber);\n    const notifierSubscription = subscribeToResult(takeUntilSubscriber, this.notifier);\n    if (notifierSubscription && !takeUntilSubscriber.seenValue) {\n      takeUntilSubscriber.add(notifierSubscription);\n      return source.subscribe(takeUntilSubscriber);\n    }\n    return takeUntilSubscriber;\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass TakeUntilSubscriber<T, R> extends OuterSubscriber<T, R> {\n  seenValue = false;\n\n  constructor(destination: Subscriber<any>, ) {\n    super(destination);\n  }\n\n  notifyNext(outerValue: T, innerValue: R,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, R>): void {\n    this.seenValue = true;\n    this.complete();\n  }\n\n  notifyComplete(): void {\n    // noop\n  }\n}\n","import { Operator } from '../Operator';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { OperatorFunction, MonoTypeOperatorFunction, TeardownLogic } from '../types';\n\nexport function takeWhile<T, S extends T>(predicate: (value: T, index: number) => value is S): OperatorFunction<T, S>;\nexport function takeWhile<T, S extends T>(predicate: (value: T, index: number) => value is S, inclusive: false): OperatorFunction<T, S>;\nexport function takeWhile<T>(predicate: (value: T, index: number) => boolean, inclusive?: boolean): MonoTypeOperatorFunction<T>;\n\n/**\n * Emits values emitted by the source Observable so long as each value satisfies\n * the given `predicate`, and then completes as soon as this `predicate` is not\n * satisfied.\n *\n * <span class=\"informal\">Takes values from the source only while they pass the\n * condition given. When the first value does not satisfy, it completes.</span>\n *\n * ![](takeWhile.png)\n *\n * `takeWhile` subscribes and begins mirroring the source Observable. Each value\n * emitted on the source is given to the `predicate` function which returns a\n * boolean, representing a condition to be satisfied by the source values. The\n * output Observable emits the source values until such time as the `predicate`\n * returns false, at which point `takeWhile` stops mirroring the source\n * Observable and completes the output Observable.\n *\n * ## Example\n * Emit click events only while the clientX property is greater than 200\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { takeWhile } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(takeWhile(ev => ev.clientX > 200));\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link take}\n * @see {@link takeLast}\n * @see {@link takeUntil}\n * @see {@link skip}\n *\n * @param {function(value: T, index: number): boolean} predicate A function that\n * evaluates a value emitted by the source Observable and returns a boolean.\n * Also takes the (zero-based) index as the second argument.\n * @param {boolean} inclusive When set to `true` the value that caused\n * `predicate` to return `false` will also be emitted.\n * @return {Observable<T>} An Observable that emits the values from the source\n * Observable so long as each value satisfies the condition defined by the\n * `predicate`, then completes.\n * @method takeWhile\n * @owner Observable\n */\nexport function takeWhile<T>(\n    predicate: (value: T, index: number) => boolean,\n    inclusive = false): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) =>\n             source.lift(new TakeWhileOperator(predicate, inclusive));\n}\n\nclass TakeWhileOperator<T> implements Operator<T, T> {\n  constructor(\n      private predicate: (value: T, index: number) => boolean,\n      private inclusive: boolean) {}\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(\n        new TakeWhileSubscriber(subscriber, this.predicate, this.inclusive));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass TakeWhileSubscriber<T> extends Subscriber<T> {\n  private index: number = 0;\n\n  constructor(\n      destination: Subscriber<T>,\n      private predicate: (value: T, index: number) => boolean,\n      private inclusive: boolean) {\n    super(destination);\n  }\n\n  protected _next(value: T): void {\n    const destination = this.destination;\n    let result: boolean;\n    try {\n      result = this.predicate(value, this.index++);\n    } catch (err) {\n      destination.error(err);\n      return;\n    }\n    this.nextOrComplete(value, result);\n  }\n\n  private nextOrComplete(value: T, predicateResult: boolean): void {\n    const destination = this.destination;\n    if (Boolean(predicateResult)) {\n      destination.next(value);\n    } else {\n      if (this.inclusive) {\n        destination.next(value);\n      }\n      destination.complete();\n    }\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { MonoTypeOperatorFunction, PartialObserver, TeardownLogic } from '../types';\nimport { noop } from '../util/noop';\nimport { isFunction } from '../util/isFunction';\n\n/* tslint:disable:max-line-length */\n/** @deprecated Use an observer instead of a complete callback */\nexport function tap<T>(next: null | undefined, error: null | undefined, complete: () => void): MonoTypeOperatorFunction<T>;\n/** @deprecated Use an observer instead of an error callback */\nexport function tap<T>(next: null | undefined, error: (error: any) => void, complete?: () => void): MonoTypeOperatorFunction<T>;\n/** @deprecated Use an observer instead of a complete callback */\nexport function tap<T>(next: (value: T) => void, error: null | undefined, complete: () => void): MonoTypeOperatorFunction<T>;\nexport function tap<T>(next?: (x: T) => void, error?: (e: any) => void, complete?: () => void): MonoTypeOperatorFunction<T>;\nexport function tap<T>(observer: PartialObserver<T>): MonoTypeOperatorFunction<T>;\n/* tslint:enable:max-line-length */\n\n/**\n * Perform a side effect for every emission on the source Observable, but return\n * an Observable that is identical to the source.\n *\n * <span class=\"informal\">Intercepts each emission on the source and runs a\n * function, but returns an output which is identical to the source as long as errors don't occur.</span>\n *\n * ![](do.png)\n *\n * Returns a mirrored Observable of the source Observable, but modified so that\n * the provided Observer is called to perform a side effect for every value,\n * error, and completion emitted by the source. Any errors that are thrown in\n * the aforementioned Observer or handlers are safely sent down the error path\n * of the output Observable.\n *\n * This operator is useful for debugging your Observables for the correct values\n * or performing other side effects.\n *\n * Note: this is different to a `subscribe` on the Observable. If the Observable\n * returned by `tap` is not subscribed, the side effects specified by the\n * Observer will never happen. `tap` therefore simply spies on existing\n * execution, it does not trigger an execution to happen like `subscribe` does.\n *\n * ## Example\n * Map every click to the clientX position of that click, while also logging the click event\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { tap, map } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const positions = clicks.pipe(\n *   tap(ev => console.log(ev)),\n *   map(ev => ev.clientX),\n * );\n * positions.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link map}\n * @see {@link Observable#subscribe}\n *\n * @param {Observer|function} [nextOrObserver] A normal Observer object or a\n * callback for `next`.\n * @param {function} [error] Callback for errors in the source.\n * @param {function} [complete] Callback for the completion of the source.\n * @return {Observable} An Observable identical to the source, but runs the\n * specified Observer or callback(s) for each item.\n * @name tap\n */\nexport function tap<T>(nextOrObserver?: PartialObserver<T> | ((x: T) => void),\n                       error?: (e: any) => void,\n                       complete?: () => void): MonoTypeOperatorFunction<T> {\n  return function tapOperatorFunction(source: Observable<T>): Observable<T> {\n    return source.lift(new DoOperator(nextOrObserver, error, complete));\n  };\n}\n\nclass DoOperator<T> implements Operator<T, T> {\n  constructor(private nextOrObserver?: PartialObserver<T> | ((x: T) => void),\n              private error?: (e: any) => void,\n              private complete?: () => void) {\n  }\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new TapSubscriber(subscriber, this.nextOrObserver, this.error, this.complete));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\n\nclass TapSubscriber<T> extends Subscriber<T> {\n  private _context: any;\n\n  private _tapNext: ((value: T) => void) = noop;\n\n  private _tapError: ((err: any) => void) = noop;\n\n  private _tapComplete: (() => void) = noop;\n\n  constructor(destination: Subscriber<T>,\n              observerOrNext?: PartialObserver<T> | ((value: T) => void),\n              error?: (e?: any) => void,\n              complete?: () => void) {\n      super(destination);\n      this._tapError = error || noop;\n      this._tapComplete = complete || noop;\n      if (isFunction(observerOrNext)) {\n        this._context = this;\n        this._tapNext = observerOrNext;\n      } else if (observerOrNext) {\n        this._context = observerOrNext;\n        this._tapNext = observerOrNext.next || noop;\n        this._tapError = observerOrNext.error || noop;\n        this._tapComplete = observerOrNext.complete || noop;\n      }\n    }\n\n  _next(value: T) {\n    try {\n      this._tapNext.call(this._context, value);\n    } catch (err) {\n      this.destination.error(err);\n      return;\n    }\n    this.destination.next(value);\n  }\n\n  _error(err: any) {\n    try {\n      this._tapError.call(this._context, err);\n    } catch (err) {\n      this.destination.error(err);\n      return;\n    }\n    this.destination.error(err);\n  }\n\n  _complete() {\n    try {\n      this._tapComplete.call(this._context, );\n    } catch (err) {\n      this.destination.error(err);\n      return;\n    }\n    return this.destination.complete();\n  }\n}\n","import { Operator } from '../Operator';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\n\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\n\nimport { MonoTypeOperatorFunction, SubscribableOrPromise, TeardownLogic } from '../types';\n\nexport interface ThrottleConfig {\n  leading?: boolean;\n  trailing?: boolean;\n}\n\nexport const defaultThrottleConfig: ThrottleConfig = {\n  leading: true,\n  trailing: false\n};\n\n/**\n * Emits a value from the source Observable, then ignores subsequent source\n * values for a duration determined by another Observable, then repeats this\n * process.\n *\n * <span class=\"informal\">It's like {@link throttleTime}, but the silencing\n * duration is determined by a second Observable.</span>\n *\n * ![](throttle.png)\n *\n * `throttle` emits the source Observable values on the output Observable\n * when its internal timer is disabled, and ignores source values when the timer\n * is enabled. Initially, the timer is disabled. As soon as the first source\n * value arrives, it is forwarded to the output Observable, and then the timer\n * is enabled by calling the `durationSelector` function with the source value,\n * which returns the \"duration\" Observable. When the duration Observable emits a\n * value or completes, the timer is disabled, and this process repeats for the\n * next source value.\n *\n * ## Example\n * Emit clicks at a rate of at most one click per second\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { throttle } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(throttle(ev => interval(1000)));\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link audit}\n * @see {@link debounce}\n * @see {@link delayWhen}\n * @see {@link sample}\n * @see {@link throttleTime}\n *\n * @param {function(value: T): SubscribableOrPromise} durationSelector A function\n * that receives a value from the source Observable, for computing the silencing\n * duration for each source value, returned as an Observable or a Promise.\n * @param {Object} config a configuration object to define `leading` and `trailing` behavior. Defaults\n * to `{ leading: true, trailing: false }`.\n * @return {Observable<T>} An Observable that performs the throttle operation to\n * limit the rate of emissions from the source.\n * @method throttle\n * @owner Observable\n */\nexport function throttle<T>(durationSelector: (value: T) => SubscribableOrPromise<any>,\n                            config: ThrottleConfig = defaultThrottleConfig): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => source.lift(new ThrottleOperator(durationSelector, config.leading, config.trailing));\n}\n\nclass ThrottleOperator<T> implements Operator<T, T> {\n  constructor(private durationSelector: (value: T) => SubscribableOrPromise<any>,\n              private leading: boolean,\n              private trailing: boolean) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(\n      new ThrottleSubscriber(subscriber, this.durationSelector, this.leading, this.trailing)\n    );\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc\n * @ignore\n * @extends {Ignored}\n */\nclass ThrottleSubscriber<T, R> extends OuterSubscriber<T, R> {\n  private _throttled: Subscription;\n  private _sendValue: T;\n  private _hasValue = false;\n\n  constructor(protected destination: Subscriber<T>,\n              private durationSelector: (value: T) => SubscribableOrPromise<number>,\n              private _leading: boolean,\n              private _trailing: boolean) {\n    super(destination);\n  }\n\n  protected _next(value: T): void {\n    this._hasValue = true;\n    this._sendValue = value;\n\n    if (!this._throttled) {\n      if (this._leading) {\n        this.send();\n      } else {\n        this.throttle(value);\n      }\n    }\n  }\n\n  private send() {\n    const { _hasValue, _sendValue } = this;\n    if (_hasValue) {\n      this.destination.next(_sendValue);\n      this.throttle(_sendValue);\n    }\n    this._hasValue = false;\n    this._sendValue = null;\n  }\n\n  private throttle(value: T): void {\n    const duration = this.tryDurationSelector(value);\n    if (!!duration) {\n      this.add(this._throttled = subscribeToResult(this, duration));\n    }\n  }\n\n  private tryDurationSelector(value: T): SubscribableOrPromise<any> {\n    try {\n      return this.durationSelector(value);\n    } catch (err) {\n      this.destination.error(err);\n      return null;\n    }\n  }\n\n  private throttlingDone() {\n    const { _throttled, _trailing } = this;\n    if (_throttled) {\n      _throttled.unsubscribe();\n    }\n    this._throttled = null;\n\n    if (_trailing) {\n      this.send();\n    }\n  }\n\n  notifyNext(outerValue: T, innerValue: R,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, R>): void {\n    this.throttlingDone();\n  }\n\n  notifyComplete(): void {\n    this.throttlingDone();\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { async } from '../scheduler/async';\nimport { Observable } from '../Observable';\nimport { ThrottleConfig, defaultThrottleConfig } from './throttle';\nimport { MonoTypeOperatorFunction, SchedulerLike, TeardownLogic } from '../types';\n\n/**\n * Emits a value from the source Observable, then ignores subsequent source\n * values for `duration` milliseconds, then repeats this process.\n *\n * <span class=\"informal\">Lets a value pass, then ignores source values for the\n * next `duration` milliseconds.</span>\n *\n * ![](throttleTime.png)\n *\n * `throttleTime` emits the source Observable values on the output Observable\n * when its internal timer is disabled, and ignores source values when the timer\n * is enabled. Initially, the timer is disabled. As soon as the first source\n * value arrives, it is forwarded to the output Observable, and then the timer\n * is enabled. After `duration` milliseconds (or the time unit determined\n * internally by the optional `scheduler`) has passed, the timer is disabled,\n * and this process repeats for the next source value. Optionally takes a\n * {@link SchedulerLike} for managing timers.\n *\n * ## Examples\n *\n * #### Limit click rate\n *\n * Emit clicks at a rate of at most one click per second\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { throttleTime } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(throttleTime(1000));\n * result.subscribe(x => console.log(x));\n * ```\n *\n * #### Double Click\n *\n * The following example only emits clicks which happen within a subsequent\n * delay of 400ms of the previous click. This for example can emulate a double\n * click. It makes use of the `trailing` parameter of the throttle configuration.\n *\n * ```ts\n * import { fromEvent, asyncScheduler } from 'rxjs';\n * import { throttleTime, withLatestFrom } from 'rxjs/operators';\n *\n * // defaultThottleConfig = { leading: true, trailing: false }\n * const throttleConfig = {\n *   leading: false,\n *   trailing: true\n * }\n *\n * const click = fromEvent(document, 'click');\n * const doubleClick = click.pipe(\n *   throttleTime(400, asyncScheduler, throttleConfig)\n * );\n *\n * doubleClick.subscribe((throttleValue: Event) => {\n *   console.log(`Double-clicked! Timestamp: ${throttleValue.timeStamp}`);\n * });\n * ```\n *\n * If you enable the `leading` parameter in this example, the output would be the primary click and\n * the double click, but restricts additional clicks within 400ms.\n *\n * @see {@link auditTime}\n * @see {@link debounceTime}\n * @see {@link delay}\n * @see {@link sampleTime}\n * @see {@link throttle}\n *\n * @param {number} duration Time to wait before emitting another value after\n * emitting the last value, measured in milliseconds or the time unit determined\n * internally by the optional `scheduler`.\n * @param {SchedulerLike} [scheduler=async] The {@link SchedulerLike} to use for\n * managing the timers that handle the throttling.\n * @param {Object} config a configuration object to define `leading` and\n * `trailing` behavior. Defaults to `{ leading: true, trailing: false }`.\n * @return {Observable<T>} An Observable that performs the throttle operation to\n * limit the rate of emissions from the source.\n * @method throttleTime\n * @owner Observable\n */\nexport function throttleTime<T>(duration: number,\n                                scheduler: SchedulerLike = async,\n                                config: ThrottleConfig = defaultThrottleConfig): MonoTypeOperatorFunction<T> {\n  return (source: Observable<T>) => source.lift(new ThrottleTimeOperator(duration, scheduler, config.leading, config.trailing));\n}\n\nclass ThrottleTimeOperator<T> implements Operator<T, T> {\n  constructor(private duration: number,\n              private scheduler: SchedulerLike,\n              private leading: boolean,\n              private trailing: boolean) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(\n      new ThrottleTimeSubscriber(subscriber, this.duration, this.scheduler, this.leading, this.trailing)\n    );\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass ThrottleTimeSubscriber<T> extends Subscriber<T> {\n  private throttled: Subscription;\n  private _hasTrailingValue: boolean = false;\n  private _trailingValue: T = null;\n\n  constructor(destination: Subscriber<T>,\n              private duration: number,\n              private scheduler: SchedulerLike,\n              private leading: boolean,\n              private trailing: boolean) {\n    super(destination);\n  }\n\n  protected _next(value: T) {\n    if (this.throttled) {\n      if (this.trailing) {\n        this._trailingValue = value;\n        this._hasTrailingValue = true;\n      }\n    } else {\n      this.add(this.throttled = this.scheduler.schedule<DispatchArg<T>>(dispatchNext, this.duration, { subscriber: this }));\n      if (this.leading) {\n        this.destination.next(value);\n      } else if (this.trailing) {\n        this._trailingValue = value;\n        this._hasTrailingValue = true;\n      }\n    }\n  }\n\n  protected _complete() {\n    if (this._hasTrailingValue) {\n      this.destination.next(this._trailingValue);\n      this.destination.complete();\n    } else {\n      this.destination.complete();\n    }\n  }\n\n  clearThrottle() {\n    const throttled = this.throttled;\n    if (throttled) {\n      if (this.trailing && this._hasTrailingValue) {\n        this.destination.next(this._trailingValue);\n        this._trailingValue = null;\n        this._hasTrailingValue = false;\n      }\n      throttled.unsubscribe();\n      this.remove(throttled);\n      this.throttled = null;\n    }\n  }\n}\n\ninterface DispatchArg<T> {\n  subscriber: ThrottleTimeSubscriber<T>;\n}\n\nfunction dispatchNext<T>(arg: DispatchArg<T>) {\n  const { subscriber } = arg;\n  subscriber.clearThrottle();\n}\n","\nimport { Observable } from '../Observable';\nimport { async } from '../scheduler/async';\nimport { SchedulerLike, OperatorFunction } from '../types';\nimport { scan } from './scan';\nimport { defer } from '../observable/defer';\nimport { map } from './map';\n\n/**\n *\n * Emits an object containing the current value, and the time that has\n * passed between emitting the current value and the previous value, which is\n * calculated by using the provided `scheduler`'s `now()` method to retrieve\n * the current time at each emission, then calculating the difference. The `scheduler`\n * defaults to {@link asyncScheduler}, so by default, the `interval` will be in\n * milliseconds.\n *\n * <span class=\"informal\">Convert an Observable that emits items into one that\n * emits indications of the amount of time elapsed between those emissions.</span>\n *\n * ![](timeinterval.png)\n *\n * ## Examples\n * Emit inteval between current value with the last value\n *\n * ```ts\n * const seconds = interval(1000);\n *\n * seconds.pipe(timeInterval())\n * .subscribe(\n *     value => console.log(value),\n *     err => console.log(err),\n * );\n *\n * seconds.pipe(timeout(900))\n * .subscribe(\n *     value => console.log(value),\n *     err => console.log(err),\n * );\n *\n * // NOTE: The values will never be this precise,\n * // intervals created with `interval` or `setInterval`\n * // are non-deterministic.\n *\n * // {value: 0, interval: 1000}\n * // {value: 1, interval: 1000}\n * // {value: 2, interval: 1000}\n * ```\n *\n * @param {SchedulerLike} [scheduler] Scheduler used to get the current time.\n * @return {Observable<{ interval: number, value: T }>} Observable that emit infomation about value and interval\n * @method timeInterval\n */\nexport function timeInterval<T>(scheduler: SchedulerLike = async): OperatorFunction<T, TimeInterval<T>> {\n  return (source: Observable<T>) => defer(() => {\n    return source.pipe(\n      // TODO(benlesh): correct these typings.\n      scan(\n        ({ current }, value) => ({ value, current: scheduler.now(), last: current }),\n        { current: scheduler.now(), value: undefined,  last: undefined }\n      ) as any,\n      map<any, TimeInterval<T>>(({ current, last, value }) => new TimeInterval(value, current - last)),\n    );\n  });\n}\n\n// TODO(benlesh): make this an interface, export the interface, but not the implemented class,\n// there's no reason users should be manually creating this type.\n\n/**\n * @deprecated exposed API, use as interface only.\n */\nexport class TimeInterval<T> {\n  constructor(public value: T, public interval: number) {}\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { async } from '../scheduler/async';\nimport { Observable } from '../Observable';\nimport { isDate } from '../util/isDate';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { ObservableInput, OperatorFunction, MonoTypeOperatorFunction, SchedulerAction, SchedulerLike, TeardownLogic } from '../types';\n\n/* tslint:disable:max-line-length */\nexport function timeoutWith<T, R>(due: number | Date, withObservable: ObservableInput<R>, scheduler?: SchedulerLike): OperatorFunction<T, T | R>;\n/* tslint:enable:max-line-length */\n\n/**\n *\n * Errors if Observable does not emit a value in given time span, in case of which\n * subscribes to the second Observable.\n *\n * <span class=\"informal\">It's a version of `timeout` operator that let's you specify fallback Observable.</span>\n *\n * ![](timeoutWith.png)\n *\n * `timeoutWith` is a variation of `timeout` operator. It behaves exactly the same,\n * still accepting as a first argument either a number or a Date, which control - respectively -\n * when values of source Observable should be emitted or when it should complete.\n *\n * The only difference is that it accepts a second, required parameter. This parameter\n * should be an Observable which will be subscribed when source Observable fails any timeout check.\n * So whenever regular `timeout` would emit an error, `timeoutWith` will instead start re-emitting\n * values from second Observable. Note that this fallback Observable is not checked for timeouts\n * itself, so it can emit values and complete at arbitrary points in time. From the moment of a second\n * subscription, Observable returned from `timeoutWith` simply mirrors fallback stream. When that\n * stream completes, it completes as well.\n *\n * Scheduler, which in case of `timeout` is provided as as second argument, can be still provided\n * here - as a third, optional parameter. It still is used to schedule timeout checks and -\n * as a consequence - when second Observable will be subscribed, since subscription happens\n * immediately after failing check.\n *\n * ## Example\n * Add fallback observable\n * ```ts\n * import { intrerval } from 'rxjs';\n * import { timeoutWith } from 'rxjs/operators';\n *\n * const seconds = interval(1000);\n * const minutes = interval(60 * 1000);\n *\n * seconds.pipe(timeoutWith(900, minutes))\n *   .subscribe(\n *     value => console.log(value), // After 900ms, will start emitting `minutes`,\n *                                  // since first value of `seconds` will not arrive fast enough.\n *     err => console.log(err),     // Would be called after 900ms in case of `timeout`,\n *                                  // but here will never be called.\n *   );\n * ```\n *\n * @param {number|Date} due Number specifying period within which Observable must emit values\n *                          or Date specifying before when Observable should complete\n * @param {Observable<T>} withObservable Observable which will be subscribed if source fails timeout check.\n * @param {SchedulerLike} [scheduler] Scheduler controlling when timeout checks occur.\n * @return {Observable<T>} Observable that mirrors behaviour of source or, when timeout check fails, of an Observable\n *                          passed as a second parameter.\n * @method timeoutWith\n * @owner Observable\n */\nexport function timeoutWith<T, R>(due: number | Date,\n                                  withObservable: ObservableInput<R>,\n                                  scheduler: SchedulerLike = async): OperatorFunction<T, T | R> {\n  return (source: Observable<T>) => {\n    let absoluteTimeout = isDate(due);\n    let waitFor = absoluteTimeout ? (+due - scheduler.now()) : Math.abs(<number>due);\n    return source.lift(new TimeoutWithOperator(waitFor, absoluteTimeout, withObservable, scheduler));\n  };\n}\n\nclass TimeoutWithOperator<T> implements Operator<T, T> {\n  constructor(private waitFor: number,\n              private absoluteTimeout: boolean,\n              private withObservable: ObservableInput<any>,\n              private scheduler: SchedulerLike) {\n  }\n\n  call(subscriber: Subscriber<T>, source: any): TeardownLogic {\n    return source.subscribe(new TimeoutWithSubscriber(\n      subscriber, this.absoluteTimeout, this.waitFor, this.withObservable, this.scheduler\n    ));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass TimeoutWithSubscriber<T, R> extends OuterSubscriber<T, R> {\n\n  private action: SchedulerAction<TimeoutWithSubscriber<T, R>> = null;\n\n  constructor(destination: Subscriber<T>,\n              private absoluteTimeout: boolean,\n              private waitFor: number,\n              private withObservable: ObservableInput<any>,\n              private scheduler: SchedulerLike) {\n    super(destination);\n    this.scheduleTimeout();\n  }\n\n  private static dispatchTimeout<T, R>(subscriber: TimeoutWithSubscriber<T, R>): void {\n    const { withObservable } = subscriber;\n    (<any> subscriber)._unsubscribeAndRecycle();\n    subscriber.add(subscribeToResult(subscriber, withObservable));\n  }\n\n  private scheduleTimeout(): void {\n    const { action } = this;\n    if (action) {\n      // Recycle the action if we've already scheduled one. All the production\n      // Scheduler Actions mutate their state/delay time and return themeselves.\n      // VirtualActions are immutable, so they create and return a clone. In this\n      // case, we need to set the action reference to the most recent VirtualAction,\n      // to ensure that's the one we clone from next time.\n      this.action = (<SchedulerAction<TimeoutWithSubscriber<T, R>>> action.schedule(this, this.waitFor));\n    } else {\n      this.add(this.action = (<SchedulerAction<TimeoutWithSubscriber<T, R>>> this.scheduler.schedule<TimeoutWithSubscriber<T, R>>(\n        TimeoutWithSubscriber.dispatchTimeout, this.waitFor, this\n      )));\n    }\n  }\n\n  protected _next(value: T): void {\n    if (!this.absoluteTimeout) {\n      this.scheduleTimeout();\n    }\n    super._next(value);\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _unsubscribe() {\n    this.action = null;\n    this.scheduler = null;\n    this.withObservable = null;\n  }\n}\n","import { async } from '../scheduler/async';\nimport { isDate } from '../util/isDate';\nimport { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { TimeoutError } from '../util/TimeoutError';\nimport { MonoTypeOperatorFunction, SchedulerAction, SchedulerLike, TeardownLogic } from '../types';\nimport { timeoutWith } from './timeoutWith';\nimport { throwError } from '../observable/throwError';\n\n/**\n *\n * Errors if Observable does not emit a value in given time span.\n *\n * <span class=\"informal\">Timeouts on Observable that doesn't emit values fast enough.</span>\n *\n * ![](timeout.png)\n *\n * `timeout` operator accepts as an argument either a number or a Date.\n *\n * If number was provided, it returns an Observable that behaves like a source\n * Observable, unless there is a period of time where there is no value emitted.\n * So if you provide `100` as argument and first value comes after 50ms from\n * the moment of subscription, this value will be simply re-emitted by the resulting\n * Observable. If however after that 100ms passes without a second value being emitted,\n * stream will end with an error and source Observable will be unsubscribed.\n * These checks are performed throughout whole lifecycle of Observable - from the moment\n * it was subscribed to, until it completes or errors itself. Thus every value must be\n * emitted within specified period since previous value.\n *\n * If provided argument was Date, returned Observable behaves differently. It throws\n * if Observable did not complete before provided Date. This means that periods between\n * emission of particular values do not matter in this case. If Observable did not complete\n * before provided Date, source Observable will be unsubscribed. Other than that, resulting\n * stream behaves just as source Observable.\n *\n * `timeout` accepts also a Scheduler as a second parameter. It is used to schedule moment (or moments)\n * when returned Observable will check if source stream emitted value or completed.\n *\n * ## Examples\n * Check if ticks are emitted within certain timespan\n * ```ts\n * import { interval } from 'rxjs';\n * import { timeout } from 'rxjs/operators';\n *\n * const seconds = interval(1000);\n *\n * seconds.pipe(timeout(1100))      // Let's use bigger timespan to be safe,\n *                                  // since `interval` might fire a bit later then scheduled.\n * .subscribe(\n *     value => console.log(value), // Will emit numbers just as regular `interval` would.\n *     err => console.log(err),     // Will never be called.\n * );\n *\n * seconds.pipe(timeout(900))\n * .subscribe(\n *     value => console.log(value), // Will never be called.\n *     err => console.log(err),     // Will emit error before even first value is emitted,\n *                                  // since it did not arrive within 900ms period.\n * );\n * ```\n *\n * Use Date to check if Observable completed\n * ```ts\n * import { interval } from 'rxjs';\n * import { timeout } from 'rxjs/operators';\n *\n * const seconds = interval(1000);\n *\n * seconds.pipe(\n *   timeout(new Date(\"December 17, 2020 03:24:00\")),\n * )\n * .subscribe(\n *     value => console.log(value), // Will emit values as regular `interval` would\n *                                  // until December 17, 2020 at 03:24:00.\n *     err => console.log(err)      // On December 17, 2020 at 03:24:00 it will emit an error,\n *                                  // since Observable did not complete by then.\n * );\n * ```\n * @see {@link timeoutWith}\n *\n * @param {number|Date} due Number specifying period within which Observable must emit values\n *                          or Date specifying before when Observable should complete\n * @param {SchedulerLike} [scheduler] Scheduler controlling when timeout checks occur.\n * @return {Observable<T>} Observable that mirrors behaviour of source, unless timeout checks fail.\n * @method timeout\n * @owner Observable\n */\nexport function timeout<T>(due: number | Date,\n                           scheduler: SchedulerLike = async): MonoTypeOperatorFunction<T> {\n  return timeoutWith(due, throwError(new TimeoutError()), scheduler);\n}\n","\nimport { async } from '../scheduler/async';\nimport { OperatorFunction, SchedulerLike, Timestamp as TimestampInterface } from '../types';\nimport { map } from './map';\n\n/**\n * Attaches a timestamp to each item emitted by an observable indicating when it was emitted\n *\n * The `timestamp` operator maps the *source* observable stream to an object of type\n * `{value: T, timestamp: R}`. The properties are generically typed. The `value` property contains the value\n * and type of the *source* observable. The `timestamp` is generated by the schedulers `now` function. By\n * default it uses the *async* scheduler which simply returns `Date.now()` (milliseconds since 1970/01/01\n * 00:00:00:000) and therefore is of type `number`.\n *\n * ![](timestamp.png)\n *\n * ## Example\n *\n * In this example there is a timestamp attached to the documents click event.\n *\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { timestamp } from 'rxjs/operators';\n *\n * const clickWithTimestamp = fromEvent(document, 'click').pipe(\n *   timestamp()\n * );\n *\n * // Emits data of type {value: MouseEvent, timestamp: number}\n * clickWithTimestamp.subscribe(data => {\n *   console.log(data);\n * });\n * ```\n *\n * @param scheduler\n * @return {Observable<Timestamp<any>>|WebSocketSubject<T>|Observable<T>}\n * @method timestamp\n * @owner Observable\n */\nexport function timestamp<T>(scheduler: SchedulerLike = async): OperatorFunction<T, Timestamp<T>> {\n  return map((value: T) => new Timestamp(value, scheduler.now()));\n  // return (source: Observable<T>) => source.lift(new TimestampOperator(scheduler));\n}\n\nexport class Timestamp<T> implements TimestampInterface<T> {\n  constructor(public value: T, public timestamp: number) {\n  }\n}\n","import { reduce } from './reduce';\nimport { OperatorFunction } from '../types';\n\nfunction toArrayReducer<T>(arr: T[], item: T, index: number) {\n  if (index === 0) {\n    return [item];\n  }\n  arr.push(item);\n  return arr;\n}\n\n/**\n * Collects all source emissions and emits them as an array when the source completes.\n *\n * <span class=\"informal\">Get all values inside an array when the source completes</span>\n *\n * ![](toArray.png)\n *\n * `toArray` will wait until the source Observable completes before emitting\n * the array containing all emissions. When the source Observable errors no\n * array will be emitted.\n *\n *  ## Example\n * ```ts\n * import { interval } from 'rxjs';\n * import { toArray, take } from 'rxjs/operators';\n *\n * const source = interval(1000);\n * const example = source.pipe(\n *   take(10),\n *   toArray()\n * );\n *\n * const subscribe = example.subscribe(val => console.log(val));\n *\n * // output: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n *\n * ```\n* @return An array from an observable sequence.\n* @method toArray\n* @owner Observable\n*/\nexport function toArray<T>(): OperatorFunction<T, T[]> {\n  return reduce(toArrayReducer, [] as T[]);\n}\n","import { Observable } from '../Observable';\nimport { OperatorFunction } from '../types';\nimport { Subject } from '../Subject';\nimport { Subscriber } from '../Subscriber';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { Operator } from '../Operator';\n\n/**\n * Branch out the source Observable values as a nested Observable whenever\n * `windowBoundaries` emits.\n *\n * <span class=\"informal\">It's like {@link buffer}, but emits a nested Observable\n * instead of an array.</span>\n *\n * ![](window.png)\n *\n * Returns an Observable that emits windows of items it collects from the source\n * Observable. The output Observable emits connected, non-overlapping\n * windows. It emits the current window and opens a new one whenever the\n * Observable `windowBoundaries` emits an item. Because each window is an\n * Observable, the output is a higher-order Observable.\n *\n * ## Example\n * In every window of 1 second each, emit at most 2 click events\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { window, mergeAll, map, take } from 'rxjs/operators';\n *\n *  const clicks = fromEvent(document, 'click');\n *  const sec = interval(1000);\n *  const result = clicks.pipe(\n *      window(sec),\n *      map(win => win.pipe(take(2))), // each window has at most 2 emissions\n *      mergeAll(),              // flatten the Observable-of-Observables\n *  );\n *  result.subscribe(x => console.log(x));\n * ```\n * @see {@link windowCount}\n * @see {@link windowTime}\n * @see {@link windowToggle}\n * @see {@link windowWhen}\n * @see {@link buffer}\n *\n * @param {Observable<any>} windowBoundaries An Observable that completes the\n * previous window and starts a new window.\n * @return {Observable<Observable<T>>} An Observable of windows, which are\n * Observables emitting values of the source Observable.\n * @method window\n * @owner Observable\n */\nexport function window<T>(windowBoundaries: Observable<any>): OperatorFunction<T, Observable<T>> {\n  return function windowOperatorFunction(source: Observable<T>) {\n    return source.lift(new WindowOperator(windowBoundaries));\n  };\n}\n\nclass WindowOperator<T> implements Operator<T, Observable<T>> {\n\n  constructor(private windowBoundaries: Observable<any>) {\n  }\n\n  call(subscriber: Subscriber<Observable<T>>, source: any): any {\n    const windowSubscriber = new WindowSubscriber(subscriber);\n    const sourceSubscription = source.subscribe(windowSubscriber);\n    if (!sourceSubscription.closed) {\n      windowSubscriber.add(subscribeToResult(windowSubscriber, this.windowBoundaries));\n    }\n    return sourceSubscription;\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass WindowSubscriber<T> extends OuterSubscriber<T, any> {\n\n  private window: Subject<T> = new Subject<T>();\n\n  constructor(destination: Subscriber<Observable<T>>) {\n    super(destination);\n    destination.next(this.window);\n  }\n\n  notifyNext(outerValue: T, innerValue: any,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, any>): void {\n    this.openWindow();\n  }\n\n  notifyError(error: any, innerSub: InnerSubscriber<T, any>): void {\n    this._error(error);\n  }\n\n  notifyComplete(innerSub: InnerSubscriber<T, any>): void {\n    this._complete();\n  }\n\n  protected _next(value: T): void {\n    this.window.next(value);\n  }\n\n  protected _error(err: any): void {\n    this.window.error(err);\n    this.destination.error(err);\n  }\n\n  protected _complete(): void {\n    this.window.complete();\n    this.destination.complete();\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _unsubscribe() {\n    this.window = null;\n  }\n\n  private openWindow(): void  {\n    const prevWindow = this.window;\n    if (prevWindow) {\n      prevWindow.complete();\n    }\n    const destination = this.destination;\n    const newWindow = this.window = new Subject<T>();\n    destination.next(newWindow);\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { Subject } from '../Subject';\nimport { OperatorFunction } from '../types';\n\n/**\n * Branch out the source Observable values as a nested Observable with each\n * nested Observable emitting at most `windowSize` values.\n *\n * <span class=\"informal\">It's like {@link bufferCount}, but emits a nested\n * Observable instead of an array.</span>\n *\n * ![](windowCount.png)\n *\n * Returns an Observable that emits windows of items it collects from the source\n * Observable. The output Observable emits windows every `startWindowEvery`\n * items, each containing no more than `windowSize` items. When the source\n * Observable completes or encounters an error, the output Observable emits\n * the current window and propagates the notification from the source\n * Observable. If `startWindowEvery` is not provided, then new windows are\n * started immediately at the start of the source and when each window completes\n * with size `windowSize`.\n *\n * ## Examples\n * Ignore every 3rd click event, starting from the first one\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { windowCount, map, mergeAll, skip } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(\n *   windowCount(3),\n *   map(win => win.pipe(skip(1))), // skip first of every 3 clicks\n *   mergeAll()                     // flatten the Observable-of-Observables\n * );\n * result.subscribe(x => console.log(x));\n * ```\n *\n * Ignore every 3rd click event, starting from the third one\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { windowCount, mergeAll } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(\n *   windowCount(2, 3),\n *   mergeAll(),              // flatten the Observable-of-Observables\n * );\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link window}\n * @see {@link windowTime}\n * @see {@link windowToggle}\n * @see {@link windowWhen}\n * @see {@link bufferCount}\n *\n * @param {number} windowSize The maximum number of values emitted by each\n * window.\n * @param {number} [startWindowEvery] Interval at which to start a new window.\n * For example if `startWindowEvery` is `2`, then a new window will be started\n * on every other value from the source. A new window is started at the\n * beginning of the source by default.\n * @return {Observable<Observable<T>>} An Observable of windows, which in turn\n * are Observable of values.\n * @method windowCount\n * @owner Observable\n */\nexport function windowCount<T>(windowSize: number,\n                               startWindowEvery: number = 0): OperatorFunction<T, Observable<T>> {\n  return function windowCountOperatorFunction(source: Observable<T>) {\n    return source.lift(new WindowCountOperator<T>(windowSize, startWindowEvery));\n  };\n}\n\nclass WindowCountOperator<T> implements Operator<T, Observable<T>> {\n\n  constructor(private windowSize: number,\n              private startWindowEvery: number) {\n  }\n\n  call(subscriber: Subscriber<Observable<T>>, source: any): any {\n    return source.subscribe(new WindowCountSubscriber(subscriber, this.windowSize, this.startWindowEvery));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass WindowCountSubscriber<T> extends Subscriber<T> {\n  private windows: Subject<T>[] = [ new Subject<T>() ];\n  private count: number = 0;\n\n  constructor(protected destination: Subscriber<Observable<T>>,\n              private windowSize: number,\n              private startWindowEvery: number) {\n    super(destination);\n    destination.next(this.windows[0]);\n  }\n\n  protected _next(value: T) {\n    const startWindowEvery = (this.startWindowEvery > 0) ? this.startWindowEvery : this.windowSize;\n    const destination = this.destination;\n    const windowSize = this.windowSize;\n    const windows = this.windows;\n    const len = windows.length;\n\n    for (let i = 0; i < len && !this.closed; i++) {\n      windows[i].next(value);\n    }\n    const c = this.count - windowSize + 1;\n    if (c >= 0 && c % startWindowEvery === 0 && !this.closed) {\n      windows.shift().complete();\n    }\n    if (++this.count % startWindowEvery === 0 && !this.closed) {\n      const window = new Subject<T>();\n      windows.push(window);\n      destination.next(window);\n    }\n  }\n\n  protected _error(err: any) {\n    const windows = this.windows;\n    if (windows) {\n      while (windows.length > 0 && !this.closed) {\n        windows.shift().error(err);\n      }\n    }\n    this.destination.error(err);\n  }\n\n  protected _complete() {\n    const windows = this.windows;\n    if (windows) {\n      while (windows.length > 0 && !this.closed) {\n        windows.shift().complete();\n      }\n    }\n    this.destination.complete();\n  }\n\n  protected _unsubscribe() {\n    this.count = 0;\n    this.windows = null;\n  }\n}\n","import { Subject } from '../Subject';\nimport { Operator } from '../Operator';\nimport { async } from '../scheduler/async';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { Subscription } from '../Subscription';\nimport { isNumeric } from '../util/isNumeric';\nimport { isScheduler } from '../util/isScheduler';\nimport { OperatorFunction, SchedulerLike, SchedulerAction } from '../types';\n\n/**\n * Branch out the source Observable values as a nested Observable periodically\n * in time.\n *\n * <span class=\"informal\">It's like {@link bufferTime}, but emits a nested\n * Observable instead of an array.</span>\n *\n * ![](windowTime.png)\n *\n * Returns an Observable that emits windows of items it collects from the source\n * Observable. The output Observable starts a new window periodically, as\n * determined by the `windowCreationInterval` argument. It emits each window\n * after a fixed timespan, specified by the `windowTimeSpan` argument. When the\n * source Observable completes or encounters an error, the output Observable\n * emits the current window and propagates the notification from the source\n * Observable. If `windowCreationInterval` is not provided, the output\n * Observable starts a new window when the previous window of duration\n * `windowTimeSpan` completes. If `maxWindowCount` is provided, each window\n * will emit at most fixed number of values. Window will complete immediately\n * after emitting last value and next one still will open as specified by\n * `windowTimeSpan` and `windowCreationInterval` arguments.\n *\n * ## Examples\n * In every window of 1 second each, emit at most 2 click events\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { windowTime, map, mergeAll, take } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(\n *   windowTime(1000),\n *   map(win => win.pipe(take(2))), // each window has at most 2 emissions\n *   mergeAll(),                    // flatten the Observable-of-Observables\n * );\n * result.subscribe(x => console.log(x));\n * ```\n *\n * Every 5 seconds start a window 1 second long, and emit at most 2 click events per window\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { windowTime, map, mergeAll, take } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(\n *   windowTime(1000, 5000),\n *   map(win => win.pipe(take(2))), // each window has at most 2 emissions\n *   mergeAll(),                    // flatten the Observable-of-Observables\n * );\n * result.subscribe(x => console.log(x));\n * ```\n *\n * Same as example above but with maxWindowCount instead of take\n * ```ts\n * import { fromEvent } from 'rxjs';\n * import { windowTime, mergeAll } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(\n *   windowTime(1000, 5000, 2), // each window has still at most 2 emissions\n *   mergeAll(),                // flatten the Observable-of-Observables\n * );\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link window}\n * @see {@link windowCount}\n * @see {@link windowToggle}\n * @see {@link windowWhen}\n * @see {@link bufferTime}\n *\n * @param {number} windowTimeSpan The amount of time to fill each window.\n * @param {number} [windowCreationInterval] The interval at which to start new\n * windows.\n * @param {number} [maxWindowSize=Number.POSITIVE_INFINITY] Max number of\n * values each window can emit before completion.\n * @param {SchedulerLike} [scheduler=async] The scheduler on which to schedule the\n * intervals that determine window boundaries.\n * @return {Observable<Observable<T>>} An observable of windows, which in turn\n * are Observables.\n * @method windowTime\n * @owner Observable\n */\nexport function windowTime<T>(windowTimeSpan: number,\n                              scheduler?: SchedulerLike): OperatorFunction<T, Observable<T>>;\nexport function windowTime<T>(windowTimeSpan: number,\n                              windowCreationInterval: number,\n                              scheduler?: SchedulerLike): OperatorFunction<T, Observable<T>>;\nexport function windowTime<T>(windowTimeSpan: number,\n                              windowCreationInterval: number,\n                              maxWindowSize: number,\n                              scheduler?: SchedulerLike): OperatorFunction<T, Observable<T>>;\n\nexport function windowTime<T>(windowTimeSpan: number): OperatorFunction<T, Observable<T>> {\n  let scheduler: SchedulerLike = async;\n  let windowCreationInterval: number = null;\n  let maxWindowSize: number = Number.POSITIVE_INFINITY;\n\n  if (isScheduler(arguments[3])) {\n    scheduler = arguments[3];\n  }\n\n  if (isScheduler(arguments[2])) {\n    scheduler = arguments[2];\n  } else if (isNumeric(arguments[2])) {\n    maxWindowSize = arguments[2];\n  }\n\n  if (isScheduler(arguments[1])) {\n    scheduler = arguments[1];\n  } else if (isNumeric(arguments[1])) {\n    windowCreationInterval = arguments[1];\n  }\n\n  return function windowTimeOperatorFunction(source: Observable<T>) {\n    return source.lift(new WindowTimeOperator<T>(windowTimeSpan, windowCreationInterval, maxWindowSize, scheduler));\n  };\n}\n\nclass WindowTimeOperator<T> implements Operator<T, Observable<T>> {\n\n  constructor(private windowTimeSpan: number,\n              private windowCreationInterval: number | null,\n              private maxWindowSize: number,\n              private scheduler: SchedulerLike) {\n  }\n\n  call(subscriber: Subscriber<Observable<T>>, source: any): any {\n    return source.subscribe(new WindowTimeSubscriber(\n      subscriber, this.windowTimeSpan, this.windowCreationInterval, this.maxWindowSize, this.scheduler\n    ));\n  }\n}\n\ninterface CreationState<T> {\n  windowTimeSpan: number;\n  windowCreationInterval: number;\n  subscriber: WindowTimeSubscriber<T>;\n  scheduler: SchedulerLike;\n}\n\ninterface TimeSpanOnlyState<T> {\n    window: CountedSubject<T>;\n    windowTimeSpan: number;\n    subscriber: WindowTimeSubscriber<T>;\n  }\n\ninterface CloseWindowContext<T> {\n  action: SchedulerAction<CreationState<T>>;\n  subscription: Subscription;\n}\n\ninterface CloseState<T> {\n  subscriber: WindowTimeSubscriber<T>;\n  window: CountedSubject<T>;\n  context: CloseWindowContext<T>;\n}\n\nclass CountedSubject<T> extends Subject<T> {\n  private _numberOfNextedValues: number = 0;\n\n  next(value?: T): void {\n    this._numberOfNextedValues++;\n    super.next(value);\n  }\n\n  get numberOfNextedValues(): number {\n    return this._numberOfNextedValues;\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass WindowTimeSubscriber<T> extends Subscriber<T> {\n  private windows: CountedSubject<T>[] = [];\n\n  constructor(protected destination: Subscriber<Observable<T>>,\n              private windowTimeSpan: number,\n              private windowCreationInterval: number | null,\n              private maxWindowSize: number,\n              private scheduler: SchedulerLike) {\n    super(destination);\n\n    const window = this.openWindow();\n    if (windowCreationInterval !== null && windowCreationInterval >= 0) {\n      const closeState: CloseState<T> = { subscriber: this, window, context: <any>null };\n      const creationState: CreationState<T> = { windowTimeSpan, windowCreationInterval, subscriber: this, scheduler };\n      this.add(scheduler.schedule<CloseState<T>>(dispatchWindowClose, windowTimeSpan, closeState));\n      this.add(scheduler.schedule<CreationState<T>>(dispatchWindowCreation, windowCreationInterval, creationState));\n    } else {\n      const timeSpanOnlyState: TimeSpanOnlyState<T> = { subscriber: this, window, windowTimeSpan };\n      this.add(scheduler.schedule<TimeSpanOnlyState<T>>(dispatchWindowTimeSpanOnly, windowTimeSpan, timeSpanOnlyState));\n    }\n  }\n\n  protected _next(value: T): void {\n    const windows = this.windows;\n    const len = windows.length;\n    for (let i = 0; i < len; i++) {\n      const window = windows[i];\n      if (!window.closed) {\n        window.next(value);\n        if (window.numberOfNextedValues >= this.maxWindowSize) {\n          this.closeWindow(window);\n        }\n      }\n    }\n  }\n\n  protected _error(err: any): void {\n    const windows = this.windows;\n    while (windows.length > 0) {\n      windows.shift().error(err);\n    }\n    this.destination.error(err);\n  }\n\n  protected _complete(): void {\n    const windows = this.windows;\n    while (windows.length > 0) {\n      const window = windows.shift();\n      if (!window.closed) {\n        window.complete();\n      }\n    }\n    this.destination.complete();\n  }\n\n  public openWindow(): CountedSubject<T> {\n    const window = new CountedSubject<T>();\n    this.windows.push(window);\n    const destination = this.destination;\n    destination.next(window);\n    return window;\n  }\n\n  public closeWindow(window: CountedSubject<T>): void {\n    window.complete();\n    const windows = this.windows;\n    windows.splice(windows.indexOf(window), 1);\n  }\n}\n\nfunction dispatchWindowTimeSpanOnly<T>(this: SchedulerAction<TimeSpanOnlyState<T>>, state: TimeSpanOnlyState<T>): void {\n  const { subscriber, windowTimeSpan, window } = state;\n  if (window) {\n    subscriber.closeWindow(window);\n  }\n  state.window = subscriber.openWindow();\n  this.schedule(state, windowTimeSpan);\n}\n\nfunction dispatchWindowCreation<T>(this: SchedulerAction<CreationState<T>>, state: CreationState<T>): void {\n  const { windowTimeSpan, subscriber, scheduler, windowCreationInterval } = state;\n  const window = subscriber.openWindow();\n  const action = this;\n  let context: CloseWindowContext<T> = { action, subscription: <any>null };\n  const timeSpanState: CloseState<T> = { subscriber, window, context };\n  context.subscription = scheduler.schedule<CloseState<T>>(dispatchWindowClose, windowTimeSpan, timeSpanState);\n  action.add(context.subscription);\n  action.schedule(state, windowCreationInterval);\n}\n\nfunction dispatchWindowClose<T>(state: CloseState<T>): void {\n  const { subscriber, window, context } = state;\n  if (context && context.action && context.subscription) {\n    context.action.remove(context.subscription);\n  }\n  subscriber.closeWindow(window);\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { Subject } from '../Subject';\nimport { Subscription } from '../Subscription';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { OperatorFunction } from '../types';\n\n/**\n * Branch out the source Observable values as a nested Observable starting from\n * an emission from `openings` and ending when the output of `closingSelector`\n * emits.\n *\n * <span class=\"informal\">It's like {@link bufferToggle}, but emits a nested\n * Observable instead of an array.</span>\n *\n * ![](windowToggle.png)\n *\n * Returns an Observable that emits windows of items it collects from the source\n * Observable. The output Observable emits windows that contain those items\n * emitted by the source Observable between the time when the `openings`\n * Observable emits an item and when the Observable returned by\n * `closingSelector` emits an item.\n *\n * ## Example\n * Every other second, emit the click events from the next 500ms\n * ```ts\n * import { fromEvent, interval, EMPTY } from 'rxjs';\n * import { windowToggle, mergeAll } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const openings = interval(1000);\n * const result = clicks.pipe(\n *   windowToggle(openings, i => i % 2 ? interval(500) : EMPTY),\n *   mergeAll()\n * );\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link window}\n * @see {@link windowCount}\n * @see {@link windowTime}\n * @see {@link windowWhen}\n * @see {@link bufferToggle}\n *\n * @param {Observable<O>} openings An observable of notifications to start new\n * windows.\n * @param {function(value: O): Observable} closingSelector A function that takes\n * the value emitted by the `openings` observable and returns an Observable,\n * which, when it emits (either `next` or `complete`), signals that the\n * associated window should complete.\n * @return {Observable<Observable<T>>} An observable of windows, which in turn\n * are Observables.\n * @method windowToggle\n * @owner Observable\n */\nexport function windowToggle<T, O>(openings: Observable<O>,\n                                   closingSelector: (openValue: O) => Observable<any>): OperatorFunction<T, Observable<T>> {\n  return (source: Observable<T>) => source.lift(new WindowToggleOperator<T, O>(openings, closingSelector));\n}\n\nclass WindowToggleOperator<T, O> implements Operator<T, Observable<T>> {\n\n  constructor(private openings: Observable<O>,\n              private closingSelector: (openValue: O) => Observable<any>) {\n  }\n\n  call(subscriber: Subscriber<Observable<T>>, source: any): any {\n    return source.subscribe(new WindowToggleSubscriber(\n      subscriber, this.openings, this.closingSelector\n    ));\n  }\n}\n\ninterface WindowContext<T> {\n  window: Subject<T>;\n  subscription: Subscription;\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass WindowToggleSubscriber<T, O> extends OuterSubscriber<T, any> {\n  private contexts: WindowContext<T>[] = [];\n  private openSubscription: Subscription;\n\n  constructor(destination: Subscriber<Observable<T>>,\n              private openings: Observable<O>,\n              private closingSelector: (openValue: O) => Observable<any>) {\n    super(destination);\n    this.add(this.openSubscription = subscribeToResult(this, openings, openings as any));\n  }\n\n  protected _next(value: T) {\n    const { contexts } = this;\n    if (contexts) {\n      const len = contexts.length;\n      for (let i = 0; i < len; i++) {\n        contexts[i].window.next(value);\n      }\n    }\n  }\n\n  protected _error(err: any) {\n\n    const { contexts } = this;\n    this.contexts = null;\n\n    if (contexts) {\n      const len = contexts.length;\n      let index = -1;\n\n      while (++index < len) {\n        const context = contexts[index];\n        context.window.error(err);\n        context.subscription.unsubscribe();\n      }\n    }\n\n    super._error(err);\n  }\n\n  protected _complete() {\n    const { contexts } = this;\n    this.contexts = null;\n    if (contexts) {\n      const len = contexts.length;\n      let index = -1;\n      while (++index < len) {\n        const context = contexts[index];\n        context.window.complete();\n        context.subscription.unsubscribe();\n      }\n    }\n    super._complete();\n  }\n\n  /** @deprecated This is an internal implementation detail, do not use. */\n  _unsubscribe() {\n    const { contexts } = this;\n    this.contexts = null;\n    if (contexts) {\n      const len = contexts.length;\n      let index = -1;\n      while (++index < len) {\n        const context = contexts[index];\n        context.window.unsubscribe();\n        context.subscription.unsubscribe();\n      }\n    }\n  }\n\n  notifyNext(outerValue: any, innerValue: any,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, any>): void {\n\n    if (outerValue === this.openings) {\n      let closingNotifier;\n      try {\n        const { closingSelector } = this;\n        closingNotifier = closingSelector(innerValue);\n      } catch (e) {\n        return this.error(e);\n      }\n\n      const window = new Subject<T>();\n      const subscription = new Subscription();\n      const context = { window, subscription };\n      this.contexts.push(context);\n      const innerSubscription = subscribeToResult(this, closingNotifier, context as any);\n\n      if (innerSubscription.closed) {\n        this.closeWindow(this.contexts.length - 1);\n      } else {\n        (<any>innerSubscription).context = context;\n        subscription.add(innerSubscription);\n      }\n\n      this.destination.next(window);\n    } else {\n      this.closeWindow(this.contexts.indexOf(outerValue));\n    }\n  }\n\n  notifyError(err: any): void {\n    this.error(err);\n  }\n\n  notifyComplete(inner: Subscription): void {\n    if (inner !== this.openSubscription) {\n      this.closeWindow(this.contexts.indexOf((<any> inner).context));\n    }\n  }\n\n  private closeWindow(index: number): void {\n    if (index === -1) {\n      return;\n    }\n\n    const { contexts } = this;\n    const context = contexts[index];\n    const { window, subscription } = context;\n    contexts.splice(index, 1);\n    window.complete();\n    subscription.unsubscribe();\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { Subject } from '../Subject';\nimport { Subscription } from '../Subscription';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { OperatorFunction } from '../types';\n\n/**\n * Branch out the source Observable values as a nested Observable using a\n * factory function of closing Observables to determine when to start a new\n * window.\n *\n * <span class=\"informal\">It's like {@link bufferWhen}, but emits a nested\n * Observable instead of an array.</span>\n *\n * ![](windowWhen.png)\n *\n * Returns an Observable that emits windows of items it collects from the source\n * Observable. The output Observable emits connected, non-overlapping windows.\n * It emits the current window and opens a new one whenever the Observable\n * produced by the specified `closingSelector` function emits an item. The first\n * window is opened immediately when subscribing to the output Observable.\n *\n * ## Example\n * Emit only the first two clicks events in every window of [1-5] random seconds\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { windowWhen, map, mergeAll, take } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const result = clicks.pipe(\n *   windowWhen(() => interval(1000 + Math.random() * 4000)),\n *   map(win => win.pipe(take(2))),     // each window has at most 2 emissions\n *   mergeAll()                         // flatten the Observable-of-Observables\n * );\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link window}\n * @see {@link windowCount}\n * @see {@link windowTime}\n * @see {@link windowToggle}\n * @see {@link bufferWhen}\n *\n * @param {function(): Observable} closingSelector A function that takes no\n * arguments and returns an Observable that signals (on either `next` or\n * `complete`) when to close the previous window and start a new one.\n * @return {Observable<Observable<T>>} An observable of windows, which in turn\n * are Observables.\n * @method windowWhen\n * @owner Observable\n */\nexport function windowWhen<T>(closingSelector: () => Observable<any>): OperatorFunction<T, Observable<T>> {\n  return function windowWhenOperatorFunction(source: Observable<T>) {\n    return source.lift(new WindowOperator<T>(closingSelector));\n  };\n}\n\nclass WindowOperator<T> implements Operator<T, Observable<T>> {\n  constructor(private closingSelector: () => Observable<any>) {\n  }\n\n  call(subscriber: Subscriber<Observable<T>>, source: any): any {\n    return source.subscribe(new WindowSubscriber(subscriber, this.closingSelector));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass WindowSubscriber<T> extends OuterSubscriber<T, any> {\n  private window: Subject<T>;\n  private closingNotification: Subscription;\n\n  constructor(protected destination: Subscriber<Observable<T>>,\n              private closingSelector: () => Observable<any>) {\n    super(destination);\n    this.openWindow();\n  }\n\n  notifyNext(outerValue: T, innerValue: any,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, any>): void {\n    this.openWindow(innerSub);\n  }\n\n  notifyError(error: any, innerSub: InnerSubscriber<T, any>): void {\n    this._error(error);\n  }\n\n  notifyComplete(innerSub: InnerSubscriber<T, any>): void {\n    this.openWindow(innerSub);\n  }\n\n  protected _next(value: T): void {\n    this.window.next(value);\n  }\n\n  protected _error(err: any): void {\n    this.window.error(err);\n    this.destination.error(err);\n    this.unsubscribeClosingNotification();\n  }\n\n  protected _complete(): void {\n    this.window.complete();\n    this.destination.complete();\n    this.unsubscribeClosingNotification();\n  }\n\n  private unsubscribeClosingNotification(): void {\n    if (this.closingNotification) {\n      this.closingNotification.unsubscribe();\n    }\n  }\n\n  private openWindow(innerSub: InnerSubscriber<T, any> = null): void {\n    if (innerSub) {\n      this.remove(innerSub);\n      innerSub.unsubscribe();\n    }\n\n    const prevWindow = this.window;\n    if (prevWindow) {\n      prevWindow.complete();\n    }\n\n    const window = this.window = new Subject<T>();\n    this.destination.next(window);\n\n    let closingNotifier;\n    try {\n      const { closingSelector } = this;\n      closingNotifier = closingSelector();\n    } catch (e) {\n      this.destination.error(e);\n      this.window.error(e);\n      return;\n    }\n    this.add(this.closingNotification = subscribeToResult(this, closingNotifier));\n  }\n}\n","import { Operator } from '../Operator';\nimport { Subscriber } from '../Subscriber';\nimport { Observable } from '../Observable';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { ObservableInput, OperatorFunction, ObservedValueOf } from '../types';\n\n/* tslint:disable:max-line-length */\nexport function withLatestFrom<T, R>(project: (v1: T) => R): OperatorFunction<T, R>;\nexport function withLatestFrom<T, O2 extends ObservableInput<any>, R>(source2: O2, project: (v1: T, v2: ObservedValueOf<O2>) => R): OperatorFunction<T, R>;\nexport function withLatestFrom<T, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, R>(v2: O2, v3: O3, project: (v1: T, v2: ObservedValueOf<O2>, v3: ObservedValueOf<O3>) => R): OperatorFunction<T, R>;\nexport function withLatestFrom<T, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, R>(v2: O2, v3: O3, v4: O4, project: (v1: T, v2: ObservedValueOf<O2>, v3: ObservedValueOf<O3>, v4: ObservedValueOf<O4>) => R): OperatorFunction<T, R>;\nexport function withLatestFrom<T, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>, R>(v2: O2, v3: O3, v4: O4, v5: O5, project: (v1: T, v2: ObservedValueOf<O2>, v3: ObservedValueOf<O3>, v4: ObservedValueOf<O4>, v5: ObservedValueOf<O5>) => R): OperatorFunction<T, R>;\nexport function withLatestFrom<T, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>, O6 extends ObservableInput<any>, R>(v2: O2, v3: O3, v4: O4, v5: O5, v6: O6, project: (v1: T, v2: ObservedValueOf<O2>, v3: ObservedValueOf<O3>, v4: ObservedValueOf<O4>, v5: ObservedValueOf<O5>, v6: ObservedValueOf<O6>) => R): OperatorFunction<T, R>;\nexport function withLatestFrom<T, O2 extends ObservableInput<any>>(source2: O2): OperatorFunction<T, [T, ObservedValueOf<O2>]>;\nexport function withLatestFrom<T, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>>(v2: O2, v3: O3): OperatorFunction<T, [T, ObservedValueOf<O2>, ObservedValueOf<O3>]>;\nexport function withLatestFrom<T, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>>(v2: O2, v3: O3, v4: O4): OperatorFunction<T, [T, ObservedValueOf<O2>, ObservedValueOf<O3>, ObservedValueOf<O4>]>;\nexport function withLatestFrom<T, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>>(v2: O2, v3: O3, v4: O4, v5: O5): OperatorFunction<T, [T, ObservedValueOf<O2>, ObservedValueOf<O3>, ObservedValueOf<O4>, ObservedValueOf<O5>]>;\nexport function withLatestFrom<T, O2 extends ObservableInput<any>, O3 extends ObservableInput<any>, O4 extends ObservableInput<any>, O5 extends ObservableInput<any>, O6 extends ObservableInput<any>>(v2: O2, v3: O3, v4: O4, v5: O5, v6: O6): OperatorFunction<T, [T, ObservedValueOf<O2>, ObservedValueOf<O3>, ObservedValueOf<O4>, ObservedValueOf<O5>, ObservedValueOf<O6>]>;\nexport function withLatestFrom<T, R>(...observables: Array<ObservableInput<any> | ((...values: Array<any>) => R)>): OperatorFunction<T, R>;\nexport function withLatestFrom<T, R>(array: ObservableInput<any>[]): OperatorFunction<T, R>;\nexport function withLatestFrom<T, R>(array: ObservableInput<any>[], project: (...values: Array<any>) => R): OperatorFunction<T, R>;\n\n/* tslint:enable:max-line-length */\n\n/**\n * Combines the source Observable with other Observables to create an Observable\n * whose values are calculated from the latest values of each, only when the\n * source emits.\n *\n * <span class=\"informal\">Whenever the source Observable emits a value, it\n * computes a formula using that value plus the latest values from other input\n * Observables, then emits the output of that formula.</span>\n *\n * ![](withLatestFrom.png)\n *\n * `withLatestFrom` combines each value from the source Observable (the\n * instance) with the latest values from the other input Observables only when\n * the source emits a value, optionally using a `project` function to determine\n * the value to be emitted on the output Observable. All input Observables must\n * emit at least one value before the output Observable will emit a value.\n *\n * ## Example\n * On every click event, emit an array with the latest timer event plus the click event\n * ```ts\n * import { fromEvent, interval } from 'rxjs';\n * import { withLatestFrom } from 'rxjs/operators';\n *\n * const clicks = fromEvent(document, 'click');\n * const timer = interval(1000);\n * const result = clicks.pipe(withLatestFrom(timer));\n * result.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link combineLatest}\n *\n * @param {ObservableInput} other An input Observable to combine with the source\n * Observable. More than one input Observables may be given as argument.\n * @param {Function} [project] Projection function for combining values\n * together. Receives all values in order of the Observables passed, where the\n * first parameter is a value from the source Observable. (e.g.\n * `a.pipe(withLatestFrom(b, c), map(([a1, b1, c1]) => a1 + b1 + c1))`). If this is not\n * passed, arrays will be emitted on the output Observable.\n * @return {Observable} An Observable of projected values from the most recent\n * values from each input Observable, or an array of the most recent values from\n * each input Observable.\n * @method withLatestFrom\n * @owner Observable\n */\nexport function withLatestFrom<T, R>(...args: Array<ObservableInput<any> | ((...values: Array<any>) => R)>): OperatorFunction<T, R> {\n  return (source: Observable<T>) => {\n    let project: any;\n    if (typeof args[args.length - 1] === 'function') {\n      project = args.pop();\n    }\n    const observables = <Observable<any>[]>args;\n    return source.lift(new WithLatestFromOperator(observables, project));\n  };\n}\n\nclass WithLatestFromOperator<T, R> implements Operator<T, R> {\n  constructor(private observables: Observable<any>[],\n              private project?: (...values: any[]) => Observable<R>) {\n  }\n\n  call(subscriber: Subscriber<R>, source: any): any {\n    return source.subscribe(new WithLatestFromSubscriber(subscriber, this.observables, this.project));\n  }\n}\n\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nclass WithLatestFromSubscriber<T, R> extends OuterSubscriber<T, R> {\n  private values: any[];\n  private toRespond: number[] = [];\n\n  constructor(destination: Subscriber<R>,\n              private observables: Observable<any>[],\n              private project?: (...values: any[]) => Observable<R>) {\n    super(destination);\n    const len = observables.length;\n    this.values = new Array(len);\n\n    for (let i = 0; i < len; i++) {\n      this.toRespond.push(i);\n    }\n\n    for (let i = 0; i < len; i++) {\n      let observable = observables[i];\n      this.add(subscribeToResult<T, R>(this, observable, <any>observable, i));\n    }\n  }\n\n  notifyNext(outerValue: T, innerValue: R,\n             outerIndex: number, innerIndex: number,\n             innerSub: InnerSubscriber<T, R>): void {\n    this.values[outerIndex] = innerValue;\n    const toRespond = this.toRespond;\n    if (toRespond.length > 0) {\n      const found = toRespond.indexOf(outerIndex);\n      if (found !== -1) {\n        toRespond.splice(found, 1);\n      }\n    }\n  }\n\n  notifyComplete() {\n    // noop\n  }\n\n  protected _next(value: T) {\n    if (this.toRespond.length === 0) {\n      const args = [value, ...this.values];\n      if (this.project) {\n        this._tryProject(args);\n      } else {\n        this.destination.next(args);\n      }\n    }\n  }\n\n  private _tryProject(args: any[]) {\n    let result: any;\n    try {\n      result = this.project.apply(this, args);\n    } catch (err) {\n      this.destination.error(err);\n      return;\n    }\n    this.destination.next(result);\n  }\n}\n","import { zip as zipStatic } from '../observable/zip';\nimport { Observable } from '../Observable';\nimport { ObservableInput, OperatorFunction } from '../types';\n\n/* tslint:disable:max-line-length */\n/** @deprecated Deprecated in favor of static zip. */\nexport function zip<T, R>(project: (v1: T) => R): OperatorFunction<T, R>;\n/** @deprecated Deprecated in favor of static zip. */\nexport function zip<T, T2, R>(v2: ObservableInput<T2>, project: (v1: T, v2: T2) => R): OperatorFunction<T, R>;\n/** @deprecated Deprecated in favor of static zip. */\nexport function zip<T, T2, T3, R>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, project: (v1: T, v2: T2, v3: T3) => R): OperatorFunction<T, R>;\n/** @deprecated Deprecated in favor of static zip. */\nexport function zip<T, T2, T3, T4, R>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, project: (v1: T, v2: T2, v3: T3, v4: T4) => R): OperatorFunction<T, R>;\n/** @deprecated Deprecated in favor of static zip. */\nexport function zip<T, T2, T3, T4, T5, R>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, project: (v1: T, v2: T2, v3: T3, v4: T4, v5: T5) => R): OperatorFunction<T, R>;\n/** @deprecated Deprecated in favor of static zip. */\nexport function zip<T, T2, T3, T4, T5, T6, R>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, v6: ObservableInput<T6>, project: (v1: T, v2: T2, v3: T3, v4: T4, v5: T5, v6: T6) => R): OperatorFunction<T, R> ;\n/** @deprecated Deprecated in favor of static zip. */\nexport function zip<T, T2>(v2: ObservableInput<T2>): OperatorFunction<T, [T, T2]>;\n/** @deprecated Deprecated in favor of static zip. */\nexport function zip<T, T2, T3>(v2: ObservableInput<T2>, v3: ObservableInput<T3>): OperatorFunction<T, [T, T2, T3]>;\n/** @deprecated Deprecated in favor of static zip. */\nexport function zip<T, T2, T3, T4>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>): OperatorFunction<T, [T, T2, T3, T4]>;\n/** @deprecated Deprecated in favor of static zip. */\nexport function zip<T, T2, T3, T4, T5>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>): OperatorFunction<T, [T, T2, T3, T4, T5]>;\n/** @deprecated Deprecated in favor of static zip. */\nexport function zip<T, T2, T3, T4, T5, T6>(v2: ObservableInput<T2>, v3: ObservableInput<T3>, v4: ObservableInput<T4>, v5: ObservableInput<T5>, v6: ObservableInput<T6>): OperatorFunction<T, [T, T2, T3, T4, T5, T6]> ;\n/** @deprecated Deprecated in favor of static zip. */\nexport function zip<T, R>(...observables: Array<ObservableInput<T> | ((...values: Array<T>) => R)>): OperatorFunction<T, R>;\n/** @deprecated Deprecated in favor of static zip. */\nexport function zip<T, R>(array: Array<ObservableInput<T>>): OperatorFunction<T, R>;\n/** @deprecated Deprecated in favor of static zip. */\nexport function zip<T, TOther, R>(array: Array<ObservableInput<TOther>>, project: (v1: T, ...values: Array<TOther>) => R): OperatorFunction<T, R>;\n/* tslint:enable:max-line-length */\n\n/**\n * @deprecated Deprecated in favor of static {@link zip}.\n */\nexport function zip<T, R>(...observables: Array<ObservableInput<any> | ((...values: Array<any>) => R)>): OperatorFunction<T, R> {\n  return function zipOperatorFunction(source: Observable<T>) {\n    return source.lift.call(zipStatic<R>(source, ...observables));\n  };\n}","import { ZipOperator } from '../observable/zip';\nimport { Observable } from '../Observable';\nimport { OperatorFunction, ObservableInput } from '../types';\n\nexport function zipAll<T>(): OperatorFunction<ObservableInput<T>, T[]>;\nexport function zipAll<T>(): OperatorFunction<any, T[]>;\nexport function zipAll<T, R>(project: (...values: T[]) => R): OperatorFunction<ObservableInput<T>, R>;\nexport function zipAll<R>(project: (...values: Array<any>) => R): OperatorFunction<any, R>;\n\nexport function zipAll<T, R>(project?: (...values: Array<any>) => R): OperatorFunction<T, R> {\n  return (source: Observable<T>) => source.lift(new ZipOperator(project));\n}\n","\n/* Operator exports */\nexport { audit } from '../internal/operators/audit';\nexport { auditTime } from '../internal/operators/auditTime';\nexport { buffer } from '../internal/operators/buffer';\nexport { bufferCount } from '../internal/operators/bufferCount';\nexport { bufferTime } from '../internal/operators/bufferTime';\nexport { bufferToggle } from '../internal/operators/bufferToggle';\nexport { bufferWhen } from '../internal/operators/bufferWhen';\nexport { catchError } from '../internal/operators/catchError';\nexport { combineAll } from '../internal/operators/combineAll';\nexport { combineLatest } from '../internal/operators/combineLatest';\nexport { concat } from '../internal/operators/concat';\nexport { concatAll } from '../internal/operators/concatAll';\nexport { concatMap } from '../internal/operators/concatMap';\nexport { concatMapTo } from '../internal/operators/concatMapTo';\nexport { count } from '../internal/operators/count';\nexport { debounce } from '../internal/operators/debounce';\nexport { debounceTime } from '../internal/operators/debounceTime';\nexport { defaultIfEmpty } from '../internal/operators/defaultIfEmpty';\nexport { delay } from '../internal/operators/delay';\nexport { delayWhen } from '../internal/operators/delayWhen';\nexport { dematerialize } from '../internal/operators/dematerialize';\nexport { distinct } from '../internal/operators/distinct';\nexport { distinctUntilChanged } from '../internal/operators/distinctUntilChanged';\nexport { distinctUntilKeyChanged } from '../internal/operators/distinctUntilKeyChanged';\nexport { elementAt } from '../internal/operators/elementAt';\nexport { endWith } from '../internal/operators/endWith';\nexport { every } from '../internal/operators/every';\nexport { exhaust } from '../internal/operators/exhaust';\nexport { exhaustMap } from '../internal/operators/exhaustMap';\nexport { expand } from '../internal/operators/expand';\nexport { filter } from '../internal/operators/filter';\nexport { finalize } from '../internal/operators/finalize';\nexport { find } from '../internal/operators/find';\nexport { findIndex } from '../internal/operators/findIndex';\nexport { first } from '../internal/operators/first';\nexport { groupBy } from '../internal/operators/groupBy';\nexport { ignoreElements } from '../internal/operators/ignoreElements';\nexport { isEmpty } from '../internal/operators/isEmpty';\nexport { last } from '../internal/operators/last';\nexport { map } from '../internal/operators/map';\nexport { mapTo } from '../internal/operators/mapTo';\nexport { materialize } from '../internal/operators/materialize';\nexport { max } from '../internal/operators/max';\nexport { merge } from '../internal/operators/merge';\nexport { mergeAll } from '../internal/operators/mergeAll';\nexport { mergeMap } from '../internal/operators/mergeMap';\nexport { mergeMap as flatMap } from '../internal/operators/mergeMap';\nexport { mergeMapTo } from '../internal/operators/mergeMapTo';\nexport { mergeScan } from '../internal/operators/mergeScan';\nexport { min } from '../internal/operators/min';\nexport { multicast } from '../internal/operators/multicast';\nexport { observeOn } from '../internal/operators/observeOn';\nexport { onErrorResumeNext } from '../internal/operators/onErrorResumeNext';\nexport { pairwise } from '../internal/operators/pairwise';\nexport { partition } from '../internal/operators/partition';\nexport { pluck } from '../internal/operators/pluck';\nexport { publish } from '../internal/operators/publish';\nexport { publishBehavior } from '../internal/operators/publishBehavior';\nexport { publishLast } from '../internal/operators/publishLast';\nexport { publishReplay } from '../internal/operators/publishReplay';\nexport { race } from '../internal/operators/race';\nexport { reduce } from '../internal/operators/reduce';\nexport { repeat } from '../internal/operators/repeat';\nexport { repeatWhen } from '../internal/operators/repeatWhen';\nexport { retry } from '../internal/operators/retry';\nexport { retryWhen } from '../internal/operators/retryWhen';\nexport { refCount } from '../internal/operators/refCount';\nexport { sample } from '../internal/operators/sample';\nexport { sampleTime } from '../internal/operators/sampleTime';\nexport { scan } from '../internal/operators/scan';\nexport { sequenceEqual } from '../internal/operators/sequenceEqual';\nexport { share } from '../internal/operators/share';\nexport { shareReplay } from '../internal/operators/shareReplay';\nexport { single } from '../internal/operators/single';\nexport { skip } from '../internal/operators/skip';\nexport { skipLast } from '../internal/operators/skipLast';\nexport { skipUntil } from '../internal/operators/skipUntil';\nexport { skipWhile } from '../internal/operators/skipWhile';\nexport { startWith } from '../internal/operators/startWith';\nexport { subscribeOn } from '../internal/operators/subscribeOn';\nexport { switchAll } from '../internal/operators/switchAll';\nexport { switchMap } from '../internal/operators/switchMap';\nexport { switchMapTo } from '../internal/operators/switchMapTo';\nexport { take } from '../internal/operators/take';\nexport { takeLast } from '../internal/operators/takeLast';\nexport { takeUntil } from '../internal/operators/takeUntil';\nexport { takeWhile } from '../internal/operators/takeWhile';\nexport { tap } from '../internal/operators/tap';\nexport { throttle } from '../internal/operators/throttle';\nexport { throttleTime } from '../internal/operators/throttleTime';\nexport { throwIfEmpty } from '../internal/operators/throwIfEmpty';\nexport { timeInterval } from '../internal/operators/timeInterval';\nexport { timeout } from '../internal/operators/timeout';\nexport { timeoutWith } from '../internal/operators/timeoutWith';\nexport { timestamp } from '../internal/operators/timestamp';\nexport { toArray } from '../internal/operators/toArray';\nexport { window } from '../internal/operators/window';\nexport { windowCount } from '../internal/operators/windowCount';\nexport { windowTime } from '../internal/operators/windowTime';\nexport { windowToggle } from '../internal/operators/windowToggle';\nexport { windowWhen } from '../internal/operators/windowWhen';\nexport { withLatestFrom } from '../internal/operators/withLatestFrom';\nexport { zip } from '../internal/operators/zip';\nexport { zipAll } from '../internal/operators/zipAll';\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Configuration file for the whole player.\n * Feel free to tweak those values if you know what you're doing.\n *\n * Please not that you will need to re-build the whole project to take these\n * modifications into account.\n *\n * @type {Object}\n */\nexport default {\n  /**\n   * Volume set on unMute if the volume is set to 0 and either:\n   *   - mute has never been called before\n   *   - mute has last been called while the volume was already set to 0 (either\n   *     via setVolume, or a previous mute call)\n   * @type {Number}\n   */\n  DEFAULT_UNMUTED_VOLUME: 0.1,\n\n  /**\n   * Default time interval after which a request will timeout, in ms.\n   * @type {Number}\n   */\n  DEFAULT_REQUEST_TIMEOUT: 30 * 1000,\n\n  /**\n   * Can be either:\n   *   - \"native\": Subtitles are all displayed in a <track> element\n   *   - \"html\": Subtitles are all displayed in a <div> separated from the video\n   *     element. Can be useful to display richer TTML subtitles, for example.\n   * @type {Object|null}\n   */\n  DEFAULT_TEXT_TRACK_MODE: \"native\" as \"native\" |\n                                       \"html\",\n\n  /**\n   * Strategy to adopt when manually setting the current bitrate.\n   * Can be either:\n   *   - \"seamless\": transitions are very smooth but not immediate.\n   *   - \"direct\": the quality switch happens immediately but to achieve that,\n   *     the player will need to set a new MediaSource on the media element in\n   *     some cases. This often leads to a black screen + unavailable APIs\n   *     during a short moment.\n   * @type {string}\n   */\n  DEFAULT_MANUAL_BITRATE_SWITCHING_MODE: \"seamless\" as \"seamless\" |\n                                                       \"direct\",\n\n  /**\n   * If set to true, video through loadVideo will auto play by default\n   * @type {Boolean}\n   */\n  DEFAULT_AUTO_PLAY: false,\n\n  /**\n   * If set to false, \"native\" subtitles (in a <track> element) will be hidden\n   * by default.\n   * @type {Boolean}\n   */\n  DEFAULT_SHOW_NATIVE_SUBTITLE: true,\n\n  /**\n   * If set to true, the player will by default stop immediately and unload the\n   * content on reaching the end of the media.\n   *\n   * If set to false, it will not unload nor stop by default, leaving the user\n   * free to seek in the already-loaded content.\n   *\n   * Set to `true` for legacy reasons.\n   * @type {Boolean}\n   */\n  DEFAULT_STOP_AT_END: true,\n\n  /**\n   * Default buffer goal in seconds.\n   * Once enough content has been downloaded to fill the buffer up to\n   * ``current position + DEFAULT_WANTED_BUFFER_AHEAD\", we will stop downloading\n   * content.\n   * @type {Number}\n   */\n  DEFAULT_WANTED_BUFFER_AHEAD: 30,\n\n  /**\n   * Default max buffer size ahead of the current position in seconds.\n   * The buffer _after_ this limit will be garbage collected.\n   * Set to Infinity for no limit.\n   * @type {Number}\n   */\n  DEFAULT_MAX_BUFFER_AHEAD: Infinity,\n\n  /**\n   * Default max buffer size ahead of the current position in seconds.\n   * The buffer _before_ this limit will be garbage collected.\n   * Set to Infinity for no limit.\n   * @type {Number}\n   */\n  DEFAULT_MAX_BUFFER_BEHIND: Infinity,\n\n  /* tslint:disable no-object-literal-type-assertion */\n  /**\n   * Maximum possible buffer ahead for each type of buffer, to avoid too much\n   * memory usage when playing for a long time.\n   * Equal to Infinity if not defined here.\n   * @type {Object}\n   */\n  MAXIMUM_MAX_BUFFER_AHEAD: {\n    text: 5 * 60 * 60,\n  } as Partial<Record<\"audio\"|\"video\"|\"image\"|\"text\", number>>,\n  /* tslint:enable no-object-literal-type-assertion */\n\n  /* tslint:disable no-object-literal-type-assertion */\n  /**\n   * Maximum possible buffer behind for each type of buffer, to avoid too much\n   * memory usage when playing for a long time.\n   * Equal to Infinity if not defined here.\n   * @type {Object}\n   */\n  MAXIMUM_MAX_BUFFER_BEHIND: {\n    text: 5 * 60 * 60,\n  } as Partial<Record<\"audio\"|\"video\"|\"image\"|\"text\", number>>,\n  /* tslint:enable no-object-literal-type-assertion */\n\n  /**\n   * Default bitrate ceils initially set as the first content begins.\n   *\n   * If no track is found with a bitrate inferior or equal to the\n   * bitrate there, the one with the lowest bitrate will be taken instead.\n   *\n   * Set to 0 for the lowest bitrate, Infinity for the highest.\n   *\n   * These values are only useful for the first content played, as consecutive\n   * play will always take the last set one.\n   * @type {Object}\n   */\n  DEFAULT_INITIAL_BITRATES: {\n    audio: 0, // only \"audio\" segments\n    video: 0, // only \"video\" segments\n    other: 0, // tracks which are not audio/video (text images).\n              // Though those are generally at a single bitrate, so no adaptive\n              // mechanism is triggered for them.\n  },\n\n  /* tslint:disable no-object-literal-type-assertion */\n  /**\n   * Default bitrate ceil initially set to dictate the maximum bitrate the\n   * ABR manager can automatically switch to.\n   *\n   * If no track is found with a quality inferior or equal to the\n   * bitrate there, the lowest bitrate will be taken instead.\n   *\n   * Set to Infinity to discard any limit in the ABR strategy.\n   * @type {Object}\n   */\n  DEFAULT_MAX_BITRATES: {\n    audio: Infinity, // only \"audio\" segments\n    video: Infinity, // only \"video\" segments\n    other: Infinity, // tracks which are not audio/video\n                     // Though those are generally at a single bitrate, so no\n                     // adaptive mechanism is triggered for them.\n  } as Record<\"audio\"|\"video\"|\"other\", number>,\n  /* tslint:enable no-object-literal-type-assertion */\n\n  /**\n   * Delay after which, if the page is hidden, the user is considered inactive\n   * on the current video.\n   *\n   * Allow to enforce specific optimizations when the page is not shown.\n   * @see DEFAULT_THROTTLE_WHEN_HIDDEN\n   * @type {Number}\n   */\n  INACTIVITY_DELAY: 60 * 1000,\n\n  /**\n   * If true, if the player is in a \"hidden\" state for a delay specified by the\n   * INACTIVITY DELAY config property, we throttle automatically to the video\n   * representation with the lowest bitrate.\n   * @type {Boolean}\n   */\n  DEFAULT_THROTTLE_WHEN_HIDDEN: false,\n\n  /**\n   * If true, if the video is considered in a \"hidden\" state for a delay specified by\n   * the INACTIVITY DELAY config property, we throttle automatically to the video\n   * representation with the lowest bitrate.\n   * @type {Boolean}\n   */\n  DEFAULT_THROTTLE_VIDEO_BITRATE_WHEN_HIDDEN: false,\n\n  /**\n   * If true, the video representations you can switch to in adaptive mode\n   * are limited by the video element's width.\n   *\n   * Basically in that case, we won't switch to a video Representation with\n   * a width higher than the current width of the video HTMLElement.\n   * @type {Boolean}\n   */\n  DEFAULT_LIMIT_VIDEO_WIDTH: false,\n\n  /**\n   * Default initial live gap considered if no presentation delay has been\n   * suggested, in seconds.\n   * @type {Number}\n   */\n  DEFAULT_LIVE_GAP: {\n    DEFAULT: 10,\n    LOW_LATENCY: 3,\n  },\n\n  /**\n   * Maximum time, in seconds, the player should automatically skip when stalled\n   * because of a discontinuity in the downloaded range.\n   * @type {Number}\n   */\n  BUFFER_DISCONTINUITY_THRESHOLD: 1,\n\n  /**\n   * Ratio used to know if an already loaded segment should be re-buffered.\n   * We re-load the given segment if the current one times that ratio is\n   * inferior to the new one.\n   * @type {Number}\n   */\n  BITRATE_REBUFFERING_RATIO: 1.5,\n\n  /**\n   * Those are used when a \"QuotaExceededError\" error is received after\n   * appending a new segment in the SourceBuffer.\n   *\n   * This error can arise when the browser's buffer is considered full.\n   * In this case, the player goes into manual garbage collection (GC) mode.\n   * @type {Object}\n   */\n  BUFFER_GC_GAPS: {\n    /**\n     * _Low_ gap (from current position) from which the buffer will be _garbage\n     * collected_ (read removed from the buffer) when a QuotaExceededError is\n     * received.\n     * In seconds.\n     * @type {Number}\n     */\n    CALM: 240,\n\n    /**\n     * _High_ gap (from current position) from which the buffer will be _garbage\n     * collected_ (read removed from the buffer) when a QuotaExceededError is\n     * received, if the low one does not clean up any buffer.\n     * In seconds.\n     * @type {Number}\n     */\n    BEEFY: 30,\n  },\n\n  /**\n   * The default number of times a manifest request will be re-performed\n   * when loaded/refreshed if the request finishes on an error which\n   * justify an retry.\n   *\n   * Note that some errors do not use this counter:\n   *   - if the error is not due to the xhr, no retry will be peformed\n   *   - if the error is an HTTP error code, but not a 500-smthg or a 404, no\n   *     retry will be performed.\n   *   - if it has a high chance of being due to the user being offline, a\n   *     separate counter is used (see DEFAULT_MAX_PIPELINES_RETRY_ON_OFFLINE).\n   * @type Number\n   */\n  DEFAULT_MAX_MANIFEST_REQUEST_RETRY: 4,\n\n  /**\n   * The default number of times a pipeline request will be re-performed when\n   * on error which justify a retry.\n   *\n   * Note that some errors do not use this counter:\n   *   - if the error is not due to the xhr, no retry will be peformed\n   *   - if the error is an HTTP error code, but not a 500-smthg or a 404, no\n   *     retry will be performed.\n   *   - if it has a high chance of being due to the user being offline, a\n   *     separate counter is used (see DEFAULT_MAX_PIPELINES_RETRY_ON_OFFLINE).\n   * @type Number\n   */\n  DEFAULT_MAX_PIPELINES_RETRY_ON_ERROR: 4,\n\n  /**\n   * Under some circonstances, we're able to tell that the user is offline (see\n   * the compat files).\n   * When this happens, and xhr requests fails due to an error event (you might\n   * still be able to perform xhr offline, e.g. on localhost), you might want to\n   * retry indefinitely or with a higher number of retry than if the error is\n   * due to a CDN problem.\n   *\n   * A capped exponential backoff will still be used (like for an error code).\n   * @type {Number}\n   */\n  DEFAULT_MAX_PIPELINES_RETRY_ON_OFFLINE: Infinity,\n\n  /**\n   * Initial backoff delay when a segment / manifest download fails, in\n   * milliseconds.\n   *\n   * This delay will then grow exponentally by power of twos (200, 400, 800\n   * etc.)\n   *\n   * Please note that this delay is not exact, as it will be fuzzed.\n   * @type {Number}\n   */\n  INITIAL_BACKOFF_DELAY_BASE: {\n    REGULAR: 200,\n    LOW_LATENCY: 50,\n  },\n\n  /**\n   * Maximum backoff delay when a segment / manifest download fails, in\n   * milliseconds.\n   *\n   * Please note that this delay is not exact, as it will be fuzzed.\n   * @type {Number}\n   */\n  MAX_BACKOFF_DELAY_BASE: {\n    REGULAR: 3000,\n    LOW_LATENCY: 1000,\n  },\n\n  /**\n   * Minimum interval at which timeupdate events will be \"constructed\". This\n   * variable is for the \"regular\" mediasource strategy (that is, not for the\n   * directfile API.\n   *\n   * Those events are the base of various important mechanisms in the player:\n   *   - set the clock for the buffer.\n   *   - set the clock for the ABR strategy.\n   *   - used to trigger positionUpdate events.\n   *\n   * This common logic is for performance reasons, as we call multiple browser's\n   * APIs which are useful for most of these.\n   *\n   * Keep in mind this is the minimum interval. This logic will also be\n   * triggered when various events of the media element are received.\n   * @type {Number}\n   */\n  SAMPLING_INTERVAL_MEDIASOURCE: 1000,\n\n  /**\n   * Same than SAMPLING_INTERVAL_MEDIASOURCE but for lowLatency mode.\n   * @type {Number}\n   */\n  SAMPLING_INTERVAL_LOW_LATENCY: 250,\n\n  /**\n   * Same than SAMPLING_INTERVAL_MEDIASOURCE but for the directfile API.\n   * @type {Number}\n   */\n  SAMPLING_INTERVAL_NO_MEDIASOURCE: 500,\n\n  /**\n   * Minimum number of bytes sampled before we trust the estimate.\n   * If we have not sampled much data, our estimate may not be accurate\n   * enough to trust.\n   * If the total of bytes sampled is less than this value, we use a\n   * default estimate.\n   * This specific value is based on experimentations.\n   * @type {Number}\n   */\n  ABR_MINIMUM_TOTAL_BYTES: 150e3,\n\n  /**\n   * Minimum number of bytes, under which samples are discarded.\n   * Our models do not include latency information, so connection startup time\n   * (time to first byte) is considered part of the download time.\n   * Because of this, we should ignore very small downloads which would cause\n   * our estimate to be too low.\n   * This specific value is based on experimentation.\n   * @type {Number}\n   */\n  ABR_MINIMUM_CHUNK_SIZE: 16e3,\n\n  /**\n   * Factor with which is multiplied the bandwidth estimate when the ABR is in\n   * starvation mode.\n   * @type {Object}\n   */\n  ABR_STARVATION_FACTOR: {\n    DEFAULT: 0.72,\n    LOW_LATENCY: 0.64,\n  },\n\n  /**\n   * Factor with which is multiplied the bandwidth estimate when the ABR is not\n   * in starvation mode.\n   * @type {Object}\n   */\n  ABR_REGULAR_FACTOR: {\n    DEFAULT: 0.90,\n    LOW_LATENCY: 0.90,\n  },\n\n  /**\n   * If a SourceBuffer has less than ABR_STARVATION_GAP in seconds ahead of the\n   * current position in its buffer, the ABR manager will go into starvation\n   * mode.\n   *\n   * It gets out of starvation mode when the OUT_OF_STARVATION_GAP value is\n   * reached.\n   *\n   * Under this starvation mode:\n   *\n   *   - the bandwidth considered will be a little lower than the one estimated\n   *\n   *   - the time the next important request take will be checked\n   *     multiple times to detect when/if it takes too much time.\n   *     If the request is considered too long, the bitrate will be hastily\n   *     re-calculated from this single request.\n   *\n   * @type {Object}\n   */\n  ABR_STARVATION_GAP: {\n    DEFAULT: 5,\n    LOW_LATENCY: 5,\n  },\n  OUT_OF_STARVATION_GAP: {\n    DEFAULT: 7,\n    LOW_LATENCY: 7,\n  },\n\n  /**\n   * This is a security to avoid going into starvation mode when the content is\n   * ending (@see ABR_STARVATION_GAP).\n   * Basically, we subtract that value from the global duration of the content\n   * and we never enter \"starvation mode\" if the currently available buffer\n   * (which equals to the current position + the available buffer ahead of it)\n   * is equal or higher than this value.\n   * @type {Number}\n   */\n  ABR_STARVATION_DURATION_DELTA: 0.1,\n\n  /**\n   * Half-life, in seconds for a fastly-evolving exponential weighted moving\n   * average.\n   * The lower it is, the faster the ABR logic will react to the bandwidth\n   * falling quickly.\n   * Should be kept to a lower number than ABR_SLOW_EMA for coherency reasons.\n   * @type {Number}\n   */\n  ABR_FAST_EMA: 2,\n\n  /**\n   * Half-life, in seconds for a slowly-evolving exponential weighted moving\n   * average.\n   * The lower it is, the faster the ABR logic is going to react to recent\n   * bandwidth variation, on the higher and on the lower side.\n   * Should be kept to a higher number than ABR_FAST_EMA for coherency reasons.\n   * @type {Number}\n   */\n  ABR_SLOW_EMA: 10,\n\n  /**\n   * Number of seconds ahead in the buffer after which playback will resume when\n   * seeking on an unbuffered part of the content.\n   * @type {Number}\n   */\n  RESUME_GAP_AFTER_SEEKING: {\n    DEFAULT: 1.5,\n    LOW_LATENCY: 0.5,\n  },\n\n  /**\n   * Number of seconds ahead in the buffer after which playback will resume when\n   * the player was stalled due to a low readyState.\n   * @type {Number}\n   */\n  RESUME_GAP_AFTER_NOT_ENOUGH_DATA: {\n    DEFAULT: 0.5,\n    LOW_LATENCY: 0.5,\n  },\n\n  /**\n   * Number of seconds ahead in the buffer after which playback will resume\n   * after the player went through a buffering step.\n   * @type {Number}\n   */\n  RESUME_GAP_AFTER_BUFFERING: {\n    DEFAULT: 5,\n    LOW_LATENCY: 0.5,\n  },\n\n  /**\n   * Maximum number of seconds in the buffer based on which a \"stalling\"\n   * strategy will be considered:\n   * The player will pause playback to get enough time building a sufficient\n   * buffer. This mostly happen when seeking in an unbuffered part or when\n   * buffering.\n   * @type {Number}\n   */\n  STALL_GAP: {\n    DEFAULT: 0.5,\n    LOW_LATENCY: 0.2,\n  },\n\n  /**\n   * Maximum authorized difference between what we calculated to be the\n   * beginning or end of the segment in the SourceBuffer and what we\n   * actually are noticing now.\n   *\n   * If the segment seems to have removed more than this size in seconds, we\n   * will infer that the segment has been garbage collected and we might try to\n   * re-download it.\n   * @type {Number}\n   */\n  MAX_TIME_MISSING_FROM_COMPLETE_SEGMENT: 0.15,\n\n  /**\n   * The maximum authorized difference, in seconds, between the real buffered\n   * time of a given chunk and what the segment information of the Manifest\n   * tells us.\n   *\n   * Setting a value too high can lead to parts of the SourceBuffer being\n   * linked to the wrong segments and to segments wrongly believed to be still\n   * complete (instead of garbage collected).\n   *\n   * Setting a value too low can lead to parts of the SourceBuffer not being\n   * linked to the concerned segment and to segments wrongly believed to be\n   * partly garbage collected (instead of complete segments).\n   * @type {Number}\n   */\n  MAX_MANIFEST_BUFFERED_START_END_DIFFERENCE: 0.4,\n\n  /**\n   * The maximum authorized difference, in seconds, between the duration a\n   * segment should have according to the Manifest and the actual duration it\n   * seems to have once pushed to the SourceBuffer.\n   *\n   * Setting a value too high can lead to parts of the SourceBuffer being\n   * linked to the wrong segments and to segments wrongly believed to be still\n   * complete (instead of garbage collected).\n   *\n   * Setting a value too low can lead to parts of the SourceBuffer not being\n   * linked to the concerned segment and to segments wrongly believed to be\n   * partly garbage collected (instead of complete segments). This last point\n   * could lead to unnecessary segment re-downloading.\n   * @type {Number}\n   */\n  MAX_MANIFEST_BUFFERED_DURATION_DIFFERENCE: 0.3,\n\n  /**\n   * Minimum duration in seconds a segment should be into a buffered range to be\n   * considered as part of that range.\n   * Segments which have less than this amount of time \"linked\" to a buffered\n   * range will be deleted.\n   *\n   * Setting a value too low can lead in worst-case scenarios to segments being\n   * wrongly linked to the next or previous range it is truly linked too (if\n   * those ranges are too close).\n   *\n   * Setting a value too high can lead to part of the buffer not being assigned\n   * any segment. It also limits the minimum duration a segment can be.\n   *\n   * TODO As of now, this limits the minimum size a complete segment can be. A\n   * better logic would be to also consider the duration of a segment. Though\n   * this logic could lead to bugs with the current code.\n   * @type {Number}\n   */\n  MINIMUM_SEGMENT_SIZE: 0.005,\n\n  /**\n   * Append windows allow to filter media data from segments if they are outside\n   * a given limit.\n   * Coded frames with presentation timestamp within this range are allowed to\n   * be appended to the SourceBuffer while coded frames outside this range are\n   * filtered out.\n   *\n   * Those are often set to be the start and end of the \"Period\" the segment is\n   * in.\n   * However, we noticed that some browsers were too aggressive when the exact\n   * limits were set: more data than needed was removed, often leading to\n   * discontinuities.\n   *\n   * Those securities are added to the set windows (substracted from the window\n   * start and added to the window end) to avoid those problems.\n   * @type {Object}\n   */\n  APPEND_WINDOW_SECURITIES: {\n    START: 0.2,\n    END: 0.1,\n  },\n\n  /**\n   * Maximum interval at which text tracks are refreshed in an \"html\"\n   * textTrackMode.\n   *\n   * The text tracks are also refreshed on various video events, this interval\n   * will only trigger a refresh if none of those events was received during\n   * that timespan.\n   *\n   * Note that if the TextTrack cue did not change between two intervals or\n   * events, the DOM won't be refreshed.\n   * The TextTrack cues structure is also optimized for fast retrieval.\n   * We should thus not have much of a performance impact here if we set a low\n   * interval.\n   *\n   * @type {Number}\n   */\n  MAXIMUM_HTML_TEXT_TRACK_UPDATE_INTERVAL: 50,\n\n  /**\n   * The Buffer padding is a time offset from the current time that affects\n   * the buffer.\n   *\n   * Basically, from a given time, if the current buffer gap number (time\n   * between the current time and the end of the downloaded buffer) is above\n   * the padding described here (of the corresponding type), we won't\n   * reschedule segments for that range.\n   *\n   * This is to avoid excessive re-buffering.\n   *\n   * Keeping the padding too low would increase the risk of re-bufferings.\n   *\n   * Keeping the padding too high would delay visible quality increase.\n   *\n   * @type {Object}\n   */\n  BUFFER_PADDING: {\n    audio: 1, // only \"audio\" segments\n    video: 3, // only \"video\" segments\n    other: 1, // tracks which are not audio/video (text images).\n  },\n\n  /**\n   * Segments of different types are downloaded by steps:\n   *\n   *   - first the audio/video/text Segments which are immediately needed\n   *\n   *   - then once every of those Segments have been downloaded, less-needed\n   *     Segments\n   *\n   *   - then once every of those less-needed Segments have been downloaded,\n   *     even less-needed Segments\n   *\n   *   - etc.\n   *\n   * This stepped download strategy allows to make a better use of network\n   * ressources.\n   *\n   * For example, if more than sufficient audio buffer has been downloaded but\n   * the immediately-needed video Segment is still pending its request, we might\n   * be in a situation of rebuffering.\n   * In that case, a better strategy would be to make sure every network\n   * ressource is allocated for this video Segment before rebuffering happens.\n   *\n   * This is where those steps become useful.\n   *\n   * --\n   *\n   * The numbers defined in this Array describe what the steps are.\n   *\n   * Each number is linked to a distance from the current playing position, in\n   * seconds.\n   * Distances which will be used as limit points, from which a new step is\n   * reached (see example).\n   *\n   * Note: You can set an empty array to deactivate the steps feature (every\n   * Segments have the same priority).\n   *\n   * @example\n   *\n   * let's imagine the following SEGMENT_PRIORITIES_STEPS array:\n   * [5, 11, 17, 25]\n   *\n   * To link each Segments to a corresponding priority (and thus to a specific\n   * step), we have to consider the distance d between the current position and\n   * the start time of the Segment.\n   *\n   * We have in our example 5 groups, which correspond to the following possible\n   * d values:\n   *   1. inferior to 5\n   *   2. between 5 and 11\n   *   3. between 11 and 17\n   *   4. between 17 and 25\n   *   5. superior to 25\n   *\n   * Segments corresponding to a lower-step will need to all be downloaded\n   * before Segments of a newer step begin.\n   *\n   * @type {Array.<Number>}\n   */\n  SEGMENT_PRIORITIES_STEPS : [6, 14],\n\n  /**\n   * Robustnesses used in the {audio,video}Capabilities of the\n   * MediaKeySystemConfiguration (EME).\n   *\n   * Only used for widevine keysystems.\n   *\n   * Defined in order of importance (first will be tested first etc.)\n   * @type {Array.<string>}\n   */\n  EME_DEFAULT_WIDEVINE_ROBUSTNESSES: [ \"HW_SECURE_ALL\",\n                                       \"HW_SECURE_DECODE\",\n                                       \"HW_SECURE_CRYPTO\",\n                                       \"SW_SECURE_DECODE\",\n                                       \"SW_SECURE_CRYPTO\" ],\n\n  /**\n   * Link canonical key systems names to their respective reverse domain name,\n   * used in the EME APIs.\n   * This allows to have a simpler API, where users just need to set \"widevine\"\n   * or \"playready\" as a keySystem.\n   * @type {Object}\n   */\n  /* tslint:disable no-object-literal-type-assertion */\n  EME_KEY_SYSTEMS: {\n    clearkey:  [ \"webkit-org.w3.clearkey\",\n                 \"org.w3.clearkey\" ],\n    widevine:  [ \"com.widevine.alpha\" ],\n    playready: [ \"com.microsoft.playready\",\n                 \"com.chromecast.playready\",\n                 \"com.youtube.playready\" ],\n  } as Partial<Record<string, string[]>>,\n  /* tslint:enable no-object-literal-type-assertion */\n\n  /**\n   * When we detect that the local Manifest might be out-of-sync with the\n   * server's one, we schedule a Manifest refresh.\n   * However, as this \"unsynchronization\" is only a theory and as we do not want\n   * to send too many Manifest requests, we keep a delay between the last\n   * Manifest refresh done and that one.\n   * This value indicates which delay we want. Note that the Manifest could\n   * still be refreshed before this delay for other reasons.\n   * @type {Number}\n   */\n  OUT_OF_SYNC_MANIFEST_REFRESH_DELAY: 3000,\n\n  /**\n   * Max simultaneous MediaKeySessions that will be kept as a cache to avoid\n   * doing superfluous license requests.\n   * If this number is reached, any new session creation will close the oldest\n   * one.\n   * @type {Number}\n   */\n  EME_MAX_SIMULTANEOUS_MEDIA_KEY_SESSIONS: 50,\n\n  /**\n   * The player relies on browser events and properties to update its status to\n   * \"ENDED\".\n   *\n   * Sadly in some cases, like in Chrome 54, this event is never triggered on\n   * some contents probably due to a browser bug.\n   *\n   * This threshold resolves this issue by forcing the status to \"ENDED\" when:\n   *   1. the player is stalling\n   *   2. the absolute difference between current playback time and duration is\n   *      under this value\n   *\n   * If set to null, this workaround is disabled and the player only relies on\n   * browser events.\n   *\n   * @type {Number|null}\n   */\n  FORCED_ENDED_THRESHOLD: 0.001,\n\n  /**\n   * Maximum duration from the current position we will let in the buffer when\n   * switching an Adaptation of a given type.\n   *\n   * For example, if we have ``text: { before: 1, after: 4 }``, it means that\n   * when switching subtitles, we will let 1 second before and 4 second after\n   * the current position in the previous language (until the new segments\n   * overwrite it).\n   * This is to allow smooth transitions and avoid de-synchronization that\n   * can happen when removing the content being decoded.\n   * @type {Object}\n   */\n  ADAPTATION_SWITCH_BUFFER_PADDINGS: {\n    video: { before: 0.5, after: 1 },\n    audio: { before: 0.5, after: 2 },\n    text: { before: 0, after: 0 }, // not managed natively, so no problem here\n    image: { before: 0, after: 0 }, // not managed natively, so no problem here\n  },\n\n  /**\n   * Interval, in milliseconds, at which we should manually flush\n   * SourceBuffers.\n   * Some browsers (happened with firefox 66) sometimes \"forget\" to send us\n   * `update` or `updateend` events.\n   * In that case, we're completely unable to continue the queue here and\n   * stay locked in a waiting state.\n   * This interval is here to check at regular intervals if the underlying\n   * SourceBuffer is currently updating.\n   * @type {Number}\n   */\n  SOURCE_BUFFER_FLUSHING_INTERVAL: 2000,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Error due to an abnormal assertion fails.\n *\n * @class AssertionError\n * @extends Error\n */\nexport default class AssertionError extends Error {\n  public readonly name : \"AssertionError\";\n  public readonly message : string;\n\n  /**\n   * @param {string} message\n   */\n  constructor(message : string) {\n    super();\n    // @see https://stackoverflow.com/questions/41102060/typescript-extending-error-class\n    Object.setPrototypeOf(this, AssertionError.prototype);\n\n    this.name = \"AssertionError\";\n    this.message = message;\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport type IErrorType = \"NETWORK_ERROR\" |\n                         \"MEDIA_ERROR\" |\n                         \"ENCRYPTED_MEDIA_ERROR\" |\n                         \"OTHER_ERROR\";\n\nexport type IEncryptedMediaErrorCode = \"INCOMPATIBLE_KEYSYSTEMS\" |\n                                       \"INVALID_ENCRYPTED_EVENT\" |\n                                       \"INVALID_KEY_SYSTEM\" |\n                                       \"KEY_ERROR\" |\n                                       \"KEY_GENERATE_REQUEST_ERROR\" |\n                                       \"KEY_LOAD_ERROR\" |\n                                       \"KEY_LOAD_TIMEOUT\" |\n                                       \"KEY_STATUS_CHANGE_ERROR\" |\n                                       \"KEY_UPDATE_ERROR\" |\n                                       \"CREATE_MEDIA_KEYS_ERROR\" |\n                                       \"LICENSE_SERVER_CERTIFICATE_ERROR\" |\n                                       \"MEDIA_IS_ENCRYPTED_ERROR\" |\n                                       \"MULTIPLE_SESSIONS_SAME_INIT_DATA\";\n\nexport type IMediaErrorCode = \"BUFFER_APPEND_ERROR\" |\n                              \"BUFFER_FULL_ERROR\" |\n                              \"BUFFER_TYPE_UNKNOWN\" |\n                              \"MANIFEST_INCOMPATIBLE_CODECS_ERROR\" |\n                              \"MANIFEST_PARSE_ERROR\" |\n                              \"MANIFEST_UNSUPPORTED_ADAPTATION_TYPE\" |\n                              \"MEDIA_ERR_ABORTED\" |\n                              \"MEDIA_ERR_BLOCKED_AUTOPLAY\" |\n                              \"MEDIA_ERR_PLAY_NOT_ALLOWED\" |\n                              \"MEDIA_ERR_NOT_LOADED_METADATA\" |\n                              \"MEDIA_ERR_DECODE\" |\n                              \"MEDIA_ERR_NETWORK\" |\n                              \"MEDIA_ERR_SRC_NOT_SUPPORTED\" |\n                              \"MEDIA_ERR_UNKNOWN\" |\n                              \"MEDIA_KEYS_NOT_SUPPORTED\" |\n                              \"MEDIA_SOURCE_NOT_SUPPORTED\" |\n                              \"MEDIA_STARTING_TIME_NOT_FOUND\" |\n                              \"MEDIA_TIME_BEFORE_MANIFEST\" |\n                              \"MEDIA_TIME_AFTER_MANIFEST\" |\n                              \"MEDIA_TIME_NOT_FOUND\";\n\nexport type INetworkErrorCode = \"PIPELINE_LOAD_ERROR\";\n\nexport type IOtherErrorCode = \"PIPELINE_LOAD_ERROR\" |\n                              \"PIPELINE_PARSE_ERROR\" |\n                              \"INTEGRITY_ERROR\" |\n                              \"NONE\";\n\nexport type IErrorCode = INetworkErrorCode |\n                         IMediaErrorCode |\n                         IEncryptedMediaErrorCode |\n                         IOtherErrorCode;\n\nexport type INetworkErrorType = \"TIMEOUT\" |\n                                \"ERROR_EVENT\" |\n                                \"PARSE_ERROR\" |\n                                \"ERROR_HTTP_CODE\";\n\nconst ErrorTypes : Record<IErrorType, IErrorType> = {\n  NETWORK_ERROR: \"NETWORK_ERROR\",\n  MEDIA_ERROR: \"MEDIA_ERROR\",\n  ENCRYPTED_MEDIA_ERROR: \"ENCRYPTED_MEDIA_ERROR\",\n  OTHER_ERROR: \"OTHER_ERROR\",\n};\n\nconst NetworkErrorTypes : Record<INetworkErrorType, INetworkErrorType> = {\n  TIMEOUT: \"TIMEOUT\",\n  ERROR_EVENT: \"ERROR_EVENT\",\n  ERROR_HTTP_CODE: \"ERROR_HTTP_CODE\",\n  PARSE_ERROR: \"PARSE_ERROR\",\n};\n\nconst ErrorCodes : Record<IErrorCode, IErrorCode>  = {\n  PIPELINE_LOAD_ERROR: \"PIPELINE_LOAD_ERROR\",\n  PIPELINE_PARSE_ERROR: \"PIPELINE_PARSE_ERROR\",\n  INTEGRITY_ERROR: \"INTEGRITY_ERROR\",\n\n  MANIFEST_PARSE_ERROR: \"MANIFEST_PARSE_ERROR\",\n  MANIFEST_INCOMPATIBLE_CODECS_ERROR: \"MANIFEST_INCOMPATIBLE_CODECS_ERROR\",\n  MANIFEST_UNSUPPORTED_ADAPTATION_TYPE: \"MANIFEST_UNSUPPORTED_ADAPTATION_TYPE\",\n\n  MEDIA_STARTING_TIME_NOT_FOUND: \"MEDIA_STARTING_TIME_NOT_FOUND\",\n  MEDIA_TIME_BEFORE_MANIFEST: \"MEDIA_TIME_BEFORE_MANIFEST\",\n  MEDIA_TIME_AFTER_MANIFEST: \"MEDIA_TIME_AFTER_MANIFEST\",\n  MEDIA_TIME_NOT_FOUND: \"MEDIA_TIME_NOT_FOUND\",\n\n  MEDIA_IS_ENCRYPTED_ERROR: \"MEDIA_IS_ENCRYPTED_ERROR\",\n\n  CREATE_MEDIA_KEYS_ERROR: \"CREATE_MEDIA_KEYS_ERROR\",\n  KEY_ERROR: \"KEY_ERROR\",\n  KEY_STATUS_CHANGE_ERROR: \"KEY_STATUS_CHANGE_ERROR\",\n  KEY_UPDATE_ERROR: \"KEY_UPDATE_ERROR\",\n  KEY_LOAD_ERROR: \"KEY_LOAD_ERROR\",\n  KEY_LOAD_TIMEOUT: \"KEY_LOAD_TIMEOUT\",\n  KEY_GENERATE_REQUEST_ERROR: \"KEY_GENERATE_REQUEST_ERROR\",\n  INCOMPATIBLE_KEYSYSTEMS: \"INCOMPATIBLE_KEYSYSTEMS\",\n  INVALID_ENCRYPTED_EVENT: \"INVALID_ENCRYPTED_EVENT\",\n  INVALID_KEY_SYSTEM: \"INVALID_KEY_SYSTEM\",\n  LICENSE_SERVER_CERTIFICATE_ERROR: \"LICENSE_SERVER_CERTIFICATE_ERROR\",\n  MULTIPLE_SESSIONS_SAME_INIT_DATA: \"MULTIPLE_SESSIONS_SAME_INIT_DATA\",\n\n  BUFFER_APPEND_ERROR: \"BUFFER_APPEND_ERROR\",\n  BUFFER_FULL_ERROR: \"BUFFER_FULL_ERROR\",\n  BUFFER_TYPE_UNKNOWN: \"BUFFER_TYPE_UNKNOWN\",\n\n  MEDIA_ERR_BLOCKED_AUTOPLAY: \"MEDIA_ERR_BLOCKED_AUTOPLAY\",\n  MEDIA_ERR_PLAY_NOT_ALLOWED: \"MEDIA_ERR_PLAY_NOT_ALLOWED\",\n  MEDIA_ERR_NOT_LOADED_METADATA: \"MEDIA_ERR_NOT_LOADED_METADATA\",\n\n  MEDIA_ERR_ABORTED: \"MEDIA_ERR_ABORTED\",\n  MEDIA_ERR_NETWORK: \"MEDIA_ERR_NETWORK\",\n  MEDIA_ERR_DECODE: \"MEDIA_ERR_DECODE\",\n  MEDIA_ERR_SRC_NOT_SUPPORTED: \"MEDIA_ERR_SRC_NOT_SUPPORTED\",\n  MEDIA_ERR_UNKNOWN: \"MEDIA_ERR_UNKNOWN\",\n\n  MEDIA_SOURCE_NOT_SUPPORTED: \"MEDIA_SOURCE_NOT_SUPPORTED\",\n  MEDIA_KEYS_NOT_SUPPORTED: \"MEDIA_KEYS_NOT_SUPPORTED\",\n\n  NONE: \"NONE\",\n};\n\nexport {\n  ErrorTypes,\n  NetworkErrorTypes,\n  ErrorCodes,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Generate a normalized error message.\n * @param {string} name\n * @param {string} code\n * @param {Error|string|Event|null} [reason]\n * @returns {string}\n */\nexport default function errorMessage(\n  name : string,\n  code : string,\n  reason : string\n) : string {\n  return `${name} (${code}) ${reason}`;\n }\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ErrorTypes,\n  IEncryptedMediaErrorCode,\n} from \"./error_codes\";\nimport errorMessage from \"./error_message\";\n\n/**\n * Error linked to the encryption of the media.\n *\n * @class EncryptedMediaError\n * @extends Error\n */\nexport default class EncryptedMediaError extends Error {\n  public readonly name : \"EncryptedMediaError\";\n  public readonly type : string;\n  public readonly code : IEncryptedMediaErrorCode;\n  public message : string;\n  public fatal : boolean;\n\n  /**\n   * @param {string} code\n   * @param {string} reason\n   * @Param {Boolean} fatal\n   */\n  constructor(code : IEncryptedMediaErrorCode, reason : string) {\n    super();\n    // @see https://stackoverflow.com/questions/41102060/typescript-extending-error-class\n    Object.setPrototypeOf(this, EncryptedMediaError.prototype);\n\n    this.name = \"EncryptedMediaError\";\n    this.type = ErrorTypes.ENCRYPTED_MEDIA_ERROR;\n\n    this.code = code;\n    this.message = errorMessage(this.name, this.code, reason);\n    this.fatal = false;\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ErrorTypes,\n  IMediaErrorCode,\n} from \"./error_codes\";\nimport errorMessage from \"./error_message\";\n\n/**\n * Error linked to the media Playback.\n *\n * @class MediaError\n * @extends Error\n */\nexport default class MediaError extends Error {\n  public readonly name : \"MediaError\";\n  public readonly type : string;\n  public readonly message : string;\n  public readonly code : IMediaErrorCode;\n  public fatal : boolean;\n\n  /**\n   * @param {string} code\n   * @param {string} reason\n   * @param {Boolean} fatal\n   */\n  constructor(code : IMediaErrorCode, reason : string) {\n    super();\n    // @see https://stackoverflow.com/questions/41102060/typescript-extending-error-class\n    Object.setPrototypeOf(this, MediaError.prototype);\n\n    this.name = \"MediaError\";\n    this.type = ErrorTypes.MEDIA_ERROR;\n\n    this.code = code;\n    this.message = errorMessage(this.name, this.code, reason);\n    this.fatal = false;\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ErrorTypes,\n  INetworkErrorCode,\n  INetworkErrorType,\n  NetworkErrorTypes,\n} from \"./error_codes\";\nimport errorMessage from \"./error_message\";\n\nexport interface INetworkErrorOptions {\n  xhr? : XMLHttpRequest; // possible linked XHR to the error\n  url : string; // URL the request was on\n  status : number; // HTTP code of the response. 0 if not known.\n  type : INetworkErrorType; // Type of the error\n  message : string; // Message to display to the user\n}\n\n/**\n * Error linked to network interactions (requests).\n *\n * @class NetworkError\n * @extends Error\n */\nexport default class NetworkError extends Error {\n  public readonly name : \"NetworkError\";\n  public readonly type : string;\n  public readonly message : string;\n  public readonly code : INetworkErrorCode;\n  public readonly xhr : XMLHttpRequest | null;\n  public readonly url : string;\n  public readonly status : number;\n  public readonly errorType : INetworkErrorType;\n  public fatal : boolean;\n\n  /**\n   * @param {string} code\n   * @param {Error} options\n   * @param {Boolean} fatal\n   */\n  constructor(code : INetworkErrorCode, options : INetworkErrorOptions) {\n    super();\n    // @see https://stackoverflow.com/questions/41102060/typescript-extending-error-class\n    Object.setPrototypeOf(this, NetworkError.prototype);\n\n    this.name = \"NetworkError\";\n    this.type = ErrorTypes.NETWORK_ERROR;\n\n    this.xhr = options.xhr === undefined ? null : options.xhr;\n    this.url = options.url;\n    this.status = options.status;\n    this.errorType = options.type;\n\n    this.code = code;\n    this.message = errorMessage(this.name, this.code, options.message);\n    this.fatal = false;\n  }\n\n  /**\n   * Returns true if the NetworkError is due to the given http error code\n   * @param {number} httpErrorCode\n   * @returns {Boolean}\n   */\n  isHttpError(httpErrorCode : number) : boolean {\n    return this.errorType === NetworkErrorTypes.ERROR_HTTP_CODE &&\n           this.status === httpErrorCode;\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ErrorTypes,\n  IOtherErrorCode,\n} from \"./error_codes\";\nimport errorMessage from \"./error_message\";\n\n/**\n * @class OtherError\n * @extends Error\n */\nexport default class OtherError extends Error {\n  public readonly name : \"OtherError\";\n  public readonly type : string;\n  public readonly message : string;\n  public readonly code : IOtherErrorCode;\n  public fatal : boolean;\n\n  /**\n   * @param {string} code\n   * @param {string} reason\n   * @param {Boolean} fatal\n   */\n  constructor(code : IOtherErrorCode, reason : string) {\n    super();\n    // @see https://stackoverflow.com/questions/41102060/typescript-extending-error-class\n    Object.setPrototypeOf(this, OtherError.prototype);\n\n    this.name = \"OtherError\";\n    this.type = ErrorTypes.OTHER_ERROR;\n\n    this.code = code;\n    this.message = errorMessage(this.name, this.code, reason);\n    this.fatal = false;\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport EncryptedMediaError from \"./encrypted_media_error\";\nimport { ErrorTypes } from \"./error_codes\";\nimport MediaError from \"./media_error\";\nimport NetworkError from \"./network_error\";\nimport OtherError from \"./other_error\";\n\nexport type ICustomError = EncryptedMediaError |\n                           MediaError |\n                           OtherError |\n                           NetworkError;\n\n/**\n * Whether the error given is a ICustomError.\n * @param {Error} error\n * @returns {Boolean}\n */\nexport default function isKnownError(error : unknown) : error is ICustomError {\n  return (error instanceof EncryptedMediaError ||\n          error instanceof MediaError ||\n          error instanceof OtherError ||\n          error instanceof NetworkError) &&\n         Object.keys(ErrorTypes).indexOf(error.type) >= 0;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport isKnownError, {\n  ICustomError,\n} from \"./is_known_error\";\nimport OtherError from \"./other_error\";\n\n/*\n * Format an unknown error into an API-defined error.\n * @param {*} error\n * @returns {Error}\n */\nexport default function formatError(\n  error : unknown,\n  { defaultCode, defaultReason } : { defaultCode : \"PIPELINE_LOAD_ERROR\" |\n                                                   \"PIPELINE_PARSE_ERROR\" |\n                                                   \"NONE\";\n                                     defaultReason : string; }\n) : ICustomError {\n  if (isKnownError(error)) {\n    return error;\n  }\n  const reason = error instanceof Error ? error.toString() :\n                                          defaultReason;\n  return new OtherError(defaultCode, reason);\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { INetworkErrorType } from \"./error_codes\";\n\n/**\n * Errors linked to the XHR implentation done in the RxPlayer.\n *\n * @class RequestError\n * @extends Error\n */\nexport default class RequestError extends Error {\n  public readonly name : \"RequestError\";\n  public readonly type : INetworkErrorType;\n  public readonly message : string;\n  public readonly xhr? : XMLHttpRequest;\n  public readonly url : string;\n  public readonly status : number;\n\n  /**\n   * @param {XMLHttpRequest} xhr\n   * @param {string} url\n   * @param {string} type\n   */\n  constructor(\n    url : string,\n    status : number,\n    type : INetworkErrorType,\n    xhr? : XMLHttpRequest\n  ) {\n    super();\n    // @see https://stackoverflow.com/questions/41102060/typescript-extending-error-class\n    Object.setPrototypeOf(this, RequestError.prototype);\n\n    this.name = \"RequestError\";\n    this.url = url;\n    this.xhr = xhr;\n    this.status = status;\n    this.type = type;\n    this.message = type;\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport AssertionError from \"./assertion_error\";\nimport EncryptedMediaError from \"./encrypted_media_error\";\nimport {\n  ErrorCodes,\n  ErrorTypes,\n  IErrorCode,\n  IErrorType,\n  NetworkErrorTypes,\n} from \"./error_codes\";\nimport formatError from \"./format_error\";\nimport isKnownError, {\n  ICustomError,\n} from \"./is_known_error\";\nimport MediaError from \"./media_error\";\nimport NetworkError from \"./network_error\";\nimport OtherError from \"./other_error\";\nimport RequestError from \"./request_error\";\n\nexport {\n  AssertionError,\n  EncryptedMediaError,\n  ErrorCodes,\n  ErrorTypes,\n  IErrorCode,\n  IErrorType,\n  formatError,\n  ICustomError,\n  MediaError as MediaError,\n  NetworkError,\n  OtherError,\n  RequestError,\n  NetworkErrorTypes,\n  isKnownError,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Do nothing (but do it well).\n *\n * Having this definition here allow to use the same reference each time a noop\n * is needed.\n * Also, it allows to avoid telling tslint to ignore empty blocks everywhere.\n */\n/* tslint:disable:no-empty */\nexport default function() : void {}\n/* tslint:enable:no-empty */\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport noop from \"./noop\";\n\nexport type ILoggerLevel = \"NONE\" |\n                           \"ERROR\" |\n                           \"WARNING\" |\n                           \"INFO\" |\n                           \"DEBUG\";\n\ntype tConsoleFn = (...args : unknown[]) => void;\n\nconst DEFAULT_LOG_LEVEL : ILoggerLevel = \"NONE\";\n\n/**\n * Logger implementation.\n * @class Logger\n */\nexport default class Logger {\n  public error : tConsoleFn;\n  public warn : tConsoleFn;\n  public info : tConsoleFn;\n  public debug : tConsoleFn;\n  private currentLevel : ILoggerLevel;\n  private readonly LEVELS : Record<ILoggerLevel, number>;\n\n  constructor() {\n    this.error = noop;\n    this.warn = noop;\n    this.info = noop;\n    this.debug = noop;\n    this.LEVELS = { NONE: 0,\n                    ERROR: 1,\n                    WARNING: 2,\n                    INFO: 3,\n                    DEBUG: 4 };\n    this.currentLevel = DEFAULT_LOG_LEVEL;\n  }\n\n  /**\n   * @param {string} levelStr\n   */\n  public setLevel(levelStr : string) {\n    let level : number;\n    const foundLevel = this.LEVELS[levelStr as ILoggerLevel];\n    if (foundLevel) { // levelStr is a ILoggerLevel\n      level = foundLevel;\n      this.currentLevel = levelStr as ILoggerLevel;\n    } else { // either 0 or not found\n      level = 0;\n      this.currentLevel = \"NONE\";\n    }\n\n    /* tslint:disable no-invalid-this */\n    /* tslint:disable no-console */\n    this.error = (level >= this.LEVELS.ERROR) ? console.error.bind(console) :\n                                                noop;\n    this.warn = (level >= this.LEVELS.WARNING) ? console.warn.bind(console) :\n                                                 noop;\n    this.info = (level >= this.LEVELS.INFO) ? console.info.bind(console) :\n                                              noop;\n    this.debug = (level >= this.LEVELS.DEBUG) ? console.log.bind(console) :\n                                                noop;\n    /* tslint:enable no-console */\n    /* tslint:enable no-invalid-this */\n  }\n\n  /**\n   * @returns {string}\n   */\n  public getLevel() : ILoggerLevel {\n    return this.currentLevel;\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Logger from \"./utils/logger\";\n\n// create a logger specifically for the RxPlayer.\nconst logger = new Logger();\n\nexport default logger;\n","/*\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Observable,\n} from \"rxjs\";\nimport config from \"../../config\";\nimport {\n  NetworkErrorTypes,\n  RequestError,\n} from \"../../errors\";\nimport log from \"../../log\";\n\nexport interface IDataChunk {\n  type : \"data-chunk\";\n  value : {\n    currentTime : number;\n    duration : number;\n    chunkSize : number;\n    size : number;\n    sendingTime : number;\n    url : string;\n    totalSize? : number;\n    chunk: ArrayBuffer;\n  };\n}\n\nexport interface IDataComplete {\n  type : \"data-complete\";\n  value : {\n    duration : number;\n    receivedTime : number;\n    sendingTime : number;\n    size : number;\n    status : number;\n    url : string;\n  };\n}\n\nexport interface IFetchOptions {\n  url : string;\n  headers? : { [ header: string ] : string }|null;\n  timeout? : number;\n}\n\nconst { DEFAULT_REQUEST_TIMEOUT } = config;\n\ntype IHeadersConstructor = new() => Headers;\ntype IAbortControllerConstructor = new() => AbortController;\n\nconst _Headers : IHeadersConstructor|null =\n  typeof Headers === \"function\" ? Headers :\n                                  null;\nconst _AbortController : IAbortControllerConstructor|null =\n  typeof AbortController === \"function\" ?\n    AbortController :\n    null;\n\nfunction fetchRequest(\n  options : IFetchOptions\n) : Observable< IDataChunk | IDataComplete > {\n  let headers : Headers | { [key : string ] : string } | undefined;\n  if (options.headers != null) {\n    if (_Headers == null) {\n      headers = options.headers;\n    } else {\n      headers = new _Headers();\n      const headerNames = Object.keys(options.headers);\n      for (let i = 0; i < headerNames.length; i++) {\n        const headerName = headerNames[i];\n        headers.append(headerName, options.headers[headerName]);\n      }\n    }\n  }\n\n  return new Observable((obs) => {\n    log.debug(\"Fetch: Called with URL\", options.url);\n    let hasAborted = false;\n    let timeouted = false;\n    let isDone = false;\n    const sendingTime = performance.now();\n    const abortController: AbortController | null =\n      _AbortController != null ? new _AbortController() :\n      null;\n\n    /**\n     * Abort current fetchRequest by triggering AbortController signal.\n     * @returns {void}\n     */\n    function abortRequest(): void {\n      if (!isDone) {\n        if (abortController) {\n          return abortController.abort();\n        }\n        log.warn(\"Fetch: AbortController API not available.\");\n      }\n    }\n\n    const requestTimeout = options.timeout == null ? DEFAULT_REQUEST_TIMEOUT :\n                                                     options.timeout;\n    const timeout = window.setTimeout(() => {\n      timeouted = true;\n      abortRequest();\n    }, requestTimeout);\n\n    fetch(options.url,\n          { headers,\n            method: \"GET\",\n            signal: abortController ? abortController.signal :\n                                      undefined }\n    ).then((response) => {\n      if (timeout != null) {\n        clearTimeout(timeout);\n      }\n      if (response.status >= 300) {\n        log.warn(\"Fetch: Request HTTP Error\", response);\n        obs.error(new RequestError(response.url,\n                                   response.status,\n                                   NetworkErrorTypes.ERROR_HTTP_CODE));\n        return undefined;\n      }\n\n      if (response.body == null) {\n        obs.error(new RequestError(response.url,\n                                   response.status,\n                                   NetworkErrorTypes.PARSE_ERROR));\n        return undefined;\n      }\n\n      const contentLengthHeader = response.headers.get(\"Content-Length\");\n      const contentLength = contentLengthHeader != null &&\n                            !isNaN(+contentLengthHeader) ? +contentLengthHeader :\n                                                           undefined;\n      const reader = response.body.getReader();\n      let size = 0;\n\n      return readBufferAndSendEvents();\n\n      async function readBufferAndSendEvents() : Promise<undefined> {\n        const data = await reader.read();\n\n        if (!data.done && data.value != null) {\n          size += data.value.byteLength;\n          const currentTime = performance.now();\n          const dataChunk = { type: \"data-chunk\" as const,\n                              value: { url: response.url,\n                                       currentTime,\n                                       duration: currentTime - sendingTime,\n                                       sendingTime,\n                                       chunkSize: data.value.byteLength,\n                                       chunk: data.value.buffer,\n                                       size,\n                                       totalSize: contentLength } };\n          obs.next(dataChunk);\n          return readBufferAndSendEvents();\n        } else if (data.done) {\n          const receivedTime = performance.now();\n          const duration = receivedTime - sendingTime;\n          isDone = true;\n          obs.next({ type: \"data-complete\" as const,\n                     value: { duration,\n                              receivedTime,\n                              sendingTime,\n                              size,\n                              status: response.status,\n                              url: response.url } });\n          obs.complete();\n        }\n      }\n    }).catch((err) => {\n      if (hasAborted) {\n        log.debug(\"Fetch: Request aborted.\");\n        return;\n      }\n      if (timeouted) {\n        log.warn(\"Fetch: Request timeouted.\");\n        obs.error(new RequestError(options.url,\n                                   0,\n                                   NetworkErrorTypes.TIMEOUT));\n        return;\n      }\n      log.warn(\"Fetch: Request Error\", err && err.toString());\n      obs.error(new RequestError(options.url,\n                                 0,\n                                 NetworkErrorTypes.ERROR_EVENT));\n      return;\n    });\n\n    return () => {\n      hasAborted = true;\n      abortRequest();\n    };\n  });\n}\n\n/**\n * Returns true if fetch should be supported in the current browser.\n * @return {boolean}\n */\nexport function fetchIsSupported() : boolean {\n  return !!(window.fetch &&\n         _AbortController != null &&\n         _Headers != null);\n}\n\nexport default fetchRequest;\n\n// function fetchRequest(options : IRequestOptions< undefined | null | \"\" | \"text\",\n//                                             false | undefined>)\n//                      : Observable<IRequestResponse< string, \"text\" >>;\n// function fetchRequest(options : IRequestOptions< undefined | null | \"\" | \"text\",\n//                                             true >)\n//                      : Observable<IRequestResponse< string, \"text\" > |\n//                                   IRequestProgress< string > >;\n\n// function fetchRequest(options : IRequestOptions< \"arraybuffer\",\n//                                             false | undefined>)\n//                      : Observable<IRequestResponse< ArrayBuffer, \"arraybuffer\" >>;\n// function fetchRequest(options : IRequestOptions<\"arraybuffer\", true>)\n//                      : Observable<IRequestResponse< ArrayBuffer, \"arraybuffer\" > |\n//                                   IRequestProgress < ArrayBuffer > >;\n//                                   // IRequestProgress |\n//                                   // IRequestDataChunk< ArrayBuffer, \"arraybuffer\" >>;\n\n// function fetchRequest(options : IRequestOptions< \"document\",\n//                                             false | undefined >)\n//                 : Observable<IRequestResponse< Document, \"document\" >>;\n// function fetchRequest(options : IRequestOptions< \"document\",\n//                                             true >)\n//                 : Observable<IRequestResponse< Document, \"document\" > |\n//                              IRequestProgress< undefined > >;\n\n// function fetchRequest(options : IRequestOptions< \"json\",\n//                                             false | undefined >)\n//                 : Observable<IRequestResponse< object, \"json\" >>;\n// function fetchRequest(options : IRequestOptions< \"json\", true >)\n//                 : Observable<IRequestResponse< object, \"json\" > |\n//                              IRequestProgress< undefined > >;\n\n// function fetchRequest(options : IRequestOptions< \"blob\",\n//                                             false|undefined >)\n//                 : Observable<IRequestResponse< Blob, \"blob\" >>;\n// function fetchRequest(options : IRequestOptions<\"blob\", true>)\n//                 : Observable<IRequestResponse< Blob, \"blob\" > |\n//                              IRequestProgress< Blob > >;\n\n// function fetchRequest<T>(\n//   options : IRequestOptions< XMLHttpRequestResponseType | null | undefined,\n//                              false | undefined >)\n//   : Observable<IRequestResponse< T, XMLHttpRequestResponseType >>;\n// function fetchRequest<T>(\n//   options : IRequestOptions< XMLHttpRequestResponseType | null | undefined,\n//                             true >)\n//   : Observable<IRequestResponse< T, XMLHttpRequestResponseType > |\n//                IRequestProgress< T | undefined >\n// >;\n// function fetchRequest<T>(\n//   options : IRequestOptions< XMLHttpRequestResponseType | null | undefined,\n//                             boolean | undefined >\n// ) : Observable<IRequestResponse< T, XMLHttpRequestResponseType > |\n//                IRequestProgress< T | undefined >\n// > {\n// const responseType = !options.responseType ||\n//                      options.responseType === \"document\" ? \"text\" :\n//                                                            options.responseType;\n\n// return (() => {\n//   switch (responseType) {\n//     case \"arraybuffer\":\n//       return response.arrayBuffer();\n//     case \"json\":\n//       return response.json();\n//     case \"blob\":\n//       return response.blob();\n//     case \"text\":\n//       return response.text();\n//   }\n// })().then((responseData) => {\n//   isDone = true;\n//   const receivedTime = performance.now();\n//   obs.next({ type: \"response\" as const,\n//              value: { responseType,\n//                       status: response.status,\n//                       url: response.url,\n//                       sendingTime,\n//                       receivedTime,\n//                duration: receivedTime - sendingTime,\n//                       size: responseData instanceof ArrayBuffer ?\n//                               responseData.byteLength :\n//                               0,\n//                       responseData } });\n// }).catch((err) => {\n//   log.warn(\"Fetch: Request Parsing Error\", err && err.toString());\n//   if (hasAborted) { // is that even possible?\n//     return;\n//   }\n//   obs.error(new RequestError(null,\n//                              response.url,\n//                              response.status,\n//                              NetworkErrorTypes.PARSE_ERROR));\n//   return;\n// });\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Observable } from \"rxjs\";\nimport config from \"../../config\";\nimport { RequestError } from \"../../errors\";\n\nconst { DEFAULT_REQUEST_TIMEOUT } = config;\n\nconst DEFAULT_RESPONSE_TYPE : XMLHttpRequestResponseType = \"json\";\n\n// Interface for \"progress\" events\nexport interface IRequestProgress { type : \"progress\";\n                                    value : { currentTime : number;\n                                              duration : number;\n                                              size : number;\n                                              sendingTime : number;\n                                              url : string;\n                                              totalSize? : number; };\n}\n\n// Interface for \"response\" events\nexport interface IRequestResponse<T, U> { type : \"data-loaded\";\n                                          value : { duration : number;\n                                                    receivedTime : number;\n                                                    responseData : T;\n                                                    responseType : U;\n                                                    sendingTime : number;\n                                                    size : number;\n                                                    status : number;\n                                                    url : string; }; }\n\n// Arguments for the \"request\" utils\nexport interface IRequestOptions<T, U> { url : string;\n                                         headers? : { [ header: string ] : string } |\n                                                    null;\n                                         responseType? : T;\n                                         timeout? : number;\n                                         sendProgressEvents? : U; }\n\n/**\n * @param {string} data\n * @returns {Object|null}\n */\nfunction toJSONForIE(data : string) : unknown|null {\n  try {\n    return JSON.parse(data);\n  } catch (e) {\n    return null;\n  }\n}\n\n/**\n * # request function\n *\n * Translate GET requests into Rx.js Observables.\n *\n * ## Overview\n *\n * Perform the request on subscription.\n * Emit zero, one or more progress event(s) and then the data if the request\n * was successful.\n *\n * Throw if an error happened or if the status code is not in the 200 range at\n * the time of the response.\n * Complete after emitting the data.\n * Abort the xhr on unsubscription.\n *\n * ## Emitted Objects\n *\n * The emitted objects are under the following form:\n * ```\n *   {\n *     type {string}: the type of event\n *     value {Object}: the event value\n *   }\n * ```\n *\n * The type of event can either be \"progress\" or \"data-loaded\". The value is\n * under a different form depending on the type.\n *\n * For \"progress\" events, the value should be the following object:\n * ```\n *   {\n *     url {string}: url on which the request is being done\n *     sendingTime {Number}: timestamp at which the request was sent.\n *     currentTime {Number}: timestamp at which the progress event was\n *                           triggered\n *     size {Number}: current size downloaded, in bytes (without\n *                          overhead)\n *     totalSize {Number|undefined}: total size to download, in bytes\n *                                   (without overhead)\n *   }\n * ```\n *\n * For \"data-loaded\" events, the value should be the following object:\n * ```\n *   {\n *     status {Number}: xhr status code\n *     url {string}: URL on which the request was done (can be different than\n *                   the one given in arguments when we go through\n *                   redirections).\n *     responseType {string}: the responseType of the request\n *                            (e.g. \"json\", \"document\"...).\n *     sendingTime {Number}: time at which the request was sent, in ms.\n *     receivedTime {Number}: timest at which the response was received, in ms.\n *     size {Number}: size of the received data, in bytes.\n *     responseData {*}: Data in the response. Format depends on the\n *                       responseType.\n *   }\n * ```\n *\n * For any successful request you should have 0+ \"progress\" events and 1\n * \"data-loaded\" event.\n *\n * For failing request, you should have 0+ \"progress\" events and 0 \"data-loaded\"\n * event (the Observable will throw before).\n *\n * ## Errors\n *\n * Several errors can be emitted (the Rx.js way). Namely:\n *   - RequestErrorTypes.TIMEOUT_ERROR: the request timeouted (took too long to\n *     respond).\n *   - RequestErrorTypes.PARSE_ERROR: the browser APIs used to parse the\n *                                    data failed.\n *   - RequestErrorTypes.ERROR_HTTP_CODE: the HTTP code at the time of reception\n *                                        was not in the 200-299 (included)\n *                                        range.\n *   - RequestErrorTypes.ERROR_EVENT: The XHR had an error event before the\n *                                    response could be fetched.\n * @param {Object} options\n * @returns {Observable}\n */\n\n// overloading to the max\nfunction request(options : IRequestOptions< undefined | null | \"\" | \"text\",\n                                            false | undefined>)\n                : Observable<IRequestResponse< string, \"text\" >>;\nfunction request(options : IRequestOptions< undefined | null | \"\" | \"text\",\n                                            true >)\n                : Observable<IRequestResponse< string, \"text\" > |\n                             IRequestProgress >;\n\nfunction request(options : IRequestOptions< \"arraybuffer\",\n                                            false | undefined>)\n                : Observable<IRequestResponse< ArrayBuffer, \"arraybuffer\" >>;\nfunction request(options : IRequestOptions<\"arraybuffer\", true>)\n                : Observable<IRequestResponse<ArrayBuffer, \"arraybuffer\"> |\n                             IRequestProgress >;\n\nfunction request(options : IRequestOptions< \"document\",\n                                            false | undefined >)\n                : Observable<IRequestResponse< Document, \"document\" >>;\nfunction request(options : IRequestOptions< \"document\",\n                                            true >)\n                : Observable<IRequestResponse< Document, \"document\" > |\n                             IRequestProgress >;\n\nfunction request(options : IRequestOptions< \"json\",\n                                            false | undefined >)\n                : Observable<IRequestResponse< object, \"json\" >>;\nfunction request(options : IRequestOptions< \"json\", true >)\n                : Observable<IRequestResponse< object, \"json\" > |\n                             IRequestProgress >;\n\nfunction request(options : IRequestOptions< \"blob\",\n                                            false|undefined >)\n                : Observable<IRequestResponse< Blob, \"blob\" >>;\nfunction request(options : IRequestOptions<\"blob\", true>)\n                : Observable<IRequestResponse< Blob, \"blob\" > |\n                             IRequestProgress >;\n\nfunction request<T>(\n  options : IRequestOptions< XMLHttpRequestResponseType | null | undefined,\n                             false | undefined >)\n  : Observable<IRequestResponse< T, XMLHttpRequestResponseType >>;\nfunction request<T>(\n  options : IRequestOptions< XMLHttpRequestResponseType | null | undefined,\n                            true >)\n  : Observable<IRequestResponse< T, XMLHttpRequestResponseType > |\n               IRequestProgress\n>;\nfunction request<T>(\n  options : IRequestOptions< XMLHttpRequestResponseType | null | undefined,\n                            boolean | undefined >\n) : Observable<IRequestResponse< T, XMLHttpRequestResponseType > |\n               IRequestProgress\n> {\n  const requestOptions = {\n    url: options.url,\n    headers: options.headers,\n    responseType: options.responseType == null ? DEFAULT_RESPONSE_TYPE :\n                                                 options.responseType,\n    timeout: options.timeout == null ? DEFAULT_REQUEST_TIMEOUT :\n                                       options.timeout,\n  };\n\n  return new Observable((obs) => {\n    const { url,\n            headers,\n            responseType,\n            timeout } = requestOptions;\n    const xhr = new XMLHttpRequest();\n    xhr.open(\"GET\", url, true);\n\n    if (timeout >= 0) {\n      xhr.timeout = timeout;\n    }\n\n    xhr.responseType = responseType;\n\n    if (xhr.responseType === \"document\") {\n      xhr.overrideMimeType(\"text/xml\");\n    }\n\n    if (headers) {\n      const _headers = headers;\n      for (const key in _headers) {\n        if (_headers.hasOwnProperty(key)) {\n          xhr.setRequestHeader(key, _headers[key]);\n        }\n      }\n    }\n\n    const sendingTime = performance.now();\n\n    xhr.onerror = function onXHRError() {\n      obs.error(new RequestError(url, xhr.status, \"ERROR_EVENT\", xhr));\n    };\n\n    xhr.ontimeout = function onXHRTimeout() {\n      obs.error(new RequestError(url, xhr.status, \"TIMEOUT\", xhr));\n    };\n\n    if (options.sendProgressEvents === true) {\n      xhr.onprogress = function onXHRProgress(event) {\n        const currentTime = performance.now();\n        obs.next({ type: \"progress\",\n                   value: { url,\n                            duration: currentTime - sendingTime,\n                            sendingTime,\n                            currentTime,\n                            size: event.loaded,\n                            totalSize: event.total } });\n      };\n    }\n\n    xhr.onload = function onXHRLoad(event : ProgressEvent) {\n      if (xhr.readyState === 4) {\n        if (xhr.status >= 200 && xhr.status < 300) {\n          const receivedTime = performance.now();\n          const totalSize = xhr.response instanceof\n                              ArrayBuffer ? xhr.response.byteLength :\n                                            event.total;\n          const status = xhr.status;\n          const loadedResponseType = xhr.responseType;\n          const _url = xhr.responseURL || url;\n\n          let responseData : T;\n          if (loadedResponseType === \"json\") {\n            // IE bug where response is string with responseType json\n            responseData = xhr.response !== \"string\" ? xhr.response :\n                                                       toJSONForIE(xhr.responseText);\n          } else {\n            responseData = xhr.response;\n          }\n\n          if (responseData == null) {\n            obs.error(new RequestError(url, xhr.status, \"PARSE_ERROR\", xhr));\n            return;\n          }\n\n          obs.next({ type: \"data-loaded\",\n                     value: { status,\n                              url: _url,\n                              responseType: loadedResponseType,\n                              sendingTime,\n                              receivedTime,\n                              duration: receivedTime - sendingTime,\n                              size: totalSize,\n                              responseData, }, });\n          obs.complete();\n\n        } else {\n          obs.error(new RequestError(url, xhr.status, \"ERROR_HTTP_CODE\", xhr));\n        }\n      }\n    };\n\n    xhr.send();\n    return () => {\n      if (xhr && xhr.readyState !== 4) {\n        xhr.abort();\n      }\n    };\n  });\n}\n\nexport default request;\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport fetchRequest, {\n  fetchIsSupported,\n  IDataChunk,\n  IDataComplete,\n} from \"./fetch\";\nimport xhr, {\n  IRequestOptions,\n  IRequestProgress,\n  IRequestResponse,\n} from \"./xhr\";\n\nexport default xhr;\nexport {\n  fetchIsSupported,\n  fetchRequest,\n  IDataChunk,\n  IDataComplete,\n  IRequestOptions,\n  IRequestProgress,\n  IRequestResponse,\n  xhr,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Observable } from \"rxjs\";\n\nimport {\n  CustomManifestLoader,\n  ILoadedManifest,\n  IManifestLoaderArguments,\n  IManifestLoaderObservable,\n  IManifestLoaderObserver,\n} from \"../types\";\n\nexport default function callCustomManifestLoader(\n  customManifestLoader : CustomManifestLoader,\n  fallbackManifestLoader : (x : IManifestLoaderArguments) =>\n                             IManifestLoaderObservable\n) : (x : IManifestLoaderArguments) => IManifestLoaderObservable {\n\n  return (args : IManifestLoaderArguments) : IManifestLoaderObservable => {\n    return new Observable((obs: IManifestLoaderObserver) => {\n      const { url } = args;\n      const timeAPIsDelta = Date.now() - performance.now();\n      let hasFinished = false;\n      let hasFallbacked = false;\n\n      /**\n       * Callback triggered when the custom manifest loader has a response.\n       * @param {Object} args\n       */\n      const resolve = (_args : { data : ILoadedManifest;\n                                 size? : number;\n                                 duration? : number;\n                                 url? : string;\n                                 receivingTime? : number;\n                                 sendingTime? : number; }) =>\n      {\n        if (!hasFallbacked) {\n          hasFinished = true;\n          const receivedTime =\n            _args.receivingTime != null ? _args.receivingTime - timeAPIsDelta :\n            undefined;\n          const sendingTime =\n            _args.sendingTime != null ? _args.sendingTime - timeAPIsDelta :\n            undefined;\n\n          obs.next({ type: \"data-loaded\",\n                     value: { responseData: _args.data,\n                              size: _args.size,\n                              duration: _args.duration,\n                              url: _args.url,\n                              receivedTime, sendingTime } });\n          obs.complete();\n        }\n      };\n\n      /**\n       * Callback triggered when the custom manifest loader fails\n       * @param {*} err - The corresponding error encountered\n       */\n      const reject = (err : unknown) : void => {\n        if (!hasFallbacked) {\n          hasFinished = true;\n          obs.error(err);\n        }\n      };\n\n      /**\n       * Callback triggered when the custom manifest loader wants to fallback to\n       * the \"regular\" implementation\n       */\n      const fallback = () => {\n        hasFallbacked = true;\n        fallbackManifestLoader(args).subscribe(obs);\n      };\n\n      const callbacks = { reject, resolve, fallback };\n      const abort = customManifestLoader(url, callbacks);\n\n      return () => {\n        if (!hasFinished && !hasFallbacked && typeof abort === \"function\") {\n          abort();\n        }\n      };\n    });\n  };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport request from \"../../utils/request\";\nimport {\n  CustomManifestLoader,\n  IManifestLoaderArguments,\n  IManifestLoaderObservable,\n} from \"../types\";\nimport callCustomManifestLoader from \"./call_custom_manifest_loader\";\n\n/**\n * Manifest loader triggered if there was no custom-defined one in the API.\n * @param {string} url\n * @returns {Observable}\n */\nfunction regularManifestLoader(\n  { url } : IManifestLoaderArguments\n) : IManifestLoaderObservable {\n  if (url == null) {\n    throw new Error(\"Cannot perform HTTP(s) request. URL not known\");\n  }\n  return request({ url, responseType: \"document\" });\n}\n\n/**\n * Generate a manifest loader for the application\n * @param {Function} [customManifestLoader]\n * @returns {Function}\n */\nexport default function generateManifestLoader(\n   { customManifestLoader } : { customManifestLoader?: CustomManifestLoader }\n) : (x : IManifestLoaderArguments) => IManifestLoaderObservable {\n  if (customManifestLoader == null) {\n    return regularManifestLoader;\n  }\n  return callCustomManifestLoader(customManifestLoader,\n                                  regularManifestLoader);\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIE OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport features from \"./index\";\nimport { IFeatureFunction } from \"./types\";\n\n/**\n * @param {Array.<Object>} featureFuncList\n */\nexport default function addFeatures(featureFuncList : IFeatureFunction[]) : void {\n  for (let i = 0; i < featureFuncList.length; i++) {\n    const addFeature = featureFuncList[i];\n    if (typeof addFeature !== \"function\") {\n      throw new Error(\"Unrecognized feature\");\n    }\n    addFeature(features);\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Observable } from \"rxjs\";\nimport { ICustomSourceBuffer } from \"../compat\";\nimport {\n  IEMEManagerEvent,\n  IKeySystemOption,\n} from \"../core/eme\";\nimport {\n  IDirectfileEvent,\n  IDirectFileOptions,\n} from \"../core/init/initialize_directfile\";\nimport {\n  IHTMLTextTracksParserFn,\n  INativeTextTracksParserFn,\n} from \"../parsers/texttracks\";\nimport { ITransportFunction } from \"../transports\";\n\nexport type IDirectFileInit = (args : IDirectFileOptions) =>\n                                Observable<IDirectfileEvent>;\n\nexport type IEMEManager = (mediaElement : HTMLMediaElement,\n                           keySystems: IKeySystemOption[]) =>\n                             Observable<IEMEManagerEvent>;\n\nexport type INativeTextTracksBuffer =\n  new(mediaElement : HTMLMediaElement,\n      hideNativeSubtitle: boolean) => ICustomSourceBuffer<unknown>;\n\nexport type IHTMLTextTracksBuffer =\n  new(mediaElement : HTMLMediaElement,\n      textTrackElement: HTMLElement) => ICustomSourceBuffer<unknown>;\n\ninterface IBifThumbnail { index : number;\n                          duration : number;\n                          ts : number;\n                          data : Uint8Array; }\n\ninterface IImageTrackSegmentData {\n  data : IBifThumbnail[]; // image track data, in the given type\n  end : number; // end time time until which the segment apply\n  start : number; // start time from which the segment apply\n  timescale : number; // timescale to convert the start and end into seconds\n  type : string; // the type of the data (example: \"bif\")\n}\n\ninterface IBifObject { fileFormat : string;\n                       version : string;\n                       imageCount : number;\n                       timescale : number;\n                       format : string;\n                       width : number;\n                       height : number;\n                       aspectRatio : string;\n                       isVod : boolean;\n                       thumbs : IBifThumbnail[]; }\n\nexport type IImageBuffer = new() => ICustomSourceBuffer<IImageTrackSegmentData>;\n\nexport type IImageParser =\n  ((buffer : Uint8Array) => IBifObject);\n\n// interface of the global `features` object through which features are\n// accessed.\nexport interface IFeaturesObject {\n  transports : Partial<Record<string, ITransportFunction>>;\n  imageBuffer : IImageBuffer|null;\n  imageParser : IImageParser|null;\n  nativeTextTracksBuffer : INativeTextTracksBuffer|null;\n  nativeTextTracksParsers : Partial<Record<string, INativeTextTracksParserFn>>;\n  htmlTextTracksBuffer : IHTMLTextTracksBuffer|null;\n  htmlTextTracksParsers : Partial<Record<string, IHTMLTextTracksParserFn>>;\n  emeManager : IEMEManager|null;\n  directfile : IDirectFileInit|null;\n}\n\nexport type IFeatureFunction = (features : IFeaturesObject) => void;\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * File allowing feature-switching.\n *\n * Every optional feature is included here.\n * They all should subsequently be accessed in the code through the exported\n * `features` object.\n *\n * The then exported features object will be used dynamically to know which\n * features are activated.\n *\n * This also lazy-feature loading, where this exported object can be updated\n * at runtime, to allow some new features even if the player instance has\n * already have been instanciated.\n */\n\nimport addFeatures from \"./add_features\";\nimport {\n  IFeatureFunction,\n  IFeaturesObject,\n} from \"./types\";\n\n/**\n * Initial features object, with no feature activated by default.\n * @type {Object}\n */\nconst features : IFeaturesObject = { transports: {},\n                                     imageBuffer: null,\n                                     imageParser: null,\n                                     nativeTextTracksBuffer: null,\n                                     nativeTextTracksParsers: {},\n                                     htmlTextTracksBuffer: null,\n                                     htmlTextTracksParsers: {},\n                                     emeManager: null,\n                                     directfile: null };\n\nexport default features;\nexport {\n  addFeatures,\n  IFeatureFunction,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { of as observableOf } from \"rxjs\";\nimport features from \"../../features\";\nimport request from \"../../utils/request\";\nimport {\n  IImageParserObservable,\n  ISegmentLoaderArguments,\n  ISegmentLoaderObservable,\n  ISegmentParserArguments,\n} from \"../types\";\n\n/**\n * @param {Object} args\n * @returns {Observable}\n */\nexport function imageLoader(\n  { segment } : ISegmentLoaderArguments\n) : ISegmentLoaderObservable< ArrayBuffer | null > {\n  if (segment.isInit || segment.mediaURL == null) {\n    return observableOf({ type: \"data-created\" as const,\n                          value: { responseData: null } });\n  }\n  const { mediaURL } = segment;\n  return request({ url: mediaURL,\n                   responseType: \"arraybuffer\",\n                   sendProgressEvents: true });\n}\n\n/**\n * @param {Object} args\n * @returns {Observable}\n */\nexport function imageParser(\n  { response,\n    content } : ISegmentParserArguments<Uint8Array|ArrayBuffer|null>\n) : IImageParserObservable {\n  const { segment, period } = content;\n  const { data, isChunked } = response;\n\n  if (isChunked) {\n    throw new Error(\"Image data should not be downloaded in chunks\");\n  }\n\n  // TODO image Parsing should be more on the sourceBuffer side, no?\n  if (data === null || features.imageParser == null) {\n    return observableOf({ chunkData: null,\n                          chunkInfos: segment.timescale > 0 ?\n                            { duration: segment.isInit ? 0 : segment.duration,\n                              time: segment.isInit ? -1 : segment.time,\n                              timescale: segment.timescale } :\n                            null,\n                          chunkOffset: segment.timestampOffset || 0,\n                          appendWindow: [period.start, period.end] });\n  }\n\n  const bifObject = features.imageParser(new Uint8Array(data));\n  const thumbsData = bifObject.thumbs;\n  return observableOf({ chunkData: { data: thumbsData,\n                                       start: 0,\n                                       end: Number.MAX_VALUE,\n                                       timescale: 1,\n                                       type: \"bif\" },\n                        chunkInfos: { time: 0,\n                                        duration: Number.MAX_VALUE,\n                                        timescale: bifObject.timescale },\n                        chunkOffset: segment.timestampOffset || 0,\n                        appendWindow: [period.start, period.end] });\n}\n","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Array.prototype.find ponyfill.\n * @param {Array} arr\n * @param {Function} predicate\n * @param {*} context\n * @returns {boolean}\n */\nexport default function arrayFind<T>(\n    arr : T[],\n    predicate : (arg: T, index : number, arr : T[]) => boolean,\n    thisArg? : any\n) : T | undefined {\n  if (typeof (Array.prototype as any).find === \"function\") {\n    /* tslint:disable ban */\n    return (arr as any).find(predicate, thisArg);\n    /* tslint:enable ban */\n  }\n\n  const len = arr.length >>> 0;\n  for (let i = 0; i < len; i++) {\n    const val = arr[i];\n    if (predicate.call(thisArg, val, i, arr)) {\n      return val;\n    }\n  }\n  return undefined;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Array.prototype.includes ponyfill.\n * Returns ``true`` if the given array ``arr`` contains the element\n * ``searchElement``. false ``otherwise``.\n *\n * Inspired from MDN polyfill, but ponyfilled instead\n *\n * @example\n * ```js\n * arrayIncludes([1, 2, 3], 3);\n * // => true\n *\n * arrayIncludes([1, 2, 3], 7);\n * // => false\n *\n * const obj = { a: 4 };\n * arrayIncludes([obj, { b: 7 }, { a: 3 }, obj);\n * // => true\n *\n * // does not perform deep equality\n * arrayIncludes([{ a: 4 }, { b: 7 }, { a: 3 }, { a: 4 });\n * // => false\n *\n * // the third argument state the starting index. 0 if not set.\n *\n * arrayIncludes([1, 2, 3], 2, 1);\n * // => true\n *\n * arrayIncludes([1, 2, 3], 2, 2);\n * // => false\n * ```\n *\n * @param {Array} arr\n * @param {*} searchElement\n * @param {number} [fromIndex]\n * @returns {boolean}\n */\nexport default function arrayIncludes<T>(\n  arr : T[],\n  searchElement : T,\n  fromIndex? : number\n) : boolean {\n  /* tslint:disable no-unbound-method */\n  if (typeof Array.prototype.includes === \"function\") {\n  /* tslint:enable no-unbound-method */\n    /* tslint:disable ban */\n    return arr.includes(searchElement, fromIndex);\n    /* tslint:enable ban */\n  }\n\n  const len = arr.length >>> 0;\n\n  if (len === 0) {\n    return false;\n  }\n\n  const n = (fromIndex as number) | 0;\n  let k = n >= 0 ?\n    Math.min(n, len - 1) :\n    Math.max(len + n, 0);\n\n  const areTheSame = (x : T, y : T) =>\n                       x === y ||\n                       // Viva las JavaScriptas!\n                       (\n                         typeof x === \"number\" &&\n                         typeof y === \"number\" &&\n                         isNaN(x) && isNaN(y));\n\n  while (k < len) {\n    if (areTheSame(arr[k], searchElement)) {\n      return true;\n    }\n    k++;\n  }\n\n  return false;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Translate ISO 639-1 language codes into ISO 639-3 ones.\n */\nconst ISO_MAP_1_TO_3 : { [ lang : string ] : string } = {\n  aa: \"aar\", // Afar\n  ab: \"abk\", // Abkhazian\n  ae: \"ave\", // Avestan\n  af: \"afr\", // Afrikaans\n  ak: \"aka\", // Akan\n  am: \"amh\", // Amharic\n  an: \"arg\", // Aragonese\n  ar: \"ara\", // Arabic\n  as: \"asm\", // Assamese\n  av: \"ava\", // Avaric\n  ay: \"aym\", // Aymara\n  az: \"aze\", // Azerbaijani\n  ba: \"bak\", // Bashkir\n  be: \"bel\", // Belarusian\n  bg: \"bul\", // Bulgarian\n  bi: \"bis\", // Bislama\n  bm: \"bam\", // Bambara\n  bn: \"ben\", // Bengali\n  bo: \"bod\", // Tibetan\n  br: \"bre\", // Breton\n  bs: \"bos\", // Bosnian\n  ca: \"cat\", // Catalan, Valencian\n  ce: \"che\", // Chechen\n  ch: \"cha\", // Chamorro\n  co: \"cos\", // Corsican\n  cr: \"cre\", // Cree\n  cs: \"ces\", // Czech\n  cu: \"chu\", // Church Slavic, Church Slavonic, Old Church Slavonic,\n             // Old Slavonic, Old Bulgarian\n  cv: \"chv\", // Chuvash\n  cy: \"cym\", // Welsh\n  da: \"dan\", // Danish\n  de: \"deu\", // German\n  dv: \"div\", // Divehi, Dhivehi, Maldivian\n  dz: \"dzo\", // Dzongkha\n  ee: \"ewe\", // Ewe\n  el: \"ell\", // Greek (modern)\n  en: \"eng\", // English\n  eo: \"epo\", // Esperanto\n  es: \"spa\", // Spanish, Castilian\n  et: \"est\", // Estonian\n  eu: \"eus\", // Basque\n  fa: \"fas\", // Persian\n  ff: \"ful\", // Fulah\n  fi: \"fin\", // Finnish\n  fj: \"fij\", // Fijian\n  fo: \"fao\", // Faroese\n  fr: \"fra\", // French\n  fy: \"fry\", // Western Frisian\n  ga: \"gle\", // Irish\n  gd: \"gla\", // Gaelic, Scottish Gaelic\n  gl: \"glg\", // Galician\n  gn: \"grn\", // Guaran\n  gu: \"guj\", // Gujarati\n  gv: \"glv\", // Manx\n  ha: \"hau\", // Hausa\n  he: \"heb\", // Hebrew (modern)\n  hi: \"hin\", // Hindi\n  ho: \"hmo\", // Hiri Motu\n  hr: \"hrv\", // Croatian\n  ht: \"hat\", // Haitian, Haitian Creole\n  hu: \"hun\", // Hungarian\n  hy: \"hye\", // Armenian\n  hz: \"her\", // Herero\n  ia: \"ina\", // Interlingua\n  id: \"ind\", // Indonesian\n  ie: \"ile\", // Interlingue\n  ig: \"ibo\", // Igbo\n  ii: \"iii\", // Sichuan Yi, Nuosu\n  ik: \"ipk\", // Inupiaq\n  io: \"ido\", // Ido\n  is: \"isl\", // Icelandic\n  it: \"ita\", // Italian\n  iu: \"iku\", // Inuktitut\n  ja: \"jpn\", // Japanese\n  jv: \"jav\", // Javanese\n  ka: \"kat\", // Georgian\n  kg: \"kon\", // Kongo\n  ki: \"kik\", // Kikuyu, Gikuyu\n  kj: \"kua\", // Kuanyama, Kwanyama\n  kk: \"kaz\", // Kazakh\n  kl: \"kal\", // Kalaallisut, Greenlandic\n  km: \"khm\", // Central Khmer\n  kn: \"kan\", // Kannada\n  ko: \"kor\", // Korean\n  kr: \"kau\", // Kanuri\n  ks: \"kas\", // Kashmiri\n  ku: \"kur\", // Kurdish\n  kv: \"kom\", // Komi\n  kw: \"cor\", // Cornish\n  ky: \"kir\", // Kirghiz, Kyrgyz\n  la: \"lat\", // Latin\n  lb: \"ltz\", // Luxembourgish, Letzeburgesch\n  lg: \"lug\", // Ganda\n  li: \"lim\", // Limburgan, Limburger, Limburgish\n  ln: \"lin\", // Lingala\n  lo: \"lao\", // Lao\n  lt: \"lit\", // Lithuanian\n  lu: \"lub\", // Luba-Katanga\n  lv: \"lav\", // Latvian\n  mg: \"mlg\", // Malagasy\n  mh: \"mah\", // Marshallese\n  mi: \"mri\", // Maori\n  mk: \"mkd\", // Macedonian\n  ml: \"mal\", // Malayalam\n  mn: \"mon\", // Mongolian\n  mr: \"mar\", // Marathi\n  ms: \"msa\", // Malay\n  mt: \"mlt\", // Maltese\n  my: \"mya\", // Burmese\n  na: \"nau\", // Nauru\n  nb: \"nob\", // Norwegian Bokml\n  nd: \"nde\", // North Ndebele\n  ne: \"nep\", // Nepali\n  ng: \"ndo\", // Ndonga\n  nl: \"nld\", // Dutch, Flemish\n  nn: \"nno\", // Norwegian Nynorsk\n  no: \"nor\", // Norwegian\n  nr: \"nbl\", // South Ndebele\n  nv: \"nav\", // Navajo, Navaho\n  ny: \"nya\", // Chichewa, Chewa, Nyanja\n  oc: \"oci\", // Occitan\n  oj: \"oji\", // Ojibwa\n  om: \"orm\", // Oromo\n  or: \"ori\", // Oriya\n  os: \"oss\", // Ossetian, Ossetic\n  pa: \"pan\", // Panjabi, Punjabi\n  pi: \"pli\", // Pali\n  pl: \"pol\", // Polish\n  ps: \"pus\", // Pashto, Pushto\n  pt: \"por\", // Portuguese\n  qu: \"que\", // Quechua\n  rm: \"roh\", // Romansh\n  rn: \"run\", // Rundi\n  ro: \"ron\", // Romanian, Moldavian, Moldovan\n  ru: \"rus\", // Russian\n  rw: \"kin\", // Kinyarwanda\n  sa: \"san\", // Sanskrit\n  sc: \"srd\", // Sardinian\n  sd: \"snd\", // Sindhi\n  se: \"sme\", // Northern Sami\n  sg: \"sag\", // Sango\n  si: \"sin\", // Sinhala, Sinhalese\n  sk: \"slk\", // Slovak\n  sl: \"slv\", // Slovenian\n  sm: \"smo\", // Samoan\n  sn: \"sna\", // Shona\n  so: \"som\", // Somali\n  sq: \"sqi\", // Albanian\n  sr: \"srp\", // Serbian\n  ss: \"ssw\", // Swati\n  st: \"sot\", // Southern Sotho\n  su: \"sun\", // Sundanese\n  sv: \"swe\", // Swedish\n  sw: \"swa\", // Swahili\n  ta: \"tam\", // Tamil\n  te: \"tel\", // Telugu\n  tg: \"tgk\", // Tajik\n  th: \"tha\", // Thai\n  ti: \"tir\", // Tigrinya\n  tk: \"tuk\", // Turkmen\n  tl: \"tgl\", // Tagalog\n  tn: \"tsn\", // Tswana\n  to: \"ton\", // Tonga (Tonga Islands)\n  tr: \"tur\", // Turkish\n  ts: \"tso\", // Tsonga\n  tt: \"tat\", // Tatar\n  tw: \"twi\", // Twi\n  ty: \"tah\", // Tahitian\n  ug: \"uig\", // Uighur, Uyghur\n  uk: \"ukr\", // Ukrainian\n  ur: \"urd\", // Urdu\n  uz: \"uzb\", // Uzbek\n  ve: \"ven\", // Venda\n  vi: \"vie\", // Vietnamese\n  vo: \"vol\", // Volapk\n  wa: \"wln\", // Walloon\n  wo: \"wol\", // Wolof\n  xh: \"xho\", // Xhosa\n  yi: \"yid\", // Yiddish\n  yo: \"yor\", // Yoruba\n  za: \"zha\", // Zhuang, Chuang\n  zh: \"zho\", // Chinese\n  zu: \"zul\", // Zulu\n};\n\nexport default ISO_MAP_1_TO_3;\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Translate ISO 639-2 synonyms to their ISO 639-3 counterparts.\n */\nconst ISO_MAP_2_TO_3 : { [ lang : string ] : string } = {\n  alb: \"sqi\", // Albanian\n  arm: \"hye\", // Armenian\n  baq: \"eus\", // Basque\n  bur: \"mya\", // Burmese\n  chi: \"zho\", // Chinese\n  cze: \"ces\", // Czech\n  dut: \"nld\", // Dutch; Flemish\n  fre: \"fra\", // French\n  geo: \"kat\", // Georgian\n  ger: \"deu\", // German\n  gre: \"ell\", // Modern Greek (1453)\n  ice: \"isl\", // Icelandic\n  mac: \"mkd\", // Macedonian\n  mao: \"mri\", // Maori\n  may: \"msa\", // Malay\n  per: \"fas\", // Persian\n  slo: \"slk\", // Slovak\n  rum: \"ron\", // Moldovan\n  tib: \"bod\", // Tibetan\n  wel: \"cym\", // Welsh\n};\n\nexport default ISO_MAP_2_TO_3;\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ISO_MAP_1_TO_3 from \"./ISO_639-1_to_ISO_639-3\";\nimport ISO_MAP_2_TO_3 from \"./ISO_639-2_to_ISO_639-3\";\n\ninterface IMinimalAudioTrackObject { language: string;\n                                     audioDescription?: boolean; }\n\ninterface IMinimalTextTrackObject { language: string;\n                                    closedCaption?: boolean; }\n\ninterface INormalizedAudioTrackObject\n          extends IMinimalAudioTrackObject { normalized: string;\n                                             audioDescription : boolean; }\n\ninterface INormalizedTextTrackObject\n          extends IMinimalTextTrackObject { normalized: string;\n                                            closedCaption : boolean; }\n/**\n * Normalize language given.\n * Basically:\n *   - converts it to lowercase.\n *   - normalize \"base\" (what is before the possible first \"-\") to an ISO639-3\n *     compatible string.\n * @param {string} _language\n * @returns {string}\n */\nfunction normalizeLanguage(_language : string) : string {\n  if (_language == null || _language === \"\") {\n    return \"\";\n  }\n  const fields = (\"\" + _language).toLowerCase().split(\"-\");\n  const base = fields[0];\n  const normalizedBase = normalizeBase(base);\n  if (normalizedBase) {\n    return normalizedBase;\n  }\n  return _language;\n}\n\n/**\n * Normalize language into an ISO639-3 format.\n * Returns undefined if it failed to do so\n * @param {string} base\n * @returns {string}\n */\nfunction normalizeBase(base : string) : string|undefined {\n  let result;\n  switch (base.length) {\n    case 2:\n      result = ISO_MAP_1_TO_3[base];\n      break;\n    case 3:\n      result = ISO_MAP_2_TO_3[base];\n      break;\n  }\n  return result;\n}\n\n/**\n * Normalize text track from a user given input into an object\n * with three properties:\n *   - language {string}: The language the user gave us\n *   - normalized {string}: An attempt to normalize the language into an\n *     ISO 639-3 code\n *   - closedCaption {Boolean}: Whether the track is a closed caption track\n * @param {Object|string|null|undefined} _language\n * @returns {Object|null|undefined}\n */\nfunction normalizeTextTrack(\n  _language : string|IMinimalTextTrackObject|null|undefined\n) : INormalizedTextTrackObject|null|undefined {\n  if (_language != null) {\n    let language;\n    let closedCaption;\n    if (typeof _language === \"string\") {\n      language = _language;\n      closedCaption = false;\n    } else {\n      language = _language.language;\n      closedCaption = !!_language.closedCaption;\n    }\n\n    return { language,\n             closedCaption,\n             normalized: normalizeLanguage(language) };\n  }\n\n  return _language;\n}\n\n/**\n * Normalize audio track from a user given input into an object\n * with three properties:\n *   - language {string}: The language the user gave us\n *   - normalized {string}: An attempt to normalize the language into an\n *     ISO 639-3 code\n *   - audioDescription {Boolean}: Whether the track is a closed caption track\n * @param {Object|string|null|undefined} _language\n * @returns {Object|null|undefined}\n */\nfunction normalizeAudioTrack(\n  _language : string|IMinimalAudioTrackObject|null|undefined\n) : INormalizedAudioTrackObject|null|undefined {\n  if (_language != null) {\n    let language;\n    let audioDescription;\n    if (typeof _language === \"string\") {\n      language = _language;\n      audioDescription = false;\n    } else {\n      language = _language.language;\n      audioDescription = !!_language.audioDescription;\n    }\n\n    return { language,\n             audioDescription,\n             normalized: normalizeLanguage(language) };\n  }\n\n  return _language;\n}\n\nexport default normalizeLanguage;\nexport {\n  normalizeAudioTrack,\n  normalizeTextTrack,\n  INormalizedTextTrackObject,\n  INormalizedAudioTrackObject,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport normalizeLanguage, {\n  INormalizedAudioTrackObject,\n  INormalizedTextTrackObject,\n  normalizeAudioTrack,\n  normalizeTextTrack,\n} from \"./normalize\";\nexport default normalizeLanguage;\nexport {\n  INormalizedAudioTrackObject,\n  INormalizedTextTrackObject,\n  normalizeAudioTrack,\n  normalizeTextTrack,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Uniq implementation by combining a filter and an indexOf.\n * @param {Array.<*>} arr\n * @returns {Array.<*>}\n */\nfunction uniqFromFilter<T>(arr: T[]) : T[] {\n  return arr.filter((val, i, self) => self.indexOf(val) === i);\n}\n\n/**\n * Uniq implementation by using the Set browser API.\n * @param {Array.<*>} arr\n * @returns {Array.<*>}\n */\nfunction uniqFromSet<T>(arr: T[]) : T[] {\n  return Array.from(new Set(arr));\n}\n\n/**\n * Returns the input array without duplicates values.\n * All values are unique.\n * @param {Array.<*>} arr\n * @returns {Array.<*>}\n */\nexport default typeof (window as any).Set === \"function\" ? uniqFromSet :\n                                                           uniqFromFilter;\nexport {\n  uniqFromFilter,\n  uniqFromSet,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// true on IE11\n// false on Edge and other IEs/browsers.\nconst isIE11 : boolean = !!(window as any).MSInputMethodContext &&\n                         !!(document as any).documentMode;\n\n// true for IE / Edge\nconst isIEOrEdge : boolean = navigator.appName === \"Microsoft Internet Explorer\" ||\n                             navigator.appName === \"Netscape\" &&\n                             /(Trident|Edge)\\//.test(navigator.userAgent);\n\nconst isFirefox : boolean = navigator.userAgent.toLowerCase()\n                                               .indexOf(\"firefox\") !== -1;\n\nconst isSamsungBrowser : boolean = /SamsungBrowser/.test(navigator.userAgent);\n\nconst isSafari : boolean = /Safari/i.test(navigator.userAgent);\n\nexport {\n  isIE11,\n  isIEOrEdge,\n  isFirefox,\n  isSafari,\n  isSamsungBrowser,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ICompatTextTrack } from \"./browser_compatibility_types\";\nimport { isIEOrEdge } from \"./browser_detection\";\n\n/**\n * Add text track to the given media element.\n * Returns an object with the following properties:\n *   - track {TextTrack}: the added text track\n *   - trackElement {HTMLElement|undefined}: the added <track> element.\n *     undefined if no trackElement was added.\n *\n * @param {HTMLMediaElement} mediaElement\n * @param {Boolean} hidden\n * @returns {Object}\n */\nexport default function addTextTrack(\n  mediaElement : HTMLMediaElement,\n  hidden : boolean\n) : { track : ICompatTextTrack;\n      trackElement? : HTMLTrackElement; }\n{\n  let track;\n  let trackElement;\n\n  const kind = \"subtitles\";\n\n  if (isIEOrEdge) {\n    const tracksLength = mediaElement.textTracks.length;\n    track = tracksLength > 0 ? mediaElement.textTracks[tracksLength - 1] :\n                               mediaElement.addTextTrack(kind);\n    track.mode = hidden ? track.HIDDEN :\n                          track.SHOWING;\n  } else {\n    trackElement = document.createElement(\"track\");\n    mediaElement.appendChild(trackElement);\n    track = trackElement.track;\n    trackElement.kind = kind;\n    track.mode = hidden ? \"hidden\" : \"showing\";\n  }\n  return { track, trackElement };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isSafari } from \"./browser_detection\";\n\n// On Safari 12.1, it seems that since fairplay CDM implementation\n// within the browser is not standard with EME w3c current spec, the\n// requestMediaKeySystemAccess API doesn't resolve positively, even\n// if the drm (fairplay in most cases) is supported.\nexport default function shouldUseWebKitMediaKeys() {\n  return isSafari && (window as any).WebKitMediaKeys != null;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { MediaError } from \"../errors\";\nimport shouldUseWebKitMediaKeys from \"./should_use_webkit_media_keys\";\n\n// regular MediaKeys type + optional functions present in IE11\ninterface ICompatMediaKeysConstructor {\n  isTypeSupported? : (type : string) => boolean; // IE11 only\n  new(keyType? : string) : MediaKeys; // argument for IE11 only\n}\n\n// Regular VTTCue as present in most browsers\n// TODO open TypeScript issue about it?\ntype ICompatVTTCueConstructor = new(start : number,\n                                    end : number,\n                                    cueText : string) => ICompatVTTCue;\n\ninterface ICompatVTTCue { align : string;\n                          endTime : number;\n                          id : string;\n                          line : number|\"auto\";\n                          lineAlign : string;\n                          position : number|\"auto\";\n                          positionAlign : string;\n                          size : number|string;\n                          snapToLines : boolean;\n                          startTime : number;\n                          vertical : string; }\n\n// surcharge TextTrack to allow adding ICompatVTTCue to it\ninterface ICompatTextTrack extends TextTrack {\n  addCue(cue: TextTrackCue|ICompatVTTCue) : void;\n  removeCue(cue: TextTrackCue|ICompatVTTCue) : void;\n}\n\n// Document with added optional functions for old browsers\ninterface ICompatDocument extends Document { mozCancelFullScreen? : () => void;\n                                             mozFullScreenElement? : HTMLElement;\n                                             mozHidden? : boolean;\n                                             msExitFullscreen? : () => void;\n                                             webkitExitFullscreen : () => void;\n                                             fullscreenElement : Element|null;\n                                             msFullscreenElement? : Element|null;\n                                             webkitFullscreenElement : Element|null;\n                                             msHidden? : boolean;\n                                             webkitHidden? : boolean; }\n\n// Element with added optional functions for old browsers\ninterface ICompatHTMLMediaElement extends HTMLMediaElement {\n  mozRequestFullScreen? : () => void;\n  msRequestFullscreen? : () => void;\n  webkitRequestFullscreen : () => void;\n}\n\n// for some reasons, Typescript seem to forget about SessionTypes\n// XXX TODO remove when the issue is resolved\n// https://github.com/Microsoft/TypeScript/issues/19189\ninterface ICompatMediaKeySystemAccess extends MediaKeySystemAccess {\n  getConfiguration() : ICompatMediaKeySystemConfiguration;\n}\ninterface ICompatMediaKeySystemConfiguration {\n  audioCapabilities?: MediaKeySystemMediaCapability[];\n  distinctiveIdentifier?: MediaKeysRequirement;\n  initDataTypes?: string[];\n  persistentState?: MediaKeysRequirement;\n  videoCapabilities?: MediaKeySystemMediaCapability[];\n  sessionTypes?: string[];\n}\n\n// Draft from W3C https://wicg.github.io/picture-in-picture/#pictureinpicturewindow\nexport interface ICompatPictureInPictureWindow\n  extends EventTarget { width: number;\n                        height: number; }\n\nconst win = window as any;\nconst HTMLElement_ : typeof HTMLElement = win.HTMLElement;\nconst VTTCue_ : ICompatVTTCueConstructor|undefined = win.VTTCue ||\n                                                     win.TextTrackCue;\n\nconst MediaSource_ : typeof MediaSource|undefined = win.MediaSource ||\n                                                    win.MozMediaSource ||\n                                                    win.WebKitMediaSource ||\n                                                    win.MSMediaSource;\n\nconst MediaKeys_ : ICompatMediaKeysConstructor|undefined = (() => {\n  if (shouldUseWebKitMediaKeys()) {\n    return win.WebKitMediaKeys;\n  }\n  return win.MediaKeys ||\n         win.MSMediaKeys ||\n         win.MozMediaKeys ||\n         win.WebKitMediaKeys ||\n         class {\n           public readonly create : () => never;\n           public readonly isTypeSupported : () => never;\n           public readonly createSession : () => never;\n           public readonly setServerCertificate : () => never;\n           constructor() {\n            const noMediaKeys = () => {\n              throw new MediaError(\"MEDIA_KEYS_NOT_SUPPORTED\",\n                                   \"No `MediaKeys` implementation found \" +\n                                   \"in the current browser.\");\n            };\n             this.create = noMediaKeys;\n             this.createSession = noMediaKeys;\n             this.isTypeSupported = noMediaKeys;\n             this.setServerCertificate = noMediaKeys;\n           }\n         };\n})();\n\nconst READY_STATES = { HAVE_NOTHING: 0,\n                       HAVE_METADATA: 1,\n                       HAVE_CURRENT_DATA: 2,\n                       HAVE_FUTURE_DATA: 3,\n                       HAVE_ENOUGH_DATA: 4 };\n\nexport {\n  HTMLElement_,\n  ICompatDocument,\n  ICompatHTMLMediaElement,\n  ICompatMediaKeySystemAccess,\n  ICompatMediaKeySystemConfiguration,\n  ICompatMediaKeysConstructor,\n  ICompatTextTrack,\n  ICompatVTTCue,\n  ICompatVTTCueConstructor,\n  MediaKeys_,\n  MediaSource_,\n  READY_STATES,\n  VTTCue_,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isIEOrEdge } from \"./browser_detection\";\n\n/**\n * TODO(pierre): fix patchSegmentInPlace to work with IE11. Maybe\n * try to put free atom inside traf children\n *\n * Returns true if the current target is tolerant enough for us to\n * simply be able to \"patch\" an ISOBMFF segment or if we have to create a\n * new one from scratch instead.\n * @returns {Boolean}\n */\nexport default function canPatchISOBMFFSegment() : boolean {\n  return !isIEOrEdge;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../log\";\nimport { IEventEmitter } from \"../utils/event_emitter\";\n\ninterface ICustomSourceBufferEvents { updatestart : Event|undefined;\n                                      update : Event|undefined;\n                                      updateend : Event|undefined;\n                                      error : Event; }\n\nexport interface ICustomSourceBuffer<T>\n  extends IEventEmitter<ICustomSourceBufferEvents> {\n    buffered : TimeRanges;\n    changeType? : (type: string) => void;\n    updating : boolean;\n    appendWindowStart : number;\n    appendWindowEnd : number;\n    timestampOffset : number;\n    appendBuffer(data : T) : void;\n    remove(from : number, to : number) : void;\n    abort() : void;\n  }\n\n/**\n * If the changeType MSE API is implemented, update the current codec of the\n * SourceBuffer and return true if it succeeded.\n * In any other cases, return false.\n * @param {Object} sourceBuffer\n * @param {string} codec\n * @returns {boolean}\n */\nexport default function tryToChangeSourceBufferType(\n  sourceBuffer : ICustomSourceBuffer<unknown>,\n  codec : string\n) : boolean {\n  if (typeof sourceBuffer.changeType === \"function\") {\n    try {\n      sourceBuffer.changeType(codec);\n    } catch (e) {\n      log.warn(\"Could not call 'changeType' on the given SourceBuffer:\", e);\n      return false;\n    }\n    return true;\n  }\n  return false;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../log\";\nimport { isFirefox } from \"./browser_detection\";\n\n/**\n * Clear element's src attribute.\n * @param {HTMLMediaElement} element\n */\nexport default function clearElementSrc(element : HTMLMediaElement) : void {\n  // On Firefox, we also have to make sure the textTracks elements are both\n  // disabled and removed from the DOM.\n  // If we do not do that, we may be left with displayed text tracks on the\n  // screen\n  if (isFirefox) {\n    const { textTracks }= element;\n    for (let i = 0; i < textTracks.length; i++) {\n      textTracks[i].mode = \"disabled\";\n    }\n    if (element.hasChildNodes()) {\n      const { childNodes } = element;\n      for (let j = childNodes.length - 1; j >= 0; j--) {\n        if (childNodes[j].nodeName === \"track\") {\n          try {\n            element.removeChild(childNodes[j]);\n          } catch (err) {\n            log.warn(\"Compat: Could not remove text track child from element.\");\n          }\n        }\n      }\n    }\n  }\n  element.src = \"\";\n\n  // On IE11, element.src = \"\" is not sufficient as it\n  // does not clear properly the current MediaKey Session.\n  // Microsoft recommended to use element.removeAttr(\"src\").\n  element.removeAttribute(\"src\");\n}\n","'use strict';\n\nvar PENDING = 'pending';\nvar SETTLED = 'settled';\nvar FULFILLED = 'fulfilled';\nvar REJECTED = 'rejected';\nvar NOOP = function () {};\nvar isNode = typeof global !== 'undefined' && typeof global.process !== 'undefined' && typeof global.process.emit === 'function';\n\nvar asyncSetTimer = typeof setImmediate === 'undefined' ? setTimeout : setImmediate;\nvar asyncQueue = [];\nvar asyncTimer;\n\nfunction asyncFlush() {\n\t// run promise callbacks\n\tfor (var i = 0; i < asyncQueue.length; i++) {\n\t\tasyncQueue[i][0](asyncQueue[i][1]);\n\t}\n\n\t// reset async asyncQueue\n\tasyncQueue = [];\n\tasyncTimer = false;\n}\n\nfunction asyncCall(callback, arg) {\n\tasyncQueue.push([callback, arg]);\n\n\tif (!asyncTimer) {\n\t\tasyncTimer = true;\n\t\tasyncSetTimer(asyncFlush, 0);\n\t}\n}\n\nfunction invokeResolver(resolver, promise) {\n\tfunction resolvePromise(value) {\n\t\tresolve(promise, value);\n\t}\n\n\tfunction rejectPromise(reason) {\n\t\treject(promise, reason);\n\t}\n\n\ttry {\n\t\tresolver(resolvePromise, rejectPromise);\n\t} catch (e) {\n\t\trejectPromise(e);\n\t}\n}\n\nfunction invokeCallback(subscriber) {\n\tvar owner = subscriber.owner;\n\tvar settled = owner._state;\n\tvar value = owner._data;\n\tvar callback = subscriber[settled];\n\tvar promise = subscriber.then;\n\n\tif (typeof callback === 'function') {\n\t\tsettled = FULFILLED;\n\t\ttry {\n\t\t\tvalue = callback(value);\n\t\t} catch (e) {\n\t\t\treject(promise, e);\n\t\t}\n\t}\n\n\tif (!handleThenable(promise, value)) {\n\t\tif (settled === FULFILLED) {\n\t\t\tresolve(promise, value);\n\t\t}\n\n\t\tif (settled === REJECTED) {\n\t\t\treject(promise, value);\n\t\t}\n\t}\n}\n\nfunction handleThenable(promise, value) {\n\tvar resolved;\n\n\ttry {\n\t\tif (promise === value) {\n\t\t\tthrow new TypeError('A promises callback cannot return that same promise.');\n\t\t}\n\n\t\tif (value && (typeof value === 'function' || typeof value === 'object')) {\n\t\t\t// then should be retrieved only once\n\t\t\tvar then = value.then;\n\n\t\t\tif (typeof then === 'function') {\n\t\t\t\tthen.call(value, function (val) {\n\t\t\t\t\tif (!resolved) {\n\t\t\t\t\t\tresolved = true;\n\n\t\t\t\t\t\tif (value === val) {\n\t\t\t\t\t\t\tfulfill(promise, val);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresolve(promise, val);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, function (reason) {\n\t\t\t\t\tif (!resolved) {\n\t\t\t\t\t\tresolved = true;\n\n\t\t\t\t\t\treject(promise, reason);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t} catch (e) {\n\t\tif (!resolved) {\n\t\t\treject(promise, e);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nfunction resolve(promise, value) {\n\tif (promise === value || !handleThenable(promise, value)) {\n\t\tfulfill(promise, value);\n\t}\n}\n\nfunction fulfill(promise, value) {\n\tif (promise._state === PENDING) {\n\t\tpromise._state = SETTLED;\n\t\tpromise._data = value;\n\n\t\tasyncCall(publishFulfillment, promise);\n\t}\n}\n\nfunction reject(promise, reason) {\n\tif (promise._state === PENDING) {\n\t\tpromise._state = SETTLED;\n\t\tpromise._data = reason;\n\n\t\tasyncCall(publishRejection, promise);\n\t}\n}\n\nfunction publish(promise) {\n\tpromise._then = promise._then.forEach(invokeCallback);\n}\n\nfunction publishFulfillment(promise) {\n\tpromise._state = FULFILLED;\n\tpublish(promise);\n}\n\nfunction publishRejection(promise) {\n\tpromise._state = REJECTED;\n\tpublish(promise);\n\tif (!promise._handled && isNode) {\n\t\tglobal.process.emit('unhandledRejection', promise._data, promise);\n\t}\n}\n\nfunction notifyRejectionHandled(promise) {\n\tglobal.process.emit('rejectionHandled', promise);\n}\n\n/**\n * @class\n */\nfunction Promise(resolver) {\n\tif (typeof resolver !== 'function') {\n\t\tthrow new TypeError('Promise resolver ' + resolver + ' is not a function');\n\t}\n\n\tif (this instanceof Promise === false) {\n\t\tthrow new TypeError('Failed to construct \\'Promise\\': Please use the \\'new\\' operator, this object constructor cannot be called as a function.');\n\t}\n\n\tthis._then = [];\n\n\tinvokeResolver(resolver, this);\n}\n\nPromise.prototype = {\n\tconstructor: Promise,\n\n\t_state: PENDING,\n\t_then: null,\n\t_data: undefined,\n\t_handled: false,\n\n\tthen: function (onFulfillment, onRejection) {\n\t\tvar subscriber = {\n\t\t\towner: this,\n\t\t\tthen: new this.constructor(NOOP),\n\t\t\tfulfilled: onFulfillment,\n\t\t\trejected: onRejection\n\t\t};\n\n\t\tif ((onRejection || onFulfillment) && !this._handled) {\n\t\t\tthis._handled = true;\n\t\t\tif (this._state === REJECTED && isNode) {\n\t\t\t\tasyncCall(notifyRejectionHandled, this);\n\t\t\t}\n\t\t}\n\n\t\tif (this._state === FULFILLED || this._state === REJECTED) {\n\t\t\t// already resolved, call callback async\n\t\t\tasyncCall(invokeCallback, subscriber);\n\t\t} else {\n\t\t\t// subscribe\n\t\t\tthis._then.push(subscriber);\n\t\t}\n\n\t\treturn subscriber.then;\n\t},\n\n\tcatch: function (onRejection) {\n\t\treturn this.then(null, onRejection);\n\t}\n};\n\nPromise.all = function (promises) {\n\tif (!Array.isArray(promises)) {\n\t\tthrow new TypeError('You must pass an array to Promise.all().');\n\t}\n\n\treturn new Promise(function (resolve, reject) {\n\t\tvar results = [];\n\t\tvar remaining = 0;\n\n\t\tfunction resolver(index) {\n\t\t\tremaining++;\n\t\t\treturn function (value) {\n\t\t\t\tresults[index] = value;\n\t\t\t\tif (!--remaining) {\n\t\t\t\t\tresolve(results);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tfor (var i = 0, promise; i < promises.length; i++) {\n\t\t\tpromise = promises[i];\n\n\t\t\tif (promise && typeof promise.then === 'function') {\n\t\t\t\tpromise.then(resolver(i), reject);\n\t\t\t} else {\n\t\t\t\tresults[i] = promise;\n\t\t\t}\n\t\t}\n\n\t\tif (!remaining) {\n\t\t\tresolve(results);\n\t\t}\n\t});\n};\n\nPromise.race = function (promises) {\n\tif (!Array.isArray(promises)) {\n\t\tthrow new TypeError('You must pass an array to Promise.race().');\n\t}\n\n\treturn new Promise(function (resolve, reject) {\n\t\tfor (var i = 0, promise; i < promises.length; i++) {\n\t\t\tpromise = promises[i];\n\n\t\t\tif (promise && typeof promise.then === 'function') {\n\t\t\t\tpromise.then(resolve, reject);\n\t\t\t} else {\n\t\t\t\tresolve(promise);\n\t\t\t}\n\t\t}\n\t});\n};\n\nPromise.resolve = function (value) {\n\tif (value && typeof value === 'object' && value.constructor === Promise) {\n\t\treturn value;\n\t}\n\n\treturn new Promise(function (resolve) {\n\t\tresolve(value);\n\t});\n};\n\nPromise.reject = function (reason) {\n\treturn new Promise(function (resolve, reject) {\n\t\treject(reason);\n\t});\n};\n\nmodule.exports = Promise;\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport pinkie from \"pinkie\";\n\nexport default typeof Promise === \"function\" ? Promise :\n                                               pinkie;\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport PPromise from \"../../utils/promise\";\n\n// XXX TODO remove when the issue is resolved\n// https://github.com/Microsoft/TypeScript/issues/19189\nimport { ICompatMediaKeySystemConfiguration } from \"../browser_compatibility_types\";\nimport { ICustomMediaKeys } from \"./custom_media_keys\";\n\n// MediaKeySystemAccess implementation\nexport interface ICustomMediaKeySystemAccess {\n  readonly keySystem : string;\n  getConfiguration() : ICompatMediaKeySystemConfiguration;\n  createMediaKeys() : Promise<MediaKeys|ICustomMediaKeys>;\n}\n\n/**\n * Simple implementation of the MediaKeySystemAccess EME API.\n *\n * All needed arguments are given to the constructor\n * @class CustomMediaKeySystemAccess\n */\nexport default class CustomMediaKeySystemAccess implements ICustomMediaKeySystemAccess {\n  /**\n   * @param {string} _keyType - type of key system (e.g. \"widevine\" or\n   * \"com.widevine.alpha\").\n   * @param {Object} _mediaKeys - MediaKeys implementation\n   * @param {Object} _configuration - Configuration accepted for this\n   * MediaKeySystemAccess.\n   */\n  constructor(\n    private readonly _keyType : string,\n    private readonly _mediaKeys : ICustomMediaKeys|MediaKeys,\n    private readonly _configuration : ICompatMediaKeySystemConfiguration\n  ) {}\n\n  /**\n   * @returns {string} - current key system type (e.g. \"widevine\" or\n   * \"com.widevine.alpha\").\n   */\n  get keySystem() : string {\n    return this._keyType;\n  }\n\n  /**\n   * @returns {Promise.<Object>} - Promise wrapping the MediaKeys for this\n   * MediaKeySystemAccess. Never rejects.\n   */\n  public createMediaKeys() : Promise<ICustomMediaKeys|MediaKeys> {\n    return new PPromise((res) => res(this._mediaKeys));\n  }\n\n  /**\n   * @returns {Object} - Configuration accepted for this MediaKeySystemAccess.\n   */\n  public getConfiguration() : ICompatMediaKeySystemConfiguration {\n    return this._configuration;\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { AssertionError } from \"../errors\";\n\n/**\n * Throw an AssertionError if the given assertion is false.\n * @param {boolean} assertion\n * @param {string} [message] - Optional message property for the AssertionError.\n * @throws AssertionError - Throws if the assertion given is false\n */\nexport default function assert(assertion : boolean, message? : string) {\n  if (!assertion) {\n    throw new AssertionError(message || \"invalid assertion\");\n  }\n}\n\ntype IObjectInterface<T> = Partial<Record<keyof T, string>>;\n\n/**\n * Throws if the given Object does not respect the interface.\n * @param {Object} o\n * @param {Object} iface - Contains the checked keynames of o and link them\n * to their types (obtained through the typeof operator).\n * @param {string} [name=\"object\"] - name of the _interface_\n * @throws AssertionError - The argument o given is not an object\n * @throws AssertionError - The _interface_ is not respected.\n */\nexport function assertInterface<T>(\n  o: T,\n  iface: IObjectInterface<T>,\n  name: string = \"object\"\n) : void {\n  assert(o != null, `${name} should be an object`);\n  for (const k in iface) {\n    if (iface.hasOwnProperty(k)) {\n      /* tslint:disable:max-line-length */\n      assert(typeof o[k] === iface[k], `${name} should have property ${k} as a ${iface[k]}`);\n      /* tslint:enable:max-line-length */\n    }\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport assert from \"./assert\";\n\ntype TypedArray = Int8Array |\n                  Int16Array |\n                  Int32Array |\n                  Uint8Array |\n                  Uint16Array |\n                  Uint32Array |\n                  Uint8ClampedArray |\n                  Float32Array |\n                  Float64Array;\n\n/**\n * Convert a simple string to an Uint8Array containing the corresponding\n * UTF-8 code units.\n * /!\\ its implementation favors simplicity and performance over accuracy.\n * Each character having a code unit higher than 255 in UTF-16 will be\n * truncated (real value % 256).\n * Please take that into consideration when calling this function.\n * @param {string} str\n * @returns {Uint8Array}\n */\nfunction strToBytes(str : string) : Uint8Array {\n  const len = str.length;\n  const arr = new Uint8Array(len);\n  for (let i = 0; i < len; i++) {\n    arr[i] = str.charCodeAt(i) & 0xFF;\n  }\n  return arr;\n}\n\n/**\n * construct string from the code units given\n * @param {Uint16Array|Uint8Array} bytes\n * @returns {string}\n */\nfunction bytesToStr(bytes : TypedArray) : string {\n  // NOTE: ugly I know, but TS is problematic here (you can try)\n  return (String.fromCharCode as any).apply(null, bytes);\n}\n\n/**\n * construct string from the code units given.\n * Only use every other byte for each UTF-16 character.\n * @param {Uint8Array} bytes\n * @returns {string}\n */\nfunction bytesToUTF16Str(bytes : TypedArray) : string {\n  let str = \"\";\n  const len = bytes.length;\n  for (let i = 0; i < len; i += 2) {\n    str += String.fromCharCode(bytes[i]);\n  }\n  return str;\n}\n\n/**\n * Convert hex codes in a string form into the corresponding bytes.\n * @param {string} str\n * @returns {Uint8Array}\n * @throws TypeError - str.length is odd\n */\nfunction hexToBytes(str : string) : Uint8Array {\n  const len = str.length;\n  const arr = new Uint8Array(len / 2);\n  for (let i = 0, j = 0; i < len; i += 2, j++) {\n    arr[j] = parseInt(str.substring(i, i + 2), 16) & 0xFF;\n  }\n  return arr;\n}\n\n/**\n * Convert bytes into the corresponding hex string, with the possibility\n * to add a separator.\n * @param {Uint8Array} bytes\n * @param {string} [sep=\"\"] - separator. Separate each two hex character.\n * @returns {string}\n */\nfunction bytesToHex(bytes : Uint8Array, sep : string = \"\") : string {\n  let hex = \"\";\n  for (let i = 0; i < bytes.byteLength; i++) {\n    hex += (bytes[i] >>> 4).toString(16);\n    hex += (bytes[i] & 0xF).toString(16);\n    if (sep.length && i < bytes.byteLength - 1) {\n      hex += sep;\n    }\n  }\n  return hex;\n}\n\n/**\n * Returns a Uint8Array from the arguments given, in order:\n *   - if the next argument given is a number N set the N next bytes to 0.\n *   - else set the next bytes to the argument given.\n * @param {...(Number|Uint8Array)} args\n * @returns {Uint8Array}\n */\nfunction concat(...args : Array<TypedArray|number[]|number>) : Uint8Array {\n  const l = args.length;\n  let i = -1;\n  let len = 0;\n  let arg;\n  while (++i < l) {\n    arg = args[i];\n    len += (typeof arg === \"number\") ? arg : arg.length;\n  }\n  const arr = new Uint8Array(len);\n  let offset = 0;\n  i = -1;\n  while (++i < l) {\n    arg = args[i];\n    if (typeof arg === \"number\") {\n      offset += arg;\n    }\n    else if (arg.length > 0) {\n      arr.set(arg, offset);\n      offset += arg.length;\n    }\n  }\n  return arr;\n}\n\n/**\n * Translate groups of 2 big-endian bytes to Integer (from 0 up to 65535).\n * @param {Uint8Array} bytes\n * @param {Number} offset - The offset (from the start of the given array)\n * @returns {Number}\n */\nfunction be2toi(bytes : Uint8Array, offset : number) : number {\n  return ((bytes[offset + 0] << 8) +\n          (bytes[offset + 1] << 0));\n}\n\n/**\n * Translate groups of 3 big-endian bytes to Integer.\n * @param {Uint8Array} bytes\n * @param {Number} offset - The offset (from the start of the given array)\n * @returns {Number}\n */\nfunction be3toi(bytes : Uint8Array, offset : number) : number {\n  return ((bytes[offset + 0] * 0x0010000) +\n          (bytes[offset + 1] * 0x0000100) +\n          (bytes[offset + 2]));\n}\n\n/**\n * Translate groups of 4 big-endian bytes to Integer.\n * @param {Uint8Array} bytes\n * @param {Number} offset - The offset (from the start of the given array)\n * @returns {Number}\n */\nfunction be4toi(bytes : Uint8Array, offset : number) : number {\n  return ((bytes[offset + 0] * 0x1000000) +\n          (bytes[offset + 1] * 0x0010000) +\n          (bytes[offset + 2] * 0x0000100) +\n          (bytes[offset + 3]));\n}\n\n/**\n * Translate groups of 8 big-endian bytes to Integer.\n * @param {Uint8Array} bytes\n * @param {Number} offset - The offset (from the start of the given array)\n * @returns {Number}\n */\nfunction be8toi(bytes : Uint8Array, offset : number) : number {\n  return (((bytes[offset + 0] * 0x1000000) +\n           (bytes[offset + 1] * 0x0010000) +\n           (bytes[offset + 2] * 0x0000100) +\n           (bytes[offset + 3])\n          ) * 0x100000000 +\n\n         (bytes[offset + 4] * 0x1000000) +\n         (bytes[offset + 5] * 0x0010000) +\n         (bytes[offset + 6] * 0x0000100) +\n         (bytes[offset + 7]));\n}\n\n/**\n * Translate Integer (from 0 up to 65535) to a Uint8Array of length 2 of\n * the corresponding big-endian bytes.\n * @param {Number} num\n * @returns {Uint8Array}\n */\nfunction itobe2(num : number) : Uint8Array {\n  return new Uint8Array([ (num >>> 8) & 0xFF,\n                          (num)       & 0xFF ]);\n}\n\n/**\n * Translate Integer to a Uint8Array of length 4 of the corresponding big-endian\n * bytes.\n * @param {Number} num\n * @returns {Uint8Array}\n */\nfunction itobe4(num : number) : Uint8Array {\n  return new Uint8Array([ (num >>> 24) & 0xFF,\n                          (num >>> 16) & 0xFF,\n                          (num >>>  8) & 0xFF,\n                          (num)        & 0xFF ]);\n}\n\n/**\n * Translate Integer to a Uint8Array of length 8 of the corresponding big-endian\n * bytes.\n * /!\\ If the top-most bytes are set, this might go over MAX_SAFE_INTEGER, thus\n * leading to a \"bad\" value.\n * @param {Number} num\n * @returns {Uint8Array}\n */\nfunction itobe8(num : number) : Uint8Array {\n  const l = (num % 0x100000000);\n  const h = (num - l) / 0x100000000;\n  return new Uint8Array([ (h >>> 24) & 0xFF,\n                          (h >>> 16) & 0xFF,\n                          (h >>>  8) & 0xFF,\n                          (h)        & 0xFF,\n                          (l >>> 24) & 0xFF,\n                          (l >>> 16) & 0xFF,\n                          (l >>>  8) & 0xFF,\n                          (l)        & 0xFF ]);\n}\n\n/**\n * Translate groups of 2 little-endian bytes to Integer (from 0 up to 65535).\n * @param {Uint8Array} bytes\n * @param {Number} offset - The offset (from the start of the given array)\n * @returns {Number}\n */\nfunction le2toi(bytes : Uint8Array, offset : number) : number {\n  return ((bytes[offset + 0] << 0) +\n          (bytes[offset + 1] << 8));\n}\n\n/**\n * Translate groups of 4 little-endian bytes to Integer.\n * @param {Uint8Array} bytes\n * @param {Number} offset - The offset (from the start of the given array)\n * @returns {Number}\n */\nfunction le4toi(bytes : Uint8Array, offset : number) : number {\n  return ((bytes[offset + 0]) +\n          (bytes[offset + 1] * 0x0000100) +\n          (bytes[offset + 2] * 0x0010000) +\n          (bytes[offset + 3] * 0x1000000));\n}\n\n/**\n * Translate groups of 8 little-endian bytes to Integer.\n * @param {Uint8Array} bytes\n * @param {Number} offset - The offset (from the start of the given array)\n * @returns {Number}\n */\nfunction le8toi(bytes : Uint8Array, offset : number) : number {\n  return (bytes[offset + 0]) +\n         (bytes[offset + 1] * 0x0000100) +\n         (bytes[offset + 2] * 0x0010000) +\n         (bytes[offset + 3] * 0x1000000) +\n         (\n           (bytes[offset + 4]) +\n           (bytes[offset + 5] * 0x0000100) +\n           (bytes[offset + 6] * 0x0010000) +\n           (bytes[offset + 7] * 0x1000000)\n         ) * 0x100000000;\n}\n\n/**\n * Translate Integer (from 0 up to 65535) to a Uint8Array of length 2 of\n * the corresponding little-endian bytes.\n * @param {Number} num\n * @returns {Uint8Array}\n */\nfunction itole2(num : number) : Uint8Array {\n  return new Uint8Array([ (num)       & 0xFF,\n                          (num >>> 8) & 0xFF ]);\n}\n\n/**\n * Translate Integer to a Uint8Array of length 4 of the corresponding\n * little-endian bytes.\n * @param {Number} num\n * @returns {Uint8Array}\n */\nfunction itole4(num : number) : Uint8Array {\n  return new Uint8Array([ (num)        & 0xFF,\n                          (num >>>  8) & 0xFF,\n                          (num >>> 16) & 0xFF,\n                          (num >>> 24) & 0xFF ]);\n}\n\n/**\n * @param {string} uuid\n * @returns {string}\n * @throws AssertionError - The uuid length is not 16\n */\nfunction guidToUuid(uuid : string) : string {\n  assert(uuid.length === 16, \"UUID length should be 16\");\n  const buf = strToBytes(uuid);\n\n  const p1A = buf[0];\n  const p1B = buf[1];\n  const p1C = buf[2];\n  const p1D = buf[3];\n  const p2A = buf[4];\n  const p2B = buf[5];\n  const p3A = buf[6];\n  const p3B = buf[7];\n  const p4 = buf.subarray(8, 10);\n  const p5 = buf.subarray(10, 16);\n\n  const ord = new Uint8Array(16);\n  ord[0] = p1D; ord[1] = p1C; ord[2] = p1B; ord[3] = p1A; // swap32 BE -> LE\n  ord[4] = p2B; ord[5] = p2A;                             // swap16 BE -> LE\n  ord[6] = p3B; ord[7] = p3A;                             // swap16 BE -> LE\n  ord.set(p4,  8);\n  ord.set(p5, 10);\n\n  return bytesToHex(ord);\n}\n\nexport {\n  strToBytes,\n  bytesToStr, bytesToUTF16Str,\n  hexToBytes,\n  bytesToHex,\n  concat,\n  be2toi, be3toi, be4toi, be8toi,\n  le2toi, le4toi, le8toi,\n  itobe2, itobe4, itobe8,\n  itole2, itole4,\n  guidToUuid,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  from as observableFrom,\n  Observable,\n  of as observableOf,\n} from \"rxjs\";\n\ninterface IObservableLike<T> { subscribe(next : (i: T) => void,\n                                         error : (e: any) => void,\n                                         complete : () => void) :\n                                 (\n                                   { dispose? : () => void;\n                                     unsubscribe? : () => void; } |\n                                   void); }\n\n/**\n * Try to cast the given value into an observable.\n * StraightForward - test first for an Observable then for a Promise.\n * @param {Observable|Function|*}\n * @returns {Observable}\n */\nfunction castToObservable<T>(\n  value : Observable<T>|IObservableLike<T>|Promise<T>) : Observable<T>;\nfunction castToObservable<T>(value? : T) : Observable<T>;\nfunction castToObservable<T>(value? : any) : Observable<T> {\n  if (value instanceof Observable) {\n    return value;\n  }\n\n  if (value && typeof value.subscribe === \"function\") {\n    const valObsLike = value as IObservableLike<T>;\n    return new Observable((obs) => {\n      const sub = valObsLike.subscribe((val : T)   => { obs.next(val); },\n                                       (err : unknown) => { obs.error(err); },\n                                       () => { obs.complete(); });\n      return () => {\n        if (sub && sub.dispose) {\n          sub.dispose();\n        }\n        else if (sub && sub.unsubscribe) {\n          sub.unsubscribe();\n        }\n      };\n    });\n  }\n\n  if (value && typeof value.then === \"function\") {\n    return observableFrom(value as Promise<T>);\n  }\n\n  return observableOf(value);\n}\n\nexport default castToObservable;\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Observable,\n  Observer,\n} from \"rxjs\";\nimport log from \"../log\";\n\nexport interface IEventEmitter<T> {\n  addEventListener<TEventName extends keyof T>(evt : TEventName,\n                                               fn : IListener<T, TEventName>) :\n                                                void;\n  removeEventListener<TEventName extends keyof T>(evt : TEventName,\n                                                  fn : IListener<T, TEventName>) :\n                                                   void;\n  trigger?<TEventName extends keyof T>(evt : TEventName,\n                                       arg : IArgs<T, TEventName>) : void;\n}\n\n// Type of the argument in the listener's callback\ntype IArgs<TEventRecord, TEventName\n     extends keyof TEventRecord> = TEventRecord[TEventName];\n\n// Type of the listener function\ntype IListener<TEventRecord, TEventName\n     extends keyof TEventRecord> = (args: IArgs<TEventRecord, TEventName>) => void;\n\ntype IListeners<TEventRecord> = {\n  [P in keyof TEventRecord]? : Array<IListener<TEventRecord, P>>\n};\n\n/**\n * Simple but fully type-safe EventEmitter implementation.\n * @class EventEmitter\n */\nexport default class EventEmitter<T> implements IEventEmitter<T> {\n  /**\n   * @type {Object}\n   * @private\n   */\n  private _listeners : IListeners<T>;\n\n  constructor() {\n    this._listeners = {};\n  }\n\n  /**\n   * Register a new callback for an event.\n   *\n   * @param {string} evt - The event to register a callback to\n   * @param {Function} fn - The callback to call as that event is triggered.\n   * The callback will take as argument the eventual payload of the event\n   * (single argument).\n   */\n  public addEventListener<TEventName extends keyof T>(\n    evt : TEventName,\n    fn : IListener<T, TEventName>\n  ) : void {\n    const listeners = this._listeners[evt];\n    if (!listeners) {\n      this._listeners[evt] = [fn];\n    } else {\n      listeners.push(fn);\n    }\n  }\n\n  /**\n   * Unregister callbacks linked to events.\n   * @param {string} [evt] - The event for which the callback[s] should be\n   * unregistered. Set it to null or undefined to remove all callbacks\n   * currently registered (for any event).\n   * @param {Function} [fn] - The callback to unregister. If set to null\n   * or undefined while the evt argument is set, all callbacks linked to that\n   * event will be unregistered.\n   */\n  public removeEventListener<TEventName extends keyof T>(\n    evt? : TEventName,\n    fn? : IListener<T, TEventName>\n  ) : void {\n    if (evt == null) {\n      this._listeners = {};\n      return;\n    }\n\n    const listeners = this._listeners[evt];\n    if (!listeners) {\n      return;\n    }\n    if (fn == null) {\n      delete this._listeners[evt];\n      return;\n    }\n\n    const index = listeners.indexOf(fn);\n    if (~index) {\n      listeners.splice(index, 1);\n    }\n\n    if (!listeners.length) {\n      delete this._listeners[evt];\n    }\n  }\n\n  /**\n   * Trigger every registered callbacks for a given event\n   * @param {string} evt - The event to trigger\n   * @param {*} arg - The eventual payload for that event. All triggered\n   * callbacks will recieve this payload as argument.\n   */\n  public trigger<TEventName extends keyof T>(\n    evt : TEventName,\n    arg : IArgs<T, TEventName>\n  ) : void {\n    const listeners = this._listeners[evt];\n    if (!listeners) {\n      return;\n    }\n\n    listeners.slice().forEach((listener) => {\n      try {\n        listener(arg);\n      } catch (e) {\n        log.error(e, e.stack);\n      }\n    });\n  }\n}\n\n/**\n * Simple redefinition of the fromEvent from rxjs to also work on our\n * implementation of EventEmitter with type-checked strings\n * @param {Object} target\n * @param {string} eventName\n * @returns {Observable}\n */\nexport function fromEvent<T, TEventName extends keyof T>(\n  target : IEventEmitter<T>,\n  eventName : TEventName\n) : Observable<IArgs<T, TEventName>> {\n  return new Observable((obs : Observer<IArgs<T, TEventName>>) => {\n    function handler(event : IArgs<T, TEventName>) {\n      obs.next(event);\n    }\n    target.addEventListener(eventName, handler);\n    return () => {\n      target.removeEventListener(eventName, handler);\n    };\n  });\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * This file provides browser-agnostic event listeners under the form of\n * RxJS Observables\n */\n\nimport {\n  combineLatest as observableCombineLatest,\n  defer as observableDefer,\n  fromEvent as observableFromEvent,\n  interval as observableInterval,\n  merge as observableMerge,\n  NEVER,\n  Observable,\n  of as observableOf,\n} from \"rxjs\";\nimport {\n  delay,\n  distinctUntilChanged,\n  map,\n  mapTo,\n  startWith,\n  switchMap,\n  throttleTime,\n} from \"rxjs/operators\";\nimport config from \"../config\";\nimport log from \"../log\";\nimport { IEventEmitter } from \"../utils/event_emitter\";\nimport {\n  HTMLElement_,\n  ICompatDocument,\n  ICompatPictureInPictureWindow,\n} from \"./browser_compatibility_types\";\n\nconst BROWSER_PREFIXES = [\"\", \"webkit\", \"moz\", \"ms\"];\n\nconst INACTIVITY_DELAY = config.INACTIVITY_DELAY;\nconst pixelRatio = window.devicePixelRatio || 1;\n\n/**\n * Find the first supported event from the list given.\n * @param {HTMLElement} element\n * @param {string} eventNameSuffix\n * @returns {Boolean}\n */\nfunction isEventSupported(\n  element : HTMLElement,\n  eventNameSuffix : string\n) : boolean {\n  const clone = document.createElement(element.tagName);\n  const eventName = \"on\" + eventNameSuffix;\n  if (eventName in clone) {\n    return true;\n  } else {\n    clone.setAttribute(eventName, \"return;\");\n    return typeof (clone as any)[eventName] === \"function\";\n  }\n}\n\n/**\n * Find the first supported event from the list given.\n * @param {HTMLElement} element\n * @param {Array.<string>} eventNames\n * @returns {string|undefined}\n */\nfunction findSupportedEvent(\n  element : HTMLElement,\n  eventNames : string[]\n) : string|undefined {\n  return eventNames\n    .filter((name) => isEventSupported(element, name))[0];\n}\n\n/**\n * @param {Array.<string>} eventNames\n * @param {Array.<string>|undefined} prefixes\n * @returns {Array.<string>}\n */\nfunction eventPrefixed(eventNames : string[], prefixes? : string[]) : string[] {\n  return eventNames.reduce((parent : string[], name : string) =>\n    parent.concat((prefixes || BROWSER_PREFIXES)\n          .map((p) => p + name)), []);\n}\n\nexport interface IEventEmitterLike {\n  addEventListener : (eventName: string, handler: () => void) => void;\n  removeEventListener: (eventName: string, handler: () => void) => void;\n}\n\nexport type IEventTargetLike = HTMLElement |\n                               IEventEmitterLike |\n                               IEventEmitter<any>;\n\n/**\n * @param {Array.<string>} eventNames\n * @param {Array.<string>|undefined} prefixes\n * @returns {Observable}\n */\nfunction compatibleListener<T extends Event>(\n  eventNames : string[],\n  prefixes? : string[]\n) : (element : IEventTargetLike) => Observable<T> {\n  let mem : string|undefined;\n  const prefixedEvents = eventPrefixed(eventNames, prefixes);\n  return (element : IEventTargetLike) => {\n    // if the element is a HTMLElement we can detect\n    // the supported event, and memoize it in `mem`\n    if (element instanceof HTMLElement_) {\n      if (typeof mem === \"undefined\") {\n        mem = findSupportedEvent(element, prefixedEvents);\n      }\n\n      if (mem) {\n        return observableFromEvent(element, mem) as Observable<T>;\n      } else {\n        if (__DEV__) {\n          log.warn(`compat: element ${element.tagName}` +\n                   \" does not support any of these events: \" +\n                   prefixedEvents.join(\", \"));\n        }\n        return NEVER;\n      }\n    }\n\n    // otherwise, we need to listen to all the events\n    // and merge them into one observable sequence\n    return observableMerge(...prefixedEvents.map(eventName =>\n                             observableFromEvent(element, eventName))\n    );\n  };\n}\n\n/**\n * Returns an observable:\n *   - emitting true when the document is visible\n *   - emitting false when the document is hidden\n * @returns {Observable}\n */\nfunction visibilityChange() : Observable<boolean> {\n  let prefix : string|undefined;\n\n  const doc = document as ICompatDocument;\n  if (doc.hidden != null) {\n    prefix = \"\";\n  } else if (doc.mozHidden != null) {\n    prefix = \"moz\";\n  } else if (doc.msHidden != null) {\n    prefix = \"ms\";\n  } else if (doc.webkitHidden != null) {\n    prefix = \"webkit\";\n  }\n\n  const hidden = prefix ? prefix + \"Hidden\" :\n                          \"hidden\";\n  const visibilityChangeEvent = prefix ? prefix + \"visibilitychange\" :\n                                         \"visibilitychange\";\n  return observableDefer(() => {\n    const isHidden = document[hidden as \"hidden\"];\n    return observableFromEvent(document, visibilityChangeEvent)\n      .pipe(\n        map(() => !(document[hidden as \"hidden\"])),\n        startWith(!isHidden),\n        distinctUntilChanged()\n      );\n  });\n}\n\n/**\n * @returns {Observable}\n */\nfunction videoSizeChange() : Observable<unknown> {\n  return observableFromEvent(window, \"resize\");\n}\n\n/**\n * Emit `true` if the page is considered active.\n * `false` when considered inactive.\n * Emit the original value on subscription.\n * @returns {Observable}\n */\nfunction isActive() : Observable<boolean> {\n  return visibilityChange().pipe(\n    switchMap((x) => {\n      if (!x) {\n        return observableOf(x).pipe(\n          delay(INACTIVITY_DELAY)\n        );\n      }\n      return observableOf(x);\n    })\n  );\n}\n\n/**\n * Get video width from Picture-in-Picture window\n * @param {HTMLMediaElement} mediaElement\n * @param {Object} pipWindow\n * @returns {number}\n */\nfunction getVideoWidthFromPIPWindow(\n  mediaElement: HTMLMediaElement,\n  pipWindow: ICompatPictureInPictureWindow\n): number {\n  const { width, height } = pipWindow;\n  const videoRatio = mediaElement.clientHeight / mediaElement.clientWidth;\n  const calcWidth = height / videoRatio;\n  return Math.min(width, calcWidth);\n}\n\nexport interface IPictureInPictureEvent {\n  isEnabled : boolean;\n  pipWindow : ICompatPictureInPictureWindow | null;\n}\n\n/**\n * Emit when video enters and leaves Picture-In-Picture mode.\n * @param {HTMLMediaElement} mediaElement\n * @returns {Observable}\n */\nexport function onPictureInPictureEvent$(\n  mediaElement: HTMLMediaElement\n): Observable<IPictureInPictureEvent> {\n  return observableDefer(() => {\n    if ((mediaElement as any).webkitSupportsPresentationMode &&\n        typeof (mediaElement as any).webkitSetPresentationMode === \"function\")\n    {\n      const isWebKitPIPEnabled =\n        (mediaElement as any).webkitPresentationMode === \"picture-in-picture\";\n      return observableFromEvent(mediaElement, \"webkitpresentationmodechanged\")\n          .pipe(\n            map(() => ({ isEnabled: (mediaElement as any)\n                           .webkitPresentationMode === \"picture-in-picture\",\n                         pipWindow: null })),\n            startWith({ isEnabled: isWebKitPIPEnabled, pipWindow: null })\n          );\n    }\n\n    const isPIPEnabled = (\n      (document as any).pictureInPictureElement &&\n      (document as any).pictureInPictureElement === mediaElement\n    );\n    const initialState = { isEnabled: isPIPEnabled, pipWindow: null };\n    return observableMerge(\n      observableFromEvent(mediaElement, \"enterpictureinpicture\")\n        .pipe(map((evt: any) => ({ isEnabled: true,\n                                   pipWindow: evt.pictureInPictureWindow }))),\n      observableFromEvent(mediaElement, \"leavepictureinpicture\")\n        .pipe(mapTo({ isEnabled: false, pipWindow: null }))\n    ).pipe(startWith(initialState));\n  });\n}\n\n/**\n * Returns `true` when video is considered as visible (the page is visible and/or\n * the Picture-In-Picture is activated). Returns `false` otherwise.\n * @param {Observable} pip$\n * @returns {Observable}\n */\nfunction isVideoVisible(\n  pip$ : Observable<IPictureInPictureEvent>\n) : Observable<boolean> {\n  return observableCombineLatest([visibilityChange(), pip$]).pipe(\n    switchMap(([ isVisible, pip ]) => {\n      if (pip.isEnabled || isVisible) {\n        return observableOf(true);\n      }\n      return observableOf(false)\n        .pipe(delay(INACTIVITY_DELAY));\n    }),\n    distinctUntilChanged()\n  );\n}\n\n/**\n * Get video width from HTML video element, or video estimated dimensions\n * when Picture-in-Picture is activated.\n * @param {HTMLMediaElement} mediaElement\n * @returns {Observable}\n */\nfunction videoWidth$(\n  mediaElement : HTMLMediaElement,\n  pip$ : Observable<IPictureInPictureEvent>\n) : Observable<number> {\n  return observableCombineLatest([\n    pip$,\n    observableInterval(20000).pipe(startWith(null)),\n    videoSizeChange().pipe(throttleTime(500), startWith(null)),\n  ]).pipe(\n    switchMap(([ pip ]) : Observable<number> => {\n      if (!pip.isEnabled) {\n        return observableOf(mediaElement.clientWidth * pixelRatio);\n      } else if (pip.pipWindow != null) {\n        const { pipWindow } = pip;\n        const firstWidth = getVideoWidthFromPIPWindow(mediaElement, pipWindow);\n\n        // RxJS typing issue (for the \"as any\")\n        return observableFromEvent(pipWindow as any, \"resize\").pipe(\n          startWith(firstWidth * pixelRatio),\n          map(() => getVideoWidthFromPIPWindow(mediaElement, pipWindow) * pixelRatio)\n        );\n      } else {\n        return observableOf(Infinity);\n      }\n    }),\n    distinctUntilChanged()\n  );\n}\n\n/**\n * @param {HTMLMediaElement} mediaElement\n * @returns {Observable}\n */\nconst onLoadedMetadata$ = compatibleListener([\"loadedmetadata\"]);\n\n/**\n * @param {HTMLMediaElement} mediaElement\n * @returns {Observable}\n */\nconst onSeeking$ = compatibleListener([\"seeking\"]);\n\n/**\n * @param {HTMLMediaElement} mediaElement\n * @returns {Observable}\n */\nconst onSeeked$ = compatibleListener([\"seeked\"]);\n\n/**\n * @param {HTMLMediaElement} mediaElement\n * @returns {Observable}\n */\nconst onEnded$ = compatibleListener([\"ended\"]);\n\n/**\n * @param {HTMLMediaElement} mediaElement\n * @returns {Observable}\n */\nconst onTimeUpdate$ = compatibleListener([\"timeupdate\"]);\n\n/**\n * @param {HTMLElement} element\n * @returns {Observable}\n */\nconst onFullscreenChange$ = compatibleListener(\n  [\"fullscreenchange\", \"FullscreenChange\"],\n\n  // On IE11, fullscreen change events is called MSFullscreenChange\n  BROWSER_PREFIXES.concat(\"MS\")\n);\n\n/**\n * @param {HTMLMediaElement} mediaElement\n * @returns {Observable}\n */\nconst onPlayPause$ = (mediaElement : HTMLMediaElement) : Observable<Event> =>\n  observableMerge(compatibleListener([\"play\"])(mediaElement),\n                  compatibleListener([\"pause\"])(mediaElement));\n\n/**\n * @param {HTMLMediaElement} mediaElement\n * @returns {Observable}\n */\nconst onTextTrackChanges$ =\n  (textTrackList : TextTrackList) : Observable<TrackEvent> =>\n    observableMerge(compatibleListener<TrackEvent>([\"addtrack\"])(textTrackList),\n                    compatibleListener<TrackEvent>([\"removetrack\"])(textTrackList));\n\n/**\n * @param {MediaSource} mediaSource\n * @returns {Observable}\n */\nconst onSourceOpen$ = compatibleListener([\"sourceopen\", \"webkitsourceopen\"]);\n\n/**\n * @param {SourceBuffer} sourceBuffer\n * @returns {Observable}\n */\nconst onUpdate$ = compatibleListener([\"update\"]);\n\n/**\n * @param {MediaSource} mediaSource\n * @returns {Observable}\n */\nconst onRemoveSourceBuffers$ = compatibleListener([\"onremovesourcebuffer\"]);\n\n/**\n * @param {HTMLMediaElement} mediaElement\n * @returns {Observable}\n */\nconst onEncrypted$ = compatibleListener<MediaEncryptedEvent>([\"encrypted\", \"needkey\"]);\n\n/**\n * @param {MediaKeySession} mediaKeySession\n * @returns {Observable}\n */\nconst onKeyMessage$ = compatibleListener<MediaKeyMessageEvent>([\"keymessage\", \"message\"]);\n\n/**\n * @param {MediaKeySession} mediaKeySession\n * @returns {Observable}\n */\nconst onKeyAdded$ = compatibleListener([\"keyadded\", \"ready\"]);\n\n/**\n * @param {MediaKeySession} mediaKeySession\n * @returns {Observable}\n */\nconst onKeyError$ = compatibleListener([\"keyerror\", \"error\"]);\n\n/**\n * @param {MediaKeySession} mediaKeySession\n * @returns {Observable}\n */\nconst onKeyStatusesChange$ = compatibleListener([\"keystatuseschange\"]);\n\nexport {\n  isActive,\n  isVideoVisible,\n  videoWidth$,\n  onPlayPause$,\n  onTextTrackChanges$,\n  onLoadedMetadata$,\n  onSeeking$,\n  onSeeked$,\n  onEnded$,\n  onTimeUpdate$,\n  onFullscreenChange$,\n  onSourceOpen$,\n  onUpdate$,\n  onRemoveSourceBuffers$,\n  onEncrypted$,\n  onKeyMessage$,\n  onKeyAdded$,\n  onKeyError$,\n  onKeyStatusesChange$,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  merge as observableMerge,\n  Observable,\n  of as observableOf,\n  Subject,\n  throwError as observableThrow,\n} from \"rxjs\";\nimport { takeUntil } from \"rxjs/operators\";\nimport {\n  bytesToStr,\n  strToBytes,\n} from \"../../utils/byte_parsing\";\nimport castToObservable from \"../../utils/cast_to_observable\";\nimport EventEmitter, {\n  IEventEmitter,\n} from \"../../utils/event_emitter\";\nimport PPromise from \"../../utils/promise\";\nimport {\n  // XXX TODO remove when the issue is resolved\n  // https://github.com/Microsoft/TypeScript/issues/19189\n  ICompatMediaKeySystemAccess,\n  ICompatMediaKeySystemConfiguration,\n  MediaKeys_,\n} from \"../browser_compatibility_types\";\nimport { isIE11 } from \"../browser_detection\";\nimport * as events from \"../event_listeners\";\nimport shouldUseWebKitMediaKeys from \"../should_use_webkit_media_keys\";\nimport CustomMediaKeySystemAccess from \"./custom_key_system_access\";\n\nlet requestMediaKeySystemAccess : null |\n                                  ((keyType : string,\n                                    config : ICompatMediaKeySystemConfiguration[])\n                                      => Observable<ICompatMediaKeySystemAccess |\n                                                    CustomMediaKeySystemAccess>)\n                                = null;\n\nfunction createMediaKeysSession(\n  mediaKeys: MediaKeys | ICustomMediaKeys,\n  sessionType: MediaKeySessionType\n): MediaKeySession | ICustomMediaKeySession {\n  return mediaKeys.createSession(sessionType);\n}\n\nlet createSession = createMediaKeysSession;\n\ntype TypedArray = Int8Array |\n                  Int16Array |\n                  Int32Array |\n                  Uint8Array |\n                  Uint16Array |\n                  Uint32Array |\n                  Uint8ClampedArray |\n                  Float32Array |\n                  Float64Array;\n\ninterface ICustomMediaKeyStatusMap {\n    readonly size: number;\n    forEach(callback: (status : MediaKeyStatus) => void, thisArg?: any): void;\n    get(\n      keyId: Int8Array |\n             Int16Array |\n             Int32Array |\n             Uint8Array |\n             Uint16Array |\n             Uint32Array |\n             Uint8ClampedArray |\n             Float32Array |\n             Float64Array |\n             DataView |\n             ArrayBuffer |\n             null\n    ) : MediaKeyStatus|undefined;\n    has(\n      keyId: Int8Array |\n             Int16Array |\n             Int32Array |\n             Uint8Array |\n             Uint16Array |\n             Uint32Array |\n             Uint8ClampedArray |\n             Float32Array |\n             Float64Array |\n             DataView |\n             ArrayBuffer |\n             null\n      ) : boolean;\n}\n\ninterface IMediaKeySessionEvents { [key : string] : MediaKeyMessageEvent|Event;\n                                   // \"keymessage\"\n                                   // \"message\"\n                                   // \"keyadded\"\n                                   // \"ready\"\n                                   // \"keyerror\"\n                                   /* \"error\" */ }\n\nexport interface ICustomMediaKeySession extends IEventEmitter<IMediaKeySessionEvents> {\n  // Attributes\n  readonly closed: Promise<void>;\n  expiration: number;\n  keyStatuses: ICustomMediaKeyStatusMap;\n  sessionId : string;\n\n  // Event handlers\n  onmessage? : (message : MediaKeyMessageEvent) => void;\n  onkeystatusesChange? : (evt : Event) => void;\n\n  // Functions\n\n  generateRequest(initDataType: string,\n                  initData: ArrayBuffer | TypedArray | DataView | null)\n                 : Promise<void>;\n\n  load(sessionId: string) : Promise<boolean>;\n  update(response: ArrayBuffer | TypedArray | DataView | null): Promise<void>;\n  close() : Promise<void>;\n  remove() : Promise<void>;\n}\n\nexport interface ICustomMediaKeys {\n  _setVideo : (vid : HTMLMediaElement) => void;\n  createSession(sessionType? : MediaKeySessionType) : ICustomMediaKeySession;\n  setServerCertificate(setServerCertificate : ArrayBuffer|TypedArray) : Promise<void>;\n}\n\ntype IMockMediaKeysConstructor = new(ks : string) => ICustomMediaKeys;\n\n// Default CustomMediaKeys implementation\nlet CustomMediaKeys : IMockMediaKeysConstructor =\n  class implements ICustomMediaKeys {\n    _setVideo() : void {\n      throw new Error(\"MediaKeys is not implemented in your browser\");\n    }\n    createSession() : ICustomMediaKeySession {\n      throw new Error(\"MediaKeys is not implemented in your browser\");\n    }\n    setServerCertificate() : Promise<void> {\n      throw new Error(\"MediaKeys is not implemented in your browser\");\n    }\n  };\n\n/**\n * Since Safari 12.1, EME APIs are available without webkit prefix.\n * However, it seems that since fairplay CDM implementation within the browser is not\n * standard with EME w3c current spec, the requestMediaKeySystemAccess API doesn't resolve\n * positively, even if the drm (fairplay in most cases) is supported.\n *\n * Therefore, we prefer not to use requestMediaKeySystemAccess on Safari when webkit API\n * is available.\n */\nif (navigator.requestMediaKeySystemAccess &&\n    !shouldUseWebKitMediaKeys()\n) {\n  requestMediaKeySystemAccess = (a : string, b : ICompatMediaKeySystemConfiguration[]) =>\n    castToObservable(\n      navigator.requestMediaKeySystemAccess(a, b) as Promise<ICompatMediaKeySystemAccess>\n    );\n} else {\n\n  type IWrappedUpdateFunction =\n    (license : ArrayBuffer, sessionId? : string) => Promise<void>;\n  type IUpdateFunction =\n    (license : TypedArray|ArrayBuffer, sessionId : string) => void;\n\n  // Wrap \"MediaKeys.prototype.update\" form an event based system to a\n  // Promise based function.\n  const wrapUpdate = (memUpdate : IUpdateFunction) : IWrappedUpdateFunction => {\n    return function(\n      this : ICustomMediaKeySession,\n      license : ArrayBuffer,\n      sessionId? : string\n    ) : Promise<void> {\n      return new PPromise((resolve, reject) => {\n        try {\n          memUpdate.call(this, license, sessionId || \"\");\n          resolve();\n        } catch (e) {\n          reject(e);\n        }\n      });\n    };\n  };\n\n  interface IOldWebkitHTMLMediaElement extends HTMLVideoElement {\n    webkitGenerateKeyRequest : (keyType: string, initData : ArrayBuffer) => void;\n    webkitAddKey : (\n      keyType: string,\n      key : ArrayBuffer|TypedArray|DataView,\n      kid : ArrayBuffer|TypedArray|DataView|null,\n      sessionId : string\n    ) => void;\n  }\n\n  /**\n   * Returns true if the given media element has old webkit methods\n   * corresponding to the IOldWebkitHTMLMediaElement interface.\n   * @param {HTMLMediaElement} element\n   * @returns {Boolean}\n   */\n  const isOldWebkitMediaElement = (\n    element : HTMLMediaElement|IOldWebkitHTMLMediaElement\n  ) : element is IOldWebkitHTMLMediaElement => {\n    return typeof (element as IOldWebkitHTMLMediaElement)\n      .webkitGenerateKeyRequest === \"function\";\n  };\n\n  // This is for Chrome with unprefixed EME api\n  if (isOldWebkitMediaElement(HTMLVideoElement.prototype)) {\n    class WebkitMediaKeySession extends EventEmitter<IMediaKeySessionEvents>\n                                implements ICustomMediaKeySession\n    {\n      public readonly update : (license : ArrayBuffer, sessionId? : string) =>\n                                 Promise<void>;\n      public readonly closed: Promise<void>;\n      public expiration: number;\n      public keyStatuses: ICustomMediaKeyStatusMap;\n      public sessionId : string;\n\n      private readonly _vid : HTMLMediaElement |\n                              IOldWebkitHTMLMediaElement;\n      private readonly _key : string;\n      private readonly _closeSession$ : Subject<void>;\n\n      constructor(\n        mediaElement : HTMLMediaElement |\n                       IOldWebkitHTMLMediaElement,\n        keySystem : string\n      ) {\n        super();\n        this._closeSession$ = new Subject();\n        this._vid = mediaElement;\n        this._key = keySystem;\n\n        this.sessionId = \"\";\n        this.closed = new PPromise((resolve) => {\n          this._closeSession$.subscribe(resolve);\n        });\n        this.keyStatuses = new Map();\n        this.expiration = NaN;\n\n        observableMerge(events.onKeyMessage$(mediaElement),\n                        events.onKeyAdded$(mediaElement),\n                        events.onKeyError$(mediaElement))\n          .pipe(takeUntil(this._closeSession$))\n          .subscribe((evt : Event) => this.trigger(evt.type, evt));\n\n        this.update = wrapUpdate((license, sessionId?) => {\n          if (!isOldWebkitMediaElement(this._vid)) {\n            throw new Error(\"impossible to add a new key\");\n          }\n          if (this._key.indexOf(\"clearkey\") >= 0) {\n            const licenseTypedArray =\n              license instanceof ArrayBuffer ? new Uint8Array(license) :\n                                               license;\n            const json = JSON.parse(bytesToStr(licenseTypedArray));\n            const key = strToBytes(atob(json.keys[0].k));\n            const kid = strToBytes(atob(json.keys[0].kid));\n            this._vid.webkitAddKey(this._key, key, kid, sessionId);\n          } else {\n            this._vid.webkitAddKey(this._key, license, null, sessionId);\n          }\n          this.sessionId = sessionId;\n        });\n      }\n\n      generateRequest(_initDataType : string, initData : ArrayBuffer) : Promise<void> {\n        return new PPromise((resolve) => {\n          if (!isOldWebkitMediaElement(this._vid)) {\n            throw new Error(\"impossible to generate a key request\");\n          }\n          this._vid.webkitGenerateKeyRequest(this._key, initData);\n          resolve();\n        });\n      }\n\n      close() : Promise<void> {\n        return new PPromise((resolve) => {\n          this._closeSession$.next();\n          this._closeSession$.complete();\n          resolve();\n        });\n      }\n\n      load() : Promise<boolean> {\n        return PPromise.resolve(false);\n      }\n\n      remove() : Promise<void> {\n        return PPromise.resolve();\n      }\n    }\n\n    CustomMediaKeys = class implements ICustomMediaKeys {\n      private readonly ks_ : string;\n      private _vid? : HTMLMediaElement;\n\n      constructor(keySystem : string) {\n        this.ks_ = keySystem;\n      }\n\n      _setVideo(vid : HTMLMediaElement) : void {\n        this._vid = vid;\n      }\n\n      createSession(/* sessionType */) : ICustomMediaKeySession {\n        if (!this._vid) {\n          throw new Error(\"Video not attached to the MediaKeys\");\n        }\n        return new WebkitMediaKeySession(this._vid, this.ks_);\n      }\n\n      setServerCertificate() : Promise<void> {\n        throw new Error(\"Server certificate is not implemented in your browser\");\n      }\n    };\n\n    const isTypeSupported = function(keyType : string) : boolean {\n      // get any <video> element from the DOM or create one\n      // and try the `canPlayType` method\n      const videoElement = document.querySelector(\"video\") ||\n                           document.createElement(\"video\");\n      if (videoElement && videoElement.canPlayType) {\n        return !!(videoElement as any).canPlayType(\"video/mp4\", keyType);\n      } else {\n        return false;\n      }\n    };\n\n    requestMediaKeySystemAccess = function(\n      keyType : string,\n      keySystemConfigurations : ICompatMediaKeySystemConfiguration[]\n    ) : Observable<CustomMediaKeySystemAccess> {\n      if (!isTypeSupported(keyType)) {\n        return observableThrow(undefined);\n      }\n\n      for (let i = 0; i < keySystemConfigurations.length; i++) {\n        const keySystemConfiguration = keySystemConfigurations[i];\n        const { videoCapabilities,\n                audioCapabilities,\n                initDataTypes,\n                sessionTypes,\n                distinctiveIdentifier,\n                persistentState } = keySystemConfiguration;\n\n        let supported = true;\n        supported = supported &&\n                    (!initDataTypes ||\n                     !!initDataTypes\n                       .filter((initDataType) => initDataType === \"cenc\")[0]);\n\n        supported = supported &&\n                    (!sessionTypes ||\n                     sessionTypes\n                       .filter((sessionType) =>\n                         sessionType === \"temporary\").length === sessionTypes.length);\n        supported = supported && (distinctiveIdentifier !== \"required\");\n        supported = supported && (persistentState !== \"required\");\n\n        if (supported) {\n          const keySystemConfigurationResponse = {\n            videoCapabilities,\n            audioCapabilities,\n            initDataTypes: [\"cenc\"],\n            sessionTypes: [\"temporary\"],\n            distinctiveIdentifier: \"not-allowed\" as \"not-allowed\",\n            persistentState: \"not-allowed\" as \"not-allowed\",\n          };\n\n          return observableOf(\n            new CustomMediaKeySystemAccess(keyType,\n                                           new CustomMediaKeys(keyType),\n                                           keySystemConfigurationResponse)\n          );\n        }\n      }\n\n      return observableThrow(undefined);\n    };\n  } else if (MediaKeys_ &&\n             MediaKeys_.prototype &&\n             typeof MediaKeys_.isTypeSupported === \"function\"\n  ) {\n\n    requestMediaKeySystemAccess = function(\n      keyType : string,\n      keySystemConfigurations : ICompatMediaKeySystemConfiguration[]\n    ) : Observable<ICompatMediaKeySystemAccess|CustomMediaKeySystemAccess> {\n      // TODO Why TS Do not understand that isTypeSupported exists here?\n      if (!(MediaKeys_ as any).isTypeSupported(keyType)) {\n        return observableThrow(undefined);\n      }\n\n      for (let i = 0; i < keySystemConfigurations.length; i++) {\n        const keySystemConfiguration = keySystemConfigurations[i];\n        const { videoCapabilities,\n                audioCapabilities,\n                initDataTypes,\n                distinctiveIdentifier } = keySystemConfiguration;\n\n        let supported = true;\n        supported = supported &&\n                    (!initDataTypes ||\n                     !!initDataTypes.filter((idt) => idt === \"cenc\")[0]);\n        supported = supported && (distinctiveIdentifier !== \"required\");\n\n        if (supported) {\n          const keySystemConfigurationResponse = {\n            videoCapabilities,\n            audioCapabilities,\n            initDataTypes: [\"cenc\"],\n            distinctiveIdentifier: \"not-allowed\" as \"not-allowed\",\n            persistentState: \"required\" as \"required\",\n            sessionTypes: [\"temporary\", \"persistent-license\"],\n          };\n\n          return observableOf(\n            new CustomMediaKeySystemAccess(\n              keyType,\n              new (MediaKeys_ as any)(keyType),\n              keySystemConfigurationResponse\n            )\n          );\n        }\n      }\n\n      return observableThrow(undefined);\n    };\n\n    if (isIE11 &&\n        typeof MediaKeys_.prototype.createSession === \"function\"\n    ) {\n      class IE11MediaKeySession\n      extends EventEmitter<IMediaKeySessionEvents>\n      implements ICustomMediaKeySession {\n        public readonly update: (license: ArrayBuffer,\n                                 sessionId?: string) => Promise<void>;\n        public readonly closed: Promise<void>;\n        public expiration: number;\n        public keyStatuses: ICustomMediaKeyStatusMap;\n        public sessionId: string;\n        private readonly _mk: MediaKeys|ICustomMediaKeys;\n        private readonly _closeSession$: Subject<void>;\n        private _ss?: MediaKeySession;\n        constructor(mk: MediaKeys|ICustomMediaKeys) {\n          super();\n          this.sessionId = \"\";\n          this.expiration = NaN;\n          this.keyStatuses = new Map();\n          this._mk = mk;\n          this._closeSession$ = new Subject();\n          this.closed = new PPromise((resolve) => {\n            this._closeSession$.subscribe(resolve);\n          });\n          this.update = wrapUpdate((license, sessionId) => {\n            if (!this._ss) {\n              throw new Error(\"MediaKeySession not set\");\n            }\n            (this._ss as any).update(license, sessionId);\n            this.sessionId = sessionId;\n          });\n        }\n        generateRequest(_initDataType: string, initData: ArrayBuffer): Promise<void> {\n          return new PPromise((resolve) => {\n            this._ss = (this._mk as any).createSession(\"video/mp4\",\n                                                       initData) as MediaKeySession;\n            observableMerge(events.onKeyMessage$(this._ss),\n                            events.onKeyAdded$(this._ss),\n                            events.onKeyError$(this._ss)\n            ).pipe(takeUntil(this._closeSession$))\n             .subscribe((evt: Event) => this.trigger(evt.type, evt));\n            resolve();\n          });\n        }\n        close(): Promise<void> {\n          return new PPromise((resolve) => {\n            if (this._ss) {\n              /* tslint:disable no-floating-promises */\n              this._ss.close();\n              /* tslint:enable no-floating-promises */\n              this._ss = undefined;\n            }\n            this._closeSession$.next();\n            this._closeSession$.complete();\n            resolve();\n          });\n        }\n        load(): Promise<boolean> {\n          return PPromise.resolve(false);\n        }\n        remove(): Promise<void> {\n          return PPromise.resolve();\n        }\n      }\n\n      createSession = function createIE11MediaKeySession(\n        mediaKeys : MediaKeys|ICustomMediaKeys\n        ) : ICustomMediaKeySession {\n        return new IE11MediaKeySession(mediaKeys);\n      };\n    }\n  }\n}\n\nexport default CustomMediaKeys;\nexport {\n  createSession,\n  requestMediaKeySystemAccess,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  be4toi,\n  strToBytes,\n} from \"../../utils/byte_parsing\";\n\n// The way \"pssh\" will be written in ISOBMFF files\nexport const PSSH_TO_INTEGER : number = be4toi(strToBytes(\"pssh\"), 0);\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  defer as observableDefer,\n  Observable,\n} from \"rxjs\";\nimport log from \"../../log\";\nimport {\n  be4toi,\n  concat,\n} from \"../../utils/byte_parsing\";\nimport castToObservable from \"../../utils/cast_to_observable\";\nimport { isIEOrEdge } from \"../browser_detection\";\nimport { PSSH_TO_INTEGER } from \"./constants\";\nimport { ICustomMediaKeySession } from \"./custom_media_keys\";\n\n/**\n * Some browsers have problems when the CENC PSSH box is the first managed PSSH\n * encountered (for the moment just Edge was noted with this behavior).\n *\n * This function tries to move CENC PSSH boxes at the end of the given init\n * data.\n *\n * If the initData is unrecognized or if a CENC PSSH is not found, this function\n * throws.\n * @param {Uint8Array} initData - Initialization data you want to patch\n * @returns {Uint8Array} - Initialization data, patched\n */\nexport function patchInitData(initData : Uint8Array) : Uint8Array {\n  const initialLength = initData.byteLength;\n  log.info(\"Compat: Trying to move CENC PSSH from init data at the end of it.\");\n  let cencs = new Uint8Array();\n  let resInitData = new Uint8Array();\n\n  let offset = 0;\n  while (offset < initData.length) {\n    if (initData.length < offset + 8 ||\n        be4toi(initData, offset + 4) !== PSSH_TO_INTEGER\n    ) {\n      log.warn(\"Compat: unrecognized initialization data. Cannot patch it.\");\n      throw new Error(\"Compat: unrecognized initialization data. Cannot patch it.\");\n    }\n\n    const len = be4toi(new Uint8Array(initData), offset);\n    if (offset + len > initData.length) {\n      log.warn(\"Compat: unrecognized initialization data. Cannot patch it.\");\n      throw new Error(\"Compat: unrecognized initialization data. Cannot patch it.\");\n    }\n\n    const currentPSSH = initData.subarray(offset, offset + len);\n    // yep\n    if (initData[offset + 12] === 0x10 &&\n        initData[offset + 13] === 0x77 &&\n        initData[offset + 14] === 0xef &&\n        initData[offset + 15] === 0xec &&\n        initData[offset + 16] === 0xc0 &&\n        initData[offset + 17] === 0xb2 &&\n        initData[offset + 18] === 0x4d &&\n        initData[offset + 19] === 0x02 &&\n        initData[offset + 20] === 0xac &&\n        initData[offset + 21] === 0xe3 &&\n        initData[offset + 22] === 0x3c &&\n        initData[offset + 23] === 0x1e &&\n        initData[offset + 24] === 0x52 &&\n        initData[offset + 25] === 0xe2 &&\n        initData[offset + 26] === 0xfb &&\n        initData[offset + 27] === 0x4b\n    ) {\n      log.info(\"Compat: CENC PSSH found.\");\n      cencs = concat(cencs, currentPSSH);\n    } else {\n      resInitData = concat(resInitData, currentPSSH);\n    }\n    offset += len;\n  }\n\n  if (offset !== initData.length) {\n    log.warn(\"Compat: unrecognized initialization data. Cannot patch it.\");\n    throw new Error(\"Compat: unrecognized initialization data. Cannot patch it.\");\n  }\n\n  if (resInitData.byteLength === initialLength) {\n    log.warn(\"Compat: CENC PSSH not found. Cannot patch it\");\n    throw new Error(\"Compat: unrecognized initialization data. Cannot patch it.\");\n  }\n  return concat(resInitData, cencs);\n}\n\n/**\n * Generate a request from session.\n * @param {MediaKeySession}session - MediaKeySession on which the request will\n * be done.\n * @param {Uint8Array}initData - Initialization data given e.g. by the\n * \"encrypted\" event for the corresponding request.\n * @param {string} initDataType - Initialization data type given e.g. by the\n * \"encrypted\" event for the corresponding request.\n * @param {string} sessionType - Type of session you want to generate. Consult\n * EME Specification for more information on session types.\n * @returns {Observable} - Emit when done. Errors if fails.\n */\nexport default function generateKeyRequest(\n  session: MediaKeySession|ICustomMediaKeySession,\n  initData: Uint8Array,\n  initDataType: string|undefined\n) : Observable<unknown> {\n  return observableDefer(() => {\n    log.debug(\"Compat: Calling generateRequest on the MediaKeySession\");\n    let patchedInit : Uint8Array;\n    if (isIEOrEdge) {\n      try {\n        patchedInit = patchInitData(initData);\n      } catch (_e) {\n        patchedInit = initData;\n      }\n    } else {\n      patchedInit = initData;\n    }\n    return castToObservable(session.generateRequest(initDataType || \"\",\n                                                    patchedInit));\n  });\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Convert given buffer to a 32bit integer hash\n * @param {Array.<number>|TypedArray} buffer\n * @returns {number}\n */\nexport default function hashBuffer(buffer : Uint8Array|number[]) : number {\n  let hash = 0;\n  let char;\n  for (let i = 0; i < buffer.length; i++) {\n    char = buffer[i];\n    hash = ((hash <<  5) - hash) + char;\n    hash = hash & hash; // Convert to 32bit integer\n  }\n  return hash;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Simple hash-based set.\n * @class SimpleSet\n */\nexport default class SimpleSet {\n  /**\n   * Hashes currently stored\n   * @type {Object}\n   * @private\n   */\n  private _hashes : Partial<Record<string, true>>;\n\n  constructor() {\n    this._hashes = {};\n  }\n\n  /**\n   * Add a new hash entry in the set.\n   * Do not have any effect on already-added hashes\n   * @param {string|number} x\n   */\n  public add(x : string|number) : void {\n    this._hashes[x] = true;\n  }\n\n  /**\n   * Remove an hash entry from the set.\n   * Do not have any effect on already-removed or inexistant hashes\n   * @param {string|number} x\n   */\n  public remove(x : string|number) : void {\n    delete this._hashes[x];\n  }\n\n  /**\n   * Test if the given hash has an entry in the set.\n   * @param {string|number} x\n   * @returns {boolean}\n   */\n  public test(x : string|number) : boolean {\n    return !!this._hashes[x];\n  }\n\n  /**\n   * Returns true if there's currently no hash in this set.\n   * @returns {boolean}\n   */\n  public isEmpty() : boolean {\n    return !Object.keys(this._hashes).length;\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { EncryptedMediaError } from \"../../errors\";\nimport log from \"../../log\";\nimport {\n  be4toi,\n  concat,\n} from \"../../utils/byte_parsing\";\nimport hashBuffer from \"../../utils/hash_buffer\";\nimport SimpleSet from \"../../utils/simple_set\";\nimport { PSSH_TO_INTEGER } from \"./constants\";\n\n/**\n * As we observed on some browsers (IE and Edge), the initialization data on\n * some segments have sometimes duplicated PSSH when sent through an encrypted\n * event (but not when pushed to the SourceBuffer).\n *\n * This function tries to guess if the initialization data contains only PSSHs\n * concatenated (as it is usually the case).\n * If that's the case, it will filter duplicated PSSHs from it.\n *\n * @param {Uint8Array} initData - Raw initialization data\n * @returns {Uint8Array} - Initialization data, \"cleaned\"\n */\nfunction cleanEncryptedEvent(initData : Uint8Array) : Uint8Array {\n  let resInitData = new Uint8Array();\n  const currentHashes = new SimpleSet();\n\n  let offset = 0;\n  while (offset < initData.length) {\n    if (initData.length < offset + 8 ||\n        be4toi(initData, offset + 4) !== PSSH_TO_INTEGER\n    ) {\n      log.warn(\"Compat: Unrecognized initialization data. Use as is.\");\n      return initData;\n    }\n\n    const len = be4toi(new Uint8Array(initData), offset);\n    if (offset + len > initData.length) {\n      log.warn(\"Compat: Unrecognized initialization data. Use as is.\");\n      return initData;\n    }\n    const currentPSSH = initData.subarray(offset, offset + len);\n    const currentPSSHHash = hashBuffer(currentPSSH);\n    if (!currentHashes.test(currentPSSHHash)) {\n      currentHashes.add(currentPSSHHash);\n      resInitData = concat(resInitData, currentPSSH);\n    } else {\n      log.warn(\"Compat: Duplicated PSSH found in initialization data, removing it.\");\n    }\n    offset += len;\n  }\n\n  if (offset !== initData.length) {\n    log.warn(\"Compat: Unrecognized initialization data. Use as is.\");\n    return initData;\n  }\n  return resInitData;\n}\n\n/**\n * Take out the two things we need on an encryptedEvent:\n *   - the initialization Data\n *   - the initialization Data type\n *\n * @param {MediaEncryptedEvent} encryptedEvent - Payload received with an\n * \"encrypted\" event.\n * @returns {Object} - Initialization data and Initialization data type.\n * @throws {EncryptedMediaError} - Throws if no initialization data is\n * encountered in the given event.\n */\nexport default function getInitData(\n  encryptedEvent : MediaEncryptedEvent\n) : {\n  initData : Uint8Array;\n  initDataType : string|undefined;\n} {\n  const initData = encryptedEvent.initData;\n  if (initData == null) {\n    throw new EncryptedMediaError(\"INVALID_ENCRYPTED_EVENT\",\n                                  \"Compat: No init data found on media encrypted event.\");\n  }\n\n  const initDataBytes = new Uint8Array(initData);\n  return { initData: cleanEncryptedEvent(initDataBytes),\n           initDataType: encryptedEvent.initDataType };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  defer as observableDefer,\n  Observable\n} from \"rxjs\";\nimport castToObservable from \"../../utils/cast_to_observable\";\nimport CustomMediaKeys, {\n  ICustomMediaKeys,\n} from \"./custom_media_keys\";\n\n/**\n * Set the MediaKeys given on the media element.\n * @param {HTMLMediaElement} elt\n * @param {Object} mediaKeys\n * @returns {*}\n */\nfunction _setMediaKeys(\n  elt : HTMLMediaElement,\n  mediaKeys : MediaKeys|ICustomMediaKeys|null\n) : any {\n  if (mediaKeys instanceof CustomMediaKeys) {\n    return mediaKeys._setVideo(elt);\n  }\n\n  if (elt.setMediaKeys) {\n    return elt.setMediaKeys(mediaKeys);\n  }\n\n  if (mediaKeys === null) {\n    return;\n  }\n\n  if ((elt as any).WebkitSetMediaKeys) {\n    return (elt as any).WebkitSetMediaKeys(mediaKeys);\n  }\n\n  if ((elt as any).mozSetMediaKeys) {\n    return (elt as any).mozSetMediaKeys(mediaKeys);\n  }\n\n  if ((elt as any).msSetMediaKeys) {\n    return (elt as any).msSetMediaKeys(mediaKeys);\n  }\n}\n\n/**\n * Set the given MediaKeys on the given HTMLMediaElement.\n * Emits null when done then complete.\n * @param {HTMLMediaElement} elt\n * @param {Object} mediaKeys\n * @returns {Observable}\n */\nexport default function setMediaKeys$(\n  elt : HTMLMediaElement,\n  mediaKeys : MediaKeys|ICustomMediaKeys|null\n) : Observable<unknown> {\n  return observableDefer(() => castToObservable(_setMediaKeys(elt, mediaKeys)));\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport CustomMediaKeySystemAccess, {\n  ICustomMediaKeySystemAccess,\n} from \"./custom_key_system_access\";\nimport {\n  createSession,\n  ICustomMediaKeys,\n  ICustomMediaKeySession,\n  requestMediaKeySystemAccess,\n} from \"./custom_media_keys\";\nimport generateKeyRequest from \"./generate_key_request\";\nimport getInitData from \"./get_init_data\";\nimport setMediaKeys from \"./set_media_keys\";\n\nexport {\n  CustomMediaKeySystemAccess,\n  createSession,\n  generateKeyRequest,\n  getInitData,\n  ICustomMediaKeySession,\n  ICustomMediaKeySystemAccess,\n  ICustomMediaKeys,\n  requestMediaKeySystemAccess,\n  setMediaKeys,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ICompatDocument,\n  ICompatHTMLMediaElement,\n} from \"./browser_compatibility_types\";\n\n/**\n * Request fullScreen action on a given element.\n * @param {HTMLElement} elt\n * rs-detect)\n */\nfunction requestFullscreen(element : HTMLMediaElement) : void {\n  if (!isFullscreen()) {\n    const elt = element as ICompatHTMLMediaElement;\n    if (elt.requestFullscreen) {\n      /* tslint:disable no-floating-promises */\n      elt.requestFullscreen();\n      /* tslint:enable no-floating-promises */\n    } else if (elt.msRequestFullscreen) {\n      elt.msRequestFullscreen();\n    } else if (elt.mozRequestFullScreen) {\n      elt.mozRequestFullScreen();\n    } else if (elt.webkitRequestFullscreen) {\n      (\n        elt.webkitRequestFullscreen as any\n      )((Element as any).ALLOW_KEYBOARD_INPUT);\n    }\n  }\n}\n\n/**\n * Exit fullscreen if an element is currently in fullscreen.\n */\nfunction exitFullscreen() : void {\n  if (isFullscreen()) {\n    const doc = document as ICompatDocument;\n    if (doc.exitFullscreen) {\n      /* tslint:disable no-floating-promises */\n      doc.exitFullscreen();\n      /* tslint:enable no-floating-promises */\n    } else if (doc.msExitFullscreen) {\n      doc.msExitFullscreen();\n    } else if (doc.mozCancelFullScreen) {\n      doc.mozCancelFullScreen();\n    } else if (doc.webkitExitFullscreen) {\n      doc.webkitExitFullscreen();\n    }\n  }\n}\n\n/**\n * Returns true if an element in the document is being displayed in fullscreen\n * mode;\n * otherwise it's false.\n * @returns {boolean}\n */\nfunction isFullscreen() : boolean {\n  const doc = document as ICompatDocument;\n  return !!(doc.fullscreenElement ||\n            doc.mozFullScreenElement ||\n            doc.webkitFullscreenElement ||\n            doc.msFullscreenElement);\n}\n\nexport {\n  requestFullscreen,\n  exitFullscreen,\n  isFullscreen,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { requestMediaKeySystemAccess } from \"./eme\";\n\n/**\n * Returns true if the browser has the minimum needed EME APIs to decrypt a\n * content.\n * @returns {Boolean}\n */\nexport default function hasEMEAPIs() : boolean {\n  return typeof requestMediaKeySystemAccess === \"function\";\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { MediaSource_ } from \"./browser_compatibility_types\";\n\n/**\n * Returns true if the given codec is supported by the browser's MediaSource\n * implementation.\n * @returns {Boolean}\n */\nexport default function isCodecSupported(codec : string) : boolean {\n  if (!MediaSource_) {\n    return false;\n  }\n\n  /* tslint:disable no-unbound-method */\n  if (typeof MediaSource_.isTypeSupported === \"function\") {\n  /* tslint:enable no-unbound-method */\n    return MediaSource_.isTypeSupported(codec);\n  }\n\n  return true;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Some browsers have a builtin API to know if it's connected at least to a\n * LAN network, at most to the internet.\n *\n * /!\\ This feature can be dangerous as you can both have false positives and\n * false negatives.\n *\n * False positives:\n *   - you can still play local contents (on localhost) if isOffline == true\n *   - on some browsers isOffline might be true even if we're connected to a LAN\n *     or a router (it would mean we're just not able to connect to the\n *     Internet). So we can eventually play LAN contents if isOffline == true\n *\n * False negatives:\n *   - in some cases, we even might have isOffline at false when we do not have\n *     any connection:\n *       - in browsers that do not support the feature\n *       - in browsers running in some virtualization softwares where the\n *         network adapters are always connected.\n *\n * Use with these cases in mind.\n * @returns {Boolean}\n */\nexport default function isOffline() : boolean {\n  /* tslint:disable no-boolean-literal-compare */\n  return navigator.onLine === false;\n  /* tslint:enable no-boolean-literal-compare */\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isFirefox } from \"./browser_detection\";\n\n/**\n * firefox fix: sometimes playback can be stalled, even if we are in a buffer.\n * TODO This seems to be about an old Firefox version. Delete it?\n * @param {number} time\n * @param {Object|null} currentRange\n * @param {string} state\n * @param {Boolean} isStalled\n * @returns {Boolean}\n */\nexport default function isPlaybackStuck(\n  time : number,\n  currentRange : { start: number;\n                   end: number; } |\n                 null,\n  state : string,\n  isStalled : boolean\n) : boolean {\n  const FREEZE_THRESHOLD = 10; // freeze threshold in seconds\n  return (isFirefox &&\n          isStalled &&\n          state === \"timeupdate\" &&\n          !!currentRange &&\n          currentRange.end - time > FREEZE_THRESHOLD);\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ICompatVTTCue } from \"./browser_compatibility_types\";\n\n/**\n * Returns true if the given cue is an instance of a VTTCue.\n * @param {*} cue\n * @returns {boolean}\n */\nexport default function isVTTCue(\n  cue : ICompatVTTCue|TextTrackCue\n) : cue is ICompatVTTCue {\n  return typeof (window as any).VTTCue === \"function\" &&\n         cue instanceof (window as any).VTTCue;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../log\";\nimport {\n  ICompatVTTCue,\n  VTTCue_,\n} from \"./browser_compatibility_types\";\n\n/**\n * Creates a cue using the best platform-specific interface available.\n *\n * @param {Number} startTime\n * @param {Number} endTime\n * @param {string} payload\n * @returns {VTTCue|TextTrackCue|null} Text track cue or null if the parameters\n * were invalid.\n */\nexport default function makeCue(\n  startTime : number,\n  endTime : number,\n  payload : string\n) : ICompatVTTCue|TextTrackCue|null {\n  if (!VTTCue_) {\n    throw new Error(\"VTT cues not supported in your target\");\n  }\n  if (startTime >= endTime) {\n\n    // IE/Edge will throw in this case.\n    // See issue #501\n    log.warn(\"Compat: Invalid cue times: \" + startTime + \" - \" + endTime);\n    return null;\n  }\n\n  return new VTTCue_(startTime, endTime, payload);\n}\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","'use strict';\n\nvar callable, byObserver;\n\ncallable = function (fn) {\n\tif (typeof fn !== 'function') throw new TypeError(fn + \" is not a function\");\n\treturn fn;\n};\n\nbyObserver = function (Observer) {\n\tvar node = document.createTextNode(''), queue, currentQueue, i = 0;\n\tnew Observer(function () {\n\t\tvar callback;\n\t\tif (!queue) {\n\t\t\tif (!currentQueue) return;\n\t\t\tqueue = currentQueue;\n\t\t} else if (currentQueue) {\n\t\t\tqueue = currentQueue.concat(queue);\n\t\t}\n\t\tcurrentQueue = queue;\n\t\tqueue = null;\n\t\tif (typeof currentQueue === 'function') {\n\t\t\tcallback = currentQueue;\n\t\t\tcurrentQueue = null;\n\t\t\tcallback();\n\t\t\treturn;\n\t\t}\n\t\tnode.data = (i = ++i % 2); // Invoke other batch, to handle leftover callbacks in case of crash\n\t\twhile (currentQueue) {\n\t\t\tcallback = currentQueue.shift();\n\t\t\tif (!currentQueue.length) currentQueue = null;\n\t\t\tcallback();\n\t\t}\n\t}).observe(node, { characterData: true });\n\treturn function (fn) {\n\t\tcallable(fn);\n\t\tif (queue) {\n\t\t\tif (typeof queue === 'function') queue = [queue, fn];\n\t\t\telse queue.push(fn);\n\t\t\treturn;\n\t\t}\n\t\tqueue = fn;\n\t\tnode.data = (i = ++i % 2);\n\t};\n};\n\nmodule.exports = (function () {\n\t// Node.js\n\tif ((typeof process === 'object') && process && (typeof process.nextTick === 'function')) {\n\t\treturn process.nextTick;\n\t}\n\n\t// MutationObserver\n\tif ((typeof document === 'object') && document) {\n\t\tif (typeof MutationObserver === 'function') return byObserver(MutationObserver);\n\t\tif (typeof WebKitMutationObserver === 'function') return byObserver(WebKitMutationObserver);\n\t}\n\n\t// W3C Draft\n\t// http://dvcs.w3.org/hg/webperf/raw-file/tip/specs/setImmediate/Overview.html\n\tif (typeof setImmediate === 'function') {\n\t\treturn function (cb) { setImmediate(callable(cb)); };\n\t}\n\n\t// Wide available standard\n\tif ((typeof setTimeout === 'function') || (typeof setTimeout === 'object')) {\n\t\treturn function (cb) { setTimeout(callable(cb), 0); };\n\t}\n\n\treturn null;\n}());\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport nextTick from \"next-tick\";\nimport EventEmitter from \"../utils/event_emitter\";\n\ntype IWebKitSourceBufferConstructor = new() => IWebKitSourceBuffer;\n\ninterface IWebKitSourceBuffer { append(data : ArrayBuffer) : void;\n                                remove(from : number, to : number) : void; }\n\n// TODO This is the last ugly side-effect here.\n// Either remove it or find the best way to implement that\nexport default function patchWebkitSourceBuffer() {\n  // old WebKit SourceBuffer implementation,\n  // where a synchronous append is used instead of appendBuffer\n  if ((window as any).WebKitSourceBuffer &&\n      !(window as any).WebKitSourceBuffer.prototype.addEventListener\n  ) {\n\n    const sourceBufferWebkitRef : IWebKitSourceBufferConstructor =\n      (window as any).WebKitSourceBuffer;\n    const sourceBufferWebkitProto = sourceBufferWebkitRef.prototype;\n\n    for (const fnName in EventEmitter.prototype) {\n      if (EventEmitter.prototype.hasOwnProperty(fnName)) {\n        sourceBufferWebkitProto[fnName] = (EventEmitter.prototype as any)[fnName];\n      }\n    }\n\n    sourceBufferWebkitProto._listeners = [];\n\n    sourceBufferWebkitProto.__emitUpdate =\n      function(eventName : string, val : any) {\n        nextTick(() => {\n          /* tslint:disable no-invalid-this */\n          this.trigger(eventName, val);\n          this.updating = false;\n          this.trigger(\"updateend\");\n          /* tslint:enable no-invalid-this */\n        });\n      };\n\n    sourceBufferWebkitProto.appendBuffer =\n      function(data : any) {\n        /* tslint:disable no-invalid-this */\n        if (this.updating) {\n          throw new Error(\"updating\");\n        }\n        this.trigger(\"updatestart\");\n        this.updating = true;\n        try {\n          this.append(data);\n        } catch (error) {\n          this.__emitUpdate(\"error\", error);\n          return;\n        }\n        this.__emitUpdate(\"update\");\n        /* tslint:enable no-invalid-this */\n      };\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Observable,\n  throwError as observableThrow,\n} from \"rxjs\";\n\n/**\n * @param {Function} func - A function you want to execute\n * @param {*} args - The function's argument\n * @returns {*} - If it fails, returns a throwing Observable, else the\n * function's result (which should be, in most cases, an Observable).\n */\nexport default function tryCatch<T, I>(\n  func : (args : T) => Observable<I>,\n  args : T\n) : Observable<I> {\n  try {\n    return func(args);\n  } catch (e) {\n    return observableThrow(e);\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  defer as observableDefer,\n  Observable,\n} from \"rxjs\";\nimport castToObservable from \"../utils/cast_to_observable\";\nimport tryCatch from \"../utils/rx-try_catch\";\n\n/**\n * Call play on the media element on subscription and return the response as an\n * observable.\n * @param {HTMLMediaElement} mediaElement\n * @returns {Observable}\n */\nexport default function play$(mediaElement : HTMLMediaElement) : Observable<unknown> {\n  return observableDefer(() =>\n    // mediaElement.play is not always a Promise. In the improbable case it\n    // throws, I prefer still to catch to return the error wrapped in an\n    // Observable\n    tryCatch(() => castToObservable(mediaElement.play()), undefined)\n  );\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Observable,\n  Observer,\n} from \"rxjs\";\nimport log from \"../log\";\nimport clearElementSrc from \"./clear_element_src\";\n\n/**\n * Set an URL to the element's src.\n * Emit ``undefined`` when done.\n * Unlink src on unsubscription.\n *\n * @param {HTMLMediaElement} mediaElement\n * @param {string} url\n * @returns {Observable}\n */\nexport default function setElementSrc$(\n  mediaElement : HTMLMediaElement,\n  url : string\n) : Observable<void> {\n  return new Observable((observer : Observer<void>) => {\n    log.info(\"Setting URL to Element\", url, mediaElement);\n\n    mediaElement.src = url;\n\n    observer.next(undefined);\n    return () => {\n      clearElementSrc(mediaElement);\n    };\n  });\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isIE11 } from \"./browser_detection\";\n\n/**\n * Returns true if the current target require the media keys to be renewed on\n * each content.\n * @returns {Boolean}\n */\nexport default function shouldRenewMediaKeys() : boolean {\n  return isIE11;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isIE11 } from \"./browser_detection\";\n\n/**\n * Returns true if the mediakeys associated to a media element should be\n * unset once the content is stopped.\n * Depends on the target.\n * @returns {Boolean}\n */\nexport default function shouldUnsetMediaKeys() : boolean {\n  return isIE11;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isSamsungBrowser } from \"./browser_detection\";\n\n/**\n * Returns true if the metadata received after a \"loadedmetadata\" event has\n * to be validated in the current browser (which means that we do not trust\n * this event on these browsers).\n * @returns {boolean}\n */\nexport default function shouldValidateMetadata() : boolean {\n  return isSamsungBrowser;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Observable,\n  of as observableOf,\n} from \"rxjs\";\nimport { take } from \"rxjs/operators\";\nimport { READY_STATES } from \"./browser_compatibility_types\";\nimport { onLoadedMetadata$ } from \"./event_listeners\";\n\n/**\n * Returns an observable emitting a single time, as soon as a seek is possible\n * (the metadata are loaded).\n * @param {HTMLMediaElement} mediaElement\n * @returns {Observable}\n */\nexport default function whenLoadedMetadata$(\n  mediaElement : HTMLMediaElement\n) : Observable<unknown> {\n  if (mediaElement.readyState >= READY_STATES.HAVE_METADATA) {\n    return observableOf(null);\n  } else {\n    return onLoadedMetadata$(mediaElement)\n      .pipe(take(1));\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Observable,\n  of as observableOf,\n} from \"rxjs\";\nimport { take } from \"rxjs/operators\";\nimport { onSourceOpen$ } from \"./event_listeners\";\n\n/**\n * Wait for the MediaSource's sourceopen event and emit. Emit immediatelly if\n * already received.\n * @param {MediaSource} mediaSource\n * @returns {Observable}\n */\nexport default function whenMediaSourceOpen$(\n  mediaSource : MediaSource\n) : Observable<Event|null> {\n  if (mediaSource.readyState === \"open\") {\n    return observableOf(null);\n  } else {\n    return onSourceOpen$(mediaSource)\n      .pipe(take(1));\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport addTextTrack from \"./add_text_track\";\nimport {\n  ICompatMediaKeySystemAccess,\n  ICompatMediaKeySystemConfiguration,\n  ICompatTextTrack,\n  ICompatVTTCue,\n  MediaSource_,\n  VTTCue_,\n} from \"./browser_compatibility_types\";\nimport canPatchISOBMFFSegment from \"./can_patch_isobmff\";\nimport tryToChangeSourceBufferType, {\n  ICustomSourceBuffer,\n} from \"./change_source_buffer_type\";\nimport clearElementSrc from \"./clear_element_src\";\nimport {\n  createSession,\n  CustomMediaKeySystemAccess,\n  generateKeyRequest,\n  getInitData,\n  ICustomMediaKeys,\n  ICustomMediaKeySession,\n  ICustomMediaKeySystemAccess,\n  requestMediaKeySystemAccess,\n  setMediaKeys,\n} from \"./eme\";\nimport * as events from \"./event_listeners\";\nimport {\n  exitFullscreen,\n  isFullscreen,\n  requestFullscreen,\n} from \"./fullscreen\";\nimport hasEMEAPIs from \"./has_eme_apis\";\nimport isCodecSupported from \"./is_codec_supported\";\nimport isOffline from \"./is_offline\";\nimport isPlaybackStuck from \"./is_playback_stuck\";\nimport isVTTCue from \"./is_vtt_cue\";\nimport makeVTTCue from \"./make_vtt_cue\";\nimport patchWebkitSourceBuffer from \"./patch_webkit_source_buffer\";\nimport play$ from \"./play\";\nimport setElementSrc$ from \"./set_element_src\";\nimport shouldRenewMediaKeys from \"./should_renew_media_keys\";\nimport shouldUnsetMediaKeys from \"./should_unset_media_keys\";\nimport shouldValidateMetadata from \"./should_validate_metadata\";\nimport whenLoadedMetadata$ from \"./when_loaded_metadata\";\nimport whenMediaSourceOpen$ from \"./when_media_source_open\";\n\n// TODO TO REMOVE\npatchWebkitSourceBuffer();\n\nexport {\n  addTextTrack,\n  canPatchISOBMFFSegment,\n  clearElementSrc,\n  createSession,\n  CustomMediaKeySystemAccess,\n  events,\n  exitFullscreen,\n  generateKeyRequest,\n  getInitData,\n  hasEMEAPIs,\n  ICompatMediaKeySystemAccess,\n  ICompatMediaKeySystemConfiguration,\n  ICompatTextTrack,\n  ICompatVTTCue,\n  ICustomMediaKeySession,\n  ICustomMediaKeySystemAccess,\n  ICustomMediaKeys,\n  ICustomSourceBuffer,\n  isCodecSupported,\n  isFullscreen,\n  isOffline,\n  isPlaybackStuck,\n  isVTTCue,\n  makeVTTCue,\n  MediaSource_,\n  play$,\n  requestFullscreen,\n  requestMediaKeySystemAccess,\n  setElementSrc$,\n  setMediaKeys,\n  shouldRenewMediaKeys,\n  shouldUnsetMediaKeys,\n  shouldValidateMetadata,\n  tryToChangeSourceBufferType,\n  VTTCue_,\n  whenLoadedMetadata$,\n  whenMediaSourceOpen$,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isCodecSupported }from \"../compat\";\nimport { IParsedRepresentation } from \"../parsers/manifest\";\n\n/**\n * Only keep Representations for which the codec is currently supported.\n * @param {string} adaptationType\n * @param {Array.<Object>} representations\n * @returns {Array.<Object>}\n */\nexport default function filterSupportedRepresentations(\n  adaptationType : string,\n  representations : IParsedRepresentation[]\n) : IParsedRepresentation[] {\n  if (adaptationType === \"audio\" || adaptationType === \"video\") {\n    return representations\n      .filter((representation) => isCodecSupported(getCodec(representation)));\n  }\n\n  return representations; // TODO for the other types?\n}\n\n/**\n * Construct the codec string from given codecs and mimetype.\n * @param {Object} representation\n * @returns {string}\n */\nfunction getCodec(representation : IParsedRepresentation) : string {\n  const { codecs = \"\", mimeType = \"\" } = representation;\n  return `${mimeType};codecs=\"${codecs}\"`;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IParsedRepresentation } from \"../parsers/manifest\";\nimport IRepresentationIndex from \"./representation_index\";\n\ninterface IContentProtection { keyId? : Uint8Array;\n                               systemId? : string; }\n\n/**\n * Normalized Representation structure.\n * @class Representation\n */\nclass Representation {\n  // ID uniquely identifying the Representation in the Adaptation.\n  // TODO unique for the whole manifest?\n  public readonly id : string|number;\n\n  // Interface allowing to request segments for specific times.\n  public index : IRepresentationIndex;\n\n  // Bitrate this Representation is in, in bits per seconds.\n  public bitrate : number;\n\n  // Frame-rate, when it can be applied, of this Representation, in any textual\n  // indication possible (often under a ratio form).\n  public frameRate? : string;\n\n  // A string describing the codec used for this Representation.\n  // Examples: vp9, hvc, stpp\n  // undefined if we do not know.\n  public codec? : string;\n\n  // A string describing the mime-type for this Representation.\n  // Examples: audio/mp4, video/webm, application/mp4, text/plain\n  // undefined if we do not know.\n  public mimeType? : string;\n\n  // If this Representation is linked to video content, this value is the width\n  // in pixel of the corresponding video data.\n  public width? : number;\n\n  // If this Representation is linked to video content, this value is the height\n  // in pixel of the corresponding video data.\n  public height? : number;\n\n  // DRM Information for this Representation.\n  public contentProtections? : IContentProtection[];\n\n  /**\n   * @param {Object} args\n   */\n  constructor(args : IParsedRepresentation) {\n    this.id = args.id;\n    this.bitrate = args.bitrate;\n    this.codec = args.codecs;\n\n    if (args.height != null) {\n      this.height = args.height;\n    }\n\n    if (args.width != null) {\n      this.width = args.width;\n    }\n\n    if (args.mimeType != null) {\n      this.mimeType = args.mimeType;\n    }\n\n    if (args.contentProtections) {\n      this.contentProtections = args.contentProtections;\n    }\n\n    if (args.frameRate) {\n      this.frameRate = args.frameRate;\n    }\n\n    this.index = args.index;\n  }\n\n  /**\n   * Returns \"mime-type string\" which includes both the mime-type and the codec,\n   * which is often needed when interacting with the browser's APIs.\n   * @returns {string}\n   */\n  getMimeTypeString() : string {\n    return `${this.mimeType};codecs=\"${this.codec}\"`;\n  }\n}\n\nexport default Representation;\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ICustomError,\n  MediaError,\n} from \"../errors\";\nimport log from \"../log\";\nimport { IParsedAdaptation } from \"../parsers/manifest\";\nimport arrayFind from \"../utils/array_find\";\nimport arrayIncludes from \"../utils/array_includes\";\nimport normalizeLanguage from \"../utils/languages\";\nimport uniq from \"../utils/uniq\";\nimport filterSupportedRepresentations from \"./filter_supported_representations\";\nimport Representation from \"./representation\";\n\nexport type IAdaptationType = \"video\" | \"audio\" | \"text\" | \"image\";\n\nexport const SUPPORTED_ADAPTATIONS_TYPE: IAdaptationType[] = [ \"audio\",\n                                                               \"video\",\n                                                               \"text\",\n                                                               \"image\" ];\n\nfunction isSupportedAdaptationType(\n  adaptationType : string\n) : adaptationType is IAdaptationType {\n  return arrayIncludes(SUPPORTED_ADAPTATIONS_TYPE, adaptationType);\n}\n\nexport interface IRepresentationInfos { bufferType: IAdaptationType;\n                                        language?: string;\n                                        isAudioDescription? : boolean;\n                                        isClosedCaption? : boolean;\n                                        normalizedLanguage? : string; }\n\nexport type IRepresentationFilter = (representation: Representation,\n                                     adaptationInfos: IRepresentationInfos)\n                                    => boolean;\n\n/**\n * Normalized Adaptation structure.\n * An Adaptation describes a single `Track`. For example a specific audio\n * track (in a given language) or a specific video track.\n * It istelf can be represented in different qualities, which we call here\n * `Representation`.\n * @class Adaptation\n */\nexport default class Adaptation {\n\n  // ID uniquely identifying the Adaptation in the Period.\n  public readonly id : string;\n\n  // Different `Representations` (e.g. qualities) this Adaptation is available\n  // in.\n  public readonly representations : Representation[];\n\n  // Type of this Adaptation.\n  public readonly type : IAdaptationType;\n\n  // Whether this track contains an audio description for the visually impaired.\n  public isAudioDescription? : boolean;\n\n  // Whether this Adaptation contains closed captions for the hard-of-hearing.\n  public isClosedCaption? : boolean;\n\n  // Language this Adaptation is in, as announced in the original Manifest.\n  public language? : string;\n\n  // Language this Adaptation is in, when translated into an ISO639-3 code.\n  public normalizedLanguage? : string;\n\n  // `true` if this Adaptation was not present in the original Manifest, but was\n  // manually added after through the corresponding APIs.\n  public manuallyAdded : boolean;\n\n  // Array containing every errors that happened when the Adaptation has been\n  // created, in the order they have happened.\n  public readonly parsingErrors : ICustomError[];\n\n  /**\n   * @constructor\n   * @param {Object} parsedAdaptation\n   * @param {Object|undefined} [options]\n   */\n  constructor(parsedAdaptation : IParsedAdaptation, options : {\n    representationFilter? : IRepresentationFilter;\n    isManuallyAdded? : boolean;\n  } = {}) {\n    const { representationFilter, isManuallyAdded } = options;\n    this.parsingErrors = [];\n    this.id = parsedAdaptation.id;\n\n    if (!isSupportedAdaptationType(parsedAdaptation.type)) {\n      log.info(\"Manifest: Not supported adaptation type\", parsedAdaptation.type);\n      throw new MediaError(\"MANIFEST_UNSUPPORTED_ADAPTATION_TYPE\",\n                           `\"${parsedAdaptation.type}\" is not a valid ` +\n                           \"Adaptation type.\");\n    }\n    this.type = parsedAdaptation.type;\n\n    const hadRepresentations = !!parsedAdaptation.representations.length;\n    const argsRepresentations =\n      filterSupportedRepresentations(parsedAdaptation.type,\n                                     parsedAdaptation.representations);\n\n    if (hadRepresentations && argsRepresentations.length === 0) {\n      log.warn(\"Incompatible codecs for adaptation\", parsedAdaptation);\n      const error = new MediaError(\"MANIFEST_INCOMPATIBLE_CODECS_ERROR\",\n                                   \"An Adaptation contains only incompatible codecs.\");\n      this.parsingErrors.push(error);\n    }\n\n    if (parsedAdaptation.language != null) {\n      this.language = parsedAdaptation.language;\n      this.normalizedLanguage = normalizeLanguage(parsedAdaptation.language);\n    }\n\n    if (parsedAdaptation.closedCaption != null) {\n      this.isClosedCaption = parsedAdaptation.closedCaption;\n    }\n    if (parsedAdaptation.audioDescription != null) {\n      this.isAudioDescription = parsedAdaptation.audioDescription;\n    }\n\n    this.representations = argsRepresentations\n      .map(representation => new Representation(representation))\n      .sort((a, b) => a.bitrate - b.bitrate)\n      .filter(representation => {\n        if (representationFilter == null) {\n          return true;\n        }\n        return representationFilter(representation,\n                                    { bufferType: this.type,\n                                      language: this.language,\n                                      normalizedLanguage: this.normalizedLanguage,\n                                      isClosedCaption: this.isClosedCaption,\n                                      isAudioDescription: this.isAudioDescription });\n      });\n\n    // for manuallyAdded adaptations (not in the manifest)\n    this.manuallyAdded = !!isManuallyAdded;\n  }\n\n  /**\n   * Returns unique bitrate for every Representation in this Adaptation.\n   * @returns {Array.<Number>}\n   */\n  getAvailableBitrates() : number[] {\n    const bitrates = this.representations.map(r => r.bitrate);\n    return uniq(bitrates);\n  }\n\n  /**\n   * Returns the Representation linked to the given ID.\n   * @param {number|string} wantedId\n   * @returns {Object|undefined}\n   */\n  getRepresentation(wantedId : number|string) : Representation|undefined {\n    return arrayFind(this.representations, ({ id }) => wantedId === id);\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Adaptation from \"./adaptation\";\nimport Period from \"./period\";\nimport Representation from \"./representation\";\nimport { ISegment } from \"./representation_index\";\n\ninterface IBufferedChunkInfos { adaptation : Adaptation;\n                                period : Period;\n                                representation : Representation;\n                                segment : ISegment; }\n\n/**\n * Check if two contents are the same\n * @param {Object} content1\n * @param {Object} content2\n * @returns {boolean}\n */\nexport default function areSameContent(\n  content1: IBufferedChunkInfos,\n  content2: IBufferedChunkInfos\n): boolean {\n  return (content1.segment.id === content2.segment.id &&\n          content1.representation.id === content2.representation.id &&\n          content1.adaptation.id === content2.adaptation.id &&\n          content1.period.id === content2.period.id);\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Creates an ID generator which generates an ID each time you call it.\n * @returns {Function}\n */\nexport default function idGenerator() : () => string {\n  let lastID = 0;\n  return function generateNewId() : string {\n    return \"\" + lastID++;\n  };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport arrayIncludes from \"./array_includes\";\n\nconst WARNED_MESSAGES : string[] = [];\n\n/**\n * Perform a console.warn only once in the application lifetime.\n *\n * Useful for deprecated messages, for example.\n *\n * @param {string} message\n */\nexport default function warnOnce(message : string) : void {\n  if (!arrayIncludes(WARNED_MESSAGES, message)) {\n    /* tslint:disable no-console */\n    console.warn(message);\n    /* tslint:enable no-console */\n    WARNED_MESSAGES.push(message);\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @param {Object|Array} o\n * @returns {Array.<*>}\n */\nfunction objectValues<T>(o : { [s: string] : T } | ArrayLike<T>) : T[] {\n  return Object.keys(o).map((k) => (o as any)[k]);\n}\n\n/* tslint:disable no-unbound-method */\nexport default typeof Object.values === \"function\" ? Object.values :\n                                                     objectValues;\n/* tslint:enable no-unbound-method */\n\nexport {\n  objectValues,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  ICustomError,\n  MediaError,\n} from \"../errors\";\nimport { IParsedPeriod } from \"../parsers/manifest\";\nimport arrayFind from \"../utils/array_find\";\nimport objectValues from \"../utils/object_values\";\nimport Adaptation, {\n  IAdaptationType,\n  IRepresentationFilter,\n} from \"./adaptation\";\n\n// Structure listing every `Adaptation` in a Period.\nexport type IManifestAdaptations = Partial<Record<IAdaptationType, Adaptation[]>>;\n\n/**\n * Class representing a single `Period` of the Manifest.\n * A Period contains every information about the content available for a\n * specific period in time.\n * @class Period\n */\nexport default class Period {\n  // ID uniquely identifying the Period in the Manifest.\n  public readonly id : string;\n\n  // Every 'Adaptation' in that Period, per type of Adaptation.\n  public adaptations : IManifestAdaptations;\n\n  // Duration of this Period, in seconds.\n  // `undefined` for still-running Periods.\n  public duration? : number;\n\n  // Absolute start time of the Period, in seconds.\n  public start : number;\n\n  // Absolute end time of the Period, in seconds.\n  // `undefined` for still-running Periods.\n  public end? : number;\n\n  // Array containing every errors that happened when the Period has been\n  // created, in the order they have happened.\n  public readonly parsingErrors : ICustomError[];\n\n  /**\n   * @constructor\n   * @param {Object} args\n   * @param {function|undefined} [representationFilter]\n   */\n  constructor(\n    args : IParsedPeriod,\n    representationFilter? : IRepresentationFilter\n  ) {\n    this.parsingErrors = [];\n    this.id = args.id;\n    this.adaptations = (Object.keys(args.adaptations) as IAdaptationType[])\n      .reduce<IManifestAdaptations>((acc, type) => {\n        const adaptationsForType = args.adaptations[type];\n        if (!adaptationsForType) {\n          return acc;\n        }\n        const filteredAdaptations = adaptationsForType\n          .map((adaptation) : Adaptation|null => {\n            let newAdaptation : Adaptation|null = null;\n            try {\n              newAdaptation = new Adaptation(adaptation, { representationFilter });\n            } catch (err) {\n              if (err.code === \"MANIFEST_UNSUPPORTED_ADAPTATION_TYPE\") {\n                this.parsingErrors.push(err);\n                return null;\n              }\n              throw err;\n            }\n            this.parsingErrors.push(...newAdaptation.parsingErrors);\n            return newAdaptation;\n          })\n          .filter((adaptation) : adaptation is Adaptation =>\n            adaptation != null && adaptation.representations.length > 0\n          );\n        if (filteredAdaptations.length === 0 &&\n            adaptationsForType.length > 0 &&\n            (type === \"video\" || type === \"audio\")\n        ) {\n          throw new MediaError(\"MANIFEST_PARSE_ERROR\",\n                               \"No supported \" + type + \" adaptations\");\n        }\n\n        if (filteredAdaptations.length) {\n          acc[type] = filteredAdaptations;\n        }\n        return acc;\n      }, {});\n\n    if (!this.adaptations.video && !this.adaptations.audio) {\n      throw new MediaError(\"MANIFEST_PARSE_ERROR\",\n                           \"No supported audio and video tracks.\");\n    }\n\n    this.duration = args.duration;\n    this.start = args.start;\n\n    if (this.duration != null && this.start != null) {\n      this.end = this.start + this.duration;\n    }\n  }\n\n  /**\n   * Returns every `Adaptations` (or `tracks`) linked to that Period, in an\n   * Array.\n   * @returns {Array.<Object>}\n   */\n  getAdaptations() : Adaptation[] {\n    const adaptationsByType = this.adaptations;\n    return objectValues(adaptationsByType)\n      .reduce<Adaptation[]>((acc, adaptations) =>\n        // Note: the second case cannot happen. TS is just being dumb here\n        adaptations != null ? acc.concat(adaptations) :\n                              acc,\n        []\n    );\n  }\n\n  /**\n   * Returns every `Adaptations` (or `tracks`) linked to that Period for a\n   * given type.\n   * @param {string} adaptationType\n   * @returns {Array.<Object>}\n   */\n  getAdaptationsForType(adaptationType : IAdaptationType) : Adaptation[] {\n    return this.adaptations[adaptationType] || [];\n  }\n\n  /**\n   * Returns the Adaptation linked to the given ID.\n   * @param {number|string} wantedId\n   * @returns {Object|undefined}\n   */\n  getAdaptation(wantedId : string) : Adaptation|undefined {\n    return arrayFind(this.getAdaptations(), ({ id }) => wantedId === id);\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../../log\";\nimport IRepresentationIndex, {\n  ISegment,\n} from \"./types\";\n\nexport interface IStaticRepresentationIndexInfos { media: string; }\n\n/**\n * Simple RepresentationIndex implementation for static files.\n * @class StaticRepresentationIndex\n */\nexport default class StaticRepresentationIndex implements IRepresentationIndex {\n  // URL of the content\n  private readonly _mediaURL: string;\n\n  /**\n   * @param {Object} infos\n   */\n  constructor(infos : IStaticRepresentationIndexInfos) {\n    this._mediaURL = infos.media;\n  }\n\n  /**\n   * Static contents do not have any initialization segments.\n   * Just return null.\n   * @returns {null}\n   */\n  getInitSegment() : null {\n    return null;\n  }\n\n  /**\n   * Returns the only Segment available here.\n   * @returns {Array.<Object>}\n   */\n  getSegments() : ISegment[] {\n    return [{ id: \"0\",\n              isInit: false,\n              number: 0,\n              time: 0,\n              duration: Number.MAX_VALUE,\n              timescale: 1,\n              mediaURL: this._mediaURL }];\n  }\n\n  /**\n   * Returns first position in index.\n   * @returns {undefined}\n   */\n  getFirstPosition() : undefined {\n    return ;\n    /* tslint:enable return-undefined */\n  }\n\n  /**\n   * Returns last position in index.\n   * @returns {undefined}\n   */\n  getLastPosition() : undefined {\n    return ;\n  }\n\n  /**\n   * Returns false as a static file never need to be refreshed.\n   * @returns {Boolean}\n   */\n  shouldRefresh() : false {\n    return false;\n  }\n\n  /**\n   * @returns {Number}\n   */\n  checkDiscontinuity() : -1 {\n    return -1;\n  }\n\n  /**\n   * Returns true as a static file should never need lose availability.\n   * @returns {Boolean}\n   */\n  isSegmentStillAvailable() : true {\n    return true;\n  }\n\n  /**\n   * @returns {Boolean}\n   */\n  canBeOutOfSyncError() : false {\n    return false;\n  }\n\n  /**\n   * @returns {Boolean}\n   */\n  isFinished() : true {\n    return true;\n  }\n\n  _addSegments() : void {\n    log.warn(\"Tried add Segments to a static RepresentationIndex\");\n  }\n\n  _update() : void {\n    log.warn(\"Tried to update a static RepresentationIndex\");\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ICustomError } from \"../../errors\";\nimport Manifest, {\n  Adaptation,\n  Period,\n  Representation,\n} from \"../../manifest\";\nimport {\n  ILocalManifestInitSegmentLoader,\n  ILocalManifestSegmentLoader,\n} from \"../../parsers/manifest/local\";\n\n// privateInfos specific to Smooth Initialization Segments\nexport interface ISmoothInitSegmentPrivateInfos { codecPrivateData? : string;\n                                                  bitsPerSample? : number;\n                                                  channels? : number;\n                                                  packetSize? : number;\n                                                  samplingRate? : number;\n                                                  protection? : {\n                                                    keyId : Uint8Array;\n                                                    keySystems : Array<{\n                                                      systemId : string;\n                                                      privateData : Uint8Array;\n                                                    }>;\n                                                  }; }\n\nexport interface IBaseContentInfos { manifest: Manifest;\n                                     period: Period;\n                                     adaptation: Adaptation;\n                                     representation: Representation; }\n\nexport interface IMetaPlaylistPrivateInfos { transportType : string;\n                                             baseContent : IBaseContentInfos;\n                                             contentStart : number;\n                                             contentEnd? : number; }\n\n// privateInfos specific to local Manifest's init segments\nexport interface ILocalManifestInitSegmentPrivateInfos {\n  load : ILocalManifestInitSegmentLoader;\n}\n\n// privateInfos specific to local Manifests\nexport interface ILocalManifestSegmentPrivateInfos {\n  load : ILocalManifestSegmentLoader;\n  segment : { time : number; duration : number; timescale : number };\n}\n\nexport interface IPrivateInfos {\n  smoothInit? : ISmoothInitSegmentPrivateInfos;\n  metaplaylistInfos? : IMetaPlaylistPrivateInfos;\n  localManifestInitSegment? : ILocalManifestInitSegmentPrivateInfos;\n  localManifestSegment? : ILocalManifestSegmentPrivateInfos;\n}\n\n// ISegment Object.\n// Represent a single Segment from a Representation.\nexport interface ISegment {\n  duration : number; // Estimated duration of the segment, in timescale\n  id : string; // ID of the Segment. Should be unique for this Representation\n  isInit : boolean; // If true, this Segment contains initialization data\n  mediaURL : string|null; // URL of the segment\n  time : number; // Estimated time of beginning for the segment, in timescale\n  timescale : number; // Timescale to convert time and duration into seconds\n\n  indexRange? : [number, number]; // If set, the corresponding byte-range in the\n                                  // downloaded Segment will contain an index\n                                  // describing other Segments\n                                  // TODO put in privateInfos?\n  number? : number; // Optional number of the Segment\n                    // TODO put in privateInfos?\n  privateInfos? : IPrivateInfos; // Allows a RepresentationIndex to store\n                                 // supplementary information in a given\n                                 // Segment for later downloading/parsing\n  range? : [number, number]; // Optional byte range to retrieve the Segment\n  timestampOffset? : number; // Estimated time, in seconds, at which the\n                             // concerned segment will be offseted when\n                             // decoded.\n}\n\nexport interface IRepresentationIndexSegmentInfos { duration : number;\n                                                    time : number;\n                                                    timescale : number; }\n\n// Interface that should be implemented by any Representation's index\nexport default interface IRepresentationIndex {\n  /**\n   * Returns Segment object allowing to do the Init Segment request.\n   * @returns {Object}\n   */\n  getInitSegment() : ISegment|null;\n\n  /**\n   * Returns an array of Segments needed for the amount of time given.\n   * @param {number} up\n   * @param {number} duration\n   * @returns {Array.<Object>}\n   */\n  getSegments(up : number, duration : number) : ISegment[];\n\n  /**\n   * Returns true if, from the given situation, the manifest has to be refreshed\n   * @param {number} up - Beginning timestamp of what you want\n   * @param {number} to - End timestamp of what you want\n   * @returns {Boolean}\n   */\n  shouldRefresh(up : number, to : number) : boolean;\n\n  /**\n   * Returns the starting time, in seconds, of the earliest segment currently\n   * available.\n   * Returns null if nothing is in the index\n   * Returns undefined if we cannot know this value.\n   * @returns {Number|null}\n   */\n  getFirstPosition() : number | null | undefined;\n\n  /**\n   * Returns the ending time, in seconds, of the last segment currently\n   * available.\n   * Returns null if nothing is in the index\n   * Returns undefined if we cannot know this value.\n   * @returns {Number|null|undefined}\n   */\n  getLastPosition() : number | null | undefined;\n\n  /**\n   * Returns true if a Segment returned by this index is still considered\n   * available.\n   * Returns false if it is not available anymore.\n   * Returns undefined if we cannot know whether it is still available or not.\n   * @param {Object} segment\n   * @returns {Boolean|undefined}\n   */\n  isSegmentStillAvailable(segment : ISegment) : boolean | undefined;\n\n  /**\n   * Returns true if the Error given can indicate that the local index became\n   * \"unsynchronized\" with the server.\n   * Some transport cannot become unsynchronized and can return false directly.\n   * Note: This API assumes that the user first checked that the segment is\n   * still available through `isSegmentStillAvailable`.\n   * @returns {Boolean}\n   */\n  canBeOutOfSyncError(error : ICustomError) : boolean;\n\n  /**\n   * Checks if the given time - in seconds - is in a discontinuity. That is:\n   *   - We're on the upper bound of the current range (end of the range - time\n   *     is inferior to the timescale)\n   *   - The next range starts after the end of the current range.\n   * @param {Number} _time\n   * @returns {Number} - If a discontinuity is present, this is the Starting\n   * time for the next (discontinuited) range. If not this is equal to -1.\n   */\n  checkDiscontinuity(time : number) : number;\n\n  /**\n   * Returns true if the last segments in this index have already been generated\n   * so that we can freely go to the next period.\n   * @returns {boolean}\n   */\n  isFinished() : boolean;\n\n  /**\n   * Update the index with another one, such as after a Manifest update.\n   * TODO Both this and _addSegments mutate the index. They should not be\n   * accessible like that.\n   * Think of another implementation?\n   * @param {Object} newIndex\n   */\n  _update(newIndex : IRepresentationIndex) : void;\n\n  /**\n   * Add new segments to the index, obtained through various other different\n   * ways.\n   * TODO Both this and _update mutate the index. They should not be accessible\n   * like that.\n   * Think of another implementation?\n   * @param {Array.<Object>} nextSegments\n   * @param {Object} currentSegment\n   */\n  _addSegments(\n    nextSegments : Array<{ time : number;\n                           duration : number;\n                           timescale : number;\n                           count? : number;\n                           range? : [number, number]; }>,\n    currentSegment? : { duration? : number;\n                        time : number;\n                        timescale? : number; }\n  ) : void;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport StaticRepresentationIndex from \"./static\";\nimport IRepresentationIndex, {\n  IBaseContentInfos,\n  IMetaPlaylistPrivateInfos,\n  ISegment,\n} from \"./types\";\n\nexport default IRepresentationIndex;\nexport {\n  IBaseContentInfos,\n  IMetaPlaylistPrivateInfos,\n  ISegment,\n  StaticRepresentationIndex,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../log\";\nimport arrayFind from \"../utils/array_find\";\nimport Period from \"./period\";\n\n/**\n * Update oldPeriod attributes with the one from newPeriod (e.g. when updating\n * the Manifest).\n * @param {Object} oldPeriod\n * @param {Object} newPeriod\n */\nexport default function updatePeriodInPlace(oldPeriod : Period,\n                                            newPeriod : Period) : void\n{\n  oldPeriod.start = newPeriod.start;\n  oldPeriod.end = newPeriod.end;\n  oldPeriod.duration = newPeriod.duration;\n\n  const oldAdaptations = oldPeriod.getAdaptations();\n  const newAdaptations = newPeriod.getAdaptations();\n\n  for (let j = 0; j < oldAdaptations.length; j++) {\n    const oldAdaptation = oldAdaptations[j];\n    const newAdaptation = arrayFind(newAdaptations,\n                                    a => a.id === oldAdaptation.id);\n    if (!newAdaptation) {\n      log.warn(\"Manifest: Adaptation \\\"\" +\n               oldAdaptations[j].id +\n               \"\\\" not found when merging.\");\n    } else {\n      const oldRepresentations = oldAdaptations[j].representations;\n      const newRepresentations = newAdaptation.representations;\n\n      for (let k = 0; k < oldRepresentations.length; k++) {\n        const oldRepresentation = oldRepresentations[k];\n        const newRepresentation =\n          arrayFind(newRepresentations,\n                    representation => representation.id === oldRepresentation.id);\n\n        if (!newRepresentation) {\n          log.warn(\"Manifest: Representation \\\"\" +\n                   oldRepresentations[k].id +\n                   \"\\\" not found when merging.\");\n        } else {\n          oldRepresentation.index._update(newRepresentation.index);\n        }\n      }\n    }\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../log\";\nimport Period from \"./period\";\nimport updatePeriodInPlace from \"./update_period_in_place\";\n\n/**\n * Update old periods by adding new periods and removing\n * not available ones.\n * @param {Array.<Object>} oldPeriods\n * @param {Array.<Object>} newPeriods\n */\nexport default function updatePeriods(\n  oldPeriods: Period[],\n  newPeriods: Period[]\n): void {\n  let firstUnhandledPeriodIdx = 0;\n  // Example :\n  //\n  // old periods : [p0] [p2] [pX] [pF]\n  // new periods : [p1] [p2] [pM] [pX] [pU]\n  //\n  // The `for` loop will remove old periods and replace new ones\n  // between the common periods between the two, in the old periods array.\n  //\n  // - Step 1 : Handle common period p2\n  //    - the p0 is removed the p2\n  //    - the p1 is added before the p2\n  //\n  //                   First unhandled period index\n  //                             |\n  //                             v\n  //    old periods : [p1] [p2] [pX] [pF]\n  //    new periods : [p1] [p2] [pM] [pX] [pU]\n  //\n  // - Step 2 : Handle common period pX\n  //    - the pM is added before the pX\n  //\n  //                              First unhandled period index\n  //                                        |\n  //                                        v\n  // old periods : [p1]  [p2]  [pM]  [pX]  [pF]\n  // new periods : [p1]  [p2]  [pM]  [pX]  [pU]\n  for (let i = 0; i < newPeriods.length; i++) {\n    const newPeriod = newPeriods[i];\n    let j = firstUnhandledPeriodIdx;\n    let oldPeriod = oldPeriods[j];\n    while (oldPeriod != null && oldPeriod.id !== newPeriod.id) {\n      j++;\n      oldPeriod = oldPeriods[j];\n    }\n    if (oldPeriod != null) {\n      updatePeriodInPlace(oldPeriod, newPeriod);\n      const periodsToInclude = newPeriods.slice(firstUnhandledPeriodIdx, i);\n      oldPeriods.splice(j, 0, ...periodsToInclude);\n      firstUnhandledPeriodIdx = i + 1;\n    }\n  }\n\n  if (firstUnhandledPeriodIdx > oldPeriods.length) {\n    log.error(\"Manifest: error when updating Periods\");\n    return;\n  }\n\n  // At this point, the first unhandled period index refers to the first\n  // position from which :\n  // - there are only undesired periods in old periods array.\n  // - there only new wanted periods in new periods array.\n  //\n  //                              First unhandled period index\n  //                                        |\n  //                                        v\n  // old periods : [p1]  [p2]  [pM]  [pX]  [pF (undesired)]\n  // new periods : [p1]  [p2]  [pM]  [pX]  [pU (wanted)]\n  //\n  // final array (old periods array) : [p1]  [p2]  [pM]  [pX]  [pU]\n  if (firstUnhandledPeriodIdx < oldPeriods.length) {\n    oldPeriods.splice(firstUnhandledPeriodIdx,\n                      oldPeriods.length - firstUnhandledPeriodIdx);\n  }\n  const remainingNewPeriods = newPeriods.slice(firstUnhandledPeriodIdx,\n                                               newPeriods.length);\n  if (remainingNewPeriods.length > 0) {\n    oldPeriods.push(...remainingNewPeriods);\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ICustomError } from \"../errors\";\nimport log from \"../log\";\nimport { IParsedManifest } from \"../parsers/manifest\";\nimport arrayFind from \"../utils/array_find\";\nimport EventEmitter from \"../utils/event_emitter\";\nimport idGenerator from \"../utils/id_generator\";\nimport warnOnce from \"../utils/warn_once\";\nimport Adaptation, {\n  IAdaptationType,\n  IRepresentationFilter,\n} from \"./adaptation\";\nimport Period from \"./period\";\nimport { StaticRepresentationIndex } from \"./representation_index\";\nimport updatePeriods from \"./update_periods\";\n\nconst generateNewId = idGenerator();\n\ntype ManifestAdaptations = Partial<Record<IAdaptationType, Adaptation[]>>;\n\ninterface ISupplementaryImageTrack {\n  mimeType : string; // mimeType identifying the type of container for the track\n  url : string; // url to the thumbnails file\n}\n\ninterface ISupplementaryTextTrack {\n  mimeType : string; // mimeType identifying the type of container for the track\n  codecs? : string; // codecs in the container (mimeType can be enough)\n  url : string; // url to the text track file\n  language? : string; // ISO639-{1,2,3} code for the language of the track\n  languages? : string[]; // TODO remove\n  closedCaption : boolean; // if true, the track are closed captions\n}\n\ninterface IManifestParsingOptions {\n  supplementaryTextTracks? : ISupplementaryTextTrack[];\n  supplementaryImageTracks? : ISupplementaryImageTrack[];\n  representationFilter? : IRepresentationFilter;\n}\n\nexport interface IManifestEvents {\n  manifestUpdate : null;\n}\n\n/**\n * Normalized Manifest structure.\n * Details the current content being played:\n *   - the duration of the content\n *   - the available tracks\n *   - the available qualities\n *   - the segments defined in those qualities\n *   - ...\n * while staying agnostic of the transport protocol used (Smooth or DASH).\n *\n * The Manifest and its contained information can evolve over time (like when\n * updating a dynamic manifest of when right management forbid some tracks from\n * being played).\n * To perform actions on those changes, any module using this Manifest can\n * listen to its sent events and react accordingly.\n * @class Manifest\n */\nexport default class Manifest extends EventEmitter<IManifestEvents> {\n  // ID uniquely identifying this Manifest.\n  public id : string;\n\n  // Type of transport used by this Manifest (e.g. `\"dash\"` or `\"smooth\"`.\n  public transport : string;\n\n  // Every `Adaptations` for the first `Period` of the Manifest.\n  // Deprecated. Please use manifest.periods[0].adaptations instead.\n  // @deprecated\n  public adaptations : ManifestAdaptations;\n\n  // List every `Period` in that Manifest chronologically (from its start time).\n  // A `Period` contains content information about the content available for\n  // a specific period in time.\n  public readonly periods : Period[];\n\n  // If true, the Manifest can evolve over time. New content can be downloaded,\n  // properties of the manifest can be changed.\n  public isDynamic : boolean;\n\n  // If true, this Manifest describes a live content.\n  // A live content is a specific kind of dynamic content where you want to play\n  // as close as possible to the maximum position.\n  // E.g., a TV channel is a live content.\n  public isLive : boolean;\n\n  // Every URI linking to that Manifest, used for refreshing it.\n  // Listed from the most important to the least important.\n  public uris : string[];\n\n  // Suggested delay from the \"live edge\" the content is suggested to start\n  // from.\n  // This only applies to live contents.\n  public suggestedPresentationDelay? : number;\n\n  // Base URL from which relative segment's URLs will be relative to.\n  // @param {string}\n  public baseURL? : string;\n\n  // Amount of time, in seconds, this Manifest is valid from its fetching time.\n  // If not valid, you will need to refresh and update this Manifest (the latter\n  // can be done through the `update` method).\n  // If no lifetime is set, this Manifest does not become invalid after an\n  // amount of time.\n  public lifetime? : number;\n\n  // Minimum time, in seconds, at which the segment defined in the Manifest\n  // begins.\n  public availabilityStartTime? : number;\n\n  // Information about the first seekable position.\n  public minimumTime? : {\n    isContinuous : boolean; // Whether this value continuously evolve over time\n    value : number; // Minimum seekable time in milliseconds calculated at `time`.\n    time : number; // `Performance.now()` output at the time `value` was calculated\n  };\n\n  // Information about the last seekable position.\n  public maximumTime? : {\n    isContinuous : boolean; // Whether this value continuously evolve over time\n    value : number; // Maximum seekable time in milliseconds calculated at `time`.\n    time : number; // `Performance.now()` output at the time `value` was calculated\n  };\n\n  // Array containing every errors that happened when the Manifest has been\n  // created, in the order they have happened.\n  public parsingErrors : ICustomError[];\n\n  // Whole duration anounced in the Manifest.\n  private _duration : number|undefined;\n\n  // Difference between the server's clock in ms and the return of the JS\n  // function `performance.now`.\n  // This property allows to calculate the server time at any moment.\n  // `undefined` if we did not obtain the server's time\n  private _clockOffset : number|undefined;\n\n  /**\n   * @param {Object} args\n   */\n  constructor(args : IParsedManifest, options : IManifestParsingOptions) {\n    super();\n    const { supplementaryTextTracks = [],\n            supplementaryImageTracks = [],\n            representationFilter } = options;\n    this.parsingErrors = [];\n    this.id = args.id;\n    this.transport = args.transportType;\n    this._clockOffset = args.clockOffset;\n\n    this.periods = args.periods.map((period) => {\n      const parsedPeriod = new Period(period, representationFilter);\n      this.parsingErrors.push(...parsedPeriod.parsingErrors);\n      return parsedPeriod;\n    }).sort((a, b) => a.start - b.start);\n\n    /**\n     * @deprecated It is here to ensure compatibility with the way the\n     * v3.x.x manages adaptations at the Manifest level\n     */\n    /* tslint:disable:deprecation */\n    this.adaptations = (this.periods[0] && this.periods[0].adaptations) || {};\n    /* tslint:enable:deprecation */\n\n    this.minimumTime = args.minimumTime;\n    this.isDynamic = args.isDynamic;\n    this.isLive = args.isLive;\n    this.uris = args.uris || [];\n\n    this.lifetime = args.lifetime;\n    this.suggestedPresentationDelay = args.suggestedPresentationDelay;\n    this.availabilityStartTime = args.availabilityStartTime;\n    this.maximumTime = args.maximumTime;\n    this.baseURL = args.baseURL;\n\n    if (!args.isDynamic && args.duration == null) {\n      log.warn(\"Manifest: non dynamic content and duration is null.\");\n    }\n    this._duration = args.duration;\n\n    if (supplementaryImageTracks.length) {\n      this.addSupplementaryImageAdaptations(supplementaryImageTracks);\n    }\n    if (supplementaryTextTracks.length) {\n      this.addSupplementaryTextAdaptations(supplementaryTextTracks);\n    }\n  }\n\n  /**\n   * Returns Period encountered at the given time.\n   * Returns undefined if there is no Period exactly at the given time.\n   * @param {number} time\n   * @returns {Period|undefined}\n   */\n  getPeriodForTime(time : number) : Period|undefined {\n    return arrayFind(this.periods, (period) => {\n      return time >= period.start &&\n             (period.end == null || period.end > time);\n    });\n  }\n\n  /**\n   * Returns period coming just after a given period.\n   * Returns undefined if not found.\n   * @param {Period} period\n   * @returns {Period|null}\n   */\n  getPeriodAfter(period : Period) : Period|null {\n    const endOfPeriod = period.end;\n    if (endOfPeriod == null) {\n      return null;\n    }\n    return arrayFind(this.periods, (_period) => {\n      return _period.end == null || endOfPeriod < _period.end;\n    }) ||null;\n  }\n\n  /**\n   * Returns the duration of the whole content described by that Manifest.\n   * @returns {Number}\n   */\n  getDuration() : number|undefined {\n    return this._duration;\n  }\n\n  /**\n   * Returns the most important URL from which the Manifest can be refreshed.\n   * @returns {string|undefined}\n   */\n  getUrl() : string|undefined {\n    return this.uris[0];\n  }\n\n  /**\n   * @deprecated only returns adaptations for the first period\n   * @returns {Array.<Object>}\n   */\n  getAdaptations() : Adaptation[] {\n    warnOnce(\"manifest.getAdaptations() is deprecated.\" +\n             \" Please use manifest.period[].getAdaptations() instead\");\n    const firstPeriod = this.periods[0];\n    if (!firstPeriod) {\n      return [];\n    }\n    const adaptationsByType = firstPeriod.adaptations;\n    const adaptationsList : Adaptation[] = [];\n    for (const adaptationType in adaptationsByType) {\n      if (adaptationsByType.hasOwnProperty(adaptationType)) {\n        const adaptations =\n          adaptationsByType[adaptationType as IAdaptationType] as Adaptation[];\n        adaptationsList.push(...adaptations);\n      }\n    }\n    return adaptationsList;\n  }\n\n  /**\n   * @deprecated only returns adaptations for the first period\n   * @returns {Array.<Object>}\n   */\n  getAdaptationsForType(adaptationType : IAdaptationType) : Adaptation[] {\n    warnOnce(\"manifest.getAdaptationsForType(type) is deprecated.\" +\n             \" Please use manifest.period[].getAdaptationsForType(type) instead\");\n    const firstPeriod = this.periods[0];\n    if (!firstPeriod) {\n      return [];\n    }\n    return firstPeriod.adaptations[adaptationType] || [];\n  }\n\n  /**\n   * @deprecated only returns adaptations for the first period\n   * @returns {Array.<Object>}\n   */\n  getAdaptation(wantedId : number|string) : Adaptation|undefined {\n    warnOnce(\"manifest.getAdaptation(id) is deprecated.\" +\n             \" Please use manifest.period[].getAdaptation(id) instead\");\n    /* tslint:disable:deprecation */\n    return arrayFind(this.getAdaptations(), ({ id }) => wantedId === id);\n    /* tslint:enable:deprecation */\n  }\n\n  /**\n   * Update the current manifest properties\n   * @param {Object} Manifest\n   */\n  update(newManifest : Manifest) : void {\n    this._duration = newManifest.getDuration();\n\n    /* tslint:disable:deprecation */\n    this.adaptations = newManifest.adaptations;\n    /* tslint:enable:deprecation */\n\n    this.availabilityStartTime = newManifest.availabilityStartTime;\n    this.baseURL = newManifest.baseURL;\n    this.id = newManifest.id;\n    this.isDynamic = newManifest.isDynamic;\n    this.isLive = newManifest.isLive;\n    this.lifetime = newManifest.lifetime;\n    this.maximumTime = newManifest.maximumTime;\n    this.minimumTime = newManifest.minimumTime;\n    this.parsingErrors = newManifest.parsingErrors;\n    this.suggestedPresentationDelay = newManifest.suggestedPresentationDelay;\n    this.transport = newManifest.transport;\n    this.uris = newManifest.uris;\n\n    updatePeriods(this.periods, newManifest.periods);\n\n    this.trigger(\"manifestUpdate\", null);\n  }\n\n  /**\n   * Get minimum position currently defined by the Manifest, in seconds.\n   * @returns {number}\n   */\n  public getMinimumPosition() : number {\n    const { minimumTime } = this;\n    if (minimumTime == null) {\n      return 0;\n    }\n    if (!minimumTime.isContinuous) {\n      return minimumTime.value;\n    }\n    const timeDiff = performance.now() - minimumTime.time;\n    return minimumTime.value + timeDiff / 1000;\n  }\n\n  /**\n   * Get maximum position currently defined by the Manifest, in seconds.\n   * @returns {number}\n   */\n  public getMaximumPosition() : number {\n    if (!this.isDynamic) {\n      const duration = this.getDuration();\n      return duration == null ? Infinity : duration;\n    }\n    const { maximumTime } = this;\n    if (maximumTime == null) {\n      const ast = this.availabilityStartTime || 0;\n      if (this._clockOffset == null) {\n        // server's time not known, rely on user's clock\n        return (Date.now() / 1000) - ast;\n     }\n      const serverTime = performance.now() + this._clockOffset;\n      return (serverTime / 1000) - ast;\n    }\n    if (!maximumTime.isContinuous) {\n      return maximumTime.value;\n    }\n    const timeDiff = performance.now() - maximumTime.time;\n    return maximumTime.value + timeDiff / 1000;\n  }\n\n  /**\n   * If true, this Manifest is currently synchronized with the server's clock.\n   * @returns {Boolean}\n   */\n  public getClockOffset() : number | undefined {\n    return this._clockOffset;\n  }\n\n  /**\n   * Add supplementary image Adaptation(s) to the manifest.\n   * @private\n   * @param {Object|Array.<Object>} imageTracks\n   */\n  private addSupplementaryImageAdaptations(\n    imageTracks : ISupplementaryImageTrack|ISupplementaryImageTrack[]\n  ) : void {\n    const _imageTracks = Array.isArray(imageTracks) ? imageTracks : [imageTracks];\n    const newImageTracks = _imageTracks.map(({ mimeType, url }) => {\n      const adaptationID = \"gen-image-ada-\" + generateNewId();\n      const representationID = \"gen-image-rep-\" + generateNewId();\n      const newAdaptation = new Adaptation({\n        id: adaptationID,\n        type: \"image\",\n        representations: [{\n          bitrate: 0,\n          id: representationID,\n          mimeType,\n          index: new StaticRepresentationIndex({ media: url }),\n        }],\n      }, { isManuallyAdded: true });\n      this.parsingErrors.push(...newAdaptation.parsingErrors);\n      return newAdaptation;\n    });\n\n    if (newImageTracks.length && this.periods.length) {\n      const { adaptations } = this.periods[0];\n      adaptations.image =\n        adaptations.image ? adaptations.image.concat(newImageTracks) :\n                            newImageTracks;\n    }\n  }\n\n  /**\n   * Add supplementary text Adaptation(s) to the manifest.\n   * @private\n   * @param {Object|Array.<Object>} textTracks\n   */\n  private addSupplementaryTextAdaptations(\n    textTracks : ISupplementaryTextTrack|ISupplementaryTextTrack[]\n  ) : void {\n    const _textTracks = Array.isArray(textTracks) ? textTracks : [textTracks];\n    const newTextAdaptations = _textTracks.reduce((allSubs : Adaptation[], {\n      mimeType,\n      codecs,\n      url,\n      language,\n      languages,\n      closedCaption,\n    }) => {\n      const langsToMapOn : string[] = language ? [language] :\n                                                 languages || [];\n\n      return allSubs.concat(langsToMapOn.map((_language) => {\n        const adaptationID = \"gen-text-ada-\" + generateNewId();\n        const representationID = \"gen-text-rep-\" + generateNewId();\n        const newAdaptation = new Adaptation({\n          id: adaptationID,\n          type: \"text\",\n          language: _language,\n          closedCaption,\n          representations: [{\n            bitrate: 0,\n            id: representationID,\n            mimeType,\n            codecs,\n            index: new StaticRepresentationIndex({ media: url }),\n          }],\n        }, { isManuallyAdded: true });\n        this.parsingErrors.push(...newAdaptation.parsingErrors);\n        return newAdaptation;\n      }));\n    }, []);\n\n    if (newTextAdaptations.length && this.periods.length) {\n      const { adaptations } = this.periods[0];\n      adaptations.text =\n        adaptations.text ? adaptations.text.concat(newTextAdaptations) :\n                           newTextAdaptations;\n    }\n  }\n}\n\nexport {\n  IManifestParsingOptions,\n  ISupplementaryImageTrack,\n  ISupplementaryTextTrack,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Adaptation, {\n  IAdaptationType,\n  IRepresentationFilter,\n  SUPPORTED_ADAPTATIONS_TYPE,\n} from \"./adaptation\";\nimport areSameContent from \"./are_same_content\";\nimport Manifest, {\n  IManifestParsingOptions,\n  ISupplementaryImageTrack,\n  ISupplementaryTextTrack,\n} from \"./manifest\";\nimport Period from \"./period\";\nimport Representation from \"./representation\";\nimport IRepresentationIndex, {\n  IBaseContentInfos,\n  IMetaPlaylistPrivateInfos,\n  ISegment,\n  StaticRepresentationIndex,\n} from \"./representation_index\";\n\nexport default Manifest;\nexport {\n  // utils\n  areSameContent,\n\n  // classes\n  Period,\n  Adaptation,\n  Representation,\n\n  // types\n  IAdaptationType,\n  IBaseContentInfos,\n  IManifestParsingOptions,\n  IMetaPlaylistPrivateInfos,\n  IRepresentationFilter,\n  IRepresentationIndex,\n  ISegment,\n  ISupplementaryImageTrack,\n  ISupplementaryTextTrack,\n  StaticRepresentationIndex,\n  SUPPORTED_ADAPTATIONS_TYPE,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Scheme part of an url (e.g. \"http://\").\nconst schemeRe = /^(?:[a-z]+:)?\\/\\//i;\n\n// Captures \"/../\" or \"/./\".\nconst selfDirRe = /\\/\\.{1,2}\\//;\n\n/**\n * Resolve self directory and previous directory references to obtain a\n * \"normalized\" url.\n * @example \"https://foo.bar/baz/booz/../biz\" => \"https://foo.bar/baz/biz\"\n * @param {string} url\n * @returns {string}\n */\nfunction _normalizeUrl(url : string) : string {\n  // fast path if no ./ or ../ are present in the url\n  if (!selfDirRe.test(url)) {\n    return url;\n  }\n\n  const newUrl : string[] = [];\n  const oldUrl = url.split(\"/\");\n  for (let i = 0, l = oldUrl.length; i < l; i++) {\n    if (oldUrl[i] === \"..\") {\n      newUrl.pop();\n    } else if (oldUrl[i] === \".\") {\n      continue;\n    } else {\n      newUrl.push(oldUrl[i]);\n    }\n  }\n\n  return newUrl.join(\"/\");\n}\n\n/**\n * Construct an url from the arguments given.\n * Basically:\n *   - The last arguments that contains a scheme (e.g. \"http://\") is the base\n *     of the url.\n *   - every subsequent string arguments are concatened to it.\n * @param {...string|undefined} args\n * @returns {string}\n */\nexport default function resolveURL(...args : Array<string|undefined>) : string {\n  const len = args.length;\n  if (len === 0) {\n    return \"\";\n  }\n\n  let base = \"\";\n  for (let i = 0; i < len; i++) {\n    let part = args[i];\n    if (typeof part !== \"string\" || part === \"\") {\n      continue;\n    }\n    if (schemeRe.test(part)) {\n      base = part;\n    }\n    else {\n      // trim if begins with \"/\"\n      if (part[0] === \"/\") {\n        part = part.substring(1);\n      }\n\n      // trim if ends with \"/\"\n      if (base[base.length - 1] === \"/\") {\n        base = base.substring(0, base.length - 1);\n      }\n\n      base = base + \"/\" + part;\n    }\n  }\n\n  return _normalizeUrl(base);\n}\n\n/**\n * Remove string after the last '/'.\n * @param {string} url\n * @returns {string}\n */\nfunction normalizeBaseURL(url : string) : string {\n  const slash = url.lastIndexOf(\"/\");\n  if (slash >= 0) {\n    return url.substring(0, slash + 1);\n  } else {\n    return url;\n  }\n}\n\nexport { normalizeBaseURL };\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../../../log\";\nimport arrayIncludes from \"../../../utils/array_includes\";\nimport { IParsedManifest } from \"../types\";\n\n/**\n * Ensure that no two periods, adaptations from the same period and\n * representations from the same adaptation, have the same ID.\n *\n * Log and mutate their ID if not until this is verified.\n *\n * @param {Object} manifest\n */\nexport default function checkManifestIDs(\n  manifest : IParsedManifest\n) : void {\n  const periodIDS : string[] = [];\n  manifest.periods.forEach((period) => {\n    const periodID = period.id;\n    if (arrayIncludes(periodIDS, periodID)) {\n      log.warn(\"Two periods with the same ID found. Updating.\");\n      const newID = periodID + \"-dup\";\n      period.id = newID;\n      checkManifestIDs(manifest);\n      periodIDS.push(newID);\n    } else {\n      periodIDS.push(periodID);\n    }\n    const { adaptations } = period;\n    const adaptationIDs : string[] = [];\n    Object.keys(adaptations).forEach((type) => {\n      (adaptations[type] || []).forEach(adaptation => {\n        const adaptationID = adaptation.id;\n        if (arrayIncludes(adaptationIDs, adaptationID)) {\n          log.warn(\"Two adaptations with the same ID found. Updating.\",\n            adaptationID);\n          const newID =  adaptationID + \"-dup\";\n          adaptation.id = newID;\n          checkManifestIDs(manifest);\n          adaptationIDs.push(newID);\n        } else {\n          adaptationIDs.push(adaptationID);\n        }\n        const representationIDs : string[] = [];\n        adaptation.representations.forEach(representation => {\n          const representationID = representation.id;\n          if (arrayIncludes(representationIDs, representationID)) {\n            log.warn(\"Two representations with the same ID found. Updating.\",\n              representationID);\n            const newID =  representationID + \"-dup\";\n            representation.id = newID;\n            checkManifestIDs(manifest);\n            representationIDs.push(newID);\n          } else {\n            representationIDs.push(representationID);\n          }\n        });\n      });\n    });\n  });\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../../../log\";\n\n/**\n * Get difference between the server's clock, in milliseconds and the return of\n * the JS function `performance.now`.\n * This property allows to calculate the server time at any moment.\n *\n * `undefined` if we could not define such offset (in which case, you could have\n * to rely on the user's clock instead).\n *\n * For example, a response of 1000 would mean that performance.now() is 1 second\n * behind the server's time.\n * @param {string} serverClock\n * @returns {number|undefined}\n */\nexport default function getClockOffset(\n  serverClock : string\n) : number|undefined {\n  const httpOffset = Date.parse(serverClock) - performance.now();\n  if (isNaN(httpOffset)) {\n    log.warn(\"DASH Parser: Invalid clock received: \",  serverClock);\n    return undefined;\n  }\n  return httpOffset;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IMPDIntermediateRepresentation } from \"./node_parsers/MPD\";\n\n/**\n * @param {Object} mpdIR\n * @returns {string|undefined}\n */\nexport default function getHTTPUTCTimingURL(\n  mpdIR : IMPDIntermediateRepresentation\n) : string|undefined {\n  const UTCTimingHTTP = mpdIR.children.utcTimings\n    .filter((utcTiming) : utcTiming is {\n      schemeIdUri : \"urn:mpeg:dash:utc:http-iso:2014\";\n      value : string;\n    } =>\n      utcTiming.schemeIdUri === \"urn:mpeg:dash:utc:http-iso:2014\" &&\n      utcTiming.value != null\n    );\n\n  return UTCTimingHTTP.length > 0 ?\n    UTCTimingHTTP[0].value : undefined;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IParsedAdaptation } from \"../types\";\n\n/**\n * Returns \"last time of reference\" from the adaptation given, considering a\n * dynamic content.\n * Undefined if a time could not be found.\n * Null if the Adaptation has no segments (it could be that it didn't started or\n * that it already finished for example).\n *\n * We consider the earliest last time from every representations in the given\n * adaptation.\n * @param {Object} adaptation\n * @returns {Number|undefined|null}\n */\nexport default function getLastPositionFromAdaptation(\n  adaptation: IParsedAdaptation\n) : number | undefined | null {\n  const { representations } = adaptation;\n  let min : null | number = null;\n  for (let i = 0; i < representations.length; i++) {\n    const lastPosition = representations[i].index.getLastPosition();\n    if (lastPosition === undefined) { // we cannot tell\n      return undefined;\n    }\n    if (lastPosition !== null) {\n      min = min == null ? lastPosition :\n                          Math.min(min, lastPosition);\n    }\n  }\n  if (min === null) { // It means that all positions were null === no segments (yet?)\n    return null;\n  }\n  return min;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../../../log\";\nimport { IParsedManifest } from \"../types\";\nimport getLastPositionFromAdaptation from \"./get_last_time_from_adaptation\";\n\n/**\n * @param {Object} manifest\n * @returns {number | undefined}\n */\nexport default function getMaximumPosition(\n  manifest: IParsedManifest\n) : number | undefined {\n  for (let i = manifest.periods.length - 1; i >= 0; i--) {\n    const periodAdaptations = manifest.periods[i].adaptations;\n    const firstAudioAdaptationFromPeriod = periodAdaptations.audio == null ?\n      undefined :\n      periodAdaptations.audio[0];\n    const firstVideoAdaptationFromPeriod =  periodAdaptations.video == null ?\n      undefined :\n      periodAdaptations.video[0];\n\n    if (firstAudioAdaptationFromPeriod != null ||\n        firstVideoAdaptationFromPeriod != null\n    ) {\n      // null == no segment\n      let maximumAudioPosition : number | null = null;\n      let maximumVideoPosition : number | null = null;\n      if (firstAudioAdaptationFromPeriod != null) {\n        const lastPosition =\n          getLastPositionFromAdaptation(firstAudioAdaptationFromPeriod);\n        if (lastPosition === undefined) {\n          return undefined;\n        }\n        maximumAudioPosition = lastPosition;\n      }\n      if (firstVideoAdaptationFromPeriod != null) {\n        const lastPosition =\n          getLastPositionFromAdaptation(firstVideoAdaptationFromPeriod);\n        if (lastPosition === undefined) {\n          return undefined;\n        }\n        maximumVideoPosition = lastPosition;\n      }\n\n      if ((firstAudioAdaptationFromPeriod != null && maximumAudioPosition === null) ||\n          (firstVideoAdaptationFromPeriod != null && maximumVideoPosition === null)\n      ) {\n        log.info(\"DASH Parser: found Period with no segment. \",\n                 \"Going to previous one to calculate last position\");\n        return undefined;\n      }\n\n      if (maximumVideoPosition != null) {\n        if (maximumAudioPosition != null) {\n          return Math.min(maximumAudioPosition, maximumVideoPosition);\n        }\n        return maximumVideoPosition;\n      }\n      if (maximumAudioPosition != null) {\n        return maximumAudioPosition;\n      }\n    }\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IParsedAdaptation } from \"../types\";\n\n/**\n * Returns \"first time of reference\" from the adaptation given, considering a\n * dynamic content.\n * Undefined if a time could not be found.\n *\n * We consider the latest first time from every representations in the given\n * adaptation.\n * @param {Object} adaptation\n * @returns {Number|undefined}\n */\nexport default function getFirstPositionFromAdaptation(\n  adaptation: IParsedAdaptation\n) : number | undefined | null {\n  const { representations } = adaptation;\n  let max : null | number = null;\n  for (let i = 0; i < representations.length; i++) {\n    const firstPosition = representations[i].index.getFirstPosition();\n    if (firstPosition === undefined) { // we cannot tell\n      return undefined;\n    }\n    if (firstPosition !== null) {\n      max = max == null ? firstPosition :\n                          Math.max(max, firstPosition);\n    }\n  }\n  if (max === null) { // It means that all positions were null === no segments (yet?)\n    return null;\n  }\n  return max;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../../../log\";\nimport { IParsedManifest } from \"../types\";\nimport getFirstPositionFromAdaptation from \"./get_first_time_from_adaptation\";\n\n/**\n * @param {Object} manifest\n * @returns {number | undefined}\n */\nexport default function getMinimumPosition(\n  manifest: IParsedManifest\n) : number | undefined {\n  for (let i = 0; i <= manifest.periods.length - 1; i++) {\n    const periodAdaptations = manifest.periods[i].adaptations;\n    const firstAudioAdaptationFromPeriod = periodAdaptations.audio == null ?\n      undefined :\n      periodAdaptations.audio[0];\n    const firstVideoAdaptationFromPeriod =  periodAdaptations.video == null ?\n      undefined :\n      periodAdaptations.video[0];\n\n    if (firstAudioAdaptationFromPeriod != null ||\n        firstVideoAdaptationFromPeriod != null)\n    {\n      // null == no segment\n      let minimumAudioPosition : number | null = null;\n      let minimumVideoPosition : number | null = null;\n      if (firstAudioAdaptationFromPeriod != null) {\n        const firstPosition =\n          getFirstPositionFromAdaptation(firstAudioAdaptationFromPeriod);\n        if (firstPosition === undefined) {\n          return undefined;\n        }\n        minimumAudioPosition = firstPosition;\n      }\n      if (firstVideoAdaptationFromPeriod != null) {\n        const firstPosition =\n          getFirstPositionFromAdaptation(firstVideoAdaptationFromPeriod);\n        if (firstPosition === undefined) {\n          return undefined;\n        }\n        minimumVideoPosition = firstPosition;\n      }\n\n      if ((firstAudioAdaptationFromPeriod != null && minimumAudioPosition === null) ||\n          (firstVideoAdaptationFromPeriod != null && minimumVideoPosition === null)) {\n        log.info(\"DASH Parser: found Period with no segment. \",\n                 \"Going to next one to calculate first position\");\n        return undefined;\n      }\n\n      if (minimumVideoPosition != null) {\n        if (minimumAudioPosition != null) {\n          return Math.max(minimumAudioPosition, minimumVideoPosition);\n        }\n        return minimumVideoPosition;\n      }\n      if (minimumAudioPosition != null) {\n        return minimumAudioPosition;\n      }\n    }\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IParsedManifest } from \"../types\";\nimport getMaximumPosition from \"./get_maximum_position\";\nimport getMinimumPosition from \"./get_minimum_position\";\n\n/**\n * @param {Object} manifest\n * @returns {Array.<number>}\n */\nexport default function getMinimumAndMaximumPosition(\n  manifest: IParsedManifest\n) : [number|undefined, number|undefined] {\n  if (manifest.periods.length === 0) {\n    throw new Error(\"DASH Parser: no period available for a dynamic content\");\n  }\n\n  return [ getMinimumPosition(manifest),\n           getMaximumPosition(manifest) ];\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface IParsedContentComponent {\n  id?: string;\n  language?: string;\n  contentType?: string;\n  par?: string;\n}\n\n/**\n * Parse a \"ContentComponent\" Element in a DASH MPD.\n * @param {Element} root\n * @returns {Object}\n */\nexport default function parseContentComponent(root: Element) : IParsedContentComponent {\n  const ret : IParsedContentComponent = {};\n\n  for (let i = 0; i < root.attributes.length; i++) {\n    const attribute = root.attributes[i];\n\n    switch (attribute.name) {\n      case \"id\":\n        ret.id = attribute.value;\n        break;\n      case \"lang\":\n        ret.language = attribute.value;\n        break;\n      case \"contentType\":\n        ret.contentType = attribute.value;\n        break;\n      case \"par\":\n        ret.par = attribute.value;\n        break;\n    }\n  }\n\n  return ret;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { hexToBytes } from \"../../../../utils/byte_parsing\";\n\nexport interface IParsedContentProtection {\n  schemeIdUri? : string;\n  value? : string;\n  keyId? : Uint8Array;\n}\n\n/**\n * Parse the \"ContentProtection\" node of a MPD.\n * @param {Element} root\n * @returns {Object}\n */\nexport default function parseContentProtection(\n  root: Element\n) : IParsedContentProtection|undefined {\n  let schemeIdUri : string|undefined;\n  let value : string|undefined;\n  let keyId : Uint8Array|undefined;\n  for (let i = 0; i < root.attributes.length; i++) {\n    const attribute = root.attributes[i];\n\n    switch (attribute.name) {\n      case \"schemeIdUri\":\n        schemeIdUri = attribute.value;\n        break;\n      case \"value\":\n        value = attribute.value;\n        break;\n      case \"cenc:default_KID\":\n        keyId = hexToBytes(attribute.value.replace(/-/g, \"\"));\n    }\n  }\n\n  return { schemeIdUri, value, keyId };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// XML-Schema\n/* tslint:disable:max-line-length */\n// <http://standards.iso.org/ittf/PubliclyAvailableStandards/MPEG-DASH_schema_files/DASH-MPD.xsd>\n/* tslint:enable:max-line-length */\n\nexport interface IScheme {\n  schemeIdUri? : string;\n  value? : string;\n}\n\nconst iso8601Duration =\n  /^P(([\\d.]*)Y)?(([\\d.]*)M)?(([\\d.]*)D)?T?(([\\d.]*)H)?(([\\d.]*)M)?(([\\d.]*)S)?/;\nconst rangeRe = /([0-9]+)-([0-9]+)/;\n\n/**\n * Parse MPD boolean attributes.\n * @param {string} str\n * @returns {Boolean}\n */\nfunction parseBoolean(str : string) : boolean {\n  return str === \"true\";\n}\n\n/**\n * Parse some MPD attributes.\n * @param {string} str\n * @returns {Boolean|Number}\n */\nfunction parseIntOrBoolean(str : string) : boolean|number {\n  if (str === \"true\") {\n    return true;\n  }\n  if (str === \"false\") {\n    return false;\n  }\n  return parseInt(str, 10);\n}\n\n/**\n * Parse MPD date attributes.\n * @param {string} str\n * @returns {Date}\n */\nfunction parseDateTime(str : string) : number {\n  return new Date(Date.parse(str)).getTime() / 1000;\n}\n\n/**\n * Parse MPD ISO8601 duration attributes into seconds.\n * @param {string} date\n * @returns {Number}\n */\nfunction parseDuration(date : string) : number {\n  if (!date) {\n    return 0;\n  }\n\n  const match = iso8601Duration.exec(date) as RegExpExecArray;\n  if (match == null) {\n    throw new Error(`${date} is not a valid ISO8601 duration`);\n  }\n\n  return (\n    parseFloat(match[2]  || \"0\") * 365 * 24 * 60 * 60 +\n    parseFloat(match[4]  || \"0\") * 30 * 24 * 60 * 60 + // not precise +\n    parseFloat(match[6]  || \"0\") * 24 * 60 * 60 +\n    parseFloat(match[8]  || \"0\") * 60 * 60 +\n    parseFloat(match[10] || \"0\") * 60 +\n    parseFloat(match[12] || \"0\")\n  );\n}\n\n/**\n * Parse MPD byterange attributes into arrays of two elements: the start and\n * the end.\n * @param {string} str\n * @returns {Array.<Number>}\n */\nfunction parseByteRange(str : string) : [number, number]|null {\n  const match = rangeRe.exec(str);\n  if (!match) {\n    return null;\n  } else {\n    return [+match[1], +match[2]];\n  }\n}\n\n/**\n * @param {Element} root\n * @returns {Object}\n */\nfunction parseScheme(root: Element) : IScheme {\n  let schemeIdUri : string|undefined;\n  let value : string|undefined;\n  for (let i = 0; i < root.attributes.length; i++) {\n    const attribute = root.attributes[i];\n\n    switch (attribute.name) {\n      case \"schemeIdUri\":\n        schemeIdUri = attribute.value;\n        break;\n      case \"value\":\n        value = attribute.value;\n        break;\n    }\n  }\n\n  return {\n    schemeIdUri,\n    value,\n  };\n}\n\nexport {\n  parseBoolean,\n  parseByteRange,\n  parseDateTime,\n  parseDuration,\n  parseIntOrBoolean,\n  parseScheme,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../../../../log\";\nimport { parseByteRange } from \"./utils\";\n\nexport interface IParsedInitialization {\n  range?: [number, number];\n  media?: string;\n  indexRange?: [number, number];\n}\n\n/**\n * @param {Element} root\n * @returns {Object}\n */\nexport default function parseInitialization(root: Element) : IParsedInitialization {\n  const parsedInitialization : IParsedInitialization = {};\n  for (let i = 0; i < root.attributes.length; i++) {\n    const attribute = root.attributes[i];\n    switch (attribute.name) {\n      case \"range\": {\n        const range = parseByteRange(attribute.value);\n        if (range == null) {\n          log.warn(`DASH: invalid range (\"${attribute.value}\")`);\n        } else {\n          parsedInitialization.range = range;\n        }\n      }\n        break;\n\n      case \"sourceURL\":\n        parsedInitialization.media = attribute.value;\n        break;\n    }\n  }\n  return parsedInitialization;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport objectAssign from \"object-assign\";\nimport log from \"../../../../log\";\nimport parseInitialization, {\n  IParsedInitialization,\n} from \"./Initialization\";\nimport {\n  parseBoolean,\n  parseByteRange,\n} from \"./utils\";\n\nexport interface ISegmentBaseAttributes {\n  availabilityTimeComplete?: boolean;\n  availabilityTimeOffset?: number;\n  duration? : number;\n  indexRange?: [number, number];\n  indexRangeExact?: boolean;\n  initialization?: IParsedInitialization;\n  presentationTimeOffset?: number;\n  startNumber? : number;\n  timescale?: number;\n}\n\ninterface ISegmentBaseSegment {\n  start: number; // start timestamp\n  duration: number; // duration\n  repeatCount: number; // repeat counter\n  range?: [number, number];\n}\n\nexport interface IParsedSegmentBase extends ISegmentBaseAttributes {\n  availabilityTimeComplete : boolean;\n  indexRangeExact : boolean;\n  timeline : ISegmentBaseSegment[];\n  timescale : number;\n  media?: string;\n}\n\n/**\n * @param {Element} root\n * @returns {Object}\n */\nexport default function parseSegmentBase(root: Element) : IParsedSegmentBase {\n  const attributes : ISegmentBaseAttributes = {};\n\n  const segmentBaseChildren = root.childNodes;\n  for (let i = 0; i < segmentBaseChildren.length; i++) {\n    if (segmentBaseChildren[i].nodeType === Node.ELEMENT_NODE) {\n      const currentNode = segmentBaseChildren[i] as Element;\n      if (currentNode.nodeName === \"Initialization\") {\n        attributes.initialization = parseInitialization(currentNode);\n      }\n    }\n  }\n\n  for (let i = 0; i < root.attributes.length; i++) {\n    const attribute = root.attributes[i];\n    switch (attribute.name) {\n      case \"timescale\": {\n        const _timescale = parseInt(attribute.value, 10);\n        if (isNaN(_timescale)) {\n          log.warn(`DASH: invalid timescale (\"${attribute.value}\")`);\n        } else {\n          attributes.timescale = _timescale;\n        }\n      }\n        break;\n      case \"presentationTimeOffset\": {\n        const _presentationTimeOffset = parseFloat(attribute.value);\n        if (isNaN(_presentationTimeOffset)) {\n          log.warn(`DASH: invalid presentationTimeOffset (\"${attribute.value}\")`);\n        } else {\n          attributes.presentationTimeOffset = _presentationTimeOffset;\n        }\n      }\n        break;\n      case \"indexRange\":\n        attributes.indexRange = parseByteRange(attribute.value) || undefined;\n        break;\n      case \"indexRangeExact\":\n        attributes.indexRangeExact = parseBoolean(attribute.value);\n        break;\n      case \"availabilityTimeOffset\": {\n        const availabilityTimeOffset = parseFloat(attribute.value);\n        if (isNaN(availabilityTimeOffset)) {\n          log.warn(`DASH: invalid availabilityTimeOffset (\"${attribute.value}\")`);\n        } else {\n          attributes.availabilityTimeOffset = availabilityTimeOffset;\n        }\n      }\n        break;\n      case \"availabilityTimeComplete\":\n        attributes.availabilityTimeComplete = parseBoolean(attribute.value);\n        break;\n      case \"duration\": {\n        const duration = parseInt(attribute.value, 10);\n        if (isNaN(duration)) {\n          log.warn(`DASH: invalid duration (\"${attribute.value}\")`);\n        } else {\n          attributes.duration = duration;\n        }\n      }\n        break;\n      case \"startNumber\": {\n        const startNumber = parseInt(attribute.value, 10);\n        if (isNaN(startNumber)) {\n          log.warn(`DASH: invalid startNumber (\"${attribute.value}\")`);\n        } else {\n          attributes.startNumber = startNumber;\n        }\n      }\n        break;\n    }\n  }\n\n  const timescale = attributes.timescale == null ? 1 : attributes.timescale;\n  const indexRangeExact = !!attributes.indexRangeExact;\n  const availabilityTimeComplete = attributes.availabilityTimeComplete == null ?\n    true : attributes.availabilityTimeComplete;\n\n  return objectAssign(\n    attributes,\n    {\n      availabilityTimeComplete,\n      indexRangeExact,\n      timeline: [],\n      timescale,\n    }\n  );\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../../../../log\";\nimport { parseByteRange } from \"./utils\";\n\nexport interface IParsedSegmentURL {\n  media?: string;\n  mediaRange?: [number, number];\n  index?: string;\n  indexRange?: [number, number];\n}\n\n/**\n * @param {Element} root\n * @returns {Object}\n */\nexport default function parseSegmentURL(root : Element) : IParsedSegmentURL {\n  const parsedSegmentURL : IParsedSegmentURL = {};\n  for (let i = 0; i < root.attributes.length; i++) {\n    const attribute = root.attributes[i];\n    switch (attribute.name) {\n      case \"media\":\n        parsedSegmentURL.media = attribute.value;\n        break;\n      case \"indexRange\": {\n        const indexRange = parseByteRange(attribute.value) || undefined;\n        if (!indexRange) {\n          log.warn(`DASH: invalid indexRange (\"${attribute.value}\")`);\n        } else {\n          parsedSegmentURL.indexRange = indexRange;\n        }\n      }\n        break;\n      case \"index\":\n        parsedSegmentURL.index = attribute.value;\n        break;\n      case \"mediaRange\": {\n        const mediaRange = parseByteRange(attribute.value) || undefined;\n        if (!mediaRange) {\n          log.warn(`DASH: invalid mediaRange (\"${attribute.value}\")`);\n        } else {\n          parsedSegmentURL.mediaRange = mediaRange;\n        }\n      }\n        break;\n    }\n  }\n  return parsedSegmentURL;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport objectAssign from \"object-assign\";\nimport parseSegmentBase, {\n  IParsedSegmentBase,\n} from \"./SegmentBase\";\nimport parseSegmentURL, {\n  IParsedSegmentURL,\n} from \"./SegmentURL\";\n\nexport interface IParsedSegmentList extends IParsedSegmentBase {\n  duration : number;\n  list: IParsedSegmentURL[];\n}\n\n/**\n * @param {Element} root\n * @returns {Object}\n */\nexport default function parseSegmentList(root: Element) : IParsedSegmentList {\n  const base = parseSegmentBase(root);\n  const list : IParsedSegmentURL[] = [];\n\n  const segmentListChildren = root.childNodes;\n  for (let i = 0; i < segmentListChildren.length; i++) {\n    if (segmentListChildren[i].nodeType === Node.ELEMENT_NODE) {\n      const currentNode = segmentListChildren[i] as Element;\n      if (currentNode.nodeName === \"SegmentURL\") {\n        const segmentURL = parseSegmentURL(currentNode);\n        list.push(segmentURL);\n      }\n    }\n  }\n\n  const baseDuration = base.duration;\n\n  if (baseDuration == null) {\n    throw new Error(\"Invalid SegmentList: no duration\");\n  }\n\n  return objectAssign(base, {\n    list,\n    duration: baseDuration, // Ugly but TS is too dumb there\n  });\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../../../../log\";\n\nexport interface IParsedS {\n  start? : number;\n  repeatCount? : number; // Amount of repetition(s)\n                         // 0 = no repeat\n                         // negative number = max possible repeat\n  duration? : number;\n}\n\n/**\n * @param {Element} root\n * @returns {Object}\n */\nexport default function parseS(root : Element) : IParsedS {\n  const parsedS : IParsedS = {};\n\n  for (let j = 0; j < root.attributes.length; j++) {\n    const attribute = root.attributes[j];\n\n    switch (attribute.name) {\n      case \"t\":\n        const start = parseInt(attribute.value, 10);\n        if (isNaN(start)) {\n          log.warn(`DASH: invalid t (\"${attribute.value}\")`);\n        } else {\n          parsedS.start = start;\n        }\n        break;\n      case \"d\":\n        const duration = parseInt(attribute.value, 10);\n        if (isNaN(duration)) {\n          log.warn(`DASH: invalid d (\"${attribute.value}\")`);\n        } else {\n          parsedS.duration = duration;\n        }\n        break;\n      case \"r\":\n        const repeatCount = parseInt(attribute.value, 10);\n        if (isNaN(repeatCount)) {\n          log.warn(`DASH: invalid r (\"${attribute.value}\")`);\n        } else {\n          parsedS.repeatCount = repeatCount;\n        }\n        break;\n    }\n  }\n  return parsedS;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport parseS, {\n  IParsedS,\n} from \"./S\";\n\nexport type IParsedTimeline = IParsedS[];\n\n/**\n * @param {Element} root\n * @returns {Array.<Object>}\n */\nexport default function parseSegmentTimeline(root: Element) : IParsedTimeline {\n  const parsedS : IParsedS[] = [];\n  const timelineChildren = root.childNodes;\n  for (let i = 0; i < timelineChildren.length; i++) {\n    if (timelineChildren[i].nodeType === Node.ELEMENT_NODE) {\n      const currentElement = timelineChildren[i] as Element;\n\n      if (currentElement.nodeName === \"S\") {\n        const s = parseS(currentElement);\n        parsedS.push(s);\n      }\n    }\n  }\n  return parsedS;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport objectAssign from \"object-assign\";\nimport { IParsedInitialization } from \"./Initialization\";\nimport parseSegmentBase, {\n  IParsedSegmentBase\n} from \"./SegmentBase\";\nimport parseSegmentTimeline, {\n  IParsedTimeline,\n} from \"./SegmentTimeline\";\nimport {\n  parseBoolean,\n} from \"./utils\";\n\nexport interface IParsedSegmentTemplate extends IParsedSegmentBase {\n  indexType: \"template\";\n  duration : number;\n  availabilityTimeComplete : boolean;\n  indexRangeExact : boolean;\n  timescale : number;\n\n  presentationTimeOffset? : number;\n  availabilityTimeOffset?: number;\n  indexRange?: [number, number];\n  initialization?: IParsedInitialization;\n  startNumber? : number;\n\n  media? : string;\n  index? : string;\n  bitstreamSwitching? : boolean;\n}\n\nexport interface IParsedSegmentTimeline {\n  indexType: \"timeline\";\n  timeline: IParsedTimeline;\n  availabilityTimeComplete : boolean;\n  indexRangeExact : boolean;\n  timescale : number;\n\n  presentationTimeOffset? : number;\n  availabilityTimeOffset?: number;\n  duration? : number;\n  indexRange?: [number, number];\n  initialization?: IParsedInitialization;\n  startNumber? : number;\n  media? : string;\n  index? : string;\n  bitstreamSwitching? : boolean;\n}\n\n/**\n * Parse initialization attribute found in segment Template to\n * correspond to the initialization found in a regular segmentBase.\n * @param {string} attrValue\n * @returns {Object}\n */\nfunction parseInitializationAttribute(attrValue : string) : IParsedInitialization  {\n  return { media: attrValue };\n}\n\n/**\n * @param {Element} root\n * @returns {Object}\n */\nexport default function parseSegmentTemplate(\n  root: Element\n) : IParsedSegmentTemplate|IParsedSegmentTimeline {\n\n  const base = parseSegmentBase(root);\n  let ret : IParsedSegmentTemplate|IParsedSegmentTimeline;\n\n  let index : string|undefined;\n  let media : string|undefined;\n  let bitstreamSwitching : boolean|undefined;\n  let timeline : IParsedTimeline|undefined;\n\n  for (let i = 0; i < root.childNodes.length; i++) {\n    if (root.childNodes[i].nodeType === Node.ELEMENT_NODE) {\n      const currentNode = root.childNodes[i] as Element;\n      if (currentNode.nodeName === \"SegmentTimeline\") {\n        timeline = parseSegmentTimeline(currentNode);\n      }\n    }\n  }\n\n  for (let i = 0; i < root.attributes.length; i++) {\n    const attribute = root.attributes[i];\n\n    switch (attribute.nodeName) {\n\n      case \"initialization\":\n        if (base.initialization == null) {\n          base.initialization = parseInitializationAttribute(attribute.value);\n        }\n        break;\n\n      case \"index\":\n        index = attribute.value;\n        break;\n\n      case \"media\":\n        media = attribute.value;\n        break;\n\n      case \"bitstreamSwitching\":\n        bitstreamSwitching = parseBoolean(attribute.value);\n        break;\n    }\n  }\n\n  if (timeline != null) {\n    ret = objectAssign({}, base, {\n      indexType: \"timeline\" as \"timeline\",\n      timeline,\n    });\n  } else {\n    const segmentDuration = base.duration;\n\n    if (segmentDuration == null) {\n      throw new Error(\"Invalid SegmentTemplate: no duration\");\n    }\n    ret = objectAssign({}, base, {\n      indexType: \"template\" as \"template\",\n      duration: segmentDuration,\n    });\n  }\n\n  if (index != null) {\n    ret.index = index;\n  }\n\n  if (media != null) {\n    ret.media = media;\n  }\n\n  if (bitstreamSwitching != null) {\n    ret.bitstreamSwitching = bitstreamSwitching;\n  }\n\n  return ret;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../../../../log\";\nimport parseSegmentBase, {\n  IParsedSegmentBase,\n} from \"./SegmentBase\";\nimport parseSegmentList, {\n  IParsedSegmentList,\n} from \"./SegmentList\";\nimport parseSegmentTemplate, {\n  IParsedSegmentTemplate,\n  IParsedSegmentTimeline,\n} from \"./SegmentTemplate\";\nimport { parseBoolean } from \"./utils\";\n\nexport interface IRepresentationIntermediateRepresentation {\n  children : IRepresentationChildren;\n  attributes : IRepresentationAttributes;\n}\n\nexport interface IRepresentationChildren {\n  // required\n  baseURL : string;\n\n  // optional\n  segmentBase? : IParsedSegmentBase;\n  segmentList? : IParsedSegmentList;\n  segmentTemplate? : IParsedSegmentTemplate|IParsedSegmentTimeline;\n}\n\nexport interface IRepresentationAttributes {\n  // optional\n  audioSamplingRate? : string;\n  bitrate? : number;\n  codecs? : string;\n  codingDependency? : boolean;\n  frameRate? : string;\n  height? : number;\n  id? : string;\n  maxPlayoutRate? : number;\n  maximumSAPPeriod? : number;\n  mimeType? : string;\n  profiles? : string;\n  qualityRanking? : number;\n  segmentProfiles? : string;\n  width? : number;\n}\n\n/**\n * @param {NodeList} representationChildren\n * @returns {Object}\n */\nfunction parseRepresentationChildren(\n  representationChildren : NodeList\n) : IRepresentationChildren {\n  const children : IRepresentationChildren = {\n    baseURL: \"\",\n  };\n\n  for (let i = 0; i < representationChildren.length; i++) {\n    if (representationChildren[i].nodeType === Node.ELEMENT_NODE) {\n      const currentElement = representationChildren[i] as Element;\n\n      switch (currentElement.nodeName) {\n        case \"BaseURL\":\n          children.baseURL = currentElement.textContent || \"\";\n          break;\n        case \"SegmentBase\":\n          children.segmentBase = parseSegmentBase(currentElement);\n          break;\n        case \"SegmentList\":\n          children.segmentList = parseSegmentList(currentElement);\n          break;\n        case \"SegmentTemplate\":\n          children.segmentTemplate = parseSegmentTemplate(currentElement);\n          break;\n      }\n    }\n  }\n  return children;\n}\n\n/**\n * @param {Element} representationElement\n * @returns {Object}\n */\nfunction parseRepresentationAttributes(\n  representationElement : Element\n) : IRepresentationAttributes {\n  const attributes : IRepresentationAttributes = {};\n  for (let i = 0; i < representationElement.attributes.length; i++) {\n    const attribute = representationElement.attributes[i];\n\n    switch (attribute.name) {\n\n      case \"audioSamplingRate\":\n        attributes.audioSamplingRate = attribute.value;\n        break;\n\n      case \"bandwidth\": {\n        const bitrate = parseInt(attribute.value, 10);\n        if (isNaN(bitrate)) {\n          log.warn(`DASH: invalid bandwidth (\"${attribute.value}\")`);\n        } else {\n          attributes.bitrate = bitrate;\n        }\n      }\n        break;\n\n      case \"codecs\":\n        attributes.codecs = attribute.value;\n        break;\n\n      case \"codingDependency\":\n        attributes.codingDependency = parseBoolean(attribute.value);\n        break;\n\n      case \"frameRate\":\n        attributes.frameRate = attribute.value;\n        break;\n\n      case \"height\": {\n        const height = parseInt(attribute.value, 10);\n        if (isNaN(height)) {\n          log.warn(`DASH: invalid height (\"${attribute.value}\")`);\n        } else {\n          attributes.height = height;\n        }\n      }\n        break;\n\n      case \"id\":\n        attributes.id = attribute.value;\n        break;\n\n      case \"maxPlayoutRate\": {\n        const maxPlayoutRate = parseFloat(attribute.value);\n        if (isNaN(maxPlayoutRate)) {\n          log.warn(`DASH: invalid maxPlayoutRate (\"${attribute.value}\")`);\n        } else {\n          attributes.maxPlayoutRate = maxPlayoutRate;\n        }\n      }\n        break;\n\n      case \"maximumSAPPeriod\": {\n        const maximumSAPPeriod = parseFloat(attribute.value);\n        if (isNaN(maximumSAPPeriod)) {\n          log.warn(`DASH: invalid maximumSAPPeriod (\"${attribute.value}\")`);\n        } else {\n          attributes.maximumSAPPeriod = maximumSAPPeriod;\n        }\n      }\n        break;\n\n      case \"mimeType\":\n        attributes.mimeType = attribute.value;\n        break;\n\n      case \"profiles\":\n        attributes.profiles = attribute.value;\n        break;\n\n      case \"qualityRanking\": {\n        const qualityRanking = parseInt(attribute.value, 10);\n        if (isNaN(qualityRanking)) {\n          log.warn(`DASH: invalid qualityRanking (\"${attribute.value}\")`);\n        } else {\n          attributes.qualityRanking = qualityRanking;\n        }\n      }\n        break;\n\n      case \"segmentProfiles\":\n        attributes.segmentProfiles = attribute.value;\n        break;\n\n      case \"width\": {\n        const width = parseInt(attribute.value, 10);\n        if (isNaN(width)) {\n          log.warn(`DASH: invalid width (\"${attribute.value}\")`);\n        } else {\n          attributes.width = width;\n        }\n      }\n        break;\n    }\n  }\n  return attributes;\n}\n\nexport function createRepresentationIntermediateRepresentation(\n  representationElement : Element\n) : IRepresentationIntermediateRepresentation {\n  return {\n    children: parseRepresentationChildren(representationElement.childNodes),\n    attributes: parseRepresentationAttributes(representationElement),\n  };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../../../../log\";\nimport parseContentComponent, {\n  IParsedContentComponent\n} from \"./ContentComponent\";\nimport parseContentProtection, {\n  IParsedContentProtection\n} from \"./ContentProtection\";\nimport {\n  createRepresentationIntermediateRepresentation,\n  IRepresentationIntermediateRepresentation,\n} from \"./Representation\";\nimport parseSegmentBase, {\n  IParsedSegmentBase,\n} from \"./SegmentBase\";\nimport parseSegmentList, {\n  IParsedSegmentList,\n} from \"./SegmentList\";\nimport parseSegmentTemplate, {\n  IParsedSegmentTemplate,\n  IParsedSegmentTimeline,\n} from \"./SegmentTemplate\";\nimport {\n  IScheme,\n  parseBoolean,\n  parseIntOrBoolean,\n  parseScheme,\n} from \"./utils\";\n\nexport interface IAdaptationSetIntermediateRepresentation {\n  children : IAdaptationSetChildren;\n  attributes : IAdaptationSetAttributes;\n}\n\nexport interface IAdaptationSetChildren {\n  // required\n  baseURL : string; // BaseURL for the contents. Empty string if not defined\n  representations : IRepresentationIntermediateRepresentation[];\n\n  // optional\n  accessibility? : IScheme;\n  contentComponent? : IParsedContentComponent;\n  contentProtections? : IParsedContentProtection[];\n  roles? : IScheme[];\n  supplementalProperties? : IScheme[];\n\n  segmentBase? : IParsedSegmentBase;\n  segmentList? : IParsedSegmentList;\n  segmentTemplate? : IParsedSegmentTemplate|IParsedSegmentTimeline;\n}\n\nexport interface IAdaptationSetAttributes {\n  // optional\n  audioSamplingRate? : string;\n  bitstreamSwitching? : boolean;\n  codecs? : string;\n  codingDependency? : boolean;\n  contentType? : string;\n  frameRate? : string;\n  group? : number;\n  height? : number;\n  id? : string;\n  language? : string;\n  maxBitrate? : number;\n  maxFrameRate? : string;\n  maxHeight? : number;\n  maxPlayoutRate? : number;\n  maxWidth? : number;\n  maximumSAPPeriod? : number;\n  mimeType? : string;\n  minBitrate? : number;\n  minFrameRate? : string;\n  minHeight? : number;\n  minWidth? : number;\n  par? : string;\n  profiles? : string;\n  segmentAlignment? : number|boolean;\n  segmentProfiles? : string;\n  subsegmentAlignment? : number|boolean;\n  width? : number;\n}\n\nfunction parseAdaptationSetChildren(\n  adaptationSetChildren : NodeList\n) : IAdaptationSetChildren {\n  const children : IAdaptationSetChildren = {\n    baseURL: \"\",\n    representations: [],\n  };\n  const contentProtections = [];\n  for (let i = 0; i < adaptationSetChildren.length; i++) {\n    if (adaptationSetChildren[i].nodeType === Node.ELEMENT_NODE) {\n      const currentElement = adaptationSetChildren[i] as Element;\n\n      switch (currentElement.nodeName) {\n\n        case \"Accessibility\":\n          children.accessibility = parseScheme(currentElement);\n          break;\n\n        case \"BaseURL\":\n          children.baseURL = currentElement.textContent || \"\";\n          break;\n\n        case \"ContentComponent\":\n          children.contentComponent = parseContentComponent(currentElement);\n          break;\n\n        case \"Representation\":\n          const representation =\n            createRepresentationIntermediateRepresentation(currentElement);\n          children.representations.push(representation);\n          break;\n\n        case \"Role\":\n          if (children.roles == null) {\n            children.roles = [parseScheme(currentElement)];\n          } else {\n            children.roles.push(parseScheme(currentElement));\n          }\n          break;\n\n        case \"SupplementalProperty\":\n          if (children.supplementalProperties == null) {\n            children.supplementalProperties = [parseScheme(currentElement)];\n          } else {\n            children.supplementalProperties.push(parseScheme(currentElement));\n          }\n          break;\n\n        case \"SegmentBase\":\n          children.segmentBase = parseSegmentBase(currentElement);\n          break;\n\n        case \"SegmentList\":\n          children.segmentList = parseSegmentList(currentElement);\n          break;\n\n        case \"SegmentTemplate\":\n          children.segmentTemplate = parseSegmentTemplate(currentElement);\n          break;\n\n        case \"ContentProtection\":\n          const contentProtection = parseContentProtection(currentElement);\n          if (contentProtection) {\n            contentProtections.push(contentProtection);\n          }\n          break;\n\n          // case \"Rating\":\n          //   children.rating = currentElement;\n          //   break;\n\n          // case \"Viewpoint\":\n          //   children.viewpoint = currentElement;\n          //   break;\n      }\n    }\n  }\n  if (contentProtections.length) {\n    children.contentProtections = contentProtections;\n  }\n  return children;\n}\n\nfunction parseAdaptationSetAttributes(\n  root : Element\n) : IAdaptationSetAttributes {\n  const parsedAdaptation : IAdaptationSetAttributes = {};\n\n  for (let i = 0; i < root.attributes.length; i++) {\n    const attribute = root.attributes[i];\n\n    switch (attribute.name) {\n\n      case \"id\":\n        parsedAdaptation.id = attribute.value;\n        break;\n\n      case \"group\": {\n        const group = parseInt(attribute.value, 10);\n        if (isNaN(group)) {\n          log.warn(`DASH: invalid group (\"${attribute.value}\")`);\n        } else {\n          parsedAdaptation.group = group;\n        }\n      }\n        break;\n\n      case \"lang\":\n        parsedAdaptation.language = attribute.value;\n        break;\n\n      case \"contentType\":\n        parsedAdaptation.contentType = attribute.value;\n        break;\n\n      case \"par\":\n        parsedAdaptation.par = attribute.value;\n        break;\n\n      case \"minBandwidth\": {\n        const minBitrate = parseInt(attribute.value, 10);\n        if (isNaN(minBitrate)) {\n          log.warn(`DASH: invalid minBandwidth (\"${attribute.value}\")`);\n        } else {\n          parsedAdaptation.minBitrate = minBitrate;\n        }\n      }\n        break;\n\n      case \"maxBandwidth\": {\n        const maxBitrate = parseInt(attribute.value, 10);\n        if (isNaN(maxBitrate)) {\n          log.warn(`DASH: invalid maxBandwidth (\"${attribute.value}\")`);\n        } else {\n          parsedAdaptation.maxBitrate = maxBitrate;\n        }\n      }\n        break;\n\n      case \"minWidth\": {\n        const minWidth = parseInt(attribute.value, 10);\n        if (isNaN(minWidth)) {\n          log.warn(`DASH: invalid minWidth (\"${attribute.value}\")`);\n        } else {\n          parsedAdaptation.minWidth = minWidth;\n        }\n      }\n        break;\n\n      case \"maxWidth\": {\n        const maxWidth = parseInt(attribute.value, 10);\n        if (isNaN(maxWidth)) {\n          log.warn(`DASH: invalid maxWidth (\"${attribute.value}\")`);\n        } else {\n          parsedAdaptation.maxWidth = maxWidth;\n        }\n      }\n        break;\n\n      case \"minHeight\": {\n        const minHeight = parseInt(attribute.value, 10);\n        if (isNaN(minHeight)) {\n          log.warn(`DASH: invalid minHeight (\"${attribute.value}\")`);\n        } else {\n          parsedAdaptation.minHeight = minHeight;\n        }\n      }\n        break;\n\n      case \"maxHeight\": {\n        const maxHeight = parseInt(attribute.value, 10);\n        if (isNaN(maxHeight)) {\n          log.warn(`DASH: invalid maxHeight (\"${attribute.value}\")`);\n        } else {\n          parsedAdaptation.maxHeight = maxHeight;\n        }\n      }\n        break;\n\n      case \"minFrameRate\": {\n        parsedAdaptation.minFrameRate = attribute.value;\n      }\n        break;\n\n      case \"maxFrameRate\":\n        parsedAdaptation.maxFrameRate = attribute.value;\n        break;\n\n      case \"segmentAlignment\": {\n        const segmentAlignment = parseIntOrBoolean(attribute.value);\n        if (typeof segmentAlignment === \"number\" && isNaN(segmentAlignment)) {\n          log.warn(`DASH: invalid segmentAlignment (\"${attribute.value}\")`);\n        } else {\n          parsedAdaptation.segmentAlignment = segmentAlignment;\n        }\n      }\n        break;\n\n      case \"subsegmentAlignment\": {\n        const subsegmentAlignment = parseIntOrBoolean(attribute.value);\n        if (typeof subsegmentAlignment === \"number\" && isNaN(subsegmentAlignment)) {\n          log.warn(`DASH: invalid subsegmentAlignment (\"${attribute.value}\")`);\n        } else {\n          parsedAdaptation.subsegmentAlignment = subsegmentAlignment;\n        }\n      }\n        break;\n\n      case \"bitstreamSwitching\":\n        parsedAdaptation.bitstreamSwitching = parseBoolean(attribute.value);\n        break;\n\n      case \"audioSamplingRate\":\n        parsedAdaptation.audioSamplingRate = attribute.value;\n        break;\n\n      case \"codecs\":\n        parsedAdaptation.codecs = attribute.value;\n        break;\n\n      case \"codingDependency\":\n        parsedAdaptation.codingDependency = parseBoolean(attribute.value);\n        break;\n\n      case \"frameRate\":\n        parsedAdaptation.frameRate = attribute.value;\n        break;\n\n      case \"height\": {\n        const height = parseInt(attribute.value, 10);\n        if (isNaN(height)) {\n          log.warn(`DASH: invalid height (\"${attribute.value}\")`);\n        } else {\n          parsedAdaptation.height = height;\n        }\n      }\n        break;\n\n      case \"maxPlayoutRate\": {\n        const maxPlayoutRate = parseFloat(attribute.value);\n        if (isNaN(maxPlayoutRate)) {\n          log.warn(`DASH: invalid maxPlayoutRate (\"${attribute.value}\")`);\n        } else {\n          parsedAdaptation.maxPlayoutRate = maxPlayoutRate;\n        }\n      }\n        break;\n\n      case \"maximumSAPPeriod\": {\n        const maximumSAPPeriod = parseFloat(attribute.value);\n        if (isNaN(maximumSAPPeriod)) {\n          log.warn(`DASH: invalid maximumSAPPeriod (\"${attribute.value}\")`);\n        } else {\n          parsedAdaptation.maximumSAPPeriod = maximumSAPPeriod;\n        }\n      }\n        break;\n\n      case \"mimeType\":\n        parsedAdaptation.mimeType = attribute.value;\n        break;\n\n      case \"profiles\":\n        parsedAdaptation.profiles = attribute.value;\n        break;\n\n      case \"segmentProfiles\":\n        parsedAdaptation.segmentProfiles = attribute.value;\n        break;\n\n      case \"width\": {\n        const width = parseInt(attribute.value, 10);\n        if (isNaN(width)) {\n          log.warn(`DASH: invalid width (\"${attribute.value}\")`);\n        } else {\n          parsedAdaptation.width = width;\n        }\n      }\n        break;\n    }\n  }\n\n  return parsedAdaptation;\n}\n\nexport function createAdaptationSetIntermediateRepresentation(\n  adaptationSetElement : Element\n) : IAdaptationSetIntermediateRepresentation {\n  return {\n    children: parseAdaptationSetChildren(adaptationSetElement.childNodes),\n    attributes: parseAdaptationSetAttributes(adaptationSetElement),\n  };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../../../../log\";\nimport {\n  createAdaptationSetIntermediateRepresentation,\n  IAdaptationSetIntermediateRepresentation,\n} from \"./AdaptationSet\";\nimport {\n  parseBoolean,\n  parseDuration,\n} from \"./utils\";\n\nexport interface IPeriodIntermediateRepresentation {\n  children : IPeriodChildren;\n  attributes : IPeriodAttributes;\n}\n\n// intermediate representation for a Period's children\nexport interface IPeriodChildren {\n  // required\n  baseURL : string; // BaseURL for the contents. Empty string if not defined\n  adaptations : IAdaptationSetIntermediateRepresentation[];\n}\n\n// intermediate representation for a Period's attributes\nexport interface IPeriodAttributes {\n  // optional\n  id? : string;\n  start? : number;\n  duration? : number;\n  bitstreamSwitching? : boolean;\n  xlinkHref? : string;\n  xlinkActuate? : string;\n}\n\n/**\n * @param {NodeList} periodChildren\n * @returns {Object}\n */\nfunction parsePeriodChildren(periodChildren : NodeList) : IPeriodChildren {\n  let baseURL = \"\";\n  const adaptations : IAdaptationSetIntermediateRepresentation[] = [];\n\n  for (let i = 0; i < periodChildren.length; i++) {\n    if (periodChildren[i].nodeType === Node.ELEMENT_NODE) {\n      const currentElement = periodChildren[i] as Element;\n\n      switch (currentElement.nodeName) {\n\n        case \"BaseURL\":\n          baseURL = currentElement.textContent || \"\";\n          break;\n\n        case \"AdaptationSet\":\n          const adaptation =\n            createAdaptationSetIntermediateRepresentation(currentElement);\n          adaptations.push(adaptation);\n          break;\n      }\n    }\n  }\n\n  return { baseURL, adaptations };\n}\n\n/**\n * @param {Element} periodElement\n * @returns {Object}\n */\nfunction parsePeriodAttributes(periodElement : Element) : IPeriodAttributes {\n  const res : IPeriodAttributes = {};\n  for (let i = 0; i < periodElement.attributes.length; i++) {\n    const attribute = periodElement.attributes[i];\n\n    switch (attribute.name) {\n      case \"id\":\n        res.id = attribute.value;\n        break;\n      case \"start\": {\n        const tempStart = parseDuration(attribute.value);\n        if (!isNaN(tempStart)) {\n          res.start = tempStart;\n        } else {\n          log.warn(\"DASH: Unrecognized start in the mpd:\", attribute.value);\n        }\n      }\n        break;\n      case \"duration\": {\n        const tempDuration = parseDuration(attribute.value);\n        if (!isNaN(tempDuration)) {\n          res.duration = tempDuration;\n        } else {\n          log.warn(\"DASH: Unrecognized duration in the mpd:\", attribute.value);\n        }\n      }\n        break;\n      case \"bitstreamSwitching\":\n        res.bitstreamSwitching = parseBoolean(attribute.value);\n        break;\n\n      case \"xlink:href\":\n        res.xlinkHref = attribute.value;\n        break;\n\n      case \"xlink:actuate\":\n        res.xlinkActuate = attribute.value;\n        break;\n    }\n  }\n  return res;\n}\n\nexport function createPeriodIntermediateRepresentation(\n  periodElement : Element\n) : IPeriodIntermediateRepresentation {\n  return {\n    children: parsePeriodChildren(periodElement.childNodes),\n    attributes: parsePeriodAttributes(periodElement),\n  };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  createPeriodIntermediateRepresentation,\n  IPeriodIntermediateRepresentation,\n} from \"./Period\";\nimport {\n  IScheme,\n  parseDateTime,\n  parseDuration,\n  parseScheme,\n} from \"./utils\";\n\nexport interface IMPDIntermediateRepresentation {\n  children : IMPDChildren;\n  attributes : IMPDAttributes;\n}\n\n// intermediate representation for the root's children\nexport interface IMPDChildren {\n  // required\n  baseURL : string; // BaseURL for the contents. Empty string if not defined\n  locations : string[]; // Location(s) at which the Manifest can be refreshed\n  periods : IPeriodIntermediateRepresentation[];\n  utcTimings : IScheme[];\n}\n\n// intermediate representation for the root's attributes\nexport interface IMPDAttributes {\n  // optional\n  id? : string;\n  profiles? : string;\n  type? : string;\n  availabilityStartTime? : number;\n  availabilityEndTime? : number;\n  publishTime? : number;\n  duration? : number; // mediaPresentationDuration\n  minimumUpdatePeriod? : number;\n  minBufferTime? : number;\n  timeShiftBufferDepth? : number;\n  suggestedPresentationDelay? : number;\n  maxSegmentDuration? : number;\n  maxSubsegmentDuration? : number;\n}\n\n/**\n * Parse children of the MPD's root into a simple object.\n * @param {NodeList} mpdChildren\n * @returns {Object}\n */\nfunction parseMPDChildren(mpdChildren : NodeList) : IMPDChildren {\n  let baseURL = \"\";\n  const locations : string[] = [];\n  const periods : IPeriodIntermediateRepresentation[] = [];\n  const utcTimings : IScheme[] = [];\n\n  for (let i = 0; i < mpdChildren.length; i++) {\n    if (mpdChildren[i].nodeType === Node.ELEMENT_NODE) {\n      const currentNode = mpdChildren[i] as Element;\n      switch (currentNode.nodeName) {\n\n        case \"BaseURL\":\n          baseURL = currentNode.textContent || \"\";\n          break;\n\n        case \"Location\":\n          locations.push(currentNode.textContent || \"\");\n          break;\n\n        case \"Period\":\n          const period =\n            createPeriodIntermediateRepresentation(currentNode);\n          periods.push(period);\n          break;\n\n        case \"UTCTiming\":\n          const utcTiming = parseScheme(currentNode);\n          utcTimings.push(utcTiming);\n          break;\n      }\n    }\n  }\n\n  return { baseURL, locations, periods, utcTimings };\n}\n\n/**\n * @param {Element} root\n * @returns {Object}\n */\nfunction parseMPDAttributes(root : Element) : IMPDAttributes {\n  const res : IMPDAttributes = {};\n  for (let i = 0; i < root.attributes.length; i++) {\n    const attribute = root.attributes[i];\n\n    switch (attribute.name) {\n      case \"id\":\n        res.id = attribute.value;\n        break;\n      case \"profiles\":\n        res.profiles = attribute.value;\n        break;\n      case \"type\":\n        res.type = attribute.value;\n        break;\n      case \"availabilityStartTime\":\n        res.availabilityStartTime = +parseDateTime(attribute.value);\n        break;\n      case \"availabilityEndTime\":\n        res.availabilityEndTime = +parseDateTime(attribute.value);\n        break;\n      case \"publishTime\":\n        res.publishTime = +parseDateTime(attribute.value);\n        break;\n      case \"mediaPresentationDuration\":\n        res.duration = parseDuration(attribute.value);\n        break;\n      case \"minimumUpdatePeriod\":\n        res.minimumUpdatePeriod = parseDuration(attribute.value);\n        break;\n      case \"minBufferTime\":\n        res.minBufferTime = parseDuration(attribute.value);\n        break;\n      case \"timeShiftBufferDepth\":\n        res.timeShiftBufferDepth = parseDuration(attribute.value);\n        break;\n      case \"suggestedPresentationDelay\":\n        res.suggestedPresentationDelay = parseDuration(attribute.value);\n        break;\n      case \"maxSegmentDuration\":\n        res.maxSegmentDuration = parseDuration(attribute.value);\n        break;\n      case \"maxSubsegmentDuration\":\n        res.maxSubsegmentDuration = parseDuration(attribute.value);\n        break;\n    }\n  }\n  return res;\n}\n\nexport function createMPDIntermediateRepresentation(\n  root : Element\n) : IMPDIntermediateRepresentation {\n  return {\n    children: parseMPDChildren(root.childNodes),\n    attributes: parseMPDAttributes(root),\n  };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IMPDAttributes } from \"./node_parsers/MPD\";\n\nexport default function parseAvailabilityStartTime(\n  rootAttributes : IMPDAttributes,\n  referenceDateTime? : number\n) : number {\n  if (rootAttributes.type !== \"dynamic\") {\n    return 0;\n  }\n  if (rootAttributes.availabilityStartTime == null) {\n    return referenceDateTime == null ? 0 : referenceDateTime;\n  }\n  return rootAttributes.availabilityStartTime;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IParsedPeriod } from \"../types\";\nimport { IMPDAttributes } from \"./node_parsers/MPD\";\n\nexport default function parseDuration(\n  rootAttributes : IMPDAttributes,\n  parsedPeriods : IParsedPeriod[]\n) : number|undefined {\n  if (rootAttributes.duration != null) {\n    return rootAttributes.duration;\n  }\n  if (rootAttributes.type === \"dynamic\") {\n    return undefined;\n  }\n  if (parsedPeriods.length) {\n    const lastPeriod = parsedPeriods[parsedPeriods.length - 1];\n    if (lastPeriod.end != null) {\n      return lastPeriod.end;\n    } else if (lastPeriod.duration != null) {\n      return lastPeriod.start + lastPeriod.duration;\n    }\n  }\n  return undefined;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Map each element using a mapping function, then flat the result into\n * a new array.\n * @param {Array.<*>}originalArray\n * @param {Function}fn\n */\nexport default function flatMap<T, U>(\n  originalArray : T[],\n  fn: (arg: T) => U[]|U\n) : U[] {\n  /* tslint:disable no-unbound-method */\n  if (typeof (Array.prototype as any).flatMap === \"function\") {\n  /* tslint:enable no-unbound-method */\n    return (originalArray as any).flatMap(fn);\n  }\n\n  return originalArray.reduce((acc : U[], arg : T) : U[] => {\n      const r = fn(arg);\n      if (Array.isArray(r)) {\n        return [...acc, ...r];\n      }\n      return [...acc, r];\n    }, []);\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../../../log\";\nimport { IParsedPeriod } from \"../types\";\n\n/**\n * Avoid periods to overlap.\n *\n * According to DASH guidelines, if a period has media duration longer than\n * the distance between the start of this period and the start of the next period,\n * use of start times implies that the client will start the playout of the next\n * period at the time stated, rather than finishing the playout of the last period.\n *\n * Even if that case if defined when period last(s) segment(s) is/are a bit longer,\n * it can be meaningful when two periods are overlapping. We will always shorten\n * the first period, and even erase it if its duration is equal to zero.\n *\n * Example (Periods are numbered under their manifest order) :\n *\n * [ Period 1 ][ Period 2 ]       ------>  [ Period 1 ][ Period 3 ]\n *             [ Period 3 ]\n *\n * [ Period 1 ][ Period 2 ]       ------>  [ Period 1 ][  2  ][ Period 3 ]\n *                  [ Period 3 ]\n *\n * [ Period 1 ][ Period 2 ]       ------>  [  1  ][      Period 3     ]\n *        [      Period 3     ]\n *\n * @param {Array.<Object>} parsedPeriods\n * @return {Array.<Object>}\n */\nexport default function flattenOverlappingPeriods(\n  parsedPeriods: IParsedPeriod[]\n): IParsedPeriod[] {\n  if (parsedPeriods.length === 0) {\n    return [];\n  }\n  const flattenedPeriods : IParsedPeriod[] = [parsedPeriods[0]];\n  for (let i = 1; i < parsedPeriods.length; i++) {\n    const parsedPeriod = parsedPeriods[i];\n    let lastFlattenedPeriod = flattenedPeriods[flattenedPeriods.length - 1];\n    while (\n      lastFlattenedPeriod.duration == null ||\n      (lastFlattenedPeriod.start + lastFlattenedPeriod.duration) > parsedPeriod.start\n    ) {\n      log.warn(\"DASH: Updating overlapping Periods.\", lastFlattenedPeriod, parsedPeriod);\n      lastFlattenedPeriod.duration = parsedPeriod.start - lastFlattenedPeriod.start;\n      lastFlattenedPeriod.end = parsedPeriod.start;\n      if (lastFlattenedPeriod.duration <= 0) {\n        flattenedPeriods.pop();\n        lastFlattenedPeriod = flattenedPeriods[flattenedPeriods.length - 1];\n      }\n    }\n    flattenedPeriods.push(parsedPeriod);\n  }\n  return flattenedPeriods;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IPeriodIntermediateRepresentation } from \"./node_parsers/Period\";\n\ninterface IPeriodTimeInformation {\n  periodStart: number;\n  periodDuration?: number;\n  periodEnd?: number;\n}\n\nexport interface IParsedPeriodsContext {\n  availabilityStartTime : number; // Time from which the content starts\n  duration? : number;\n  isDynamic : boolean;\n}\n\n/**\n * Get periods time information from current, next and previous\n * periods.\n * @param {Array.<Object>} periodsIR\n * @param {Object} manifestInfos\n * @return {Array.<Object>}\n */\nexport default function getPeriodsTimeInformation(\n  periodsIR : IPeriodIntermediateRepresentation[],\n  manifestInfos : IParsedPeriodsContext\n): IPeriodTimeInformation[] {\n  const periodsTimeInformation: IPeriodTimeInformation[] = [];\n  periodsIR.forEach((currentPeriod, i) => {\n\n    let periodStart : number;\n    if (currentPeriod.attributes.start != null) {\n      periodStart = currentPeriod.attributes.start;\n    } else {\n      if (i === 0) {\n        periodStart = (!manifestInfos.isDynamic ||\n                       manifestInfos.availabilityStartTime == null) ?\n                         0 :\n                         manifestInfos.availabilityStartTime;\n      } else {\n        // take time information from previous period\n        const prevPeriodInfos =\n          periodsTimeInformation[periodsTimeInformation.length - 1];\n        if (prevPeriodInfos != null && prevPeriodInfos.periodEnd != null) {\n          periodStart = prevPeriodInfos.periodEnd;\n        } else {\n          throw new Error(\"Missing start time when parsing periods.\");\n        }\n      }\n    }\n\n    let periodDuration : number | undefined;\n    const nextPeriod = periodsIR[i + 1];\n    if (currentPeriod.attributes.duration != null) {\n      periodDuration = currentPeriod.attributes.duration;\n    } else if (i === periodsIR.length - 1) {\n      periodDuration = manifestInfos.duration;\n    } else if (nextPeriod.attributes.start != null) {\n      periodDuration = nextPeriod.attributes.start - periodStart;\n    }\n\n    const periodEnd = periodDuration != null ? (periodStart + periodDuration) :\n                                               undefined;\n    periodsTimeInformation.push({ periodStart,\n                                   periodDuration,\n                                   periodEnd });\n  });\n  return periodsTimeInformation;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * This class allows to easily calculate the first and last available positions\n * in a content at any time.\n *\n * That task can be an hard for dynamic DASH contents: it depends on a\n * `timeShiftBufferDepth` defined in the MPD and on the maximum possible\n * position.\n *\n * The latter can come from either a clock synchronization mechanism or the\n * indexing schemes (e.g. SegmentTemplate, SegmentTimeline etc.) of the last\n * Periods.\n * As such, it might only be known once a large chunk of the MPD has already\n * been parsed.\n *\n * By centralizing the manifest bounds calculation in this class and by giving\n * an instance of it to each parsed elements which might depend on it, we\n * ensure that we can provide it once it is known to every one of those\n * elements without needing to parse a second time the MPD.\n *\n * @example\n * ```js\n * const manifestBoundsCalculator = new ManifestBoundsCalculator();\n *\n * // let's imagine a property `index` on a Representation which need to obtain\n * // the last position at any time\n * someRepresentation.index = new TemplateRepresentationIndex({\n *   // ...\n *   manifestBoundsCalculator // for now, `getLastPosition` will return `undefined`\n * });\n *\n * // ...\n * // Let's imagine a function which try to guess the last position based on a\n * // given parsed period\n * const lastPosition = getMaximumBound(somePeriod);\n * if (lastPosition != null) {\n *   const positionTime = performance.now() / 1000;\n *   manifestBoundsCalculator.setLastPosition(lastPosition, positionTime);\n *   // `getLastPosition` will now be correctly communicate the last position\n *   // (it returned `undefined` until then).\n * }\n * ```\n * @class ManifestBoundsCalculator\n */\nexport default class ManifestBoundsCalculator {\n  private _timeShiftBufferDepth : number | null;\n  private _positionTime : number | undefined;\n  private _lastPosition : number | undefined;\n  private _isDynamic : boolean;\n\n  constructor(args : { timeShiftBufferDepth? : number;\n                       isDynamic : boolean; }\n  ) {\n    this._isDynamic = args.isDynamic;\n    this._timeShiftBufferDepth = !args.isDynamic ||\n                                 args.timeShiftBufferDepth == null ?\n                                   null :\n                                   args.timeShiftBufferDepth;\n  }\n\n  /**\n   * Set the last position and the position time (the value of `performance.now()`\n   * at the time that position was true converted into seconds).\n   *\n   * @example\n   * Example if you trust `Date.now()` to give you a reliable offset:\n   * ```js\n   * const lastPosition = Date.now();\n   * const positionTime = performance.now() / 1000;\n   * manifestBoundsCalculator.setLastPosition(lastPosition, positionTime);\n   * ```\n   *\n   * @param {number} lastPositionOffset\n   */\n  setLastPosition(lastPosition : number, positionTime?: number) {\n    this._lastPosition = lastPosition;\n    this._positionTime = positionTime;\n  }\n\n  /**\n   * Returns `true` if the last position and the position time\n   * (for dynamic content only) have been comunicated.\n   * `false` otherwise.\n   * @returns {boolean}\n   */\n  lastPositionIsKnown() : boolean {\n    if (this._isDynamic) {\n      return this._positionTime != null && this._lastPosition != null;\n    }\n    return this._lastPosition != null;\n  }\n\n  /**\n   * Get minimum bound of content.\n   * @return {number|undefined}\n   */\n  getMinimumBound(): number | undefined {\n    if (!this._isDynamic || this._timeShiftBufferDepth === null) {\n      return 0;\n    }\n    const maximumBound = this.getMaximumBound();\n    if (maximumBound === undefined) {\n      return undefined;\n    }\n    const minimumBound = maximumBound - this._timeShiftBufferDepth;\n    return minimumBound;\n  }\n\n  /**\n   * Calculate the current maximum bound by using both the calculated\n   * last position and the timeshift buffer depth.\n   * `undefined` if the last position has never been communicated.\n   * @return {number|undefined}\n   */\n  getMaximumBound() : number | undefined {\n    if (this._isDynamic &&\n        this._positionTime != null &&\n        this._lastPosition != null\n      ) {\n      return Math.max((this._lastPosition - this._positionTime) +\n                        (performance.now() / 1000),\n                      0);\n    }\n    return this._lastPosition;\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport arrayFind from \"../../../utils/array_find\";\nimport arrayIncludes from \"../../../utils/array_includes\";\nimport { IRepresentationIntermediateRepresentation } from \"./node_parsers/Representation\";\n\nconst KNOWN_ADAPTATION_TYPES = [\"audio\", \"video\", \"text\", \"image\"];\nconst SUPPORTED_TEXT_TYPES = [\"subtitle\", \"caption\"];\n\ninterface IScheme {\n  schemeIdUri? : string;\n  value? : string;\n}\n\n/**\n * Infers the type of adaptation from codec and mimetypes found in it.\n *\n * This follows the guidelines defined by the DASH-IF IOP:\n *   - one adaptation set contains a single media type\n *   - The order of verifications are:\n *       1. mimeType\n *       2. Role\n *       3. codec\n *\n * Note: This is based on DASH-IF-IOP-v4.0 with some more freedom.\n * @param {Object} adaptation\n * @returns {string} - \"audio\"|\"video\"|\"text\"|\"image\"|\"metadata\"|\"unknown\"\n */\nexport default function inferAdaptationType(\n  representations: IRepresentationIntermediateRepresentation[],\n  adaptationMimeType : string|null,\n  adaptationCodecs : string|null,\n  adaptationRoles : IScheme[]|null\n) : string {\n  function fromMimeType(\n    mimeType : string,\n    roles : IScheme[]|null\n  ) : string|undefined {\n    const topLevel = mimeType.split(\"/\")[0];\n    if (arrayIncludes(KNOWN_ADAPTATION_TYPES, topLevel)) {\n      return topLevel;\n    }\n    if (mimeType === \"application/bif\") {\n      return \"image\";\n    }\n    if (mimeType === \"application/ttml+xml\") {\n      return \"text\";\n    }\n    // manage DASH-IF mp4-embedded subtitles and metadata\n    if (mimeType === \"application/mp4\") {\n      if (roles != null) {\n        if (\n          arrayFind(roles, (role) =>\n            role.schemeIdUri === \"urn:mpeg:dash:role:2011\" &&\n            arrayIncludes(SUPPORTED_TEXT_TYPES, role.value)\n          ) != null\n        ) {\n          return \"text\";\n        }\n      }\n      return \"metadata\";\n    }\n  }\n  function fromCodecs(codecs : string) {\n    switch (codecs.substring(0, 3)) {\n      case \"avc\":\n      case \"hev\":\n      case \"hvc\":\n      case \"vp8\":\n      case \"vp9\":\n      case \"av1\":\n        return \"video\";\n      case \"vtt\":\n        return \"text\";\n      case \"bif\":\n        return \"image\";\n    }\n    switch (codecs.substring(0, 4)) {\n      case \"mp4a\":\n        return \"audio\";\n      case \"wvtt\":\n      case \"stpp\":\n        return \"text\";\n    }\n  }\n  if (adaptationMimeType != null) {\n    const typeFromMimeType = fromMimeType(adaptationMimeType, adaptationRoles);\n    if (typeFromMimeType != null) {\n      return typeFromMimeType;\n    }\n  }\n  if (adaptationCodecs != null) {\n    const typeFromCodecs = fromCodecs(adaptationCodecs);\n    if (typeFromCodecs != null) {\n      return typeFromCodecs;\n    }\n  }\n\n  const representationMimeTypes = representations\n    .map(representation => representation.attributes.mimeType)\n    .filter((mimeType : string|undefined) : mimeType is string => mimeType != null);\n  const representationCodecs = representations\n    .map(representation => representation.attributes.codecs)\n    .filter((codecs : string|undefined) : codecs is string => codecs != null);\n\n  for (let i = 0; i < representationMimeTypes.length; i++) {\n    const representationMimeType = representationMimeTypes[i];\n    if (representationMimeType != null) {\n      const typeFromMimeType = fromMimeType(representationMimeType, adaptationRoles);\n      if (typeFromMimeType != null) {\n        return typeFromMimeType;\n      }\n    }\n  }\n  for (let i = 0; i < representationCodecs.length; i++) {\n    const codecs = representationCodecs[i];\n    if (codecs != null) {\n      const typeFromMimeType = fromCodecs(codecs);\n      if (typeFromMimeType != null) {\n        return typeFromMimeType;\n      }\n    }\n  }\n  return \"unknown\";\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Generic way to representat segments in an index of segments\nexport interface IIndexSegment { start: number; // start time\n                                 duration: number; // duration\n                                 repeatCount: number; // repeat counter\n                                 range?: [number, number]; } // possible\n                                                             // byte-range\n\n/**\n * Calculate the number of times a timeline element repeats based on the next\n * element.\n * @param {Object} element\n * @param {Object} nextElement\n * @param {number} maxPosition\n * @returns {Number}\n */\nexport function calculateRepeat(\n  element : IIndexSegment,\n  nextElement? : IIndexSegment|null,\n  maxPosition? : number\n) : number {\n  const { repeatCount } = element;\n\n  if (repeatCount >= 0) {\n    return repeatCount;\n  }\n\n  // A negative value of the @r attribute of the S element indicates\n  // that the duration indicated in @d attribute repeats until the\n  // start of the next S element, the end of the Period or until the\n  // next MPD update.\n  let segmentEnd : number;\n  if (nextElement != null) {\n    segmentEnd = nextElement.start;\n  } else if (maxPosition != null) {\n    segmentEnd = maxPosition;\n  } else {\n    segmentEnd = Number.MAX_VALUE;\n  }\n  return Math.ceil((segmentEnd - element.start) / element.duration) - 1;\n}\n\n/**\n * Returns end of the segment given, in index time.\n * @param {Object} segment\n * @param {Object|null} [nextSegment]\n * @param {number} maxPosition\n * @returns {Number}\n */\nexport function getIndexSegmentEnd(\n  segment : IIndexSegment,\n  nextSegment : IIndexSegment|null,\n  maxPosition? : number\n) : number {\n  const { start, duration } = segment;\n  if (duration <= 0) {\n    return start;\n  }\n\n  const repeat = calculateRepeat(segment, nextSegment, maxPosition);\n  return start + (repeat + 1) * duration;\n}\n\n/**\n * Convert from `presentationTime`, the time of the segment at the moment it\n * is decoded to `mediaTime`, the original time the segments point at.\n * @param {number} time\n * @param {Object} indexOptions\n * @returns {number}\n */\nexport function toIndexTime(\n  time : number,\n  indexOptions : { timescale : number; indexTimeOffset : number }\n) : number {\n  return time * indexOptions.timescale + indexOptions.indexTimeOffset;\n}\n\n/**\n * Convert from `mediaTime`, the original time the segments point at to\n * `presentationTime`, the time of the segment at the moment it is decoded.\n * @param {number} time\n * @param {Object} indexOptions\n * @returns {number}\n */\nexport function fromIndexTime(\n  time : number,\n  indexOptions : { timescale : number; indexTimeOffset : number }\n) : number {\n  return (time - indexOptions.indexTimeOffset) / indexOptions.timescale;\n}\n\n/**\n * @param {Number} start\n * @param {Number} duration\n * @param {Number} timescale\n * @returns {Object} - Object with two properties:\n *   - up {Number}: timescaled timestamp of the beginning time\n *   - to {Number}: timescaled timestamp of the end time (start time + duration)\n */\nexport function getTimescaledRange(\n  start: number,\n  duration: number,\n  timescale : number\n) : [number, number] {\n  return [ start * timescale,\n           (start + duration) * timescale ];\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ISegment } from \"../../../../manifest\";\n\n/**\n * Construct init segment for the given index.\n * @param {Object} index\n * @returns {Object}\n */\nexport default function getInitSegment(\n  index: { timescale: number;\n           initialization?: { mediaURL: string; range?: [number, number] };\n           indexRange?: [number, number];\n           indexTimeOffset : number; }\n) : ISegment {\n  const { initialization } = index;\n  return { id: \"init\",\n           isInit: true,\n           time: 0,\n           duration: 0,\n           range: initialization ? initialization.range || undefined :\n                                   undefined,\n           indexRange: index.indexRange || undefined,\n           mediaURL: initialization ? initialization.mediaURL :\n                                      null,\n           timescale: index.timescale,\n           timestampOffset: -(index.indexTimeOffset / index.timescale) };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport resolveURL from \"../../../../utils/resolve_url\";\n\n/**\n * Pad with 0 in the left of the given n argument to reach l length\n * @param {Number|string} n\n * @param {Number} l\n * @returns {string}\n */\nfunction padLeftWithZeros(n : number|string, l : number) : string {\n  const nToString = n.toString();\n  if (nToString.length >= l) {\n    return nToString;\n  }\n  const arr = new Array(l + 1).join(\"0\") + nToString;\n  return arr.slice(-l);\n}\n\nfunction processFormatedToken(\n  replacer : string|number\n) : (x: string, y: number, widthStr: string) => string {\n  return (_match, _format, widthStr : string) => {\n    const width = widthStr ? parseInt(widthStr, 10) : 1;\n    return padLeftWithZeros(\"\" + replacer, width);\n  };\n}\n\n/**\n * @param {string} representationURL\n * @param {string|undefined} media\n * @param {string|undefined} id\n * @param {number|undefined} bitrate\n * @returns {string}\n */\nexport function createIndexURL(\n  representationURL : string,\n  media?: string,\n  id?: string,\n  bitrate?: number\n): string {\n  return replaceRepresentationDASHTokens(resolveURL(representationURL, media),\n                                         id,\n                                         bitrate);\n}\n\n/**\n * Replace \"tokens\" written in a given path (e.g. $RepresentationID$) by the corresponding\n * infos, taken from the given segment.\n * @param {string} path\n * @param {string|undefined} id\n * @param {number|undefined} bitrate\n * @returns {string}\n */\nexport function replaceRepresentationDASHTokens(\n  path: string,\n  id?: string,\n  bitrate?: number\n): string {\n  if (path.indexOf(\"$\") === -1) {\n    return path;\n  } else {\n    return path\n      .replace(/\\$\\$/g, \"$\")\n      .replace(/\\$RepresentationID\\$/g, String(id))\n      .replace(/\\$Bandwidth(|\\%0(\\d+)d)\\$/g, processFormatedToken(bitrate ||0));\n  }\n}\n\n/**\n * Replace \"tokens\" written in a given path (e.g. $Time$) by the corresponding\n * infos, taken from the given segment.\n * @param {string} path\n * @param {number} time\n * @param {number} number\n * @returns {string}\n *\n * @throws Error - Throws if we do not have enough data to construct the URL\n */\nexport function replaceSegmentDASHTokens(\n  path : string,\n  time? : number,\n  number? : number\n) : string {\n  if (path.indexOf(\"$\") === -1) {\n    return path;\n  } else {\n    return path\n      .replace(/\\$\\$/g, \"$\")\n      .replace(/\\$Number(|\\%0(\\d+)d)\\$/g, (_x, _y, widthStr) => {\n        if (number == null) {\n          throw new Error(\"Segment number not defined in a $Number$ scheme\");\n        }\n        return processFormatedToken(number)(_x, _y, widthStr);\n      })\n      .replace(/\\$Time(|\\%0(\\d+)d)\\$/g, (_x, _y, widthStr) => {\n        if (time == null) {\n          throw new Error(\"Segment time not defined in a $Time$ scheme\");\n        }\n        return processFormatedToken(time)(_x, _y, widthStr);\n      });\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ISegment } from \"../../../../manifest\";\nimport {\n  calculateRepeat,\n  IIndexSegment,\n  toIndexTime,\n} from \"../../utils/index_helpers\";\nimport { replaceSegmentDASHTokens } from \"./tokens\";\n\n/**\n * For the given start time and duration of a timeline element, calculate how\n * much this element should be repeated to contain the time given.\n * 0 being the same element, 1 being the next one etc.\n * @param {Number} segmentStartTime\n * @param {Number} segmentDuration\n * @param {Number} wantedTime\n * @returns {Number}\n */\nfunction getWantedRepeatIndex(\n  segmentStartTime : number,\n  segmentDuration : number,\n  wantedTime : number\n) : number {\n  const diff = wantedTime - segmentStartTime;\n  return diff > 0 ? Math.floor(diff / segmentDuration) :\n                    0;\n}\n\n/**\n * Get a list of Segments for the time range wanted.\n * @param {Object} index - index object, constructed by parsing the manifest.\n * @param {number} from - starting timestamp wanted, in seconds\n * @param {number} durationWanted - duration wanted, in seconds\n * @returns {Array.<Object>}\n */\nexport default function getSegmentsFromTimeline(\n  index : { mediaURL : string;\n            startNumber? : number;\n            timeline : IIndexSegment[];\n            timescale : number;\n            indexTimeOffset : number; },\n  from : number,\n  durationWanted : number,\n  maximumTime? : number\n) : ISegment[] {\n  const scaledUp = toIndexTime(from, index);\n  const scaledTo = toIndexTime(from + durationWanted, index);\n  const { timeline, timescale, mediaURL, startNumber } = index;\n\n  let currentNumber = startNumber != null ? startNumber : undefined;\n\n  const segments : ISegment[] = [];\n\n  const timelineLength = timeline.length;\n\n  // TODO(pierre): use @maxSegmentDuration if possible\n  let maxEncounteredDuration = (timeline.length && timeline[0].duration) || 0;\n\n  for (let i = 0; i < timelineLength; i++) {\n    const timelineItem = timeline[i];\n    const { duration, start, range } = timelineItem;\n\n    maxEncounteredDuration = Math.max(maxEncounteredDuration, duration);\n\n    const repeat = calculateRepeat(timelineItem, timeline[i + 1], maximumTime);\n    let segmentNumberInCurrentRange = getWantedRepeatIndex(start, duration, scaledUp);\n    let segmentTime = start + segmentNumberInCurrentRange * duration;\n    while (segmentTime < scaledTo && segmentNumberInCurrentRange <= repeat) {\n      const segmentNumber = currentNumber != null ?\n        currentNumber + segmentNumberInCurrentRange : undefined;\n      const segment = { id: \"\" + segmentTime,\n                        time: segmentTime - index.indexTimeOffset,\n                        isInit: false,\n                        range,\n                        duration,\n                        timescale,\n                        mediaURL: replaceSegmentDASHTokens(mediaURL,\n                                                           segmentTime,\n                                                           segmentNumber),\n                        number: segmentNumber,\n                        timestampOffset: -(index.indexTimeOffset / timescale) };\n      segments.push(segment);\n\n      // update segment number and segment time for the next segment\n      segmentNumberInCurrentRange++;\n      segmentTime = start + segmentNumberInCurrentRange * duration;\n    }\n\n    if (segmentTime >= scaledTo) {\n      // we reached ``scaledTo``, we're done\n      return segments;\n    }\n\n    if (currentNumber != null) {\n      currentNumber += repeat + 1;\n    }\n  }\n\n  return segments;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  IRepresentationIndex,\n  ISegment,\n} from \"../../../../manifest\";\nimport {\n  fromIndexTime,\n  getIndexSegmentEnd,\n  IIndexSegment,\n  toIndexTime,\n} from \"../../utils/index_helpers\";\nimport getInitSegment from \"./get_init_segment\";\nimport getSegmentsFromTimeline from \"./get_segments_from_timeline\";\nimport { createIndexURL } from \"./tokens\";\n\n// index property defined for a SegmentBase RepresentationIndex\nexport interface IBaseIndex {\n  indexRange?: [number, number]; // byte range for a possible index of segments\n                                 // in the server\n  indexTimeOffset : number; // Temporal offset, in the current timescale (see\n                            // timescale), to add to the presentation time\n                            // (time a segment has at decoding time) to\n                            // obtain the corresponding media time (original\n                            // time of the media segment in the index and on\n                            // the media file).\n                            // For example, to look for a segment beginning at\n                            // a second `T` on a HTMLMediaElement, we\n                            // actually will look for a segment in the index\n                            // beginning at:\n                            // ``` T * timescale + indexTimeOffset ```\n  initialization? : { // information on the initialization segment\n    mediaURL: string; // URL to access the initialization segment\n    range?: [number, number]; // possible byte range to request it\n  };\n  mediaURL : string; // base URL to access any segment. Can contain token to\n                     // replace to convert it to a real URL\n  startNumber? : number; // number from which the first segments in this index\n                         // starts with\n  timeline : IIndexSegment[]; // Every segments defined in this index\n  timescale : number; // timescale to convert a time given here into seconds.\n                      // This is done by this simple operation:\n                      // ``timeInSeconds = timeInIndex * timescale``\n}\n\n// `index` Argument for a SegmentBase RepresentationIndex\n// Most of the properties here are already defined in IBaseIndex.\nexport interface IBaseIndexIndexArgument {\n  timeline : IIndexSegment[];\n  timescale : number;\n  media? : string;\n  indexRange?: [number, number];\n  initialization?: { media?: string; range?: [number, number] };\n  startNumber? : number;\n  presentationTimeOffset? : number; // Offset present in the index to convert\n                                    // from the mediaTime (time declared in the\n                                    // media segments and in this index) to the\n                                    // presentationTime (time wanted when\n                                    // decoding the segment).\n                                    // Basically by doing something along the\n                                    // line of:\n                                    // ```\n                                    // presentationTimeInSeconds =\n                                    //   mediaTimeInSeconds -\n                                    //   presentationTimeOffsetInSeconds *\n                                    //   periodStartInSeconds\n                                    // ```\n                                    // The time given here is in the current\n                                    // timescale (see timescale)\n}\n\n// Aditional argument for a SegmentBase RepresentationIndex\nexport interface IBaseIndexContextArgument {\n  periodStart : number; // Start of the period concerned by this\n                        // RepresentationIndex, in seconds\n  periodEnd : number|undefined; // End of the period concerned by this\n                                // RepresentationIndex, in seconds\n  representationBaseURL : string; // Base URL for the Representation concerned\n  representationId? : string; // ID of the Representation concerned\n  representationBitrate? : number; // Bitrate of the Representation concerned\n}\n\n/**\n * Add a new segment to the index.\n *\n * /!\\ Mutate the given index\n * @param {Object} index\n * @param {Object} segmentInfos\n * @returns {Boolean} - true if the segment has been added\n */\nfunction _addSegmentInfos(\n  index : IBaseIndex,\n  segmentInfos : { time : number;\n                   duration : number;\n                   timescale : number;\n                   count?: number;\n                   range?: [number, number]; }\n) : boolean {\n  if (segmentInfos.timescale !== index.timescale) {\n    const { timescale } = index;\n    index.timeline.push({ start: (segmentInfos.time / segmentInfos.timescale)\n                                 * timescale,\n                          duration: (segmentInfos.duration / segmentInfos.timescale)\n                                    * timescale,\n                          repeatCount: segmentInfos.count || 0,\n                          range: segmentInfos.range });\n  } else {\n    index.timeline.push({ start: segmentInfos.time,\n                          duration: segmentInfos.duration,\n                          repeatCount: segmentInfos.count || 0,\n                          range: segmentInfos.range });\n  }\n  return true;\n}\n\n/**\n * Provide helpers for SegmentBase-based indexes.\n * @type {Object}\n */\nexport default class BaseRepresentationIndex implements IRepresentationIndex {\n  private _index : IBaseIndex;\n\n  // absolute end of the period, timescaled and converted to index time\n  private _scaledPeriodEnd : number | undefined;\n\n  /**\n   * @param {Object} index\n   * @param {Object} context\n   */\n  constructor(index : IBaseIndexIndexArgument, context : IBaseIndexContextArgument) {\n    const { periodStart,\n            periodEnd,\n            representationBaseURL,\n            representationId,\n            representationBitrate } = context;\n    const { timescale } = index;\n\n    const presentationTimeOffset = index.presentationTimeOffset != null ?\n      index.presentationTimeOffset : 0;\n\n    const indexTimeOffset = presentationTimeOffset - periodStart * timescale;\n\n    const mediaURL = createIndexURL(representationBaseURL,\n                                    index.initialization !== undefined ?\n                                      index.initialization.media :\n                                      undefined,\n                                    representationId,\n                                    representationBitrate);\n\n    // TODO If indexRange is either undefined or behind the initialization segment\n    // the following logic will not work.\n    // However taking the nth first bytes like `dash.js` does (where n = 1500) is\n    // not straightforward as we would need to clean-up the segment after that.\n    // The following logic corresponds to 100% of tested cases, so good enough for\n    // now.\n    const range : [number, number] | undefined =\n      index.initialization !== undefined ? index.initialization.range :\n      index.indexRange !== undefined ? [0, index.indexRange[0] - 1] :\n                                       undefined;\n\n    this._index = { indexRange: index.indexRange,\n                    indexTimeOffset,\n                    initialization: { mediaURL, range },\n                    mediaURL: createIndexURL(representationBaseURL,\n                                             index.media,\n                                             representationId,\n                                             representationBitrate),\n                    startNumber: index.startNumber,\n                    timeline: index.timeline,\n                    timescale };\n    this._scaledPeriodEnd = periodEnd == null ? undefined :\n                                                toIndexTime(periodEnd, this._index);\n  }\n\n  /**\n   * Construct init Segment.\n   * @returns {Object}\n   */\n  getInitSegment() : ISegment {\n    return getInitSegment(this._index);\n  }\n\n  /**\n   * @param {Number} _up\n   * @param {Number} _to\n   * @returns {Array.<Object>}\n   */\n  getSegments(_up : number, _to : number) : ISegment[] {\n    return getSegmentsFromTimeline(this._index, _up, _to, this._scaledPeriodEnd);\n  }\n\n  /**\n   * Returns false as no Segment-Base based index should need to be refreshed.\n   * @returns {Boolean}\n   */\n  shouldRefresh() : false {\n    return false;\n  }\n\n  /**\n   * Returns first position in index.\n   * @returns {Number|null}\n   */\n  getFirstPosition() : number|null {\n    const index = this._index;\n    if (index.timeline.length === 0) {\n      return null;\n    }\n    return fromIndexTime(index.timeline[0].start, index);\n  }\n\n  /**\n   * Returns last position in index.\n   * @returns {Number|null}\n   */\n  getLastPosition() : number|null {\n    const { timeline } = this._index;\n    if (timeline.length === 0) {\n      return null;\n    }\n    const lastTimelineElement = timeline[timeline.length - 1];\n    const lastTime = getIndexSegmentEnd(lastTimelineElement,\n                                        null,\n                                        this._scaledPeriodEnd);\n    return fromIndexTime(lastTime, this._index);\n  }\n\n  /**\n   * Segments in a segmentBase scheme should stay available.\n   * @returns {Boolean|undefined}\n   */\n  isSegmentStillAvailable() : true {\n    return true;\n  }\n\n  /**\n   * We do not check for discontinuity in SegmentBase-based indexes.\n   * @returns {Number}\n   */\n  checkDiscontinuity() : -1 {\n    return -1;\n  }\n\n  /**\n   * @param {Array.<Object>} nextSegments\n   * @returns {Array.<Object>}\n   */\n  _addSegments(nextSegments : Array<{ time : number;\n                                      duration : number;\n                                      timescale : number;\n                                      count? : number;\n                                      range? : [number, number]; }>\n  ) : void {\n    for (let i = 0; i < nextSegments.length; i++) {\n      _addSegmentInfos(this._index, nextSegments[i]);\n    }\n  }\n\n  /**\n   * SegmentBase should not be updated.\n   * @returns {Boolean}\n   */\n  canBeOutOfSyncError() : false {\n    return false;\n  }\n\n  /**\n   * @returns {Boolean}\n   */\n  isFinished() : true {\n    return true;\n  }\n\n  /**\n   * @param {Object} newIndex\n   */\n  _update(newIndex : BaseRepresentationIndex) : void {\n    this._index = newIndex._index;\n  }\n}\n","/*\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../../../../log\";\nimport {\n  IRepresentationIndex,\n  ISegment,\n} from \"../../../../manifest\";\nimport { getTimescaledRange } from \"../../utils/index_helpers\";\nimport getInitSegment from \"./get_init_segment\";\nimport { createIndexURL } from \"./tokens\";\n\n// index property defined for a SegmentList RepresentationIndex\nexport interface IListIndex {\n  timescale : number; // timescale to convert a time given here into seconds.\n                      // This is done by this simple operation:\n                      // ``timeInSeconds = timeInIndex * timescale``\n  duration : number; // duration of each element in the list, in the\n                     // timescale given (see timescale and list)\n  list: Array<{ // List of Segments for this index\n    mediaURL : string; // URL of the segment\n    mediaRange? : [number, number]; // possible byte-range of the segment\n  }>;\n  indexTimeOffset : number; // Temporal offset, in the current timescale (see\n                            // timescale), to add to the presentation time\n                            // (time a segment has at decoding time) to\n                            // obtain the corresponding media time (original\n                            // time of the media segment in the index and on\n                            // the media file).\n                            // For example, to look for a segment beginning at\n                            // a second `T` on a HTMLMediaElement, we\n                            // actually will look for a segment in the index\n                            // beginning at:\n                            // ``` T * timescale + indexTimeOffset ```\n\n  initialization? : { // information on the initialization segment\n    mediaURL: string; // URL to access the initialization segment\n    range?: [number, number]; // possible byte range to request it\n  };\n  indexRange?: [number, number]; // byte range for a possible index of segments\n                                 // in the server\n}\n\n// `index` Argument for a SegmentList RepresentationIndex\n// Those properties come generally come from a SegmentList Node in an MPD.\nexport interface IListIndexIndexArgument {\n  duration : number; // duration of each element in the list, in the\n                     // timescale given (see timescale and list)\n  indexRange?: [number, number]; // byte range for a possible index of segments\n                                 // in the server\n  initialization?: { // data allowing to download the init segment\n    media? : string; // URL of the init segment\n    range?: [number, number]; // possible byte-range for the init segment\n  };\n  list: Array<{ // List of Segments for this index\n    media? : string; // URL of the segment\n    mediaRange? : [number, number]; // possible byte-range of the segment\n  }>;\n  presentationTimeOffset? : number; // Offset present in the index to convert\n                                    // from the mediaTime (time declared in the\n                                    // media segments and in this index) to the\n                                    // presentationTime (time wanted when\n                                    // decoding the segment).\n                                    // Basically by doing something along the\n                                    // line of:\n                                    // ```\n                                    // presentationTimeInSeconds =\n                                    //   mediaTimeInSeconds -\n                                    //   presentationTimeOffsetInSeconds +\n                                    //   periodStartInSeconds\n                                    // ```\n                                    // The time given here is in the current\n                                    // timescale (see timescale)\n  timescale : number; // timescale to convert a time given here into seconds.\n                      // This is done by this simple operation:\n                      // ``timeInSeconds = timeInIndex * timescale``\n}\n\n// Aditional argument for a SegmentList RepresentationIndex\n// Offers some context about the current Representation\nexport interface IListIndexContextArgument {\n  periodStart : number; // Start of the period concerned by this\n                        // RepresentationIndex, in seconds\n  representationBaseURL : string; // Base URL for the Representation concerned\n  representationId? : string; // ID of the Representation concerned\n  representationBitrate? : number; // Bitrate of the Representation concerned\n}\n\n/**\n * Provide helpers for SegmentList-based DASH indexes.\n * @type {Object}\n */\nexport default class ListRepresentationIndex implements IRepresentationIndex {\n  protected _periodStart : number;\n  private _index : IListIndex;\n\n  /**\n   * @param {Object} index\n   * @param {Object} context\n   */\n  constructor(index : IListIndexIndexArgument, context : IListIndexContextArgument) {\n    const { periodStart,\n            representationBaseURL,\n            representationId,\n            representationBitrate } = context;\n\n    this._periodStart = periodStart;\n    const presentationTimeOffset =\n      index.presentationTimeOffset != null ? index.presentationTimeOffset :\n                                             0;\n    const indexTimeOffset = presentationTimeOffset - periodStart * index.timescale;\n\n    const list = index.list.map((lItem) => ({\n      mediaURL: createIndexURL(representationBaseURL,\n                               lItem.media,\n                               representationId,\n                               representationBitrate),\n      mediaRange: lItem.mediaRange }));\n    this._index = { list,\n                    timescale: index.timescale,\n                    duration: index.duration,\n                    indexTimeOffset,\n                    indexRange: index.indexRange,\n                    initialization: index.initialization && {\n                      mediaURL: createIndexURL(representationBaseURL,\n                                               index.initialization.media,\n                                               representationId,\n                                               representationBitrate),\n                    range: index.initialization.range, }, };\n  }\n\n  /**\n   * Construct init Segment.\n   * @returns {Object}\n   */\n  getInitSegment() : ISegment {\n    return getInitSegment(this._index);\n  }\n\n  /**\n   * @param {Number} fromTime\n   * @param {Number} duration\n   * @returns {Array.<Object>}\n   */\n  getSegments(fromTime : number, dur : number) : ISegment[] {\n    const index = this._index;\n    const { duration, list, timescale } = index;\n    const fromTimeInPeriod = fromTime - this._periodStart;\n    const [ up, to ] = getTimescaledRange(fromTimeInPeriod, dur, timescale);\n\n    const scaledStart = this._periodStart * timescale;\n    const length = Math.min(list.length - 1, Math.floor(to / duration));\n    const segments : ISegment[] = [];\n    let i = Math.floor(up / duration);\n    while (i <= length) {\n      const range = list[i].mediaRange;\n      const mediaURL = list[i].mediaURL;\n      const args = { id: \"\" + i,\n                     time: i * duration + scaledStart,\n                     isInit: false,\n                     range,\n                     duration,\n                     timescale,\n                     mediaURL,\n                     timestampOffset: -(index.indexTimeOffset / timescale) };\n      segments.push(args);\n      i++;\n    }\n    return segments;\n  }\n\n  /**\n   * Returns true if, based on the arguments, the index should be refreshed.\n   * (If we should re-fetch the manifest)\n   * @param {Number} _fromTime\n   * @param {Number} toTime\n   * @returns {Boolean}\n   */\n  shouldRefresh(_fromTime : number, toTime : number) : boolean {\n    const { timescale, duration, list } = this._index;\n    const scaledTo = toTime * timescale;\n    const i = Math.floor(scaledTo / duration);\n    return i < 0 || i >= list.length;\n  }\n\n  /**\n   * Returns first position in index.\n   * @returns {Number}\n   */\n  getFirstPosition() : number {\n    return this._periodStart;\n  }\n\n  /**\n   * Returns last position in index.\n   * @returns {Number}\n   */\n  getLastPosition() : number {\n    const index = this._index;\n    const { duration, list } = index;\n    return ((list.length * duration) / index.timescale) + this._periodStart;\n  }\n\n  /**\n   * Returns true if a Segment returned by this index is still considered\n   * available.\n   * @param {Object} segment\n   * @returns {Boolean|undefined}\n   */\n  isSegmentStillAvailable(segment : ISegment) : boolean {\n    if (segment.isInit) {\n      return true;\n    }\n    const index = this._index;\n    const scaledStart = this._periodStart * index.timescale;\n    const scaledSegmentStartInPeriod = segment.timescale !== index.timescale ?\n      ((segment.time * index.timescale) / segment.timescale) + scaledStart :\n      segment.time - scaledStart;\n\n    const { duration } = index;\n    const segmentNb = scaledSegmentStartInPeriod / duration;\n    return segmentNb > 0 && segmentNb % 1 === 0;\n  }\n\n  /**\n   * We do not check for discontinuity in SegmentList-based indexes.\n   * @returns {Number}\n   */\n  checkDiscontinuity() : -1 {\n    return -1;\n  }\n\n  /**\n   * SegmentList should not be updated.\n   * @returns {Boolean}\n   */\n  canBeOutOfSyncError() : false {\n    return false;\n  }\n\n  /**\n   * @returns {Boolean}\n   */\n  isFinished() : true {\n    return true;\n  }\n\n  /**\n   * @param {Object} newIndex\n   */\n  _update(newIndex : ListRepresentationIndex) : void {\n    this._index = newIndex._index;\n  }\n\n  /**\n   * We do not have to add new segments to SegmentList-based indexes.\n   * @returns {Array}\n   */\n  _addSegments() : void {\n    if (__DEV__) {\n      log.warn(\"Tried to add Segments to a list RepresentationIndex\");\n    }\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport config from \"../../../../config\";\nimport log from \"../../../../log\";\nimport {\n  IRepresentationIndex,\n  ISegment,\n} from \"../../../../manifest\";\nimport ManifestBoundsCalculator from \"../manifest_bounds_calculator\";\nimport getInitSegment from \"./get_init_segment\";\nimport {\n  createIndexURL,\n  replaceSegmentDASHTokens,\n} from \"./tokens\";\n\nconst { MINIMUM_SEGMENT_SIZE } = config;\n\n// index property defined for a SegmentTemplate RepresentationIndex\nexport interface ITemplateIndex {\n  duration : number; // duration of each element in the timeline, in the\n                     // timescale given (see timescale and timeline)\n  timescale : number; // timescale to convert a time given here into seconds.\n                      // This is done by this simple operation:\n                      // ``timeInSeconds = timeInIndex * timescale``\n\n  indexRange?: [number, number]; // byte range for a possible index of segments\n                                 // in the server\n  initialization?: { // information on the initialization segment\n    mediaURL: string; // URL to access the initialization segment\n    range?: [number, number]; // possible byte range to request it\n  };\n  mediaURL : string; // base URL to access any segment. Can contain token to\n                     // replace to convert it to a real URL\n  indexTimeOffset : number; // Temporal offset, in the current timescale (see\n                            // timescale), to add to the presentation time\n                            // (time a segment has at decoding time) to\n                            // obtain the corresponding media time (original\n                            // time of the media segment in the index and on\n                            // the media file).\n                            // For example, to look for a segment beginning at\n                            // a second `T` on a HTMLMediaElement, we\n                            // actually will look for a segment in the index\n                            // beginning at:\n                            // ``` T * timescale + indexTimeOffset ```\n  presentationTimeOffset : number; // Time, in the timescale, at which the first\n                                   // segment of the Period is declared.\n                                   // This value should be substracted from the\n                                   // media time to produce the presentation\n                                   // time.\n  startNumber? : number; // number from which the first segments in this index\n                         // starts with\n}\n\n// `index` Argument for a SegmentTemplate RepresentationIndex\n// All of the properties here are already defined in ITemplateIndex.\nexport interface ITemplateIndexIndexArgument {\n  duration : number;\n  timescale : number;\n\n  indexRange?: [number, number];\n  initialization?: { media? : string;\n                     range? : [number, number]; };\n  media? : string;\n  presentationTimeOffset? : number;\n  startNumber? : number;\n}\n\n// Aditional argument for a SegmentTemplate RepresentationIndex\nexport interface ITemplateIndexContextArgument {\n  aggressiveMode : boolean; // If `true`, this index will return segments which\n                            // which had time to be started but not finished.\n  manifestBoundsCalculator : ManifestBoundsCalculator; // Allows to obtain the\n                                                       // minimum and maximum\n                                                       // of a content\n  isDynamic : boolean; // if true, the MPD can be updated over time\n  periodEnd : number|undefined; // End of the Period concerned by this\n                                // RepresentationIndex, in seconds\n  periodStart : number; // Start of the Period concerned by this\n                        // RepresentationIndex, in seconds\n  representationBaseURL : string; // Base URL for the Representation concerned\n                                  // i.e. Common beginning of the URL\n  representationBitrate? : number; // Bitrate of the Representation concerned\n  representationId? : string; // ID of the Representation concerned\n}\n\n/**\n * IRepresentationIndex implementation for DASH' SegmentTemplate without a\n * SegmentTimeline.\n * @class TemplateRepresentationIndex\n */\nexport default class TemplateRepresentationIndex implements IRepresentationIndex {\n  private _aggressiveMode : boolean;\n  private _index : ITemplateIndex;\n  private _manifestBoundsCalculator : ManifestBoundsCalculator;\n  private _periodStart : number;\n  private _relativePeriodEnd? : number;\n\n  // Whether this RepresentationIndex can change over time.\n  private _isDynamic : boolean;\n\n  /**\n   * @param {Object} index\n   * @param {Object} context\n   */\n  constructor(\n    index : ITemplateIndexIndexArgument,\n    context : ITemplateIndexContextArgument\n  ) {\n    const { timescale } = index;\n    const { aggressiveMode,\n            manifestBoundsCalculator,\n            isDynamic,\n            periodEnd,\n            periodStart,\n            representationBaseURL,\n            representationId,\n            representationBitrate } = context;\n\n    this._manifestBoundsCalculator = manifestBoundsCalculator;\n    this._aggressiveMode = aggressiveMode;\n    const presentationTimeOffset = index.presentationTimeOffset != null ?\n                                     index.presentationTimeOffset :\n                                     0;\n\n    const scaledStart = periodStart * timescale;\n    const indexTimeOffset = presentationTimeOffset - scaledStart;\n\n    this._index = { duration: index.duration,\n                    timescale,\n                    indexRange: index.indexRange,\n                    indexTimeOffset,\n                    initialization: index.initialization && {\n                      mediaURL: createIndexURL(representationBaseURL,\n                                               index.initialization.media,\n                                               representationId,\n                                               representationBitrate),\n                      range: index.initialization.range,\n                    },\n                    mediaURL: createIndexURL(representationBaseURL,\n                                             index.media,\n                                             representationId,\n                                             representationBitrate),\n                    presentationTimeOffset,\n                    startNumber: index.startNumber };\n    this._isDynamic = isDynamic;\n    this._periodStart = periodStart;\n    this._relativePeriodEnd = periodEnd == null ? undefined :\n                                                  periodEnd - periodStart;\n  }\n\n  /**\n   * Construct init Segment.\n   * @returns {Object}\n   */\n  getInitSegment() : ISegment {\n    return getInitSegment(this._index);\n  }\n\n  /**\n   * @param {Number} fromTime\n   * @param {Number} dur\n   * @returns {Array.<Object>}\n   */\n  getSegments(fromTime : number, dur : number) : ISegment[] {\n    const index = this._index;\n    const { duration,\n            startNumber,\n            timescale,\n            mediaURL } = index;\n\n    const scaledStart = this._periodStart * timescale;\n    const scaledEnd = this._relativePeriodEnd == null ?\n      undefined :\n      this._relativePeriodEnd * timescale;\n\n    // Convert the asked position to the right timescales, and consider them\n    // relatively to the Period's start.\n    const upFromPeriodStart = fromTime * timescale - scaledStart;\n    const toFromPeriodStart = (fromTime + dur) * timescale - scaledStart;\n    const firstSegmentStart = this._getFirstSegmentStart();\n    const lastSegmentStart = this._getLastSegmentStart();\n    if (firstSegmentStart == null || lastSegmentStart == null) {\n      return [];\n    }\n    const startPosition = Math.max(firstSegmentStart, upFromPeriodStart);\n    const lastWantedStartPosition = Math.min(lastSegmentStart, toFromPeriodStart);\n    if ((lastWantedStartPosition + duration) <= startPosition) {\n      return [];\n    }\n\n    const segments : ISegment[] = [];\n\n    // number corresponding to the Period's start\n    const numberOffset = startNumber == null ? 1 :\n                                               startNumber;\n\n    // calcul initial time from Period start, where the first segment would have\n    // the `0` number\n    let numberIndexedToZero = Math.floor(startPosition / duration);\n\n    for (let timeFromPeriodStart = numberIndexedToZero * duration;\n         timeFromPeriodStart <= lastWantedStartPosition;\n         timeFromPeriodStart += duration)\n    {\n      // To obtain the real number, adds the real number from the Period's start\n      const realNumber = numberIndexedToZero + numberOffset;\n\n      const realDuration = scaledEnd != null &&\n                           timeFromPeriodStart + duration > scaledEnd ?\n                             scaledEnd - timeFromPeriodStart :\n                             duration;\n      const realTime = timeFromPeriodStart + scaledStart;\n      const manifestTime = timeFromPeriodStart + this._index.presentationTimeOffset;\n      const realURL = replaceSegmentDASHTokens(mediaURL, manifestTime, realNumber);\n      const args = { id: \"\" + realNumber,\n                     number: realNumber,\n                     time: realTime,\n                     isInit: false,\n                     duration: realDuration,\n                     timescale,\n                     mediaURL: realURL,\n                     timestampOffset: -(index.indexTimeOffset / timescale) };\n      segments.push(args);\n      numberIndexedToZero++;\n    }\n\n    return segments;\n  }\n\n  /**\n   * Returns first possible position in the index.\n   * @returns {number|null|undefined}\n   */\n  getFirstPosition() : number | null | undefined {\n    const firstSegmentStart = this._getFirstSegmentStart();\n    if (firstSegmentStart == null) {\n      return firstSegmentStart; // return undefined or null\n    }\n    return (firstSegmentStart / this._index.timescale) + this._periodStart;\n  }\n\n  /**\n   * Returns last possible position in the index.\n   * @returns {number|null}\n   */\n  getLastPosition() : number|null|undefined {\n    const lastSegmentStart = this._getLastSegmentStart();\n    if (lastSegmentStart == null) {\n      // In that case (null or undefined), getLastPosition should reflect\n      // the result of getLastSegmentStart, as the meaning is the same for\n      // the two functions. So, we return the result of the latter.\n      return lastSegmentStart;\n    }\n    const lastSegmentEnd = lastSegmentStart + this._index.duration;\n    return (lastSegmentEnd / this._index.timescale) + this._periodStart;\n  }\n\n  /**\n   * Returns true if, based on the arguments, the index should be refreshed.\n   * We never have to refresh a SegmentTemplate-based manifest.\n   * @returns {Boolean}\n   */\n  shouldRefresh() : false {\n    return false;\n  }\n\n  /**\n   * We cannot check for discontinuity in SegmentTemplate-based indexes.\n   * @returns {Number}\n   */\n  checkDiscontinuity() : -1 {\n    return -1;\n  }\n\n  isSegmentStillAvailable(segment : ISegment) : boolean|undefined {\n    if (segment.isInit) {\n      return true;\n    }\n    if (segment.timescale !== this._index.timescale) {\n      return undefined;\n    }\n\n    const { timescale } = segment;\n    const timeRelativeToPeriodStart = segment.time - (this._periodStart * timescale);\n\n    const firstSegmentStart = this._getFirstSegmentStart();\n    const lastSegmentStart = this._getLastSegmentStart();\n    if (firstSegmentStart === undefined || lastSegmentStart === undefined) {\n      return undefined;\n    }\n    if (firstSegmentStart === null || lastSegmentStart === null) {\n      return false;\n    }\n    if (timeRelativeToPeriodStart < firstSegmentStart) {\n      return false;\n    }\n    if (timeRelativeToPeriodStart > lastSegmentStart ||\n        segment.duration !== this._index.duration) {\n      return false;\n    }\n\n    return (timeRelativeToPeriodStart / this._index.duration) % 1 === 0;\n  }\n\n  /**\n   * SegmentTemplate without a SegmentTimeline should not be updated.\n   * @returns {Boolean}\n   */\n  canBeOutOfSyncError() : false {\n    return false;\n  }\n\n  /**\n   * @returns {Boolean}\n   */\n  isFinished() : boolean {\n    if (!this._isDynamic) {\n      return true;\n    }\n    if (this._relativePeriodEnd == null) {\n      return false;\n    }\n\n    const { timescale } = this._index;\n    const lastSegmentStart = this._getLastSegmentStart();\n\n    // As last segment start is null if live time is before\n    // current period, consider the index not to be finished.\n    if (lastSegmentStart == null) {\n      return false;\n    }\n    const lastSegmentEnd = lastSegmentStart + this._index.duration;\n\n    // (1 / 60 for possible rounding errors)\n    const roundingError = (1 / 60) * timescale;\n    return (lastSegmentEnd + roundingError) >=\n           (this._relativePeriodEnd * timescale);\n  }\n\n  /**\n   * We do not have to add new segments to SegmentList-based indexes.\n   * @returns {Array}\n   */\n  _addSegments() : void {\n    log.warn(\"Tried to add Segments to a template RepresentationIndex\");\n  }\n\n  /**\n   * @param {Object} newIndex\n   */\n  _update(newIndex : TemplateRepresentationIndex) : void {\n    this._index = newIndex._index;\n    this._aggressiveMode = newIndex._aggressiveMode;\n    this._isDynamic = newIndex._isDynamic;\n    this._periodStart = newIndex._periodStart;\n    this._relativePeriodEnd = newIndex._relativePeriodEnd;\n    this._manifestBoundsCalculator = newIndex._manifestBoundsCalculator;\n  }\n\n  /**\n   * Returns the timescaled start of the first segment that should be available,\n   * relatively to the start of the Period.\n   * @returns {number | null | undefined}\n   */\n  private _getFirstSegmentStart() : number | null | undefined {\n    if (!this._isDynamic) {\n      return 0; // it is the start of the Period\n    }\n\n    // 1 - check that this index is already available\n    if (!this._relativePeriodEnd) {\n      // /!\\ The scaled max position augments continuously and might not\n      // reflect exactly the real server-side value. As segments are\n      // generated discretely.\n      const maximumBound = this._manifestBoundsCalculator.getMaximumBound();\n      if (maximumBound !== undefined && maximumBound < this._periodStart) {\n        // Maximum position is before this period.\n        // No segment is yet available here\n        return null;\n      }\n    }\n\n    const { duration, timescale } = this._index;\n    const firstPosition = this._manifestBoundsCalculator.getMinimumBound();\n    if (firstPosition === undefined) {\n      return undefined;\n    }\n\n    const segmentTime = firstPosition > this._periodStart ?\n      (firstPosition - this._periodStart) * timescale :\n      0;\n    const numberIndexedToZero = Math.floor(segmentTime / duration);\n    return numberIndexedToZero * duration;\n  }\n\n  /**\n   * Returns the timescaled start of the last segment that should be available,\n   * relatively to the start of the Period.\n   * Returns null if live time is before current period.\n   * @returns {number|null|undefined}\n   */\n  private _getLastSegmentStart() : number | null | undefined {\n    const { duration, timescale } = this._index;\n\n    if (this._isDynamic) {\n      const lastPos = this._manifestBoundsCalculator.getMaximumBound();\n      if (lastPos === undefined) {\n        return undefined;\n      }\n      if (this._relativePeriodEnd != null &&\n          this._relativePeriodEnd < (lastPos - this._periodStart)) {\n        const scaledRelativePeriodEnd = this._relativePeriodEnd * timescale;\n        return scaledRelativePeriodEnd <= 0 ? null :\n                                              scaledRelativePeriodEnd - duration;\n      }\n      // /!\\ The scaled last position augments continuously and might not\n      // reflect exactly the real server-side value. As segments are\n      // generated discretely.\n      const scaledLastPosition = (lastPos - this._periodStart) * timescale;\n\n      // Maximum position is before this period.\n      // No segment is yet available here\n      if (scaledLastPosition < 0) {\n        return null;\n      }\n      const numberOfSegmentsAvailable = this._aggressiveMode ?\n        Math.ceil(scaledLastPosition / duration) :\n        Math.floor(scaledLastPosition / duration);\n      return numberOfSegmentsAvailable <= 0 ?\n               null :\n               (numberOfSegmentsAvailable - 1) * duration;\n    } else {\n      const maximumTime = (this._relativePeriodEnd || 0) * timescale;\n      const numberIndexedToZero = Math.ceil(maximumTime / duration) - 1;\n      const regularLastSegmentStart = numberIndexedToZero * duration;\n\n      // In some SegmentTemplate, we could think that there is one more\n      // segment that there actually is due to a very little difference between\n      // the period's duration and a multiple of a segment's duration.\n      // Check that we're within a good margin\n      const minimumDuration = MINIMUM_SEGMENT_SIZE * timescale;\n      if (maximumTime - regularLastSegmentStart > minimumDuration ||\n          numberIndexedToZero === 0)\n      {\n        return regularLastSegmentStart;\n      }\n      return (numberIndexedToZero - 1) * duration;\n    }\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IIndexSegment } from \"./index_helpers\";\n\n/**\n * Remove segments which starts before the given `firstAvailablePosition` from\n * the timeline. `firstAvailablePosition` has to be time scaled.\n * @param {Array.<Object>}\n * @returns {number}\n */\nexport default function clearTimelineFromPosition(\n  timeline : IIndexSegment[],\n  firstAvailablePosition : number\n) : void {\n  while (timeline.length > 0) {\n    const firstElt = timeline[0];\n    if (firstElt.start >= firstAvailablePosition) {\n      return; // all clear\n    }\n\n    if (firstElt.repeatCount <= 0) {\n      timeline.shift();\n    } else { // we have a segment repetition\n      const nextElt = timeline[1];\n      if (nextElt != null && nextElt.start <= firstAvailablePosition) {\n        timeline.shift();\n      } else { // no next segment or next segment is available\n        if (firstElt.duration <= 0) {\n          return;\n        }\n\n        let nextStart = firstElt.start + firstElt.duration;\n        let nextRepeat = 1;\n        while (nextStart < firstAvailablePosition &&\n               nextRepeat <= firstElt.repeatCount)\n        {\n          nextStart += firstElt.duration;\n          nextRepeat++;\n        }\n        if (nextRepeat > firstElt.repeatCount) { // every start is before\n          timeline.shift();\n        } else { // some repetitions start after and some before\n          const newRepeat = firstElt.repeatCount - nextRepeat;\n          firstElt.start = nextStart;\n          firstElt.repeatCount = newRepeat;\n          return;\n        }\n      }\n    }\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ISegment } from \"../../../manifest\";\nimport { IIndexSegment } from \"./index_helpers\";\n/**\n * Returns true if a Segment returned by the corresponding index is still\n * considered available.\n * Returns false if it is not available anymore.\n * Returns undefined if we cannot know whether it is still available or not.\n * /!\\ We do not check the mediaURL of the segment.\n * @param {Object} segment\n * @param {Array.<Object>} timescale\n * @param {number} timeline\n * @returns {Boolean|undefined}\n */\nexport default function isSegmentStillAvailable(\n  segment : ISegment,\n  timeline : IIndexSegment[],\n  timescale : number,\n  indexTimeOffset : number\n) : boolean | undefined {\n  if (timescale !== segment.timescale) {\n    // weird case (update?)\n    // In any case, it would be over-engineering to do time scaling here.\n    return undefined;\n  }\n\n  for (let i = 0; i < timeline.length; i++) {\n    const tSegment = timeline[i];\n    const tSegmentTime = tSegment.start - indexTimeOffset;\n    if (tSegmentTime > segment.time) {\n      return false;\n    } else if (tSegmentTime === segment.time) { // there should be only one here\n      if (tSegment.duration !== segment.duration) {\n        return false;\n      }\n      if (tSegment.range == null) {\n        return segment.range == null;\n      }\n      return segment.range != null &&\n             tSegment.range[0] === segment.range[0] &&\n             tSegment.range[1] === segment.range[1];\n    } else { // tSegment.start < segment.time\n      if (tSegment.repeatCount >= 0 && tSegment.duration != null) {\n        const timeDiff = tSegmentTime - tSegment.start;\n        const repeat = (timeDiff / tSegment.duration) - 1;\n        return repeat % 1 === 0 && repeat <= tSegment.repeatCount;\n      }\n    }\n  }\n  return false;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n ICustomError,\n NetworkError,\n} from \"../../../../errors\";\nimport log from \"../../../../log\";\nimport {\n  IRepresentationIndex,\n  ISegment,\n} from \"../../../../manifest\";\nimport clearTimelineFromPosition from \"../../utils/clear_timeline_from_position\";\nimport {\n  fromIndexTime,\n  getIndexSegmentEnd,\n  IIndexSegment,\n  toIndexTime,\n} from \"../../utils/index_helpers\";\nimport isSegmentStillAvailable from \"../../utils/is_segment_still_available\";\nimport ManifestBoundsCalculator from \"../manifest_bounds_calculator\";\nimport getInitSegment from \"./get_init_segment\";\nimport getSegmentsFromTimeline from \"./get_segments_from_timeline\";\nimport { createIndexURL } from \"./tokens\";\n\n// Index property defined for a SegmentTimeline RepresentationIndex\n// This object contains every property needed to generate an ISegment for a\n// given media time.\nexport interface ITimelineIndex {\n  indexRange?: [number, number]; // byte range for a possible index of segments\n                                 // in the server\n  indexTimeOffset : number; // Temporal offset, in the current timescale (see\n                            // timescale), to add to the presentation time\n                            // (time a segment has at decoding time) to\n                            // obtain the corresponding media time (original\n                            // time of the media segment in the index and on\n                            // the media file).\n                            // For example, to look for a segment beginning at\n                            // a second `T` on a HTMLMediaElement, we\n                            // actually will look for a segment in the index\n                            // beginning at:\n                            // ``` T * timescale + indexTimeOffset ```\n  initialization? : { // information on the initialization segment\n    mediaURL: string; // URL to access the initialization segment\n    range?: [number, number]; // possible byte range to request it\n  };\n  mediaURL : string; // base URL to access any segment. Can contain token to\n                     // replace to convert it to a real URL\n  startNumber? : number; // number from which the first segments in this index\n                         // starts with\n  timeline : IIndexSegment[]; // Every segments defined in this index\n  timescale : number; // timescale to convert a time given here into seconds.\n                      // This is done by this simple operation:\n                      // ``timeInSeconds = timeInIndex * timescale``\n}\n\n// `index` Argument for a SegmentTimeline RepresentationIndex\n// Most of the properties here are already defined in ITimelineIndex.\nexport interface ITimelineIndexIndexArgument {\n  indexRange?: [number, number];\n  initialization? : { media? : string; range?: [number, number] };\n  media? : string;\n  startNumber? : number;\n  timeline : Array<{ start? : number;\n                     repeatCount? : number;\n                     duration? : number; }>;\n  timescale : number;\n  presentationTimeOffset? : number; // Offset present in the index to convert\n                                    // from the mediaTime (time declared in the\n                                    // media segments and in this index) to the\n                                    // presentationTime (time wanted when\n                                    // decoding the segment).\n                                    // Basically by doing something along the\n                                    // line of:\n                                    // ```\n                                    // presentationTimeInSeconds =\n                                    //   mediaTimeInSeconds -\n                                    //   presentationTimeOffsetInSeconds +\n                                    //   periodStartInSeconds\n                                    // ```\n                                    // The time given here is in the current\n                                    // timescale (see timescale)\n}\n\n// Aditional argument for a SegmentTimeline RepresentationIndex\nexport interface ITimelineIndexContextArgument {\n  manifestBoundsCalculator : ManifestBoundsCalculator; // Allows to obtain the\n                                                       // minimum and maximum\n                                                       // of a content\n  periodStart : number; // Start of the period concerned by this\n                        // RepresentationIndex, in seconds\n  periodEnd : number|undefined; // End of the period concerned by this\n                                // RepresentationIndex, in seconds\n  isDynamic : boolean; // Whether the corresponding Manifest is dynamic\n  receivedTime? : number; // time (in terms of `performance.now`) at which the\n                          // XML file containing this index was received\n  representationBaseURL : string; // Base URL for the Representation concerned\n  representationId? : string; // ID of the Representation concerned\n  representationBitrate? : number; // Bitrate of the Representation concerned\n}\n\n/**\n * Translate parsed `S` node into Segment compatible with this index:\n * Find out the start, repeatCount and duration of each of these.\n *\n * @param {Object} item - parsed `S` node\n * @param {Object|null} previousItem - the previously parsed Segment (related\n * to the `S` node coming just before). If `null`, we're talking about the first\n * segment.\n * @param {Object|null} nextItem - the `S` node coming next. If `null`, we're\n * talking about the last segment.\n * @param {number} timelineStart - Absolute start for the timeline. In the same\n * timescale than the given `S` nodes.\n * @returns {Object|null}\n */\nfunction fromParsedSToIndexSegment(\n  item : { start? : number; repeatCount? : number; duration? : number },\n  previousItem : IIndexSegment|null,\n  nextItem : { start? : number; repeatCount? : number; duration? : number }|null,\n  timelineStart : number\n) : IIndexSegment|null {\n  let start = item.start;\n  let duration = item.duration;\n  const repeatCount = item.repeatCount;\n  if (start == null) {\n    if (previousItem == null) {\n      start = timelineStart;\n    } else if (previousItem.duration != null) {\n      start = previousItem.start +\n              (previousItem.duration * (previousItem.repeatCount + 1));\n    }\n  }\n  if ((duration == null || isNaN(duration)) &&\n      nextItem && nextItem.start != null && !isNaN(nextItem.start) &&\n      start != null && !isNaN(start)\n  ) {\n    duration = nextItem.start - start;\n  }\n  if ((start != null && !isNaN(start)) &&\n      (duration != null && !isNaN(duration)) &&\n      (repeatCount == null || !isNaN(repeatCount))\n  ) {\n    return { start,\n             duration,\n             repeatCount: repeatCount || 0 };\n  }\n  log.warn(\"DASH: A \\\"S\\\" Element could not have been parsed.\");\n  return null;\n}\n\n/**\n * Get index of the segment containing the given timescaled timestamp.\n * @param {Object} index\n * @param {Number} start\n * @returns {Number}\n */\nfunction getSegmentIndex(index : ITimelineIndex, start : number) : number {\n  const { timeline } = index;\n\n  let low = 0;\n  let high = timeline.length;\n\n  while (low < high) {\n    const mid = (low + high) >>> 1;\n    if (timeline[mid].start < start) {\n      low = mid + 1;\n    } else {\n      high = mid;\n    }\n  }\n\n  return (low > 0) ? low - 1 :\n                     low;\n}\n\nexport interface ILastSegmentInformation {\n  // End of the timeline on `time`, timescaled\n  lastPosition? : number;\n\n  // Defines the time at which `lastPosition` was last calculated.\n  time : number;\n}\n\nexport default class TimelineRepresentationIndex implements IRepresentationIndex {\n  protected _index : ITimelineIndex;\n\n  // time, in terms of `performance.now`, of the last Manifest update\n  private _lastUpdate : number;\n\n  // absolute start of the period, timescaled and converted to index time\n  private _scaledPeriodStart : number;\n\n  // absolute end of the period, timescaled and converted to index time\n  private _scaledPeriodEnd : number | undefined;\n\n  // Whether this RepresentationIndex can change over time.\n  private _isDynamic : boolean;\n\n  private _manifestBoundsCalculator : ManifestBoundsCalculator;\n\n  /**\n   * @param {Object} index\n   * @param {Object} context\n   */\n  constructor(\n    index : ITimelineIndexIndexArgument,\n    context : ITimelineIndexContextArgument\n  ) {\n    const { manifestBoundsCalculator,\n            isDynamic,\n            representationBaseURL,\n            representationId,\n            representationBitrate,\n            periodStart,\n            periodEnd } = context;\n    const { timescale } = index;\n\n    const presentationTimeOffset = index.presentationTimeOffset != null ?\n      index.presentationTimeOffset : 0;\n\n    const scaledStart = periodStart * timescale;\n    const indexTimeOffset = presentationTimeOffset - scaledStart;\n\n    const initialTimeline = index.timeline;\n    const timeline : IIndexSegment[] = [];\n    for (let i = 0; i < initialTimeline.length; i++) {\n      const item = initialTimeline[i];\n      const nextItem = timeline[timeline.length - 1] || null;\n      const prevItem = initialTimeline[i + 1] || null;\n      const timelineElement = fromParsedSToIndexSegment(item,\n                                                        nextItem,\n                                                        prevItem,\n                                                        scaledStart);\n      if (timelineElement) {\n        timeline.push(timelineElement);\n      }\n    }\n\n    this._manifestBoundsCalculator = manifestBoundsCalculator;\n\n    this._lastUpdate = context.receivedTime == null ?\n                                 performance.now() :\n                                 context.receivedTime;\n\n    this._isDynamic = isDynamic;\n    this._index = { indexRange: index.indexRange,\n                    indexTimeOffset,\n                    initialization: index.initialization && {\n                      mediaURL: createIndexURL(representationBaseURL,\n                                               index.initialization.media,\n                                               representationId,\n                                               representationBitrate),\n                      range: index.initialization.range,\n                    },\n                    mediaURL: createIndexURL(representationBaseURL,\n                                             index.media,\n                                             representationId,\n                                             representationBitrate),\n                    startNumber: index.startNumber,\n                    timeline,\n                    timescale };\n    this._scaledPeriodStart = toIndexTime(periodStart, this._index);\n    this._scaledPeriodEnd = periodEnd == null ? undefined :\n                                                toIndexTime(periodEnd, this._index);\n  }\n\n  /**\n   * Construct init Segment.\n   * @returns {Object}\n   */\n  getInitSegment() : ISegment {\n    return getInitSegment(this._index);\n  }\n\n  /**\n   * Asks for segments to download for a given time range.\n   * @param {Number} from - Beginning of the time wanted, in seconds\n   * @param {Number} duration - duration wanted, in seconds\n   * @returns {Array.<Object>}\n   */\n  getSegments(from : number, duration : number) : ISegment[] {\n    this._refreshTimeline(); // first clear timeline if needed\n    return getSegmentsFromTimeline(this._index,\n                                   from,\n                                   duration,\n                                   this._scaledPeriodEnd);\n  }\n\n  /**\n   * Returns true if the index should be refreshed.\n   * @param {Number} _up\n   * @param {Number} to\n   * @returns {Boolean}\n   */\n  shouldRefresh(_up : number, to : number) : boolean {\n    this._refreshTimeline();\n    if (!this._isDynamic) {\n      return false;\n    }\n    if (this._index.timeline.length === 0) {\n      return true;\n    }\n\n    const lastTimelineElt = this._index.timeline[this._index.timeline.length - 1];\n    const lastTime = getIndexSegmentEnd(lastTimelineElt,\n                                        null,\n                                        this._scaledPeriodEnd);\n    if (to * this._index.timescale < lastTime) {\n      return false;\n    }\n    const lastTheoriticalPosition = this._getTheoriticalLastPosition();\n    if (lastTheoriticalPosition == null) {\n      return true;\n    }\n    return lastTheoriticalPosition > lastTime;\n  }\n\n  /**\n   * Returns the starting time, in seconds, of the earliest segment currently\n   * available.\n   * Returns null if nothing is in the index\n   * @returns {Number|null}\n   */\n  getFirstPosition() : number|null {\n    this._refreshTimeline();\n    const index = this._index;\n    return index.timeline.length === 0 ? null :\n                                         fromIndexTime(index.timeline[0].start,\n                                                       index);\n  }\n\n  /**\n   * Returns the ending time, in seconds, of the last segment currently\n   * available.\n   * Returns null if nothing is in the index\n   * @returns {Number|null}\n   */\n  getLastPosition() : number|null {\n    this._refreshTimeline();\n    const { timeline } = this._index;\n    if (timeline.length === 0) {\n      return null;\n    }\n    const lastTimelineElement = timeline[timeline.length - 1];\n    const lastTime = getIndexSegmentEnd(lastTimelineElement,\n                                        null,\n                                        this._scaledPeriodEnd);\n    return fromIndexTime(lastTime, this._index);\n  }\n\n  /**\n   * Returns true if a Segment returned by this index is still considered\n   * available.\n   * Returns false if it is not available anymore.\n   * Returns undefined if we cannot know whether it is still available or not.\n   * @param {Object} segment\n   * @returns {Boolean|undefined}\n   */\n  isSegmentStillAvailable(segment : ISegment) : boolean | undefined {\n    if (segment.isInit) {\n      return true;\n    }\n    this._refreshTimeline();\n    const { timeline, timescale, indexTimeOffset } = this._index;\n    return isSegmentStillAvailable(segment, timeline, timescale, indexTimeOffset);\n  }\n\n  /**\n   * Checks if the time given is in a discontinuity. That is:\n   *   - We're on the upper bound of the current range (end of the range - time\n   *     is inferior to the timescale)\n   *   - The next range starts after the end of the current range.\n   * @param {Number} _time\n   * @returns {Number} - If a discontinuity is present, this is the Starting\n   * time for the next (discontinuited) range. If not this is equal to -1.\n   */\n  checkDiscontinuity(_time : number) : number {\n    this._refreshTimeline();\n    const { timeline, timescale } = this._index;\n    const scaledTime = toIndexTime(_time, this._index);\n\n    if (scaledTime <= 0) {\n      return -1;\n    }\n\n    const segmentIndex = getSegmentIndex(this._index, scaledTime);\n    if (segmentIndex < 0 || segmentIndex >= timeline.length - 1) {\n      return -1;\n    }\n\n    const timelineItem = timeline[segmentIndex];\n    if (timelineItem.duration === -1) {\n      return -1;\n    }\n\n    const nextTimelineItem = timeline[segmentIndex + 1];\n    if (nextTimelineItem == null) {\n      return -1;\n    }\n\n    const rangeUp = timelineItem.start;\n    const rangeTo = getIndexSegmentEnd(timelineItem,\n                                       nextTimelineItem,\n                                       this._scaledPeriodEnd);\n\n    // Every segments defined in range (from rangeUp to rangeTo) are\n    // explicitely contiguous.\n    // We want to check that the range end is before the next timeline item\n    // start, and that scaled time is in this discontinuity.\n    if (rangeTo < nextTimelineItem.start &&\n        scaledTime >= rangeUp &&\n        (rangeTo - scaledTime) < timescale)\n    {\n      return fromIndexTime(nextTimelineItem.start, this._index);\n    }\n\n    return -1;\n  }\n\n  /**\n   * @param {Error} error\n   * @returns {Boolean}\n   */\n  canBeOutOfSyncError(error : ICustomError) : boolean {\n    if (!this._isDynamic) {\n      return false;\n    }\n    return error instanceof NetworkError &&\n           error.isHttpError(404);\n  }\n\n  /**\n   * @param {Object} newIndex\n   */\n  _update(newIndex : TimelineRepresentationIndex) : void {\n    this._index = newIndex._index;\n    this._isDynamic = newIndex._isDynamic;\n    this._scaledPeriodStart = newIndex._scaledPeriodStart;\n    this._scaledPeriodEnd = newIndex._scaledPeriodEnd;\n    this._lastUpdate = newIndex._lastUpdate;\n    this._manifestBoundsCalculator = newIndex._manifestBoundsCalculator;\n  }\n\n  /**\n   * We do not have to add new segments to SegmentList-based indexes.\n   * @param {Array.<Object>} nextSegments\n   * @param {Object|undefined} currentSegmentInfos\n   * @returns {Array}\n   */\n  _addSegments() : void {\n    if (__DEV__) {\n      log.warn(\"Tried to add Segments to a SegmentTimeline RepresentationIndex\");\n    }\n  }\n\n  /**\n   * @returns {Boolean}\n   */\n  isFinished() : boolean {\n    if (!this._isDynamic) {\n      return true;\n    }\n    const { timeline } = this._index;\n    if (this._scaledPeriodEnd == null || timeline.length === 0) {\n      return false;\n    }\n    const lastTimelineElement = timeline[timeline.length - 1];\n    const lastTime = getIndexSegmentEnd(lastTimelineElement,\n                                        null,\n                                        this._scaledPeriodEnd);\n\n    // We can never be truly sure if a SegmentTimeline-based index is finished\n    // or not (1 / 60 for possible rounding errors)\n    return (lastTime + 1 / 60) >= this._scaledPeriodEnd;\n  }\n\n  /**\n   * Clean-up timeline to remove segment information which should not be\n   * available due to timeshifting.\n   */\n  private _refreshTimeline() : void {\n    const firstPosition = this._manifestBoundsCalculator.getMinimumBound();\n    if (firstPosition == null) {\n      return; // we don't know yet\n    }\n    const scaledFirstPosition = toIndexTime(firstPosition, this._index);\n    clearTimelineFromPosition(this._index.timeline, scaledFirstPosition);\n  }\n\n  /**\n   * Returns last position if new segments have the same duration than the\n   * current last one.\n   * @returns {number}\n   */\n  private _getTheoriticalLastPosition() : number | undefined {\n    const index = this._index;\n    if (index.timeline.length <= 0) {\n      return undefined;\n    }\n\n    const lastTimelineElement = index.timeline[index.timeline.length - 1];\n    const lastPosition = getIndexSegmentEnd(lastTimelineElement,\n                                            null,\n                                            this._scaledPeriodEnd);\n    if (!this._isDynamic) {\n      return lastPosition;\n    }\n    const lastSegmentDuration = lastTimelineElement.duration;\n    const timeDiffInSeconds = (performance.now() - this._lastUpdate) / 1000;\n    const timeDiffTS = timeDiffInSeconds * index.timescale;\n    if (timeDiffTS < lastSegmentDuration) {\n      return lastPosition;\n    }\n    const numberOfNewSegments = Math.floor(timeDiffTS / lastSegmentDuration);\n    return numberOfNewSegments * lastSegmentDuration + lastPosition;\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../../../log\";\nimport IRepresentationIndex from \"../../../manifest/representation_index\";\nimport resolveURLfrom \"../../../utils/resolve_url\";\nimport { IParsedRepresentation }from \"../types\";\nimport BaseRepresentationIndex from \"./indexes/base\";\nimport ListRepresentationIndex from \"./indexes/list\";\nimport TemplateRepresentationIndex from \"./indexes/template\";\nimport TimelineRepresentationIndex from \"./indexes/timeline\";\nimport ManifestBoundsCalculator from \"./manifest_bounds_calculator\";\nimport {\n  IAdaptationSetIntermediateRepresentation\n} from \"./node_parsers/AdaptationSet\";\nimport {\n  IRepresentationIntermediateRepresentation,\n} from \"./node_parsers/Representation\";\n\n// Supplementary context about the current AdaptationSet\nexport interface IAdaptationInfos {\n  aggressiveMode : boolean; // Whether we should request new segments even if\n                            // they are not yet finished\n  baseURL? : string; // Eventual URL from which every relative URL will be based\n                     // on\n  manifestBoundsCalculator : ManifestBoundsCalculator; // Allows to obtain the first\n                                                       // available position of a\n                                                       // dynamic content\n  end? : number; // End time of the current period, in seconds\n  isDynamic : boolean; // Whether the Manifest can evolve with time\n  receivedTime? : number; // time (in terms of `performance.now`) at which the\n                          // XML file containing this Representation was received\n  start : number; // Start time of the current period, in seconds\n  timeShiftBufferDepth? : number; // Depth of the buffer for the whole content,\n                                  // in seconds\n}\n\n// base context given to the various indexes\ninterface IIndexContext {\n  aggressiveMode : boolean; // Whether we should request new segments even if\n                            // they are not yet finished\n  manifestBoundsCalculator : ManifestBoundsCalculator; // Allows to obtain the first\n                                                       // available position of a\n                                                       // dynamic content\n  isDynamic : boolean; // Whether the Manifest can evolve with time\n  periodStart : number; // Start of the period concerned by this\n                        // RepresentationIndex, in seconds\n  periodEnd : number|undefined; // End of the period concerned by this\n                                // RepresentationIndex, in seconds\n  representationBaseURL : string; // Base URL for the Representation concerned\n  representationId? : string; // ID of the Representation concerned\n  representationBitrate? : number; // Bitrate of the Representation concerned\n  timeShiftBufferDepth? : number; // Depth of the buffer for the whole content,\n                                  // in seconds\n}\n\n/**\n * Find and parse RepresentationIndex located in an AdaptationSet node.\n * Returns a generic parsed SegmentTemplate with a single element if not found.\n * @param {Object} adaptation\n * @param {Object} context\n */\nfunction findAdaptationIndex(\n  adaptation : IAdaptationSetIntermediateRepresentation,\n  context: IIndexContext\n): IRepresentationIndex {\n  const adaptationChildren = adaptation.children;\n  let adaptationIndex : IRepresentationIndex;\n  if (adaptationChildren.segmentBase != null) {\n    const { segmentBase } = adaptationChildren;\n    adaptationIndex = new BaseRepresentationIndex(segmentBase, context);\n  } else if (adaptationChildren.segmentList != null) {\n    const { segmentList } = adaptationChildren;\n    adaptationIndex = new ListRepresentationIndex(segmentList, context);\n  } else if (adaptationChildren.segmentTemplate != null) {\n    const { segmentTemplate } = adaptationChildren;\n    adaptationIndex = segmentTemplate.indexType === \"timeline\" ?\n      new TimelineRepresentationIndex(segmentTemplate, context) :\n      new TemplateRepresentationIndex(segmentTemplate, context);\n  } else {\n    adaptationIndex = new TemplateRepresentationIndex({\n      duration: Number.MAX_VALUE,\n      timescale: 1,\n      startNumber: 0,\n      initialization: { media: \"\" },\n      media: \"\",\n    }, context);\n  }\n  return adaptationIndex;\n}\n\n/**\n * Process intermediate periods to create final parsed periods.\n * @param {Array.<Object>} periodsIR\n * @param {Object} manifestInfos\n * @returns {Array.<Object>}\n */\nexport default function parseRepresentations(\n  representationsIR : IRepresentationIntermediateRepresentation[],\n  adaptation : IAdaptationSetIntermediateRepresentation,\n  adaptationInfos : IAdaptationInfos\n): IParsedRepresentation[] {\n  return representationsIR.map((representation) => {\n    const baseURL = representation.children.baseURL;\n    const representationBaseURL = resolveURL(adaptationInfos.baseURL, baseURL);\n\n    // 4-2-1. Find Index\n    const context = { aggressiveMode: adaptationInfos.aggressiveMode,\n                      manifestBoundsCalculator: adaptationInfos.manifestBoundsCalculator,\n                      isDynamic: adaptationInfos.isDynamic,\n                      periodEnd: adaptationInfos.end,\n                      periodStart: adaptationInfos.start,\n                      receivedTime: adaptationInfos.receivedTime,\n                      representationBaseURL,\n                      representationBitrate: representation.attributes.bitrate,\n                      representationId: representation.attributes.id,\n                      timeShiftBufferDepth: adaptationInfos.timeShiftBufferDepth };\n    let representationIndex : IRepresentationIndex;\n    if (representation.children.segmentBase != null) {\n      const { segmentBase } = representation.children;\n      representationIndex = new BaseRepresentationIndex(segmentBase, context);\n    } else if (representation.children.segmentList != null) {\n      const { segmentList } = representation.children;\n      representationIndex = new ListRepresentationIndex(segmentList, context);\n    } else if (representation.children.segmentTemplate != null) {\n      const { segmentTemplate } = representation.children;\n      representationIndex = segmentTemplate.indexType === \"timeline\" ?\n        new TimelineRepresentationIndex(segmentTemplate, context) :\n        new TemplateRepresentationIndex(segmentTemplate, context);\n    } else {\n      representationIndex = findAdaptationIndex(adaptation, context);\n    }\n\n    // 4-2-2. Find bitrate\n    let representationBitrate : number;\n    if (representation.attributes.bitrate == null) {\n      log.warn(\"DASH: No usable bitrate found in the Representation.\");\n      representationBitrate = 0;\n    } else {\n      representationBitrate = representation.attributes.bitrate;\n    }\n\n    // 4-2-3. Set ID\n    const representationID = representation.attributes.id != null ?\n      representation.attributes.id :\n      (representation.attributes.bitrate +\n         (representation.attributes.height != null ?\n            (\"-\" + representation.attributes.height) :\n            \"\") +\n         (representation.attributes.width != null ?\n            (\"-\" + representation.attributes.width) :\n            \"\") +\n         (representation.attributes.mimeType != null ?\n            (\"-\" + representation.attributes.mimeType) :\n            \"\") +\n         (representation.attributes.codecs != null ?\n            (\"-\" + representation.attributes.codecs) :\n            \"\"));\n    // 4-2-4. Construct Representation Base\n    const parsedRepresentation : IParsedRepresentation =\n      { bitrate: representationBitrate,\n        index: representationIndex,\n        id: representationID };\n    // 4-2-5. Add optional attributes\n    let codecs : string|undefined;\n    if (representation.attributes.codecs != null) {\n      codecs = representation.attributes.codecs;\n    } else if (adaptation.attributes.codecs != null) {\n      codecs = adaptation.attributes.codecs;\n    }\n    if (codecs != null) {\n      codecs = codecs === \"mp4a.40.02\" ? \"mp4a.40.2\" : codecs;\n      parsedRepresentation.codecs = codecs;\n    }\n    if (representation.attributes.frameRate != null) {\n      parsedRepresentation.frameRate =\n        representation.attributes.frameRate;\n    } else if (adaptation.attributes.frameRate != null) {\n      parsedRepresentation.frameRate =\n        adaptation.attributes.frameRate;\n    }\n    if (representation.attributes.height != null) {\n      parsedRepresentation.height =\n        representation.attributes.height;\n    } else if (adaptation.attributes.height != null) {\n      parsedRepresentation.height =\n        adaptation.attributes.height;\n    }\n    if (representation.attributes.mimeType != null) {\n      parsedRepresentation.mimeType =\n        representation.attributes.mimeType;\n    } else if (adaptation.attributes.mimeType != null) {\n      parsedRepresentation.mimeType =\n        adaptation.attributes.mimeType;\n    }\n    if (representation.attributes.width != null) {\n      parsedRepresentation.width =\n        representation.attributes.width;\n    } else if (adaptation.attributes.width != null) {\n      parsedRepresentation.width =\n        adaptation.attributes.width;\n    }\n\n    if (adaptation.children.contentProtections != null) {\n      const contentProtections = adaptation.children.contentProtections\n        .reduce<Array<{ keyId : Uint8Array }>>((acc, cp) => {\n          if (cp.keyId != null) {\n            acc.push({ keyId: cp.keyId });\n          }\n          return acc;\n        }, []);\n      if (contentProtections.length > 0) {\n        parsedRepresentation.contentProtections = contentProtections;\n      }\n    }\n\n    return parsedRepresentation;\n  });\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../../../log\";\nimport arrayFind from \"../../../utils/array_find\";\nimport arrayIncludes from \"../../../utils/array_includes\";\nimport resolveURLfrom \"../../../utils/resolve_url\";\nimport {\n  IParsedAdaptation,\n  IParsedAdaptations,\n  IParsedRepresentation,\n}from \"../types\";\nimport inferAdaptationType from \"./infer_adaptation_type\";\nimport ManifestBoundsCalculator from \"./manifest_bounds_calculator\";\nimport {\n  IAdaptationSetIntermediateRepresentation,\n} from \"./node_parsers/AdaptationSet\";\nimport parseRepresentations from \"./parse_representations\";\n\n// Supplementary context about the current Period\nexport interface IPeriodInfos {\n  aggressiveMode : boolean; // Whether we should request new segments even if\n                            // they are not yet finished\n  baseURL? : string; // Eventual URL from which every relative URL will be based\n                     // on\n  manifestBoundsCalculator : ManifestBoundsCalculator; // Allows to obtain the first\n                                                       // available position of a content\n  end? : number; // End time of the current period, in seconds\n  isDynamic : boolean; // Whether the Manifest can evolve with time\n  receivedTime? : number; // time (in terms of `performance.now`) at which the\n                          // XML file containing this AdaptationSet was received\n  start : number; // Start time of the current period, in seconds\n  timeShiftBufferDepth? : number; // Depth of the buffer for the whole content,\n                                  // in seconds\n}\n\n// Supplementary information for \"switchable\" AdaptationSets of the same Period\ninterface IAdaptationSwitchingInfos  {\n  [originalID : string] : { // ID as announced in the MPD\n    newID : string; // ID in the currently parsed Manifest\n    adaptationSetSwitchingIDs : string[]; // IDs (as announced in the MPD),\n                                          // this AdaptationSet can be\n                                          // seamlessly switched to\n  };\n}\n\n/**\n * Detect if the accessibility given defines an adaptation for the visually\n * impaired.\n * Based on DVB Document A168 (DVB-DASH).\n * @param {Object} accessibility\n * @returns {Boolean}\n */\nfunction isVisuallyImpaired(\n  accessibility: { schemeIdUri? : string; value? : string }\n) : boolean {\n  if (!accessibility) {\n    return false;\n  }\n\n  return (\n    accessibility.schemeIdUri === \"urn:tva:metadata:cs:AudioPurposeCS:2007\" &&\n    accessibility.value === \"1\"\n  );\n}\n\n/**\n * Detect if the accessibility given defines an adaptation for the hard of\n * hearing.\n * Based on DVB Document A168 (DVB-DASH).\n * @param {Object} accessibility\n * @returns {Boolean}\n */\nfunction isHardOfHearing(\n  accessibility: { schemeIdUri? : string; value? : string }\n) : boolean {\n  if (!accessibility) {\n    return false;\n  }\n\n  return (\n    accessibility.schemeIdUri === \"urn:tva:metadata:cs:AudioPurposeCS:2007\" &&\n    accessibility.value === \"2\"\n  );\n}\n\n/**\n * Contruct Adaptation ID from the information we have.\n * @param {Object} adaptation\n * @param {Array.<Object>} representations\n * @param {Object} infos\n * @returns {string}\n */\nfunction getAdaptationID(\n  adaptation : IAdaptationSetIntermediateRepresentation,\n  representations : IParsedRepresentation[],\n  infos : { isClosedCaption? : boolean; isAudioDescription? : boolean; type : string }\n) : string {\n  if (adaptation.attributes.id) {\n    return adaptation.attributes.id;\n  }\n\n  let idString = infos.type;\n  if (adaptation.attributes.language) {\n    idString += `-${adaptation.attributes.language}`;\n  }\n  if (infos.isClosedCaption) {\n    idString += \"-cc\";\n  }\n  if (infos.isAudioDescription) {\n    idString += \"-ad\";\n  }\n  if (adaptation.attributes.contentType) {\n    idString += `-${adaptation.attributes.contentType}`;\n  }\n  if (adaptation.attributes.codecs) {\n    idString += `-${adaptation.attributes.codecs}`;\n  }\n  if (adaptation.attributes.mimeType) {\n    idString += `-${adaptation.attributes.mimeType}`;\n  }\n  if (adaptation.attributes.frameRate) {\n    idString += `-${adaptation.attributes.frameRate}`;\n  }\n  if (idString.length === infos.type.length) {\n    idString += representations.length ?\n      (\"-\" + representations[0].id) : \"-empty\";\n  }\n  return \"adaptation-\" + idString;\n}\n\n/**\n * Returns a list of ID this adaptation can be seamlessly switched to\n * @param {Object} adaptation\n * @returns {Array.<string>}\n */\nfunction getAdaptationSetSwitchingIDs(\n  adaptation : IAdaptationSetIntermediateRepresentation\n) : string[] {\n  if (adaptation.children.supplementalProperties != null) {\n    const { supplementalProperties } = adaptation.children;\n    for (let j = 0; j < supplementalProperties.length; j++) {\n      const supplementalProperty = supplementalProperties[j];\n      if (\n        supplementalProperty.schemeIdUri ===\n        \"urn:mpeg:dash:adaptation-set-switching:2016\" &&\n        supplementalProperty.value != null\n      ) {\n        return supplementalProperty.value.split(\",\")\n          .map(id => id.trim())\n          .filter(id => id);\n      }\n    }\n  }\n  return [];\n}\n\n/**\n * Process intermediate periods to create final parsed periods.\n * @param {Array.<Object>} periodsIR\n * @param {Object} manifestInfos\n * @returns {Array.<Object>}\n */\nexport default function parseAdaptationSets(\n  adaptationsIR : IAdaptationSetIntermediateRepresentation[],\n  periodInfos : IPeriodInfos\n): IParsedAdaptations {\n  return adaptationsIR\n    .reduce<{ adaptations : IParsedAdaptations;\n              adaptationSwitchingInfos : IAdaptationSwitchingInfos;\n              videoMainAdaptation : IParsedAdaptation|null; }>\n    ((acc, adaptation) => {\n      const adaptationChildren = adaptation.children;\n      const parsedAdaptations = acc.adaptations;\n      const representationsIR = adaptation.children.representations;\n      const adaptationInfos = {\n        aggressiveMode: periodInfos.aggressiveMode,\n        baseURL: resolveURL(periodInfos.baseURL, adaptationChildren.baseURL),\n        manifestBoundsCalculator: periodInfos.manifestBoundsCalculator,\n        end: periodInfos.end,\n        isDynamic: periodInfos.isDynamic,\n        receivedTime: periodInfos.receivedTime,\n        start: periodInfos.start,\n        timeShiftBufferDepth: periodInfos.timeShiftBufferDepth,\n      };\n      const adaptationMimeType = adaptation.attributes.mimeType;\n      const adaptationCodecs = adaptation.attributes.codecs;\n      const type = inferAdaptationType(representationsIR,\n                                       adaptationMimeType || null,\n                                       adaptationCodecs || null,\n                                       adaptationChildren.roles || null);\n      const representations = parseRepresentations(representationsIR,\n                                                   adaptation,\n                                                   adaptationInfos);\n\n      const originalID = adaptation.attributes.id;\n      let newID : string;\n      const adaptationSetSwitchingIDs = getAdaptationSetSwitchingIDs(adaptation);\n\n      // TODO remove \"main\" video track management\n      const { roles } = adaptationChildren;\n      const isMainAdaptation = !!roles &&\n        !!arrayFind(roles, (role) => role.value === \"main\") &&\n        !!arrayFind(roles, (role) => role.schemeIdUri === \"urn:mpeg:dash:role:2011\");\n      const videoMainAdaptation = acc.videoMainAdaptation;\n      if (type === \"video\" && videoMainAdaptation !== null && isMainAdaptation) {\n        videoMainAdaptation.representations.push(...representations);\n        newID = videoMainAdaptation.id;\n      } else {\n        const { accessibility } = adaptationChildren;\n        const isClosedCaption = type === \"text\" &&\n                                accessibility != null &&\n                                isHardOfHearing(accessibility) ? true :\n                                                                 undefined;\n        const isAudioDescription = type === \"audio\" &&\n                                   accessibility != null &&\n                                   isVisuallyImpaired(accessibility) ? true :\n                                                                       undefined;\n        const adaptationID = newID = getAdaptationID(adaptation,\n                                                     representations,\n                                                     { isClosedCaption,\n                                                       isAudioDescription,\n                                                       type });\n        const parsedAdaptationSet : IParsedAdaptation = { id: adaptationID,\n                                                          representations,\n                                                          type };\n        if (adaptation.attributes.language != null) {\n          parsedAdaptationSet.language = adaptation.attributes.language;\n        }\n        if (isClosedCaption != null) {\n          parsedAdaptationSet.closedCaption = isClosedCaption;\n        }\n        if (isAudioDescription != null) {\n          parsedAdaptationSet.audioDescription = isAudioDescription;\n        }\n\n        const adaptationsOfTheSameType = parsedAdaptations[type];\n        if (!adaptationsOfTheSameType) {\n          parsedAdaptations[type] = [parsedAdaptationSet];\n          if (isMainAdaptation && type === \"video\") {\n            acc.videoMainAdaptation = parsedAdaptationSet;\n          }\n        } else {\n          let mergedInto : IParsedAdaptation|null = null;\n\n          // look if we have to merge this into another Adaptation\n          for (let k = 0; k < adaptationSetSwitchingIDs.length; k++) {\n            const id : string = adaptationSetSwitchingIDs[k];\n            const switchingInfos = acc.adaptationSwitchingInfos[id];\n            if (switchingInfos != null &&\n                switchingInfos.newID !== newID &&\n                arrayIncludes(switchingInfos.adaptationSetSwitchingIDs, originalID))\n            {\n              const adaptationToMergeInto = arrayFind(adaptationsOfTheSameType,\n                                                      (a) => a.id === id);\n              if (adaptationToMergeInto != null &&\n                  adaptationToMergeInto.audioDescription ===\n                    parsedAdaptationSet.audioDescription &&\n                  adaptationToMergeInto.closedCaption ===\n                    parsedAdaptationSet.closedCaption &&\n                  adaptationToMergeInto.language === parsedAdaptationSet.language)\n              {\n                log.info(\"DASH Parser: merging \\\"switchable\\\" AdaptationSets\",\n                  originalID, id);\n                adaptationToMergeInto.representations\n                  .push(...parsedAdaptationSet.representations);\n                mergedInto = adaptationToMergeInto;\n              }\n            }\n          }\n\n          if (isMainAdaptation && type === \"video\") {\n            if (mergedInto == null) {\n              // put \"main\" adaptation as the first\n              adaptationsOfTheSameType.unshift(parsedAdaptationSet);\n              acc.videoMainAdaptation = parsedAdaptationSet;\n            } else {\n              // put the resulting adaptation first instead\n              const indexOf = adaptationsOfTheSameType.indexOf(mergedInto);\n              if (indexOf < 0) {\n                adaptationsOfTheSameType.unshift(parsedAdaptationSet);\n              } else if (indexOf !== 0) {\n                adaptationsOfTheSameType.splice(indexOf, 1);\n                adaptationsOfTheSameType.unshift(mergedInto);\n              }\n              acc.videoMainAdaptation = mergedInto;\n            }\n          } else if (mergedInto === null) {\n            adaptationsOfTheSameType.push(parsedAdaptationSet);\n          }\n        }\n      }\n\n      if (originalID != null && acc.adaptationSwitchingInfos[originalID] == null) {\n        acc.adaptationSwitchingInfos[originalID] = { newID,\n                                                     adaptationSetSwitchingIDs };\n      }\n\n      return { adaptations: parsedAdaptations,\n               adaptationSwitchingInfos: acc.adaptationSwitchingInfos,\n               videoMainAdaptation: acc.videoMainAdaptation };\n    }, { adaptations: {},\n         videoMainAdaptation: null,\n         adaptationSwitchingInfos: {} }\n    ).adaptations;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../../../log\";\nimport flatMap from \"../../../utils/flat_map\";\nimport idGenerator from \"../../../utils/id_generator\";\nimport objectValues from \"../../../utils/object_values\";\nimport resolveURLfrom \"../../../utils/resolve_url\";\nimport {\n  IParsedAdaptation,\n  IParsedAdaptations,\n  IParsedPeriod,\n}from \"../types\";\nimport flattenOverlappingPeriods from \"./flatten_overlapping_periods\";\nimport getPeriodsTimeInformation from \"./get_periods_time_infos\";\nimport ManifestBoundsCalculator from \"./manifest_bounds_calculator\";\nimport { IPeriodIntermediateRepresentation } from \"./node_parsers/Period\";\nimport parseAdaptationSets from \"./parse_adaptation_sets\";\n\nconst generatePeriodID = idGenerator();\n\n// Information about each linked Xlink.\nexport type IXLinkInfos = WeakMap<IPeriodIntermediateRepresentation, {\n  url? : string; // real URL (post-redirection) used to download this xlink\n  sendingTime? : number; // time at which the request was sent (since the time\n                         // origin), in ms\n  receivedTime? : number; // time at which the request was received (since the\n                          // time origin), in ms\n}>;\n\nexport interface IManifestInfos {\n  aggressiveMode : boolean; // Whether we should request new segments even if\n                            // they are not yet finished\n  availabilityStartTime : number; // Time from which the content starts\n  baseURL? : string;\n  clockOffset? : number;\n  duration? : number;\n  isDynamic : boolean;\n  receivedTime? : number; // time (in terms of `performance.now`) at which the\n                          // XML file containing this Period was received\n  timeShiftBufferDepth? : number; // Depth of the buffer for the whole content,\n                                  // in seconds\n  xlinkInfos : IXLinkInfos;\n}\n\n/**\n * Process intermediate periods to create final parsed periods.\n * @param {Array.<Object>} periodsIR\n * @param {Object} manifestInfos\n * @returns {Array.<Object>}\n */\nexport default function parsePeriods(\n  periodsIR : IPeriodIntermediateRepresentation[],\n  manifestInfos : IManifestInfos\n): IParsedPeriod[] {\n  const parsedPeriods : IParsedPeriod[] = [];\n  const periodsTimeInformation = getPeriodsTimeInformation(periodsIR, manifestInfos);\n  if (periodsTimeInformation.length !== periodsIR.length) {\n    throw new Error(\"MPD parsing error: the time information are incoherent.\");\n  }\n\n  // We might to communicate the depth of the Buffer while parsing\n  const { isDynamic, timeShiftBufferDepth } = manifestInfos;\n  const manifestBoundsCalculator = new ManifestBoundsCalculator({ isDynamic,\n                                                                  timeShiftBufferDepth });\n\n  if (!isDynamic && manifestInfos.duration != null) {\n    manifestBoundsCalculator.setLastPosition(manifestInfos.duration);\n  }\n\n  // We parse it in reverse because we might need to deduce the buffer depth from\n  // the last Periods' indexes\n  for (let i = periodsIR.length - 1; i >= 0; i--) {\n    const periodIR = periodsIR[i];\n    const xlinkInfos = manifestInfos.xlinkInfos.get(periodIR);\n    const periodBaseURL = resolveURL(manifestInfos.baseURL, periodIR.children.baseURL);\n\n    const { periodStart,\n            periodDuration,\n            periodEnd } = periodsTimeInformation[i];\n\n    let periodID : string;\n    if (periodIR.attributes.id == null) {\n      log.warn(\"DASH: No usable id found in the Period. Generating one.\");\n      periodID = \"gen-dash-period-\" + generatePeriodID();\n    } else {\n      periodID = periodIR.attributes.id;\n    }\n\n    const receivedTime = xlinkInfos !== undefined ? xlinkInfos.receivedTime :\n                                                    manifestInfos.receivedTime;\n    const periodInfos = { aggressiveMode: manifestInfos.aggressiveMode,\n                          baseURL: periodBaseURL,\n                          manifestBoundsCalculator,\n                          end: periodEnd,\n                          isDynamic,\n                          receivedTime,\n                          start: periodStart,\n                          timeShiftBufferDepth };\n    const adaptations = parseAdaptationSets(periodIR.children.adaptations,\n                                            periodInfos);\n    const parsedPeriod : IParsedPeriod = { id: periodID,\n                                           start: periodStart,\n                                           end: periodEnd,\n                                           duration: periodDuration,\n                                           adaptations };\n    parsedPeriods.unshift(parsedPeriod);\n\n    if (!manifestBoundsCalculator.lastPositionIsKnown()) {\n      const lastPosition = getMaximumLastPosition(adaptations);\n      if (!isDynamic) {\n        if (typeof lastPosition === \"number\") {\n          manifestBoundsCalculator.setLastPosition(lastPosition);\n        }\n      } else {\n        if (typeof lastPosition === \"number\") {\n          const positionTime = performance.now() / 1000;\n          manifestBoundsCalculator.setLastPosition(lastPosition, positionTime);\n        } else {\n          const guessedLastPositionFromClock =\n            guessLastPositionFromClock(manifestInfos, periodStart);\n          if (guessedLastPositionFromClock !== undefined) {\n            const [guessedLastPosition, guessedPositionTime] =\n              guessedLastPositionFromClock;\n            manifestBoundsCalculator.setLastPosition(\n              guessedLastPosition, guessedPositionTime);\n          }\n        }\n      }\n    }\n  }\n\n  if (manifestInfos.isDynamic && !manifestBoundsCalculator.lastPositionIsKnown()) {\n    // Guess a last time the last position\n    const guessedLastPositionFromClock = guessLastPositionFromClock(manifestInfos, 0);\n    if (guessedLastPositionFromClock !== undefined) {\n      const [lastPosition, positionTime] = guessedLastPositionFromClock;\n      manifestBoundsCalculator.setLastPosition(lastPosition, positionTime);\n    }\n  }\n  return flattenOverlappingPeriods(parsedPeriods);\n}\n\n/**\n * Try to guess the \"last position\", which is the last position\n * available in the manifest in seconds, and the \"position time\", the time\n * (`performance.now()`) in which the last position was collected.\n *\n * These values allows to retrieve at any time in the future the new last\n * position, by substracting the position time to the last position, and\n * adding to it the new value returned by `performance.now`.\n *\n * The last position and position time are returned by this function if and only if\n * it would indicate a last position superior to the `minimumTime` given.\n *\n * This last part allows for example to detect which Period is likely to be the\n * \"current\" one in multi-periods contents. By giving the Period's start as a\n * `minimumTime`, you ensure that you will get a value only if the current time\n * is in that period.\n *\n * This is useful as guessing the live time from the clock can be seen as a last\n * resort. By detecting that the current time is before the currently considered\n * Period, we can just parse and look at the previous Period. If we can guess\n * the live time more directly from that previous one, we might be better off\n * than just using the clock.\n *\n * @param {Object} manifestInfos\n * @param {number} minimumTime\n * @returns {Array.<number|undefined>}\n */\nfunction guessLastPositionFromClock(\n  manifestInfos : IManifestInfos,\n  minimumTime : number\n) : [number, number] | undefined {\n  if (manifestInfos.clockOffset != null) {\n    const lastPosition = manifestInfos.clockOffset / 1000 -\n      manifestInfos.availabilityStartTime;\n    const positionTime = performance.now() / 1000;\n    const timeInSec = positionTime + lastPosition;\n    if (timeInSec >= minimumTime) {\n      return [timeInSec, positionTime];\n    }\n  } else {\n    const now = Date.now() / 1000;\n    if (now >= minimumTime) {\n      log.warn(\"DASH Parser: no clock synchronization mechanism found.\" +\n               \" Using the system clock instead.\");\n      const lastPosition = now - manifestInfos.availabilityStartTime;\n      const positionTime = performance.now() / 1000;\n      return [lastPosition, positionTime];\n    }\n  }\n  return undefined;\n}\n\n/**\n * Try to extract the last position declared for any segments in a Period:\n *   - If at least a single index' last position is defined, take the maximum\n *     among them.\n *   - If segments are available but we cannot define the last position\n *     return undefined.\n *   - If no segment are available in that period, return null\n * @param {Object} adaptationsPerType\n * @returns {number|null|undefined}\n */\nfunction getMaximumLastPosition(\n  adaptationsPerType : IParsedAdaptations\n) : number | null | undefined {\n  let maxEncounteredPosition : number | null = null;\n  let allIndexAreEmpty = true;\n  const adaptationsVal = objectValues(adaptationsPerType)\n    .filter((ada) : ada is IParsedAdaptation[] => ada != null);\n  const allAdaptations = flatMap(adaptationsVal,\n                                 (adaptationsForType) => adaptationsForType);\n  for (let adapIndex = 0; adapIndex < allAdaptations.length; adapIndex++) {\n    const representations = allAdaptations[adapIndex].representations;\n    for (let repIndex = 0; repIndex < representations.length; repIndex++) {\n      const representation = representations[repIndex];\n      const position = representation.index.getLastPosition();\n      if (position !== null) {\n        allIndexAreEmpty = false;\n        if (typeof position === \"number\") {\n          maxEncounteredPosition =\n            maxEncounteredPosition == null ? position :\n                                             Math.max(maxEncounteredPosition,\n                                                      position);\n        }\n      }\n    }\n  }\n\n  if (maxEncounteredPosition != null) {\n    return maxEncounteredPosition;\n  } else if (allIndexAreEmpty) {\n    return null;\n  }\n  return undefined;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport arrayFind from \"../../../utils/array_find\";\nimport idGenerator from \"../../../utils/id_generator\";\nimport resolveURL, {\n  normalizeBaseURL,\n} from \"../../../utils/resolve_url\";\nimport { IParsedManifest } from \"../types\";\nimport checkManifestIDs from \"../utils/check_manifest_ids\";\nimport getClockOffset from \"./get_clock_offset\";\nimport getHTTPUTCTimingURL from \"./get_http_utc-timing_url\";\nimport getMinimumAndMaximumPosition from \"./get_minimum_and_maximum_positions\";\nimport {\n  createMPDIntermediateRepresentation,\n  IMPDIntermediateRepresentation,\n} from \"./node_parsers/MPD\";\nimport {\n  createPeriodIntermediateRepresentation,\n  IPeriodIntermediateRepresentation,\n} from \"./node_parsers/Period\";\nimport parseAvailabilityStartTime from \"./parse_availability_start_time\";\nimport parseDuration from \"./parse_duration\";\nimport parsePeriods, {\n  IXLinkInfos,\n} from \"./parse_periods\";\n\nconst generateManifestID = idGenerator();\n\nexport interface IMPDParserArguments {\n  aggressiveMode : boolean; // Whether we should request new segments even if\n                            // they are not yet finished\n  externalClockOffset? : number; // If set, offset to add to `performance.now()`\n                                 // to obtain the current server's time\n  manifestReceivedTime? : number; // Time, in terms of `performance.now` at\n                                  // which this MPD was received.\n  referenceDateTime? : number; // Default base time, in seconds\n  url? : string; // URL of the manifest (post-redirection if one)\n}\n\ninterface ILoadedResource { url? : string;\n                            sendingTime? : number;\n                            receivedTime? : number;\n                            responseData : string; }\n\nexport type IParserResponse<T> = { type : \"needs-ressources\";\n                                   value : { ressources : string[];\n                                             continue : (\n                                               loadedRessources : ILoadedResource[]\n                                             ) => IParserResponse<T>; }; } |\n                                 { type : \"done\";\n                                   value : T; };\n/**\n * @param {Element} root - The MPD root.\n * @param {Object} args\n * @returns {Object}\n */\nexport default function parseMPD(\n  root : Element,\n  args : IMPDParserArguments\n) : IParserResponse<IParsedManifest> {\n  // Transform whole MPD into a parsed JS object representation\n  const mpdIR = createMPDIntermediateRepresentation(root);\n  return loadExternalRessourcesAndParse(mpdIR, args);\n}\n\n/**\n * Checks if xlinks needs to be loaded before actually parsing the manifest.\n * @param {Object} mpdIR\n * @param {Object} args\n * @returns {Object}\n */\nfunction loadExternalRessourcesAndParse(\n  mpdIR : IMPDIntermediateRepresentation,\n  args : IMPDParserArguments,\n  hasLoadedClock? : boolean\n) : IParserResponse<IParsedManifest> {\n  const { children: rootChildren,\n          attributes: rootAttributes } = mpdIR;\n\n  const xlinkInfos : IXLinkInfos = new WeakMap();\n  if (args.externalClockOffset == null) {\n    const isDynamic : boolean = rootAttributes.type === \"dynamic\";\n\n    const directTiming = arrayFind(rootChildren.utcTimings, (utcTiming) => {\n      return utcTiming.schemeIdUri === \"urn:mpeg:dash:utc:direct:2014\" &&\n             utcTiming.value != null;\n    });\n\n    const clockOffsetFromDirectUTCTiming =\n      directTiming != null &&\n      directTiming.value != null ? getClockOffset(directTiming.value) :\n                                   undefined;\n    let clockOffset = clockOffsetFromDirectUTCTiming != null &&\n                      !isNaN(clockOffsetFromDirectUTCTiming) ?\n                        clockOffsetFromDirectUTCTiming :\n                        undefined;\n\n    if (clockOffset != null) {\n      args.externalClockOffset = clockOffset;\n    } else if (isDynamic && hasLoadedClock !== true) {\n      const UTCTimingHTTPURL = getHTTPUTCTimingURL(mpdIR);\n      if (UTCTimingHTTPURL != null && UTCTimingHTTPURL.length > 0) {\n        // TODO fetch UTCTiming and XLinks at the same time\n        return {\n          type: \"needs-ressources\",\n          value: {\n            ressources: [UTCTimingHTTPURL],\n            continue: function continueParsingMPD(loadedRessources : ILoadedResource[]) {\n              if (loadedRessources.length !== 1) {\n                throw new Error(\"DASH parser: wrong number of loaded ressources.\");\n              }\n              clockOffset = getClockOffset(loadedRessources[0].responseData);\n              args.externalClockOffset = clockOffset;\n              return loadExternalRessourcesAndParse(mpdIR, args, true);\n            },\n          },\n        };\n      }\n    }\n  }\n\n  const xlinksToLoad : Array<{ index : number; ressource : string }> = [];\n  for (let i = 0; i < rootChildren.periods.length; i++) {\n    const { xlinkHref, xlinkActuate } = rootChildren.periods[i].attributes;\n    if (xlinkHref != null && xlinkActuate === \"onLoad\") {\n      xlinksToLoad.push({ index: i, ressource: xlinkHref });\n    }\n  }\n\n  if (xlinksToLoad.length === 0) {\n    return parseCompleteIntermediateRepresentation(mpdIR, args, xlinkInfos);\n  }\n\n  return {\n    type: \"needs-ressources\",\n    value: {\n      ressources: xlinksToLoad.map(({ ressource }) => ressource),\n      continue: function continueParsingMPD(loadedRessources : ILoadedResource[]) {\n        if (loadedRessources.length !== xlinksToLoad.length) {\n          throw new Error(\"DASH parser: wrong number of loaded ressources.\");\n        }\n\n        // Note: It is important to go from the last index to the first index in\n        // the resulting array, as we will potentially add elements to the array\n        for (let i = loadedRessources.length - 1; i >= 0; i--) {\n          const index = xlinksToLoad[i].index;\n          const { responseData: xlinkData,\n                  receivedTime,\n                  sendingTime,\n                  url } = loadedRessources[i];\n          const wrappedData = \"<root>\" + xlinkData + \"</root>\";\n          const dataAsXML = new DOMParser().parseFromString(wrappedData, \"text/xml\");\n          if (!dataAsXML || dataAsXML.children.length === 0) {\n            throw new Error(\"DASH parser: Invalid external ressources\");\n          }\n          const periods = dataAsXML.children[0].children;\n          const periodsIR : IPeriodIntermediateRepresentation[] = [];\n          for (let j = 0; j < periods.length; j++) {\n            if (periods[j].nodeType === Node.ELEMENT_NODE) {\n              const periodIR = createPeriodIntermediateRepresentation(periods[j]);\n              xlinkInfos.set(periodIR, { receivedTime, sendingTime, url });\n              periodsIR.push(periodIR);\n            }\n          }\n\n          // replace original \"xlinked\" periods by the real deal\n          rootChildren.periods.splice(index, 1, ...periodsIR);\n        }\n        return loadExternalRessourcesAndParse(mpdIR, args);\n      },\n    },\n  };\n}\n\n/**\n * Parse the MPD intermediate representation into a regular Manifest.\n * @param {Object} mpdIR\n * @param {Object} args\n * @returns {Object}\n */\nfunction parseCompleteIntermediateRepresentation(\n  mpdIR : IMPDIntermediateRepresentation,\n  args : IMPDParserArguments,\n  xlinkInfos : IXLinkInfos\n) : IParserResponse<IParsedManifest> {\n  const { children: rootChildren,\n          attributes: rootAttributes } = mpdIR;\n  const isDynamic : boolean = rootAttributes.type === \"dynamic\";\n  const baseURL = resolveURL(normalizeBaseURL(args.url == null ? \"\" :\n                                                                 args.url),\n                             rootChildren.baseURL);\n  const availabilityStartTime = parseAvailabilityStartTime(rootAttributes,\n                                                           args.referenceDateTime);\n  const timeShiftBufferDepth = rootAttributes.timeShiftBufferDepth;\n  const clockOffset = args.externalClockOffset;\n\n  const manifestInfos = { aggressiveMode: args.aggressiveMode,\n                          availabilityStartTime,\n                          baseURL,\n                          clockOffset,\n                          duration: rootAttributes.duration,\n                          isDynamic,\n                          receivedTime: args.manifestReceivedTime,\n                          timeShiftBufferDepth,\n                          xlinkInfos };\n  const parsedPeriods = parsePeriods(rootChildren.periods, manifestInfos);\n  const duration = parseDuration(rootAttributes, parsedPeriods);\n  const parsedMPD : IParsedManifest = {\n    availabilityStartTime,\n    baseURL,\n    clockOffset: args.externalClockOffset,\n    duration,\n    id: rootAttributes.id != null ? rootAttributes.id :\n                                    \"gen-dash-manifest-\" + generateManifestID(),\n    isDynamic,\n    isLive: isDynamic,\n    periods: parsedPeriods,\n    suggestedPresentationDelay: rootAttributes.suggestedPresentationDelay,\n    transportType: \"dash\",\n    uris: args.url == null ?\n      rootChildren.locations : [args.url, ...rootChildren.locations],\n  };\n\n  // -- add optional fields --\n  if (rootAttributes.minimumUpdatePeriod != null\n      && rootAttributes.minimumUpdatePeriod > 0)\n  {\n    parsedMPD.lifetime = rootAttributes.minimumUpdatePeriod;\n  }\n\n  checkManifestIDs(parsedMPD);\n  const [minTime, maxTime] = getMinimumAndMaximumPosition(parsedMPD);\n  const now = performance.now();\n  if (!isDynamic) {\n    if (minTime != null) {\n      parsedMPD.minimumTime = { isContinuous: false,\n                                value: minTime,\n                                time: now };\n    }\n    if (duration != null) {\n      parsedMPD.maximumTime = { isContinuous: false,\n                                value: duration,\n                                time: now };\n    } else if (maxTime != null) {\n      parsedMPD.maximumTime = { isContinuous: false,\n                                value: maxTime,\n                                time: now };\n    }\n  } else {\n    if (minTime != null) {\n      parsedMPD.minimumTime = { isContinuous: timeShiftBufferDepth != null,\n                                value: minTime,\n                                time: now };\n    }\n    if (maxTime != null) {\n      parsedMPD.maximumTime = { isContinuous: true,\n                                value: maxTime,\n                                time: now };\n      if (minTime == null) {\n        parsedMPD.minimumTime = { isContinuous: true,\n                                  value: maxTime,\n                                  time: now };\n      }\n    }\n  }\n\n  return { type: \"done\", value: parsedMPD };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IParsedManifest } from \"../types\";\nimport parseMPD, {\n  IMPDParserArguments,\n  IParserResponse,\n} from \"./parse_mpd\";\n\nexport type IMPDParserResponse = IParserResponse<IParsedManifest>;\n\n/**\n * @param {Document} manifest - Original manifest as returned by the server\n * @param {Object} args\n * @returns {Object} - parsed manifest\n */\nexport default function parseFromDocument(\n  document: Document,\n  args : IMPDParserArguments\n) : IMPDParserResponse {\n  const root = document.documentElement;\n  if (!root || root.nodeName !== \"MPD\") {\n    throw new Error(\"DASH Parser: document root should be MPD\");\n  }\n  return parseMPD(root, args);\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport parseFromDocument, {\n  IMPDParserResponse,\n} from \"./parse_from_document\";\n\nexport default parseFromDocument;\nexport {\n  IMPDParserResponse,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport objectAssign from \"object-assign\";\nimport {\n  combineLatest as observableCombineLatest,\n  Observable,\n  of as observableOf,\n} from \"rxjs\";\nimport {\n  filter,\n  map,\n  mergeMap,\n} from \"rxjs/operators\";\nimport Manifest from \"../../manifest\";\nimport dashManifestParser, {\n  IMPDParserResponse,\n} from \"../../parsers/manifest/dash\";\nimport request from \"../../utils/request\";\nimport {\n  ILoaderDataLoadedValue,\n  IManifestParserArguments,\n  IManifestParserObservable,\n  ITransportOptions,\n} from \"../types\";\n\n/**\n * Request external \"xlink\" ressource from a MPD.\n * @param {string} xlinkURL\n * @returns {Observable}\n */\nfunction requestStringResource(\n  url : string\n) : Observable< ILoaderDataLoadedValue< string > > {\n  return request({ url,\n                   responseType: \"text\" })\n  .pipe(\n    filter((e) => e.type === \"data-loaded\"),\n    map((e) => e.value)\n  );\n}\n\n/**\n * @param {Object} options\n * @returns {Function}\n */\nexport default function generateManifestParser(\n  options : ITransportOptions\n) : (x : IManifestParserArguments) => IManifestParserObservable {\n  const { aggressiveMode: _aggressiveMode,\n          lowLatencyMode,\n          referenceDateTime } = options;\n  const aggressiveMode = lowLatencyMode ? _aggressiveMode !== false :\n                                          _aggressiveMode === true;\n  const serverTimeOffset = options.serverSyncInfos != null ?\n    options.serverSyncInfos.serverTimestamp - options.serverSyncInfos.clientTime :\n    undefined;\n  return function manifestParser(\n    args : IManifestParserArguments\n  ) : IManifestParserObservable {\n    const { response, scheduleRequest } = args;\n    const argClockOffset = args.externalClockOffset;\n    const loaderURL = args.url;\n    const url = response.url == null ? loaderURL :\n                                       response.url;\n    const data = typeof response.responseData === \"string\" ?\n                   new DOMParser().parseFromString(response.responseData,\n                                                   \"text/xml\") :\n                   // TODO find a way to check if Document?\n                   response.responseData as Document;\n\n    const externalClockOffset = serverTimeOffset == null ? argClockOffset :\n                                                           serverTimeOffset;\n    const parsedManifest = dashManifestParser(data, { aggressiveMode,\n                                                      url,\n                                                      referenceDateTime,\n                                                      externalClockOffset });\n    return loadExternalResources(parsedManifest);\n\n    function loadExternalResources(\n      parserResponse : IMPDParserResponse\n    ) : IManifestParserObservable {\n      if (parserResponse.type === \"done\") {\n        const manifest = new Manifest(parserResponse.value, options);\n        return observableOf({ manifest, url });\n      }\n\n      const { ressources, continue: continueParsing } = parserResponse.value;\n\n      const externalResources$ = ressources\n        .map(resource => scheduleRequest(() => requestStringResource(resource)));\n\n      return observableCombineLatest(externalResources$)\n        .pipe(mergeMap(loadedResources => {\n          const resources : Array<ILoaderDataLoadedValue<string>> = [];\n          for (let i = 0; i < loadedResources.length; i++) {\n            const resource = loadedResources[i];\n            if (typeof resource.responseData !== \"string\") {\n              throw new Error(\"External DASH resources should only be strings\");\n            }\n            // Normally not needed but TypeScript is just dumb here\n            resources.push(objectAssign(resource,\n                                        { responseData: resource.responseData }));\n          }\n          return loadExternalResources(continueParsing(resources));\n        }));\n    }\n  };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Returns text-formatted byteRange (`bytes=$start-$end?)`\n * @param {Array.<string|Number>} arr\n * @returns {string}\n */\nexport default function byteRange([start, end] : [number, number]) : string {\n  return end === Infinity ?  \"bytes=\" + (+start) + \"-\" :\n                             \"bytes=\" + (+start) + \"-\" + (+end);\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { be4toi } from \"../../utils/byte_parsing\";\n\n/**\n * Find the offset for the first declaration of the given box in an isobmff.\n * Returns -1 if not found or if incomplete.\n *\n * This function does not throw or log in case of partial segments.\n * @param {Uint8Array} buf - the isobmff\n * @param {Number} wantedName\n * @returns {Number} - Offset where the box begins. -1 if not found.\n */\nexport default function findCompleteBox(\n  buf : Uint8Array,\n  wantedName : number\n) : number {\n  const len = buf.length;\n  let i = 0;\n  while (i + 8 < len) {\n    const size = be4toi(buf, i);\n    if (size <= 0) {\n      return -1;\n    }\n\n    const name = be4toi(buf, i + 4);\n    if (name === wantedName) {\n      if (i + size <= len) {\n        return i;\n      }\n      return -1;\n    }\n    i += size;\n  }\n  return -1;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { OtherError } from \"../../errors\";\nimport findCompleteBox from \"./find_complete_box\";\n\n/**\n * @param {Uint8Array} buffer\n * @param {boolean} isInit\n * @returns {Array}\n */\nexport default function checkISOBMFFIntegrity(\n  buffer : Uint8Array,\n  isInit : boolean\n) : void {\n  if (isInit) {\n    const ftypIndex = findCompleteBox(buffer, 0x66747970 /* ftyp */);\n    if (ftypIndex < 0) {\n      throw new OtherError(\"INTEGRITY_ERROR\", \"Incomplete `ftyp` box\");\n    }\n    const moovIndex = findCompleteBox(buffer, 0x6d6f6f76 /* moov */);\n    if (moovIndex < 0) {\n      throw new OtherError(\"INTEGRITY_ERROR\", \"Incomplete `moov` box\");\n    }\n  } else {\n    const moofIndex = findCompleteBox(buffer, 0x6d6f6f66 /* moof */);\n    if (moofIndex < 0) {\n      throw new OtherError(\"INTEGRITY_ERROR\", \"Incomplete `moof` box\");\n    }\n    const mdatIndex = findCompleteBox(buffer, 0x6d646174 /* mdat */);\n    if (mdatIndex < 0) {\n      throw new OtherError(\"INTEGRITY_ERROR\", \"Incomplete `mdat` box\");\n    }\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Representation } from \"../../manifest\";\n\n/**\n * @param {Object} representation\n * @returns {boolean}\n */\nexport default function isWEBMEmbeddedTrack(\n  representation : Representation\n) : boolean {\n  return representation.mimeType === \"video/webm\" ||\n         representation.mimeType === \"audio/webm\";\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { combineLatest as observableCombineLatest } from \"rxjs\";\nimport { map } from \"rxjs/operators\";\nimport { concat } from \"../../utils/byte_parsing\";\nimport xhr from \"../../utils/request\";\nimport {\n  ISegmentLoaderArguments,\n  ISegmentLoaderObservable,\n} from \"../types\";\nimport byteRange from \"../utils/byte_range\";\n\n/**\n * Perform a request for an initialization segment, agnostic to the container.\n * @param {string} url\n * @param {Object} content\n */\nexport default function initSegmentLoader(\n  url : string,\n  { segment } : ISegmentLoaderArguments\n) : ISegmentLoaderObservable<ArrayBuffer> {\n  if (segment.range == null) {\n    return xhr({ url, responseType: \"arraybuffer\", sendProgressEvents: true });\n  }\n\n  if (segment.indexRange == null) {\n    return xhr({ url,\n                 headers: { Range: byteRange(segment.range) },\n                 responseType: \"arraybuffer\",\n                 sendProgressEvents: true });\n  }\n\n  // range and indexRange are contiguous (99% of the cases)\n  if (segment.range[1] + 1 === segment.indexRange[0]) {\n    return xhr({ url,\n                 headers: { Range: byteRange([segment.range[0],\n                                              segment.indexRange[1] ]) },\n                 responseType: \"arraybuffer\",\n                 sendProgressEvents: true });\n  }\n\n  const rangeRequest$ = xhr({ url,\n                              headers: { Range: byteRange(segment.range) },\n                              responseType: \"arraybuffer\",\n                              sendProgressEvents: false });\n  const indexRequest$ = xhr({ url,\n                              headers: { Range: byteRange(segment.indexRange) },\n                              responseType: \"arraybuffer\",\n                              sendProgressEvents: false });\n  return observableCombineLatest([rangeRequest$, indexRequest$])\n    .pipe(map(([initData, indexData]) => {\n      const data = concat(new Uint8Array(initData.value.responseData),\n                          new Uint8Array(indexData.value.responseData));\n\n      const sendingTime = Math.min(initData.value.sendingTime,\n                                   indexData.value.sendingTime);\n      const receivedTime = Math.max(initData.value.receivedTime,\n                                    indexData.value.receivedTime);\n      return { type: \"data-loaded\",\n               value: { url,\n                        responseData: data,\n                        size: initData.value.size + indexData.value.size,\n                        duration: receivedTime - sendingTime,\n                        sendingTime,\n                        receivedTime } };\n    }));\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { be4toi } from \"../../utils/byte_parsing\";\nimport findCompleteBox from \"../utils/find_complete_box\";\n\n/**\n * Take a chunk of ISOBMFF data and extract complete `moof`+`mdat` subsegments\n * which are ready to be decoded.\n * Returns a tuple of two containing first an array of those subsegments\n * followed by tha last un-decodable part.\n * @param {Uint8Array} buffer\n * @returns {Array}\n */\nexport default function extractCompleteChunks(\n  buffer: Uint8Array\n) : [Uint8Array[], Uint8Array | null] {\n  let _position = 0;\n  const chunks : Uint8Array[] = [];\n  while (_position < buffer.length) {\n    const currentBuffer = buffer.subarray(_position, Infinity);\n    const moofIndex = findCompleteBox(currentBuffer, 0x6d6f6f66 /* moof */);\n    if (moofIndex < 0) {\n      // no moof, not a segment.\n      return [ chunks, currentBuffer ];\n    }\n    const moofLen = be4toi(buffer, moofIndex + _position);\n    const moofEnd = _position + moofIndex + moofLen;\n    if (moofEnd > buffer.length) {\n      // not a complete moof segment\n      return [ chunks, currentBuffer ];\n    }\n\n    const mdatIndex = findCompleteBox(currentBuffer, 0x6d646174 /* mdat */);\n    if (mdatIndex < 0) {\n      // no mdat, not a segment.\n      return [ chunks, currentBuffer ];\n    }\n    const mdatLen = be4toi(buffer, mdatIndex + _position);\n    const mdatEnd = _position + mdatIndex + mdatLen;\n    if (mdatEnd > buffer.length) {\n      // not a complete mdat segment\n      return [ chunks, currentBuffer ];\n    }\n\n    const maxEnd = Math.max(moofEnd, mdatEnd);\n    const chunk = buffer.subarray(_position, maxEnd);\n    chunks.push(chunk);\n\n    _position = maxEnd;\n  }\n  return [ chunks, null ];\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { of as observableOf } from \"rxjs\";\nimport {\n  mergeMap,\n  scan,\n} from \"rxjs/operators\";\nimport log from \"../../log\";\nimport { concat } from \"../../utils/byte_parsing\";\nimport fetchRequest, {\n  IDataChunk,\n  IDataComplete,\n} from \"../../utils/request/fetch\";\nimport {\n  ILoaderChunkedDataEvent,\n  ISegmentLoaderArguments,\n  ISegmentLoaderObservable,\n} from \"../types\";\nimport byteRange from \"../utils/byte_range\";\nimport extractCompleteChunks from \"./extract_complete_chunks\";\n\nexport default function lowLatencySegmentLoader(\n  url : string,\n  args : ISegmentLoaderArguments\n) : ISegmentLoaderObservable<ArrayBuffer> {\n  // Items emitted after processing fetch events\n  interface IScannedChunk {\n    event: IDataChunk | IDataComplete | null; // Event received from fetch\n    completeChunks: Uint8Array[]; // Complete chunks received on the event\n    partialChunk: Uint8Array | null; // Remaining incomplete chunk received on the event\n  }\n\n  const { segment } = args;\n  const headers = segment.range != null ? { Range: byteRange(segment.range) } :\n                                          undefined;\n\n  return fetchRequest({ url, headers })\n    .pipe(\n      scan<IDataChunk | IDataComplete, IScannedChunk>((acc, evt) => {\n        if (evt.type === \"data-complete\") {\n          if (acc.partialChunk != null) {\n            log.warn(\"DASH Pipelines: remaining chunk does not belong to any segment\");\n          }\n          return { event: evt, completeChunks: [], partialChunk: null };\n        }\n\n        const data = new Uint8Array(evt.value.chunk);\n        const concatenated = acc.partialChunk != null ? concat(acc.partialChunk,\n                                                               data) :\n                                                        data;\n        const [ completeChunks,\n                partialChunk ] = extractCompleteChunks(concatenated);\n        return { event: evt, completeChunks, partialChunk };\n      }, { event: null, completeChunks: [], partialChunk: null }),\n\n      mergeMap((evt : IScannedChunk) => {\n        const emitted : ILoaderChunkedDataEvent[] = [];\n        for (let i = 0; i < evt.completeChunks.length; i++) {\n          emitted.push({ type: \"data-chunk\",\n                         value: { responseData: evt.completeChunks[i] } });\n        }\n        const { event } = evt;\n        if (event != null && event.type === \"data-chunk\") {\n          const { value } = event;\n          emitted.push({ type: \"progress\",\n                         value: { duration: value.duration,\n                                  size: value.size,\n                                  url: value.url,\n                                  totalSize: value.totalSize } });\n        } else if (event != null && event.type === \"data-complete\") {\n          const { value } = event;\n          emitted.push({ type: \"data-chunk-complete\",\n                         value: { duration: value.duration,\n                                  receivedTime: value.receivedTime,\n                                  sendingTime: value.sendingTime,\n                                  size: value.size,\n                                  status: value.status,\n                                  url: value.url } });\n        }\n        return observableOf(...emitted);\n      }));\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Observable,\n  Observer,\n  of as observableOf,\n} from \"rxjs\";\nimport { tap } from \"rxjs/operators\";\nimport xhr, {\n  fetchIsSupported,\n} from \"../../utils/request\";\nimport warnOnce from \"../../utils/warn_once\";\nimport {\n  CustomSegmentLoader,\n  ILoaderRegularDataEvent,\n  ISegmentLoaderArguments,\n  ISegmentLoaderObservable,\n} from \"../types\";\nimport byteRange from \"../utils/byte_range\";\nimport checkISOBMFFIntegrity from \"../utils/check_isobmff_integrity\";\nimport isWEBMEmbeddedTrack from \"../utils/is_webm_embedded_track\";\nimport initSegmentLoader from \"./init_segment_loader\";\nimport lowLatencySegmentLoader from \"./low_latency_segment_loader\";\n\ntype ICustomSegmentLoaderObserver =\n  Observer<ILoaderRegularDataEvent<Uint8Array|ArrayBuffer>>;\n\n/**\n * Segment loader triggered if there was no custom-defined one in the API.\n * @param {Object} opt\n * @returns {Observable}\n */\nfunction regularSegmentLoader(\n  url : string,\n  args : ISegmentLoaderArguments,\n  lowLatencyMode : boolean\n) : ISegmentLoaderObservable<ArrayBuffer> {\n\n  if (args.segment.isInit) {\n    return initSegmentLoader(url, args);\n  }\n\n  const isWEBM = isWEBMEmbeddedTrack(args.representation);\n  if (lowLatencyMode && !isWEBM) {\n    if (fetchIsSupported()) {\n      return lowLatencySegmentLoader(url, args);\n    } else {\n      warnOnce(\"DASH: Your browser does not have the fetch API. You will have \" +\n               \"a higher chance of rebuffering when playing close to the live edge\");\n    }\n  }\n\n  const { segment } = args;\n  return xhr({ url,\n               responseType: \"arraybuffer\",\n               sendProgressEvents: true,\n               headers: segment.range != null ? { Range: byteRange(segment.range) } :\n                                                undefined });\n}\n\n/**\n * Generate a segment loader:\n *   - call a custom SegmentLoader if defined\n *   - call the regular loader if not\n * @param {boolean} lowLatencyMode\n * @param {Function} [customSegmentLoader]\n * @returns {Function}\n */\nexport default function generateSegmentLoader(\n  { lowLatencyMode,\n    segmentLoader: customSegmentLoader,\n    checkMediaSegmentIntegrity } : { lowLatencyMode: boolean;\n                                     segmentLoader? : CustomSegmentLoader;\n                                     checkMediaSegmentIntegrity? : boolean; }\n) : (x : ISegmentLoaderArguments) => ISegmentLoaderObservable< Uint8Array |\n                                                               ArrayBuffer |\n                                                               null > {\n  if (checkMediaSegmentIntegrity !== true) {\n    return segmentLoader;\n  }\n  return (content) => segmentLoader(content).pipe(tap(res => {\n    if ((res.type === \"data-loaded\" || res.type === \"data-chunk\") &&\n        res.value.responseData !== null)\n    {\n      checkISOBMFFIntegrity(new Uint8Array(res.value.responseData),\n                            content.segment.isInit);\n    }\n  }));\n\n  /**\n   * @param {Object} content\n   * @returns {Observable}\n   */\n  function segmentLoader(\n    content : ISegmentLoaderArguments\n  ) : ISegmentLoaderObservable< Uint8Array | ArrayBuffer | null > {\n    const { mediaURL } = content.segment;\n    if (mediaURL == null) {\n      return observableOf({ type: \"data-created\" as const,\n                            value: { responseData: null } });\n    }\n\n    if (lowLatencyMode || customSegmentLoader == null) {\n      return regularSegmentLoader(mediaURL, content, lowLatencyMode);\n    }\n\n    const args = { adaptation: content.adaptation,\n                   manifest: content.manifest,\n                   period: content.period,\n                   representation: content.representation,\n                   segment: content.segment,\n                   transport: \"dash\",\n                   url: mediaURL };\n\n    return new Observable((obs : ICustomSegmentLoaderObserver) => {\n      let hasFinished = false;\n      let hasFallbacked = false;\n\n      /**\n       * Callback triggered when the custom segment loader has a response.\n       * @param {Object} args\n       */\n      const resolve = (_args : {\n        data : ArrayBuffer|Uint8Array;\n        size? : number;\n        duration? : number;\n      }) => {\n        if (!hasFallbacked) {\n          hasFinished = true;\n          obs.next({ type: \"data-loaded\" as const,\n                     value: { responseData: _args.data,\n                              size: _args.size,\n                              duration: _args.duration } });\n          obs.complete();\n        }\n      };\n\n      /**\n       * Callback triggered when the custom segment loader fails\n       * @param {*} err - The corresponding error encountered\n       */\n      const reject = (err = {}) : void => {\n        if (!hasFallbacked) {\n          hasFinished = true;\n          obs.error(err);\n        }\n      };\n\n      /**\n       * Callback triggered when the custom segment loader wants to fallback to\n       * the \"regular\" implementation\n       */\n      const fallback = () => {\n        hasFallbacked = true;\n        const regular$ = regularSegmentLoader(mediaURL, content, lowLatencyMode);\n\n        // HACK What is TypeScript/RxJS doing here??????\n        /* tslint:disable deprecation */\n        // @ts-ignore\n        regular$.subscribe(obs);\n        /* tslint:enable deprecation */\n      };\n\n      const callbacks = { reject, resolve, fallback };\n      const abort = customSegmentLoader(args, callbacks);\n\n      return () => {\n        if (!hasFinished && !hasFallbacked && typeof abort === \"function\") {\n          abort();\n        }\n      };\n    });\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  concat,\n  itobe4,\n  strToBytes,\n} from \"../../../utils/byte_parsing\";\n\n/**\n * Speed up string to bytes conversion by memorizing the result\n *\n * The keys here are ISOBMFF box names. The values are the corresponding\n * bytes conversion for putting as an ISOBMFF boxes.\n *\n * Used by the boxName method.\n * @type {Object}\n */\nconst boxNamesMem : { [boxName: string]: Uint8Array } = {};\n\n/**\n * Convert the string name of an ISOBMFF box into the corresponding bytes.\n * Has a memorization mechanism to speed-up if you want to translate the\n * same string multiple times.\n * @param {string} str\n * @returns {Uint8Array}\n */\nfunction boxName(str : string) : Uint8Array {\n  if (boxNamesMem[str]) {\n    return boxNamesMem[str];\n  }\n\n  const nameInBytes = strToBytes(str);\n  boxNamesMem[str] = nameInBytes;\n  return nameInBytes;\n}\n\n/**\n * Create a new ISOBMFF \"box\" with the given name.\n * @param {string} name - name of the box you want to create, must always\n * be 4 characters (uuid boxes not supported)\n * @param {Uint8Array} buff - content of the box\n * @returns {Uint8Array} - The entire ISOBMFF box (length+name+content)\n */\nfunction createBox(name : string, buff : Uint8Array) : Uint8Array {\n  const len = buff.length + 8;\n  return concat(itobe4(len), boxName(name), buff);\n}\n\n/**\n * @param {string} name\n * @param {Array.<Uint8Array>} children\n * @returns {Uint8Array}\n */\nfunction createBoxWithChildren(\n  name : string,\n  children : Uint8Array[]\n) : Uint8Array {\n  return createBox(name, concat(...children));\n}\n\nexport {\n  createBox,\n  createBoxWithChildren,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { be4toi } from \"../../../utils/byte_parsing\";\n\n/**\n * Returns the content of a box based on its name.\n * `null` if not found.\n * /!\\ does not work with UUID boxes\n * @param {Uint8Array} buf - the isobmff structure\n * @param {Number} boxName - the 4-letter 'name' of the box (e.g. 'sidx' or\n * 'moov'), hexa encoded\n * @returns {UInt8Array|null}\n */\nfunction getBoxContent(buf : Uint8Array, boxName : number) : Uint8Array|null {\n  const offsets = getBoxOffsets(buf, boxName);\n  return offsets != null ? buf.subarray(offsets[0] + 8, offsets[1]) : null;\n}\n\n/**\n * Returns an ISOBMFF box based on its name.\n * `null` if not found.\n * /!\\ does not work with UUID boxes\n * @param {Uint8Array} buf - the isobmff structure\n * @param {Number} boxName - the 4-letter 'name' of the box (e.g. 'sidx' or\n * 'moov'), hexa encoded\n * @returns {UInt8Array|null}\n */\nfunction getBox(buf : Uint8Array, boxName : number) : Uint8Array|null {\n  const offsets = getBoxOffsets(buf, boxName);\n  return offsets != null ? buf.subarray(offsets[0], offsets[1]) : null;\n}\n\n/**\n * Returns start and end offset for a given box.\n * `null` if not found.\n * /!\\ does not work with UUID boxes\n * @param {Uint8Array} buf - the isobmff structure\n * @param {Number} boxName - the 4-letter 'name' of the box (e.g. 'sidx' or\n * 'moov'), hexa encoded\n * @returns {Array.<number>|null}\n */\nfunction getBoxOffsets(buf : Uint8Array, boxName : number) : [number, number]|null {\n  const l = buf.length;\n  let i = 0;\n\n  let name : number;\n  let size : number = 0;\n  while (i + 8 < l) {\n    size = be4toi(buf, i);\n    name = be4toi(buf, i + 4);\n    if (size <= 0) {\n      throw new Error(\"ISOBMFF: Size out of range\");\n    }\n    if (name === boxName) {\n      break;\n    } else {\n      i += size;\n    }\n  }\n\n  if (i < l) {\n    return [i, i + size];\n  } else {\n    return null;\n  }\n}\n\n/**\n * Gives the content of a specific UUID with its attached ID\n * @param {Uint8Array} buf\n * @param {Number} id1\n * @param {Number} id2\n * @param {Number} id3\n * @param {Number} id4\n * @returns {Uint8Array|undefined}\n */\nfunction getUuidContent(\n  buf : Uint8Array,\n  id1 : number,\n  id2 : number,\n  id3 : number,\n  id4 : number\n) : Uint8Array|undefined {\n  let len : number;\n  const l = buf.length;\n  for (let i = 0; i < l; i += len) {\n    len = be4toi(buf, i);\n    if (\n      be4toi(buf, i +  4) === 0x75756964 /* === \"uuid\" */ &&\n      be4toi(buf, i +  8) === id1 &&\n      be4toi(buf, i + 12) === id2 &&\n      be4toi(buf, i + 16) === id3 &&\n      be4toi(buf, i + 20) === id4\n    ) {\n      return buf.subarray(i + 24, i + len);\n    }\n  }\n}\n\nexport {\n  getBox,\n  getBoxContent,\n  getBoxOffsets,\n  getUuidContent,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getBoxContent } from \"./get_box\";\n\n/**\n * Returns TRAF Box from the whole ISOBMFF File.\n * Returns null if not found.\n * @param {Uint8Array} buffer\n * @returns {Uint8Array|null}\n */\nfunction getTRAF(buffer : Uint8Array) : Uint8Array|null {\n  const moof = getBoxContent(buffer, 0x6d6f6f66 /* moof */);\n  if (!moof) {\n    return null;\n  }\n  return getBoxContent(moof, 0x74726166 /* traf */);\n}\n\n/**\n * Returns MDAT Box from the whole ISOBMFF File.\n * Returns null if not found.\n * @param {Uint8Array} buffer\n * @returns {Uint8Array|null}\n */\nfunction getMDAT(buf : Uint8Array) : Uint8Array|null {\n  return getBoxContent(buf, 0x6D646174 /* \"mdat\" */);\n}\n\n/**\n * Returns MDIA Box from the whole ISOBMFF File.\n * Returns null if not found.\n * @param {Uint8Array} buffer\n * @returns {Uint8Array|null}\n */\nfunction getMDIA(buf : Uint8Array) : Uint8Array|null {\n  const moov = getBoxContent(buf, 0x6d6f6f76 /* moov */);\n  if (!moov) {\n    return null;\n  }\n\n  const trak = getBoxContent(moov, 0x7472616b /* \"trak\" */);\n  if (!trak) {\n    return null;\n  }\n\n  return getBoxContent(trak, 0x6d646961 /* \"mdia\" */);\n}\n\nexport {\n  getTRAF,\n  getMDAT,\n  getMDIA,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n    bytesToUTF16Str,\n    guidToUuid,\n    le2toi,\n} from \"../../../../utils/byte_parsing\";\n\n/**\n * Parse PlayReady privateData to get its Hexa-coded KeyID.\n * @param {Uint8Array} privateData\n * @returns {string}\n */\nexport function getPlayReadyKIDFromPrivateData(\n  data: Uint8Array\n) : string {\n  const xmlLength = le2toi(data, 8);\n  const xml = bytesToUTF16Str(data.subarray(10, xmlLength + 10));\n  const doc = new DOMParser().parseFromString(xml, \"application/xml\");\n  const kidElement = doc.querySelector(\"KID\");\n  if (!kidElement) {\n    throw new Error(\"Cannot parse PlayReady private data: invalid XML\");\n  }\n  const kid = kidElement.textContent || \"\";\n  return guidToUuid(atob(kid)).toLowerCase();\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport { getPlayReadyKIDFromPrivateData } from \"./playready\";\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../../../log\";\nimport assert from \"../../../utils/assert\";\nimport {\n  be2toi,\n  be3toi,\n  be4toi,\n  be8toi,\n  concat,\n  hexToBytes,\n  itobe4,\n} from \"../../../utils/byte_parsing\";\nimport { createBox } from \"./create_box\";\nimport { getPlayReadyKIDFromPrivateData } from \"./drm\";\nimport {\n  getMDIA,\n  getTRAF,\n} from \"./read\";\n\ninterface IISOBMFFKeySystem {\n  systemId : string;\n  privateData : Uint8Array;\n}\n\n/**\n * Find the offset for the first declaration of the given box in an isobmff.\n * Returns -1 if not found.\n *\n * This function calls log.error in case of partial segments.\n * @param {Uint8Array} buf - the isobmff\n * @param {Number} wantedName\n * @returns {Number} - Offset where the box begins. -1 if not found.\n */\nfunction findBox(buf : Uint8Array, wantedName : number) : number {\n  const len = buf.length;\n  let i = 0;\n  while (i + 8 < len) {\n    const size = be4toi(buf, i);\n    if (size <= 0) {\n      log.error(\"ISOBMFF: size out of range\");\n      return -1;\n    }\n\n    const name = be4toi(buf, i + 4);\n    if (name === wantedName) {\n      if (i + size <= len) {\n        return i;\n      }\n      log.error(\"ISOBMFF: box out of range\");\n      return -1;\n    }\n\n    i += size;\n  }\n  return -1;\n}\n\n// Segment information returned from a parsed sidx\nexport interface ISidxSegment {\n  time : number;\n  duration : number;\n  count : 0;\n  timescale : number;\n  range : [number, number];\n}\n\n/**\n * Parse the sidx part (segment index) of the isobmff.\n * Returns null if not found.\n *\n * @param {Uint8Array} buf\n * @param {Number} initialOffset\n * @returns {Object|null} {Array.<Object>} - Information about each subsegment.\n * Contains those keys:\n *   - time {Number}: starting _presentation time_ for the subsegment,\n *     timescaled\n *   - duration {Number}: duration of the subsegment, timescaled\n *   - timescale {Number}: the timescale in which the time and duration are set\n *   - count {Number}: always at 0\n *   - range {Array.<Number>}: first and last bytes in the media file\n *     from the anchor point (first byte after the sidx box) for the\n *     concerned subsegment.\n */\nfunction getSegmentsFromSidx(\n  buf : Uint8Array,\n  initialOffset : number\n) : ISidxSegment[]|null {\n  const index = findBox(buf, 0x73696478 /* \"sidx\" */);\n  if (index === -1) {\n    return null;\n  }\n  let offset = initialOffset;\n\n  const size = be4toi(buf, index);\n  let pos = index + /* size */4 + /* name */4;\n\n  /* version(8) */\n  /* flags(24) */\n  /* reference_ID(32); */\n  /* timescale(32); */\n  const version = buf[pos]; pos += 4 + 4;\n  const timescale = be4toi(buf, pos); pos += 4;\n\n  /* earliest_presentation_time(32 / 64) */\n  /* first_offset(32 / 64) */\n  let time;\n  if (version === 0) {\n    time    = be4toi(buf, pos);        pos += 4;\n    offset += be4toi(buf, pos) + size; pos += 4;\n  }\n  else if (version === 1) {\n    time    = be8toi(buf, pos);        pos += 8;\n    offset += be8toi(buf, pos) + size; pos += 8;\n  }\n  else {\n    return null;\n  }\n\n  const segments : ISidxSegment[] = [];\n\n  /* reserved(16) */\n  /* reference_count(16) */\n  pos += 2;\n  let count = be2toi(buf, pos);\n  pos += 2;\n  while (--count >= 0) {\n    /* reference_type(1) */\n    /* reference_size(31) */\n    /* segment_duration(32) */\n    /* sap..(32) */\n    const refChunk = be4toi(buf, pos);\n    pos += 4;\n    const refType = (refChunk & 0x80000000) >>> 31;\n    const refSize = (refChunk & 0x7fffffff);\n\n    // when set to 1 indicates that the reference is to a sidx, else to media\n    if (refType === 1) {\n      throw new Error(\"sidx with reference_type `1` not yet implemented\");\n    }\n\n    const duration = be4toi(buf, pos);\n    pos += 4;\n\n    // let sapChunk = be4toi(buf, pos + 8);\n    pos += 4;\n\n    // TODO(pierre): handle sap\n    // let startsWithSap = (sapChunk & 0x80000000) >>> 31;\n    // let sapType = (sapChunk & 0x70000000) >>> 28;\n    // let sapDelta = sapChunk & 0x0FFFFFFF;\n\n    segments.push({ time,\n                    duration,\n                    count: 0,\n                    timescale,\n                    range: [offset, offset + refSize - 1] });\n\n    time += duration;\n    offset += refSize;\n  }\n\n  return segments;\n}\n\n/**\n * Parse track Fragment Decode Time to get a precize initial time for this\n * segment (in the media timescale).\n * Stops at the first tfdt encountered from the beginning of the file.\n * Returns this time. -1 if not found.\n * @param {Uint8Array} buffer\n * @returns {Number}\n */\nfunction getTrackFragmentDecodeTime(buffer : Uint8Array) : number {\n  const traf = getTRAF(buffer);\n  if (!traf) {\n    return -1;\n  }\n\n  const index = findBox(traf, 0x74666474 /* tfdt */);\n  if (index === -1) {\n    return -1;\n  }\n\n  let pos = index + /* size */4 + /* name */4;\n  const version = traf[pos]; pos += 4;\n  if (version > 1) {\n    return -1;\n  }\n\n  return version ? be8toi(traf, pos) : be4toi(traf, pos);\n}\n\n/**\n * @param {Uint8Array} traf\n * @returns {number}\n */\nfunction getDefaultDurationFromTFHDInTRAF(traf : Uint8Array) : number {\n  const index = findBox(traf, 0x74666864 /* tfhd */);\n  if (index === -1) {\n    return -1;\n  }\n\n  let pos = index + /* size */4 + /* name */4 + /* version */ 1;\n\n  const flags = be3toi(traf, pos); pos += 3;\n\n  const hasBaseDataOffset = flags & 0x000001;\n  const hasSampleDescriptionIndex = flags & 0x000002;\n  const hasDefaultSampleDuration = flags & 0x000008;\n\n  if (!hasDefaultSampleDuration) {\n    return -1;\n  }\n\n  pos += 4;\n\n  if (hasBaseDataOffset) {\n    pos += 8;\n  }\n\n  if (hasSampleDescriptionIndex) {\n    pos += 4;\n  }\n\n  const defaultDuration = be4toi(traf, pos);\n\n  return defaultDuration;\n}\n\n/**\n * @param {Uint8Array} buffer\n * @returns {number}\n */\nfunction getDurationFromTrun(buffer : Uint8Array) : number {\n  const traf = getTRAF(buffer);\n  if (!traf) {\n    return -1;\n  }\n\n  const index = findBox(traf, 0x7472756e /* trun */);\n  if (index === -1) {\n    return -1;\n  }\n\n  let pos = index + /* size */4 + /* name */4;\n  const version = traf[pos]; pos += 1;\n  if (version > 1) {\n    return -1;\n  }\n  const flags = be3toi(traf, pos); pos += 3;\n  const hasSampleDuration = flags & 0x000100;\n\n  let defaultDuration = 0;\n  if (!hasSampleDuration) {\n    defaultDuration = getDefaultDurationFromTFHDInTRAF(traf);\n    if (defaultDuration < 0) {\n      return -1;\n    }\n  }\n\n  const hasDataOffset = flags & 0x000001;\n  const hasFirstSampleFlags = flags & 0x000004;\n  const hasSampleSize = flags & 0x000200;\n  const hasSampleFlags = flags & 0x000400;\n  const hasSampleCompositionOffset = flags & 0x000800;\n\n  const sampleCounts = be4toi(traf, pos); pos += 4;\n\n  if (hasDataOffset) {\n    pos += 4;\n  }\n\n  if (hasFirstSampleFlags) {\n    pos += 4;\n  }\n\n  let i = sampleCounts;\n  let duration = 0;\n  while (i--) {\n    if (hasSampleDuration) {\n      duration += be4toi(traf, pos);\n      pos += 4;\n    } else {\n      duration += defaultDuration;\n    }\n    if (hasSampleSize) {\n      pos += 4;\n    }\n    if (hasSampleFlags) {\n      pos += 4;\n    }\n    if (hasSampleCompositionOffset) {\n      pos += 4;\n    }\n  }\n\n  return duration;\n}\n\n/**\n * Get various information from a movie header box. Found in init segments.\n * null if not found or not parsed.\n *\n * This timescale is the default timescale used for segments.\n * @param {Uint8Array} buffer\n * @returns {Number}\n */\nfunction getMDHDTimescale(buffer : Uint8Array) : number {\n  const mdia = getMDIA(buffer);\n  if (!mdia) {\n    return -1;\n  }\n\n  const index = findBox(mdia, 0x6d646864  /* \"mdhd\" */);\n  if (index === -1) {\n    return -1;\n  }\n\n  let pos = index + /* size */4 + /* name */4;\n\n  const version = mdia[pos]; pos += 4;\n  if (version === 1) {\n    pos += 16;\n    return be4toi(mdia, pos);\n  } else if (version === 0) {\n    pos += 8;\n    return be4toi(mdia, pos);\n  } else {\n    return -1;\n  }\n}\n\n/**\n * Returns a PSSH box from a systemId and private data.\n * @param {Array.<Object>} pssList - The content protections under the form of\n * object containing two properties:\n *   - systemId {string}: The uuid code. Should only contain 32 hexadecimal\n *     numbers and hyphens\n *   - privateData {Uint8Array} private data associated.\n * @returns {Uint8Array}\n */\nfunction createPssh({ systemId, privateData } : IISOBMFFKeySystem) : Uint8Array {\n  const _systemId = systemId.replace(/-/g, \"\");\n\n  assert(_systemId.length === 32);\n  return createBox(\"pssh\", concat(\n    4, // 4 initial zeroed bytes\n    hexToBytes(_systemId),\n    itobe4(privateData.length),\n    privateData\n  ));\n}\n\n/**\n * Update ISOBMFF given to add a \"pssh\" box in the \"moov\" box for every content\n * protection in the pssList array given.\n * @param {Uint8Array} buf - the ISOBMFF file\n * @param {Array.<Object>} pssList - The content protections under the form of\n * objects containing two properties:\n *   - systemId {string}: The uuid code. Should only contain 32 hexadecimal\n *     numbers and hyphens\n *   - privateData {Uint8Array} private data associated.\n * @returns {Uint8Array} - The new ISOBMFF generated.\n */\nfunction patchPssh(buf : Uint8Array, pssList : IISOBMFFKeySystem[]) : Uint8Array {\n  if (!pssList || !pssList.length) {\n    return buf;\n  }\n\n  const pos = findBox(buf, 0x6d6f6f76 /* = \"moov\" */);\n  if (pos === -1) {\n    return buf;\n  }\n\n  const size = be4toi(buf, pos); // size of the \"moov\" box\n  const moov = buf.subarray(pos, pos + size);\n\n  const moovArr = [moov];\n  for (let i = 0; i < pssList.length; i++) {\n    moovArr.push(createPssh(pssList[i]));\n  }\n\n  const newmoov = concat(...moovArr);\n  newmoov.set(itobe4(newmoov.length), 0); // overwrite \"moov\" length\n\n  return concat(\n    buf.subarray(0, pos),\n    newmoov,\n    buf.subarray(pos + size)\n  );\n}\n\nexport {\n  getMDHDTimescale,\n  getPlayReadyKIDFromPrivateData,\n  getTrackFragmentDecodeTime,\n  getDurationFromTrun,\n  getSegmentsFromSidx,\n  patchPssh,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport {\n  createBox,\n  createBoxWithChildren,\n} from \"./create_box\";\nexport {\n  getBox,\n  getBoxContent,\n  getBoxOffsets,\n  getUuidContent,\n} from \"./get_box\";\nexport {\n  getMDAT,\n  getMDIA,\n  getTRAF,\n} from \"./read\";\nexport {\n  getMDHDTimescale,\n  getPlayReadyKIDFromPrivateData,\n  getTrackFragmentDecodeTime,\n  getDurationFromTrun,\n  getSegmentsFromSidx,\n  ISidxSegment,\n  patchPssh,\n} from \"./utils\";\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../../../log\";\n\nconst SEGMENT_ID = 0x18538067;\nconst INFO_ID = 0x1549a966;\nconst TIMECODESCALE_ID = 0x2AD7B1;\nconst DURATION_ID = 0x4489;\nconst CUES_ID = 0x1C53BB6B;\nconst CUE_POINT_ID = 0xbb;\nconst CUE_TIME_ID = 0xb3;\nconst CUE_TRACK_POSITIONS_ID = 0xb7;\nconst CUE_CLUSTER_POSITIONS_ID = 0xf1;\n\nexport interface ICuesSegment {\n  time : number;\n  duration : number;\n  count : 0;\n  timescale : number;\n  range : [number, number];\n}\n\n/**\n * Find the offsets of the value linked to the given element ID.\n * @param {number} elementID - ID for the searched element.\n * @param {Array.<number>} parents - eventual IDs of the parent elements. From\n * top level to lower level (from the furthest to the closest).\n * @param {Uint8Array} buffer - buffer where the ID will be searched\n * @param {Array.<number>} range - start and end offsets in the buffer where the\n * ID will be searched.\n * @returns {Array.<number>|null}\n */\nfunction findNextElement(\n  elementID : number,\n  parents : number[],\n  buffer : Uint8Array,\n  [ initialOffset, maxOffset ] : [ number, number ]\n) : [number, number]|null {\n  let currentOffset = initialOffset;\n  while (currentOffset < maxOffset) {\n    const parsedID = getEBMLID(buffer, currentOffset);\n    if (parsedID == null) {\n      return null;\n    }\n\n    const { value: ebmlTagID, length: ebmlTagLength } = parsedID;\n    const sizeOffset = currentOffset + ebmlTagLength;\n    const parsedValue = getEBMLValue(buffer, sizeOffset);\n    if (parsedValue == null) {\n      return null;\n    }\n\n    const { length: valueLengthLength, value: valueLength } = parsedValue;\n    const valueOffset = sizeOffset + valueLengthLength;\n    const valueEndOffset = valueOffset + valueLength;\n    if (ebmlTagID === elementID) {\n      return [valueOffset, valueEndOffset];\n    } else if (parents.length) {\n      for (let i = 0; i < parents.length; i++) {\n        if (ebmlTagID === parents[i]) {\n          const newParents = parents.slice(i + 1, parents.length);\n          return findNextElement(\n            elementID, newParents, buffer, [valueOffset, valueEndOffset]);\n        }\n      }\n    }\n    currentOffset = valueEndOffset;\n  }\n  return null;\n}\n\n/**\n * Return the timecode scale (basically timescale) of the whole file.\n * @param {Uint8Array} buffer\n * @param {number} initialOffset\n * @returns {number|null}\n */\nexport function getTimeCodeScale(\n  buffer : Uint8Array,\n  initialOffset : number\n) : number|null {\n  const timeCodeScaleOffsets = findNextElement(\n    TIMECODESCALE_ID, [SEGMENT_ID, INFO_ID], buffer, [initialOffset, buffer.length]);\n  if (timeCodeScaleOffsets == null) {\n    return null;\n  }\n  const length = timeCodeScaleOffsets[1] - timeCodeScaleOffsets[0];\n  return 1e9 / bytesToNumber(buffer, timeCodeScaleOffsets[0], length);\n}\n\n/**\n * Return the duration of the concerned media.\n * @param {Uint8Array} buffer\n * @param {number} initialOffset\n * @returns {number|null}\n */\nfunction getDuration(\n  buffer : Uint8Array,\n  initialOffset : number\n) : number|null {\n  const timeCodeScaleOffsets = findNextElement(\n    DURATION_ID, [SEGMENT_ID, INFO_ID], buffer, [initialOffset, buffer.length]);\n  if (timeCodeScaleOffsets == null) {\n    return null;\n  }\n\n  const length = timeCodeScaleOffsets[1] - timeCodeScaleOffsets[0];\n  if (length === 4) {\n    return get_IEEE754_32Bits(buffer, timeCodeScaleOffsets[0]);\n  } else if (length === 8) {\n    return get_IEEE754_64Bits(buffer, timeCodeScaleOffsets[0]);\n  }\n  return null;\n}\n\n/**\n * @param {Uint8Array} buffer\n * @param {number} initialOffset\n * @returns {Array.<Object>|null}\n */\nexport function getSegmentsFromCues(\n  buffer : Uint8Array,\n  initialOffset : number\n) : ICuesSegment[]|null {\n  const segmentRange = findNextElement(\n   SEGMENT_ID, [], buffer, [initialOffset, buffer.length]);\n  if (segmentRange == null) {\n    return null;\n  }\n\n  const [ segmentRangeStart, segmentRangeEnd ] = segmentRange;\n\n  const timescale = getTimeCodeScale(buffer, segmentRangeStart);\n  if (timescale == null) {\n    return null;\n  }\n\n  const duration = getDuration(buffer, segmentRangeStart);\n  if (duration == null) {\n    return null;\n  }\n\n  const cuesRange = findNextElement(\n    CUES_ID, [], buffer, [segmentRangeStart, segmentRangeEnd]);\n  if (cuesRange == null) {\n    return null;\n  }\n\n  const rawInfos : Array<{\n    time : number;\n    duration? : number;\n    rangeStart : number;\n  }> = [];\n\n  let currentOffset = cuesRange[0];\n  while (currentOffset < cuesRange[1]) {\n    const cuePointRange = findNextElement(\n      CUE_POINT_ID, [], buffer, [currentOffset, cuesRange[1]]);\n\n    if (cuePointRange == null) {\n      break;\n    }\n\n    const cueTimeRange = findNextElement(\n      CUE_TIME_ID, [], buffer, [cuePointRange[0], cuePointRange[1]]);\n    if (cueTimeRange == null) {\n      return null;\n    }\n    const time = bytesToNumber(\n      buffer, cueTimeRange[0], cueTimeRange[1] - cueTimeRange[0]);\n\n    const cueOffsetRange = findNextElement(\n      CUE_CLUSTER_POSITIONS_ID, [CUE_TRACK_POSITIONS_ID],\n      buffer, [cuePointRange[0], cuePointRange[1]]);\n    if (cueOffsetRange == null) {\n      return null;\n    }\n\n    const rangeStart = bytesToNumber(\n      buffer, cueOffsetRange[0], cueOffsetRange[1] - cueOffsetRange[0]) +\n      segmentRangeStart;\n    rawInfos.push({ time, rangeStart });\n\n    currentOffset = cuePointRange[1];\n  }\n\n  const segments : ICuesSegment[] = [];\n\n  for (let i = 0; i < rawInfos.length; i++) {\n    const currentSegment = rawInfos[i];\n    if (i === rawInfos.length - 1) {\n      segments.push({\n        time: currentSegment.time,\n        count: 0,\n        timescale,\n        duration: i === 0 ?\n          duration : duration - currentSegment.time,\n        range: [currentSegment.rangeStart, Infinity],\n      });\n    } else {\n      segments.push({\n        time: currentSegment.time,\n        count: 0,\n        timescale,\n        duration: rawInfos[i + 1].time - currentSegment.time,\n        range: [currentSegment.rangeStart, rawInfos[i + 1].rangeStart - 1],\n      });\n    }\n  }\n\n  return segments;\n}\n\nfunction getLength(buffer : Uint8Array, offset : number) : number|undefined {\n  for (let length = 1; length <= 8; length++) {\n    if (buffer[offset] >= Math.pow(2, 8 - length)) {\n      return length;\n    }\n  }\n  return undefined;\n}\n\nfunction getEBMLID(\n  buffer : Uint8Array,\n  offset : number\n) : { length : number; value : number }|null {\n  const length = getLength(buffer, offset);\n  if (length == null) {\n    log.warn(\"webm: unrepresentable length\");\n    return null;\n  }\n  if (offset + length > buffer.length) {\n    log.warn(\"webm: impossible length\");\n    return null;\n  }\n\n  let value = 0;\n  for (let i = 0; i < length; i++) {\n    value = buffer[offset + i] * Math.pow(2, (length - i - 1) * 8) + value;\n  }\n  return { length, value };\n}\n\nfunction getEBMLValue(\n  buffer : Uint8Array,\n  offset : number\n) : { length : number; value : number }|null {\n  const length = getLength(buffer, offset);\n  if (length == null) {\n    log.warn(\"webm: unrepresentable length\");\n    return null;\n  }\n  if (offset + length > buffer.length) {\n    log.warn(\"webm: impossible length\");\n    return null;\n  }\n\n  let value = (buffer[offset] & (1 << (8 - length)) - 1) *\n    Math.pow(2, (length - 1) * 8);\n  for (let i = 1; i < length; i++) {\n    value = buffer[offset + i] * Math.pow(2, (length - i - 1) * 8) + value;\n  }\n  return { length, value };\n}\n\n/**\n * Convert a IEEE754 32 bits floating number as an Uint8Array into its\n * corresponding Number.\n * @param {Uint8Array} buffer\n * @param {number} offset\n * @returns {number}\n */\nfunction get_IEEE754_32Bits(\n  buffer : Uint8Array,\n  offset : number\n) {\n  return new DataView(buffer.buffer).getFloat32(offset);\n}\n\n/**\n * Convert a IEEE754 64 bits floating number as an Uint8Array into its\n * corresponding Number.\n * @param {Uint8Array} buffer\n * @param {number} offset\n * @returns {number}\n */\nfunction get_IEEE754_64Bits(\n  buffer : Uint8Array,\n  offset : number\n) : number {\n  return new DataView(buffer.buffer).getFloat64(offset);\n}\n\nfunction bytesToNumber(\n  buffer : Uint8Array,\n  offset : number,\n  length : number\n) : number {\n  let value = 0;\n  for (let i = 0; i < length; i++) {\n    value = buffer[offset + i] * Math.pow(2, (length - i - 1) * 8) + value;\n  }\n  return value;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport {\n  ICuesSegment,\n  getSegmentsFromCues,\n  getTimeCodeScale,\n} from \"./utils\";\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ISegment } from \"../../manifest\";\nimport {\n  getDurationFromTrun,\n  getTrackFragmentDecodeTime,\n} from \"../../parsers/containers/isobmff\";\nimport { IChunkTimingInfos } from \"../types\";\n\n/**\n * Get precize start and duration of a chunk.\n * @param {UInt8Array} buffer - An ISOBMFF container (at least a `moof` + a\n * `mdat` box.\n * @param {Boolean} isChunked - If true, the whole segment was chunked into\n * multiple parts and buffer is one of them. If false, buffer is the whole\n * segment.\n * @param {Object} segment\n * @param {Array.<Object>|undefined} sidxSegments - Segments from sidx. Here\n * pre-parsed for performance reasons as it is usually available when\n * this function is called.\n * @param {Object|undefined} initInfos\n * @returns {Object}\n */\nexport default function getISOBMFFTimingInfos(\n  buffer : Uint8Array,\n  isChunked : boolean,\n  segment : ISegment,\n  initInfos? : IChunkTimingInfos\n) : IChunkTimingInfos | null {\n  let startTime;\n  let duration;\n  const trunDuration = getDurationFromTrun(buffer);\n  const timescale = initInfos && initInfos.timescale ? initInfos.timescale :\n                                                       segment.timescale;\n\n  const baseDecodeTime = getTrackFragmentDecodeTime(buffer);\n  if (isChunked) { // when chunked, no mean to know the duration for now\n    if (initInfos == null) {\n      return null;\n    }\n    if (baseDecodeTime < 0) {\n      return null;\n    }\n    return { time: baseDecodeTime,\n             duration: trunDuration >= 0 ? trunDuration :\n                                           undefined,\n             timescale: initInfos.timescale };\n  }\n\n  // we could always make a mistake when reading a container.\n  // If the estimate is too far from what the segment seems to imply, take\n  // the segment infos instead.\n  let maxDecodeTimeDelta : number;\n\n  // Scaled start time and duration as announced in the segment data\n  let segmentDuration : number|undefined;\n\n  if (timescale === segment.timescale) {\n    maxDecodeTimeDelta = Math.min(timescale * 0.9,\n                                  segment.duration != null ? segment.duration / 4 :\n                                                             0.25);\n    segmentDuration = segment.duration;\n  } else {\n    maxDecodeTimeDelta =\n      Math.min(timescale * 0.9,\n               segment.duration != null ?\n                 ((segment.duration / segment.timescale) * timescale) / 4 :\n                   0.25\n    );\n    segmentDuration = segment.duration != null ?\n                        (segment.duration / segment.timescale) * timescale :\n                        undefined;\n  }\n\n  if (baseDecodeTime >= 0) {\n    startTime = segment.timestampOffset != null ?\n                  baseDecodeTime + (segment.timestampOffset * timescale) :\n                  baseDecodeTime;\n  } else {\n    return null;\n  }\n\n  if (trunDuration >= 0 &&\n      (\n        segmentDuration == null ||\n        Math.abs(trunDuration - segmentDuration) <= maxDecodeTimeDelta\n      ))\n  {\n    duration = trunDuration;\n  }\n\n  return { timescale, time: startTime, duration };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  of as observableOf,\n} from \"rxjs\";\nimport {\n  getMDHDTimescale,\n  getSegmentsFromSidx,\n} from \"../../parsers/containers/isobmff\";\nimport {\n  getSegmentsFromCues,\n  getTimeCodeScale,\n} from \"../../parsers/containers/matroska\";\nimport {\n  ISegmentParserArguments,\n  ISegmentParserObservable,\n} from \"../types\";\nimport getISOBMFFTimingInfos from \"../utils/get_isobmff_timing_infos\";\nimport isWEBMEmbeddedTrack from \"../utils/is_webm_embedded_track\";\n\nexport default function parser(\n  { content,\n    response,\n    init } : ISegmentParserArguments< Uint8Array |\n                                      ArrayBuffer |\n                                      null >\n) : ISegmentParserObservable< Uint8Array | ArrayBuffer > {\n  const { period, representation, segment } = content;\n  const { data, isChunked } = response;\n  if (data == null) {\n    return observableOf({ chunkData: null,\n                          chunkInfos: null,\n                          chunkOffset: 0,\n                          appendWindow: [period.start, period.end] });\n  }\n\n  const chunkData = data instanceof Uint8Array ? data :\n                                                 new Uint8Array(data);\n  const isWEBM = isWEBMEmbeddedTrack(representation);\n\n  if (!segment.isInit) {\n    const chunkInfos = isWEBM ? null : // TODO extract from webm\n                                getISOBMFFTimingInfos(chunkData,\n                                                      isChunked,\n                                                      segment,\n                                                      init);\n    const chunkOffset = segment.timestampOffset || 0;\n    return observableOf({ chunkData,\n                          chunkInfos,\n                          chunkOffset,\n                          appendWindow: [period.start, period.end] });\n  }\n\n  // it is an initialization segment\n\n  const { indexRange } = segment;\n  const nextSegments = isWEBM ?\n    getSegmentsFromCues(chunkData, 0) :\n    getSegmentsFromSidx(chunkData, indexRange ? indexRange[0] : 0);\n  if (nextSegments) {\n    representation.index._addSegments(nextSegments);\n  }\n\n  const timescale = isWEBM ? getTimeCodeScale(chunkData, 0) :\n                             getMDHDTimescale(chunkData);\n  const initChunkInfos = timescale != null && timescale > 0 ? { time: 0,\n                                                                duration: 0,\n                                                                timescale } :\n                                                              null;\n  return observableOf({ chunkData,\n                        chunkInfos: initChunkInfos,\n                        chunkOffset: segment.timestampOffset || 0,\n                        appendWindow: [period.start, period.end] });\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Representation } from \"../../manifest\";\n\n/**\n * Returns true if the given texttrack segment represents a textrack embedded\n * in a mp4 file.\n * @param {Representation} representation\n * @returns {Boolean}\n */\nexport default function isMP4EmbeddedTextTrack(\n  representation : Representation\n) : boolean {\n  return representation.mimeType === \"application/mp4\";\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { of as observableOf } from \"rxjs\";\nimport { tap } from \"rxjs/operators\";\nimport request, {\n  fetchIsSupported,\n} from \"../../utils/request\";\nimport warnOnce from \"../../utils/warn_once\";\nimport {\n  ISegmentLoaderArguments,\n  ISegmentLoaderObservable,\n} from \"../types\";\nimport byteRange from \"../utils/byte_range\";\nimport checkISOBMFFIntegrity from \"../utils/check_isobmff_integrity\";\nimport isMP4EmbeddedTextTrack from \"../utils/is_mp4_embedded_text_track\";\nimport initSegmentLoader from \"./init_segment_loader\";\nimport lowLatencySegmentLoader from \"./low_latency_segment_loader\";\n\n/**\n * Perform requests for \"text\" segments\n * @param {boolean} lowLatencyMode\n * @returns {Function}\n */\nexport default function generateTextTrackLoader(\n  { lowLatencyMode,\n    checkMediaSegmentIntegrity } : { lowLatencyMode : boolean;\n                                     checkMediaSegmentIntegrity? : boolean; }\n) : (x : ISegmentLoaderArguments) => ISegmentLoaderObservable< ArrayBuffer |\n                                                               string |\n                                                               null > {\n  if (checkMediaSegmentIntegrity !== true) {\n    return textTrackLoader;\n  }\n  return (content) => textTrackLoader(content).pipe(tap(res => {\n    if ((res.type === \"data-loaded\" || res.type === \"data-chunk\") &&\n        res.value.responseData !== null &&\n        typeof res.value.responseData !== \"string\")\n    {\n      checkISOBMFFIntegrity(new Uint8Array(res.value.responseData),\n                            content.segment.isInit);\n    }\n  }));\n\n  /**\n   * @param {Object} args\n   * @returns {Observable}\n   */\n  function textTrackLoader(\n    args : ISegmentLoaderArguments\n  ) : ISegmentLoaderObservable< ArrayBuffer | string | null > {\n    const { mediaURL,\n            range } = args.segment;\n\n    if (mediaURL == null) {\n      return observableOf({ type: \"data-created\",\n                            value: { responseData: null } });\n    }\n\n    if (args.segment.isInit) {\n      return initSegmentLoader(mediaURL, args);\n    }\n\n    const isMP4Embedded = isMP4EmbeddedTextTrack(args.representation);\n    if (lowLatencyMode && isMP4Embedded) {\n      if (fetchIsSupported()) {\n        return lowLatencySegmentLoader(mediaURL, args);\n      } else {\n        warnOnce(\"DASH: Your browser does not have the fetch API. You will have \" +\n                 \"a higher chance of rebuffering when playing close to the live edge\");\n      }\n    }\n\n    // ArrayBuffer when in mp4 to parse isobmff manually, text otherwise\n    const responseType = isMP4Embedded ?  \"arraybuffer\" :\n                                          \"text\";\n    return request<ArrayBuffer|string>({ url: mediaURL,\n                                         responseType,\n                                         headers: range ? { Range: byteRange(range) } :\n                                                          null,\n                                         sendProgressEvents: true });\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Creates a new string from the given array of char codes.\n *\n * @param {Uint8Array} args\n * @returns {string}\n */\nfunction stringFromCharCode(args : Uint8Array) : string {\n  const max = 16000;\n  let ret = \"\";\n  for (let i = 0; i < args.length; i += max) {\n    const subArray = args.subarray(i, i + max);\n\n    // NOTE: ugly I know, but TS is problematic here (you can try)\n    ret += (String.fromCharCode as any).apply(null, subArray);\n  }\n  return ret;\n}\n\n/**\n * Creates a string from the given buffer as UTF-8 encoding.\n * @param {BufferSource} [data]\n * @returns {string}\n * @throws {Error}\n * @export\n */\nexport default function stringFromUTF8(data? : Uint8Array|null) : string {\n  if (!data) {\n    return \"\";\n  }\n\n  let uint8 = new Uint8Array(data);\n\n  // If present, strip off the UTF-8 BOM.\n  if (uint8[0] === 0xef && uint8[1] === 0xbb && uint8[2] === 0xbf) {\n    uint8 = uint8.subarray(3);\n  }\n\n  // http://stackoverflow.com/a/13691499\n  const utf8 = stringFromCharCode(uint8);\n\n  // This converts each character in the string to an escape sequence.  If the\n  // character is in the ASCII range, it is not converted; otherwise it is\n  // converted to a URI escape sequence.\n  // Example: \"\\x67\\x35\\xe3\\x82\\xac\" -> \"g#%E3%82%AC\"\n  // TODO \"escape\" is deprecated, provide a ponyfill?\n  const escaped = escape(utf8);\n\n  // Decode the escaped sequence.  This will interpret UTF-8 sequences into the\n  // correct character.\n  // Example: \"g#%E3%82%AC\" -> \"g#\"\n  return decodeURIComponent(escaped);\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../../log\";\nimport {\n  Adaptation,\n  ISegment,\n  Representation,\n} from \"../../manifest\";\nimport { getMDAT } from \"../../parsers/containers/isobmff\";\nimport stringFromUTF8 from \"../../utils/string_from_utf8\";\nimport {\n  IChunkTimingInfos,\n  ITextTrackSegmentData,\n} from \"../types\";\n\n/**\n * Return plain text text track from the given ISOBMFF.\n * @param {Uint8Array} chunkBytes\n * @returns {string}\n */\nexport function extractTextTrackFromISOBMFF(chunkBytes : Uint8Array) : string {\n  return stringFromUTF8(getMDAT(chunkBytes));\n}\n\n/**\n * Returns the a string expliciting the format of a text track when that text\n * track is embedded into a ISOBMFF file.\n * @param {Object} representation\n * @returns {string}\n */\nexport function getISOBMFFTextTrackFormat(\n  representation : Representation\n) : \"ttml\" | \"vtt\" {\n  const codec = representation.codec == null ? \"\" :\n                                               representation.codec;\n  switch (codec.toLowerCase()) {\n    case \"stpp\": // stpp === TTML in MP4\n    case \"stpp.ttml.im1t\":\n      return \"ttml\";\n    case \"wvtt\": // wvtt === WebVTT in MP4\n      return \"vtt\";\n  }\n\n  throw new Error(\"The codec used for the subtitles \" +\n                  `\"${codec}\" is not managed yet.`);\n}\n\n/**\n * Returns the a string expliciting the format of a text track in plain text.\n * @param {Object} representation\n * @returns {string}\n */\nexport function getPlainTextTrackFormat(\n  representation : Representation\n) : \"ttml\" | \"sami\" | \"vtt\" | \"srt\" {\n  const { mimeType = \"\" } = representation;\n  switch (representation.mimeType) {\n    case \"application/ttml+xml\":\n      return \"ttml\";\n    case \"application/x-sami\":\n    case \"application/smil\":\n      return \"sami\";\n    case \"text/vtt\":\n      return \"vtt\";\n  }\n\n  const { codec = \"\" } = representation;\n  const codeLC = codec.toLowerCase();\n  if (codeLC === \"srt\") {\n    return \"srt\";\n  }\n  throw new Error(`could not find a text-track parser for the type ${mimeType}`);\n}\n\n/**\n * @param {Object} content\n * @param {ArrayBuffer|UInt8Array|null} chunkData\n * @param {Object|null} chunkInfos\n * @param {boolean} isChunked\n * @returns {Object|null}\n */\nexport function getISOBMFFEmbeddedTextTrackData(\n  { segment,\n    adaptation,\n    representation } : { segment : ISegment;\n                         adaptation : Adaptation;\n                         representation : Representation; },\n  chunkBytes : Uint8Array,\n  chunkInfos : IChunkTimingInfos | null,\n  isChunked : boolean\n) : ITextTrackSegmentData | null {\n  if (segment.isInit) {\n    return null;\n  }\n  let startTime : number | undefined;\n  let endTime : number | undefined;\n  let timescale : number = 1;\n  if (chunkInfos == null) {\n    if (!isChunked) {\n      log.warn(\"Transport: Unavailable time data for current text track.\");\n    } else {\n      startTime = segment.time;\n      endTime = startTime + segment.duration;\n      timescale = segment.timescale;\n    }\n  } else {\n    startTime = chunkInfos.time;\n    if (chunkInfos.duration != null) {\n      endTime = startTime + chunkInfos.duration;\n    } else if (!isChunked) {\n      endTime = startTime + segment.duration;\n    }\n    timescale = chunkInfos.timescale;\n  }\n\n  const type = getISOBMFFTextTrackFormat(representation);\n  const textData = extractTextTrackFromISOBMFF(chunkBytes);\n  return { data: textData,\n           type,\n           language: adaptation.language,\n           start: startTime,\n           end: endTime,\n           timescale } ;\n}\n\n/**\n * @param {Object} content\n * @param {ArrayBuffer|UInt8Array|null} chunkData\n * @param {Object|null} chunkInfos\n * @param {boolean} isChunked\n * @returns {Object|null}\n */\nexport function getPlainTextTrackData(\n  { segment,\n    adaptation,\n    representation } : { segment : ISegment;\n                         adaptation : Adaptation;\n                         representation : Representation; },\n  textTrackData : string,\n  isChunked : boolean\n) : ITextTrackSegmentData | null {\n  if (segment.isInit) {\n    return null;\n  }\n  let start : number | undefined;\n  let end : number | undefined;\n  let timescale : number = 1;\n  if (!isChunked) {\n    start = segment.time;\n    end = start + segment.duration;\n    timescale = segment.timescale;\n  } else {\n    log.warn(\"Transport: Unavailable time data for current text track.\");\n  }\n\n  const type = getPlainTextTrackFormat(representation);\n  return { data: textTrackData,\n           type,\n           language: adaptation.language,\n           start,\n           end,\n           timescale };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { of as observableOf } from \"rxjs\";\nimport {\n  getMDHDTimescale,\n  getSegmentsFromSidx,\n} from \"../../parsers/containers/isobmff\";\nimport {\n  bytesToStr,\n  strToBytes,\n} from \"../../utils/byte_parsing\";\nimport {\n  ISegmentParserArguments,\n  ITextParserObservable,\n} from \"../types\";\nimport getISOBMFFTimingInfos from \"../utils/get_isobmff_timing_infos\";\nimport isMP4EmbeddedTextTrack from \"../utils/is_mp4_embedded_text_track\";\nimport {\n  getISOBMFFEmbeddedTextTrackData,\n  getPlainTextTrackData,\n} from \"../utils/parse_text_track\";\n\n/**\n * Parse TextTrack data when it is embedded in an ISOBMFF file.\n * @param {Object} infos\n * @returns {Observable.<Object>}\n */\nfunction parseISOBMFFEmbeddedTextTrack(\n  { response,\n    content,\n    init } : ISegmentParserArguments< Uint8Array |\n                                      ArrayBuffer |\n                                      string >\n) : ITextParserObservable {\n  const { period, representation, segment } = content;\n  const { isInit, indexRange } = segment;\n  const { data, isChunked } = response;\n\n  const chunkBytes = typeof data === \"string\" ? strToBytes(data) :\n                     data instanceof Uint8Array ? data :\n                                                  new Uint8Array(data);\n  if (isInit) {\n    const sidxSegments = getSegmentsFromSidx(chunkBytes,\n                                             indexRange ? indexRange[0] : 0);\n    const mdhdTimescale = getMDHDTimescale(chunkBytes);\n    const initChunkInfos = mdhdTimescale > 0 ? { time: 0,\n                                                 duration: 0,\n                                                 timescale: mdhdTimescale } :\n                                               null;\n    if (sidxSegments) {\n      representation.index._addSegments(sidxSegments);\n    }\n    return observableOf({ chunkData: null,\n                          chunkInfos: initChunkInfos,\n                          chunkOffset: segment.timestampOffset || 0,\n                          appendWindow: [period.start, period.end] });\n  }\n  const chunkInfos = getISOBMFFTimingInfos(chunkBytes, isChunked, segment, init);\n  const chunkData = getISOBMFFEmbeddedTextTrackData(content,\n                                                    chunkBytes,\n                                                    chunkInfos,\n                                                    isChunked);\n  return observableOf({ chunkData,\n                        chunkInfos,\n                        chunkOffset: segment.timestampOffset || 0,\n                        appendWindow: [period.start, period.end] });\n}\n\n/**\n * Parse TextTrack data in plain text form.\n * @param {Object} infos\n * @returns {Observable.<Object>}\n */\nfunction parsePlainTextTrack(\n  { response,\n    content } : ISegmentParserArguments< Uint8Array |\n                                         ArrayBuffer |\n                                         string >\n) : ITextParserObservable {\n  const { period, segment } = content;\n  if (segment.isInit) {\n    return observableOf({ chunkData: null,\n                          chunkInfos: null,\n                          chunkOffset: segment.timestampOffset || 0,\n                          appendWindow: [period.start, period.end] });\n  }\n\n  const { data, isChunked } = response;\n  let textTrackData : string;\n  if (typeof data !== \"string\") {\n    const bytesData = data instanceof Uint8Array ? data :\n                                                   new Uint8Array(data);\n    textTrackData = bytesToStr(bytesData);\n  } else {\n    textTrackData = data;\n  }\n  const chunkData = getPlainTextTrackData(content, textTrackData, isChunked);\n  return observableOf({ chunkData,\n                        chunkInfos: null,\n                        chunkOffset: segment.timestampOffset || 0,\n                        appendWindow: [period.start, period.end] });\n}\n\n/**\n * Parse TextTrack data.\n * @param {Object} infos\n * @returns {Observable.<Object>}\n */\nexport default function textTrackParser(\n  { response,\n    content,\n    init } : ISegmentParserArguments< Uint8Array |\n                                      ArrayBuffer |\n                                      string |\n                                      null >\n) : ITextParserObservable {\n  const { period, representation, segment } = content;\n  const { data, isChunked } = response;\n  if (data == null) { // No data, just return empty infos\n    return observableOf({ chunkData: null,\n                          chunkInfos: null,\n                          chunkOffset: segment.timestampOffset || 0,\n                          appendWindow: [period.start, period.end] });\n  }\n\n  const isMP4 = isMP4EmbeddedTextTrack(representation);\n  if (isMP4) {\n    return parseISOBMFFEmbeddedTextTrack({ response: { data, isChunked },\n                                           content,\n                                           init });\n  } else {\n    return parsePlainTextTrack({ response: { data, isChunked }, content });\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ITransportOptions,\n  ITransportPipelines,\n} from \"../types\";\nimport generateManifestLoader from \"../utils/document_manifest_loader\";\nimport {\n  imageLoader,\n  imageParser,\n} from \"./image_pipelines\";\nimport generateManifestParser from \"./manifest_parser\";\nimport generateSegmentLoader from \"./segment_loader\";\nimport segmentParser from \"./segment_parser\";\nimport generateTextTrackLoader from \"./text_loader\";\nimport textTrackParser from \"./text_parser\";\n\n/**\n * Returns pipelines used for DASH streaming.\n * @param {Object} options\n * implementation. Used for each generated http request.\n * @returns {Object}\n */\nexport default function(options : ITransportOptions) : ITransportPipelines {\n  const manifestLoader = generateManifestLoader({\n    customManifestLoader: options.manifestLoader,\n  });\n  const manifestParser = generateManifestParser(options);\n  const segmentLoader = generateSegmentLoader(options);\n  const textTrackLoader = generateTextTrackLoader(options);\n\n  return { manifest: { loader: manifestLoader,\n                       parser: manifestParser },\n           audio: { loader: segmentLoader,\n                    parser: segmentParser },\n           video: { loader: segmentLoader,\n                    parser: segmentParser },\n           text: { loader: textTrackLoader,\n                   parser: textTrackParser },\n           image: { loader: imageLoader,\n                    parser: imageParser } };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * /!\\ This file is feature-switchable.\n * It always should be imported through the `features` object.\n */\n\nimport DASHPipelines from \"./pipelines\";\nexport default DASHPipelines;\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @param {string} fourCC\n * @param {string} codecPrivateData\n * @returns {string}\n */\nexport function getAudioCodecs(\n  fourCC : string,\n  codecPrivateData : string\n) : string {\n  let mpProfile;\n  if (fourCC === \"AACH\") {\n    mpProfile = 5; // High Efficiency AAC Profile\n  } else {\n    mpProfile = codecPrivateData ?\n      (parseInt(codecPrivateData.substring(0, 2), 16) & 0xF8) >> 3 : 2;\n  }\n  return mpProfile ? (\"mp4a.40.\" + mpProfile) : \"\";\n}\n\n/**\n * @param {string} codecPrivateData\n * @returns {string}\n */\nexport function getVideoCodecs(codecPrivateData : string) : string {\n  // we can extract codes only if fourCC is on of \"H264\", \"X264\", \"DAVC\", \"AVC1\"\n  const [, avcProfile = \"\"] = /00000001\\d7([0-9a-fA-F]{6})/\n    .exec(codecPrivateData) || [];\n  return avcProfile && \"avc1.\" + avcProfile;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ninterface IHSSManifestSegment {\n  start : number;\n  duration : number;\n  repeatCount : number;\n}\n\n/**\n * Parse C nodes to build index timeline.\n * @param {Element} nodes\n */\nexport default function parseCNodes(\n  nodes : Element[]\n) : IHSSManifestSegment[] {\n  return nodes.reduce<IHSSManifestSegment[]>((timeline, node , i) => {\n    const dAttr = node.getAttribute(\"d\");\n    const tAttr = node.getAttribute(\"t\");\n    const rAttr = node.getAttribute(\"r\");\n\n    const repeatCount = rAttr ? +rAttr - 1 : 0;\n    let start = tAttr ? +tAttr : undefined;\n    let duration = dAttr ? +dAttr : undefined;\n\n    if (i === 0) { // first node\n      start = start || 0;\n    } else { // from second node to the end\n      const prev = timeline[i - 1];\n      if (start == null || isNaN(start)) {\n        if (prev.duration == null || isNaN(prev.duration)) {\n          throw new Error(\"Smooth: Invalid CNodes. Missing timestamp.\");\n        }\n        start = prev.start + prev.duration * (prev.repeatCount + 1);\n      }\n    }\n    if (duration == null || isNaN(duration)) {\n      const nextNode = nodes[i + 1];\n      if (nextNode) {\n        const nextTAttr = nextNode.getAttribute(\"t\");\n        const nextStart = nextTAttr ? +nextTAttr : null;\n        if (nextStart === null) {\n          throw new Error(\n            \"Can't build index timeline from Smooth Manifest.\");\n        }\n        duration = nextStart - start;\n      } else {\n        return timeline;\n      }\n    }\n    timeline.push({ duration, start, repeatCount });\n    return timeline;\n  }, []);\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  concat,\n  hexToBytes,\n  strToBytes,\n} from \"../../../utils/byte_parsing\";\nimport { getPlayReadyKIDFromPrivateData }from \"../../containers/isobmff\";\n\nexport interface IKeySystem {\n  systemId : string;\n  privateData : Uint8Array;\n}\n\nexport interface IContentProtectionSmooth {\n  keyId : Uint8Array;\n  keySystems: IKeySystem[];\n}\n\n/**\n * @param {Uint8Array} keyIdBytes\n * @returns {Array.<Object>}\n */\nfunction createWidevineKeySystem(\n  keyIdBytes : Uint8Array\n) : IKeySystem[] {\n  return [{\n    systemId: \"edef8ba9-79d6-4ace-a3c8-27dcd51d21ed\", // Widevine\n    privateData: concat([0x08, 0x01, 0x12, 0x10], keyIdBytes),\n  }];\n}\n\n/**\n * Parse \"Protection\" Node, which contains DRM information\n * @param {Element} protectionNode\n * @returns {Object}\n */\nexport default function parseProtectionNode(\n  protectionNode : Element,\n  keySystemCreator : (keyIdBytes : Uint8Array) => IKeySystem[] = createWidevineKeySystem\n) : IContentProtectionSmooth {\n  if (\n    !protectionNode.firstElementChild ||\n    protectionNode.firstElementChild.nodeName !== \"ProtectionHeader\"\n  ) {\n    throw new Error(\"Protection should have ProtectionHeader child\");\n  }\n  const header = protectionNode.firstElementChild;\n  const privateData = strToBytes(atob(header.textContent || \"\"));\n  const keyIdHex = getPlayReadyKIDFromPrivateData(privateData);\n  const keyIdBytes = hexToBytes(keyIdHex);\n\n  // remove possible braces\n  const systemId = (header.getAttribute(\"SystemID\") || \"\").toLowerCase()\n    .replace(/\\{|\\}/g, \"\");\n  return {\n    keyId: keyIdBytes,\n    keySystems: [\n      {\n        systemId,\n        privateData,\n        // keyIds: [keyIdBytes],\n      },\n    ].concat(keySystemCreator(keyIdBytes)),\n  };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getIndexSegmentEnd } from \"../../utils/index_helpers\";\n\nexport interface IIndexSegment { start : number;\n                                 duration : number;\n                                 repeatCount: number; }\n\nexport interface ITimelineIndex { timescale : number;\n                                  timeline : IIndexSegment[]; }\n\n/**\n * Add a new segment to the index.\n *\n * /!\\ Mutate the given index\n * @param {Object} index\n * @param {Object} newSegment\n * @param {Object} currentSegment\n * @returns {Boolean} - true if the segment has been added\n */\nexport default function _addSegmentInfos(\n  index : ITimelineIndex,\n  newSegment : { time : number;\n                 duration : number;\n                 timescale : number; },\n  currentSegment : { time : number;\n                     duration : number;\n                     timescale : number; }\n) : boolean {\n  const { timeline, timescale } = index;\n  const timelineLength = timeline.length;\n  const last = timeline[timelineLength - 1];\n\n  const scaledNewSegment = newSegment.timescale === timescale ?\n    { time: newSegment.time,\n      duration: newSegment.duration, } :\n    { time: (newSegment.time / newSegment.timescale) * timescale,\n      duration: (newSegment.duration / newSegment.timescale) * timescale };\n\n  let scaledCurrentTime;\n\n  if (currentSegment && currentSegment.timescale) {\n    scaledCurrentTime = currentSegment.timescale === timescale ?\n      currentSegment.time :\n      (currentSegment.time / currentSegment.timescale) * timescale;\n  }\n\n  // in some circumstances, the new segment information are only duration\n  // information that we could use to deduct the start of the next segment.\n  // This is the case where the new segment are associated to a current\n  // segment and have the same start.\n  // However, we prefer to be sure of the duration of the new segments\n  // before adding such segments.\n  const shouldDeductNextSegment = scaledCurrentTime != null &&\n    (scaledNewSegment.time === scaledCurrentTime);\n  if (shouldDeductNextSegment) {\n    return false;\n  } else if (scaledNewSegment.time >= getIndexSegmentEnd(last, null)) {\n    // if the given timing has a timestamp after the timeline end we\n    // just need to push a new element in the timeline, or increase\n    // the @r attribute of the last element.\n    if (last.duration === scaledNewSegment.duration) {\n      last.repeatCount++;\n    } else {\n      index.timeline.push({ duration: scaledNewSegment.duration,\n                            start: scaledNewSegment.time,\n                            repeatCount: 0 });\n    }\n    return true;\n  }\n\n  return false;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @param {string} url\n * @param {string|number} bitrate\n * @returns {string}\n */\nfunction replaceRepresentationSmoothTokens(\n    url : string,\n    bitrate : string|number,\n    customAttributes : string[]\n  ) : string {\n    return url.replace(/\\{bitrate\\}/g, String(bitrate))\n              .replace(/{CustomAttributes}/g, customAttributes.length > 0 ?\n                                                customAttributes[0] :\n                                                \"\");\n  }\n\n/**\n * @param {string} url\n * @param {number} time\n * @returns {string}\n */\nfunction replaceSegmentSmoothTokens(url : string, time : number) : string {\n  return url.replace(/\\{start time\\}/g, String(time));\n}\n\nexport {\n  replaceRepresentationSmoothTokens,\n  replaceSegmentSmoothTokens\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n ICustomError,\n NetworkError,\n} from \"../../../errors\";\nimport log from \"../../../log\";\nimport {\n  IRepresentationIndex,\n  ISegment,\n} from \"../../../manifest\";\nimport clearTimelineFromPosition from \"../utils/clear_timeline_from_position\";\nimport { getIndexSegmentEnd } from \"../utils/index_helpers\";\nimport isSegmentStillAvailable from \"../utils/is_segment_still_available\";\nimport addSegmentInfos from \"./utils/add_segment_infos\";\nimport { replaceSegmentSmoothTokens } from \"./utils/tokens\";\n\nexport interface IIndexSegment { start : number;\n                                 duration : number;\n                                 repeatCount: number; }\n\ninterface ITimelineIndex { presentationTimeOffset? : number;\n                           timescale : number;\n                           media : string;\n                           timeline : IIndexSegment[];\n                           startNumber? : number;\n                           isLive : boolean;\n                           timeShiftBufferDepth? : number;\n                           manifestReceivedTime? : number; }\n\n/**\n * Get index of the segment containing the given timescaled timestamp.\n * @param {Object} index\n * @param {Number} start\n * @returns {Number}\n */\nfunction getSegmentIndex(index : ITimelineIndex, start : number) : number {\n  const { timeline } = index;\n\n  let low = 0;\n  let high = timeline.length;\n\n  while (low < high) {\n    const mid = (low + high) >>> 1;\n    if (timeline[mid].start < start) {\n      low = mid + 1;\n    } else {\n      high = mid;\n    }\n  }\n\n  return (low > 0) ? low - 1 :\n                     low;\n}\n\n/**\n * @param {Number} start\n * @param {Number} up\n * @param {Number} duration\n * @returns {Number}\n */\nfunction getSegmentNumber(\n  start : number,\n  up : number,\n  duration : number\n) : number {\n  const diff = up - start;\n  return diff > 0 ? Math.floor(diff / duration) :\n                    0;\n}\n\n// interface ISmoothIndex {\n//   presentationTimeOffset? : number;\n//   timescale : number;\n//   media? : string;\n//   timeline : IIndexSegment[];\n//   startNumber? : number;\n// }\n\n/**\n * Convert second-based start time and duration to the timescale of the\n * manifest's index.\n * @param {Object} index\n * @param {Number} start\n * @param {Number} duration\n * @returns {Object} - Object with two properties:\n *   - up {Number}: timescaled timestamp of the beginning time\n *   - to {Number}: timescaled timestamp of the end time (start time + duration)\n */\nfunction normalizeRange(\n  index: { timescale?: number },\n  start: number,\n  duration: number\n) : { up: number;\n      to: number; }\n{\n  const timescale = index.timescale || 1;\n\n  return { up: start * timescale,\n           to: (start + duration) * timescale };\n}\n\n/**\n * Calculate the number of times a segment repeat based on the next segment.\n * @param {Object} segment\n * @param {Object} nextSegment\n * @returns {Number}\n */\nfunction calculateRepeat(\n  segment : IIndexSegment,\n  nextSegment : IIndexSegment\n) : number {\n  let repeatCount = segment.repeatCount || 0;\n\n  // A negative value of the @r attribute of the S element indicates\n  // that the duration indicated in @d attribute repeats until the\n  // start of the next S element, the end of the Period or until the\n  // next MPD update.\n  // TODO Also for SMOOTH????\n  if (segment.duration != null && repeatCount < 0) {\n    const repeatEnd = nextSegment ? nextSegment.start : Infinity;\n    repeatCount = Math.ceil((repeatEnd - segment.start) / segment.duration) - 1;\n  }\n\n  return repeatCount;\n}\n\nexport interface ISmoothRIOptions {\n  aggressiveMode : boolean;\n  isLive : boolean;\n  segmentPrivateInfos : ISmoothInitSegmentPrivateInfos;\n}\n\ninterface ISmoothInitSegmentPrivateInfos {\n  bitsPerSample? : number;\n  channels? : number;\n  codecPrivateData? : string;\n  packetSize? : number;\n  samplingRate? : number;\n  protection? : { keyId : Uint8Array;\n                  keySystems: Array<{ systemId : string;\n                                      privateData : Uint8Array; }>; };\n}\n\n/**\n * RepresentationIndex implementation for Smooth Manifests.\n *\n * Allows to interact with the index to create new Segments.\n *\n * @class SmoothRepresentationIndex\n */\nexport default class SmoothRepresentationIndex implements IRepresentationIndex {\n  // Information needed to generate an initialization segment.\n  // Taken from the Manifest.\n  private _initSegmentInfos : { codecPrivateData? : string;\n                                bitsPerSample? : number;\n                                channels? : number;\n                                packetSize? : number;\n                                samplingRate? : number;\n                                protection? : { keyId : Uint8Array;\n                                                keySystems: Array<{\n                                                  systemId : string;\n                                                  privateData : Uint8Array;\n                                                }>; }; };\n\n  // if true, this class will return segments even if we're not sure they had\n  // time to be generated on the server side.\n  private _isAggressiveMode : boolean;\n\n  // (only calculated for live contents)\n  // Calculates the difference, in timescale, between the current time (as\n  // calculated via performance.now()) and the time of the last segment known\n  // to have been generated on the server-side.\n  // Useful to know if a segment present in the timeline has actually been\n  // generated on the server-side\n  private _scaledLiveGap? : number;\n\n  // Defines the end of the latest available segment when this index was known to\n  // be valid, in the index's timescale.\n  private _initialScaledLastPosition? : number;\n\n  // Defines the earliest time when this index was known to be valid (that is, when\n  // all segments declared in it are available). This means either:\n  //   - the manifest downloading time, if known\n  //   - else, the time of creation of this RepresentationIndex, as the best guess\n  private _indexValidityTime : number;\n\n  private _isLive : boolean;\n\n  private _index : ITimelineIndex;\n\n  constructor(index : ITimelineIndex, options : ISmoothRIOptions) {\n    const { aggressiveMode, isLive, segmentPrivateInfos } = options;\n    const estimatedReceivedTime = index.manifestReceivedTime == null ?\n      performance.now() :\n      index.manifestReceivedTime;\n    this._index = index;\n    this._indexValidityTime = estimatedReceivedTime;\n\n    this._initSegmentInfos = { bitsPerSample: segmentPrivateInfos.bitsPerSample,\n                               channels: segmentPrivateInfos.channels,\n                               codecPrivateData: segmentPrivateInfos.codecPrivateData,\n                               packetSize: segmentPrivateInfos.packetSize,\n                               samplingRate: segmentPrivateInfos.samplingRate,\n                               protection: segmentPrivateInfos.protection };\n\n    this._isAggressiveMode = aggressiveMode;\n    this._isLive = isLive;\n\n    if (index.timeline.length) {\n      const lastItem = index.timeline[index.timeline.length - 1];\n      const scaledEnd = getIndexSegmentEnd(lastItem, null);\n      this._initialScaledLastPosition = scaledEnd;\n\n      if (index.isLive) {\n        const scaledReceivedTime = (estimatedReceivedTime / 1000) * index.timescale;\n        this._scaledLiveGap = scaledReceivedTime - scaledEnd;\n      }\n    }\n  }\n\n  /**\n   * Construct init Segment compatible with a Smooth Manifest.\n   * @returns {Object}\n   */\n  getInitSegment() : ISegment {\n    return { id: \"init\",\n             isInit: true,\n             time: 0,\n             duration: 0,\n             timescale: this._index.timescale,\n             privateInfos: { smoothInit: this._initSegmentInfos },\n             mediaURL: null };\n  }\n\n  /**\n   * Generate a list of Segments for a particular period of time.\n   *\n   * @param {Number} _up\n   * @param {Number} _to\n   * @returns {Array.<Object>}\n   */\n  getSegments(_up : number, _to : number) : ISegment[] {\n    this._refreshTimeline();\n    const { up, to } = normalizeRange(this._index, _up, _to);\n    const { timeline, timescale, media } = this._index;\n    const isAggressive = this._isAggressiveMode;\n\n    let currentNumber : number|undefined;\n    const segments : ISegment[] = [];\n\n    const timelineLength = timeline.length;\n\n    const maxPosition = this._scaledLiveGap == null ?\n      undefined :\n      ((performance.now() / 1000) * timescale) - this._scaledLiveGap;\n\n    for (let i = 0; i < timelineLength; i++) {\n      const segmentRange = timeline[i];\n      const { duration, start } = segmentRange;\n      const repeat = calculateRepeat(segmentRange, timeline[i + 1]);\n      let segmentNumberInCurrentRange = getSegmentNumber(start, up, duration);\n      let segmentTime = start + segmentNumberInCurrentRange * duration;\n      const timeToAddToCheckMaxPosition = isAggressive ? 0 :\n                                                         duration;\n      while (segmentTime < to &&\n             segmentNumberInCurrentRange <= repeat &&\n             (maxPosition == null ||\n             (segmentTime + timeToAddToCheckMaxPosition) <= maxPosition))\n      {\n        const time = segmentTime;\n        const number = currentNumber != null ?\n          currentNumber + segmentNumberInCurrentRange :\n          undefined;\n        const segment = { id: \"\" + segmentTime,\n                          time,\n                          isInit: false,\n                          duration,\n                          timescale,\n                          number,\n                          mediaURL: replaceSegmentSmoothTokens(media, time) };\n        segments.push(segment);\n\n        // update segment number and segment time for the next segment\n        segmentNumberInCurrentRange++;\n        segmentTime = start + segmentNumberInCurrentRange * duration;\n      }\n\n      if (segmentTime >= to) {\n        // we reached ``to``, we're done\n        return segments;\n      }\n\n      if (currentNumber != null) {\n        currentNumber += repeat + 1;\n      }\n    }\n\n    return segments;\n  }\n\n  /**\n   * Returns true if, based on the arguments, the index should be refreshed.\n   * (If we should re-fetch the manifest)\n   * @param {Number} up\n   * @param {Number} to\n   * @returns {Boolean}\n   */\n  shouldRefresh(up : number, to : number) : boolean {\n    this._refreshTimeline();\n    if (!this._index.isLive) {\n      return false;\n    }\n    const { timeline, timescale } = this._index;\n\n    const lastSegmentInCurrentTimeline = timeline[timeline.length - 1];\n    if (!lastSegmentInCurrentTimeline) {\n      return false;\n    }\n\n    const repeat = lastSegmentInCurrentTimeline.repeatCount || 0;\n    const endOfLastSegmentInCurrentTimeline =\n      lastSegmentInCurrentTimeline.start + (repeat + 1) *\n        lastSegmentInCurrentTimeline.duration;\n\n    if (to * timescale < endOfLastSegmentInCurrentTimeline) {\n      return false;\n    }\n\n    if (up * timescale >= endOfLastSegmentInCurrentTimeline) {\n      return true;\n    }\n\n    // ----\n\n    const startOfLastSegmentInCurrentTimeline =\n      lastSegmentInCurrentTimeline.start + repeat *\n        lastSegmentInCurrentTimeline.duration;\n\n    return (up * timescale) > startOfLastSegmentInCurrentTimeline;\n  }\n\n  /**\n   * Returns first position available in the index.\n   *\n   * @param {Object} index\n   * @returns {Number|null}\n   */\n  getFirstPosition() : number|null {\n    this._refreshTimeline();\n    const index = this._index;\n    if (!index.timeline.length) {\n      return null;\n    }\n    return index.timeline[0].start / index.timescale;\n  }\n\n  /**\n   * Returns last position available in the index.\n   * @param {Object} index\n   * @returns {Number}\n   */\n  getLastPosition() : number|undefined {\n    this._refreshTimeline();\n    const index = this._index;\n\n    if (this._scaledLiveGap == null) {\n      const lastTimelineElement = index.timeline[index.timeline.length - 1];\n      return getIndexSegmentEnd(lastTimelineElement, null) / index.timescale;\n    }\n\n    for (let i = index.timeline.length - 1; i >= 0; i--) {\n      const timelineElt = index.timeline[i];\n      const timescaledNow = (performance.now() / 1000) * index.timescale;\n      const { start, duration, repeatCount } = timelineElt;\n      for (let j = repeatCount; j >= 0; j--) {\n        const end = start + (duration * (j + 1));\n        const positionToReach = this._isAggressiveMode ? end - duration :\n                                                         end;\n        if (positionToReach <= timescaledNow - this._scaledLiveGap) {\n          return end / index.timescale;\n        }\n      }\n    }\n    return undefined;\n  }\n\n  /**\n   * Checks if the time given is in a discontinuity. That is:\n   *   - We're on the upper bound of the current range (end of the range - time\n   *     is inferior to the timescale)\n   *   - The next range starts after the end of the current range.\n   *\n   * @param {Number} _time\n   * @returns {Number} - If a discontinuity is present, this is the Starting\n   * time for the next (discontinuited) range. If not this is equal to -1.\n   */\n  checkDiscontinuity(_time : number) : number {\n    this._refreshTimeline();\n    const index = this._index;\n    const { timeline, timescale = 1 } = index;\n    const time = _time * timescale;\n\n    if (time <= 0) {\n      return -1;\n    }\n\n    const segmentIndex = getSegmentIndex(index, time);\n    if (segmentIndex < 0 || segmentIndex >= timeline.length - 1) {\n      return -1;\n    }\n\n    const range = timeline[segmentIndex];\n    if (range.duration === -1) {\n      return -1;\n    }\n\n    const rangeUp = range.start;\n    const rangeTo = getIndexSegmentEnd(range, null);\n    const nextRange = timeline[segmentIndex + 1];\n\n    // when we are actually inside the found range and this range has\n    // an explicit discontinuity with the next one\n    if (rangeTo !== nextRange.start &&\n        time >= rangeUp &&\n        time <= rangeTo &&\n        (rangeTo - time) < timescale) {\n      return nextRange.start / timescale;\n    }\n\n    return -1;\n  }\n\n  isSegmentStillAvailable(segment : ISegment) : boolean | undefined {\n    if (segment.isInit) {\n      return true;\n    }\n    this._refreshTimeline();\n    const { timeline, timescale } = this._index;\n    return isSegmentStillAvailable(segment, timeline, timescale, 0);\n  }\n\n  /**\n   * @param {Error} error\n   * @returns {Boolean}\n   */\n  canBeOutOfSyncError(error : ICustomError) : boolean {\n    if (!this._isLive) {\n      return false;\n    }\n    return error instanceof NetworkError &&\n           (error.isHttpError(404) || error.isHttpError(412));\n  }\n\n  /**\n   * Update this RepresentationIndex by a newly downloaded one.\n   * Check if the old index had more information about new segments and re-add\n   * them if that's the case.\n   * @param {Object} newIndex\n   */\n  _update(newIndex : SmoothRepresentationIndex) : void {\n    const oldTimeline = this._index.timeline;\n    const newTimeline = newIndex._index.timeline;\n    const oldTimescale = this._index.timescale;\n    const newTimescale = newIndex._index.timescale;\n\n    this._index = newIndex._index;\n    this._initialScaledLastPosition = newIndex._initialScaledLastPosition;\n    this._indexValidityTime = newIndex._indexValidityTime;\n    this._scaledLiveGap = newIndex._scaledLiveGap;\n\n    if (!oldTimeline.length || !newTimeline.length || oldTimescale !== newTimescale) {\n      return; // don't take risk, if something is off, take the new one\n    }\n\n    const lastOldTimelineElement = oldTimeline[oldTimeline.length - 1];\n    const lastNewTimelineElement = newTimeline[newTimeline.length - 1];\n    const newEnd = getIndexSegmentEnd(lastNewTimelineElement, null);\n    if (getIndexSegmentEnd(lastOldTimelineElement, null) <= newEnd) {\n      return;\n    }\n\n    for (let i = 0; i < oldTimeline.length; i++) {\n      const oldTimelineRange = oldTimeline[i];\n      const oldEnd = getIndexSegmentEnd(oldTimelineRange, null);\n      if (oldEnd === newEnd) { // just add the supplementary segments\n        this._index.timeline = this._index.timeline.concat(oldTimeline.slice(i + 1));\n        return;\n      }\n\n      if (oldEnd > newEnd) { // adjust repeatCount + add supplementary segments\n        if (oldTimelineRange.duration !== lastNewTimelineElement.duration) {\n          return;\n        }\n\n        const rangeDuration = newEnd - oldTimelineRange.start;\n        if (rangeDuration === 0) {\n          log.warn(\"Smooth Parser: a discontinuity detected in the previous manifest\" +\n            \" has been resolved.\");\n          this._index.timeline = this._index.timeline.concat(oldTimeline.slice(i));\n          return;\n        }\n        if (rangeDuration < 0 || rangeDuration % oldTimelineRange.duration !== 0) {\n          return;\n        }\n\n        const repeatWithOld = (rangeDuration / oldTimelineRange.duration) - 1;\n        const relativeRepeat = oldTimelineRange.repeatCount - repeatWithOld;\n        if (relativeRepeat < 0) {\n          return;\n        }\n        lastNewTimelineElement.repeatCount += relativeRepeat;\n        const supplementarySegments = oldTimeline.slice(i + 1);\n        this._index.timeline = this._index.timeline.concat(supplementarySegments);\n        return;\n      }\n    }\n  }\n\n  /**\n   * @returns {Boolean | undefined}\n   */\n  isFinished() : boolean {\n    return !this._isLive;\n  }\n\n  _addSegments(\n    nextSegments : Array<{ duration : number;\n                           time : number;\n                           timescale : number; }>,\n    currentSegment : { duration : number;\n                       time : number;\n                       timescale : number; }\n  ) : void {\n    this._refreshTimeline();\n    for (let i = 0; i < nextSegments.length; i++) {\n      addSegmentInfos(this._index, nextSegments[i], currentSegment);\n    }\n  }\n\n  /**\n   * Clean-up timeline to remove segment information which should not be\n   * available due to the timeshift window\n   */\n  private _refreshTimeline() : void {\n    // clean segments before time shift buffer depth\n    if (this._initialScaledLastPosition == null) {\n      return;\n    }\n    const index = this._index;\n    const {timeShiftBufferDepth } = index;\n    const timeSinceLastRealUpdate = (performance.now() -\n                                     this._indexValidityTime) / 1000;\n    const lastPositionEstimate = timeSinceLastRealUpdate +\n                                 this._initialScaledLastPosition / index.timescale;\n\n    if (timeShiftBufferDepth != null) {\n      const minimumPosition = (lastPositionEstimate - timeShiftBufferDepth) *\n                              index.timescale;\n      clearTimelineFromPosition(index.timeline, minimumPosition);\n    }\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @param {*} parseBoolean\n * @returns {Boolean}\n */\nexport default function parseBoolean(val : string|null) : boolean {\n  if (typeof val === \"boolean\") {\n    return val;\n  }\n  else if (typeof val === \"string\") {\n    return val.toUpperCase() === \"TRUE\";\n  }\n  else {\n    return false;\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Reduce implementation for the children of the given element.\n * @param {Element} root\n * @param {Function} fn\n * @param {*} init\n * @returns {*}\n */\nexport default function reduceChildren<T>(\n  root : Element,\n  fn : (accumulator : T, nodeName : string, node : Element) => T,\n  init : T\n) : T {\n  let node = root.firstElementChild;\n  let accumulator = init;\n  while (node) {\n    accumulator = fn(accumulator, node.nodeName, node);\n    node = node.nextElementSibling;\n  }\n  return accumulator;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport objectAssign from \"object-assign\";\nimport log from \"../../../log\";\nimport assert from \"../../../utils/assert\";\nimport idGenerator from \"../../../utils/id_generator\";\nimport resolveURL, {\n  normalizeBaseURL,\n} from \"../../../utils/resolve_url\";\nimport {\n  IContentProtection,\n  IParsedAdaptation,\n  IParsedAdaptations,\n  IParsedManifest,\n  IParsedRepresentation,\n} from \"../types\";\nimport checkManifestIDs from \"../utils/check_manifest_ids\";\nimport {\n  getAudioCodecs,\n  getVideoCodecs,\n} from \"./get_codecs\";\nimport parseCNodes from \"./parse_C_nodes\";\nimport parseProtectionNode, {\n  IContentProtectionSmooth,\n  IKeySystem,\n} from \"./parse_protection_node\";\nimport RepresentationIndex from \"./representation_index\";\nimport parseBoolean from \"./utils/parseBoolean\";\nimport reduceChildren from \"./utils/reduceChildren\";\nimport {replaceRepresentationSmoothTokens } from \"./utils/tokens\";\n\n/**\n * Default value for the aggressive `mode`.\n * In this mode, segments will be returned even if we're not sure those had time\n * to be generated.\n */\nconst DEFAULT_AGGRESSIVE_MODE = false;\n\nconst generateManifestID = idGenerator();\n\ninterface IAdaptationParserArguments {\n  root : Element;\n  rootURL : string;\n  timescale : number;\n  protections : IContentProtectionSmooth[];\n  isLive : boolean;\n  timeShiftBufferDepth? : number;\n  manifestReceivedTime? : number;\n}\n\nconst DEFAULT_MIME_TYPES: Partial<Record<string, string>> = {\n  audio: \"audio/mp4\",\n  video: \"video/mp4\",\n  text: \"application/ttml+xml\",\n};\n\nconst DEFAULT_CODECS: Partial<Record<string, string>> = {\n  audio: \"mp4a.40.2\",\n  video: \"avc1.4D401E\",\n};\n\nconst MIME_TYPES: Partial<Record<string, string>> = {\n  AACL: \"audio/mp4\",\n  AVC1: \"video/mp4\",\n  H264: \"video/mp4\",\n  TTML: \"application/ttml+xml+mp4\",\n};\n\nexport interface IHSSParserConfiguration {\n  aggressiveMode? : boolean;\n  suggestedPresentationDelay? : number;\n  referenceDateTime? : number;\n  minRepresentationBitrate? : number;\n  keySystems? : (hex? : Uint8Array) => IKeySystem[];\n}\n\ninterface ISmoothParsedQualityLevel {\n  // required\n  bitrate : number;\n  codecPrivateData : string;\n  customAttributes : string[];\n\n  // optional\n  audiotag? : number;\n  bitsPerSample? : number;\n  channels? : number;\n  codecs? : string;\n  height? : number;\n  id? : string;\n  mimeType? : string;\n  packetSize? : number;\n  samplingRate? : number;\n  width? : number;\n}\n\n/**\n * @param {Object|undefined} parserOptions\n * @returns {Function}\n */\nfunction createSmoothStreamingParser(\n  parserOptions : IHSSParserConfiguration = {}\n) : (\n  manifest : Document,\n  url? : string,\n  manifestReceivedTime? : number\n) => IParsedManifest {\n\n  const SUGGESTED_PERSENTATION_DELAY = parserOptions.suggestedPresentationDelay;\n\n  const REFERENCE_DATE_TIME = parserOptions.referenceDateTime ||\n    Date.UTC(1970, 0, 1, 0, 0, 0, 0) / 1000;\n  const MIN_REPRESENTATION_BITRATE = parserOptions.minRepresentationBitrate ||\n    0;\n\n  /**\n   * @param {Element} q\n   * @param {string} streamType\n   * @return {Object}\n   */\n  function parseQualityLevel(\n    q : Element,\n    streamType : string\n  ) : ISmoothParsedQualityLevel|null {\n\n    const customAttributes = reduceChildren<string[]>(q, (acc, qName, qNode) => {\n      if (qName === \"CustomAttributes\") {\n        acc.push(...reduceChildren<string[]>(qNode, (cAttrs, cName, cNode) => {\n          if (cName === \"Attribute\") {\n            const name = cNode.getAttribute(\"Name\");\n            const value = cNode.getAttribute(\"Value\");\n            if (name !== null && value !== null) {\n              cAttrs.push(name + \"=\" + value);\n            }\n          }\n          return cAttrs;\n        }, []));\n      }\n      return acc;\n    }, []);\n\n    /**\n     * @param {string} name\n     * @returns {string|undefined}\n     */\n    function getAttribute(name: string) : string|undefined {\n      const attr = q.getAttribute(name);\n      return attr == null ? undefined : attr;\n    }\n\n    switch (streamType) {\n\n      case \"audio\": {\n        const audiotag = getAttribute(\"AudioTag\");\n        const bitrate = getAttribute(\"Bitrate\");\n        const bitsPerSample = getAttribute(\"BitsPerSample\");\n        const channels = getAttribute(\"Channels\");\n        const codecPrivateData = getAttribute(\"CodecPrivateData\");\n        const fourCC = getAttribute(\"FourCC\");\n        const packetSize = getAttribute(\"PacketSize\");\n        const samplingRate = getAttribute(\"SamplingRate\");\n\n        return {\n          audiotag: audiotag !== undefined ? parseInt(audiotag, 10) : audiotag,\n          bitrate: bitrate ? parseInt(bitrate, 10) || 0 : 0,\n          bitsPerSample: bitsPerSample !== undefined ?\n            parseInt(bitsPerSample, 10) : bitsPerSample,\n          channels: channels !== undefined ? parseInt(channels, 10) : channels,\n          codecPrivateData: codecPrivateData || \"\",\n          customAttributes,\n          mimeType: fourCC !== undefined ? MIME_TYPES[fourCC] : fourCC,\n          packetSize: packetSize !== undefined ?\n            parseInt(packetSize, 10) : packetSize,\n          samplingRate: samplingRate !== undefined ?\n            parseInt(samplingRate, 10) : samplingRate,\n        };\n      }\n\n      case \"video\": {\n        const bitrate = getAttribute(\"Bitrate\");\n        const codecPrivateData = getAttribute(\"CodecPrivateData\");\n        const fourCC = getAttribute(\"FourCC\");\n        const width = getAttribute(\"MaxWidth\");\n        const height = getAttribute(\"MaxHeight\");\n\n        return {\n          bitrate: bitrate ? parseInt(bitrate, 10) || 0 : 0,\n          customAttributes,\n          mimeType: fourCC !== undefined ? MIME_TYPES[fourCC] : fourCC,\n          codecPrivateData: codecPrivateData || \"\",\n          codecs: getVideoCodecs(codecPrivateData || \"\"),\n          width: width !== undefined ? parseInt(width, 10) : undefined,\n          height: height !== undefined ? parseInt(height, 10) : undefined,\n        };\n      }\n\n      case \"text\": {\n        const bitrate = getAttribute(\"Bitrate\");\n        const codecPrivateData = getAttribute(\"CodecPrivateData\");\n        const fourCC = getAttribute(\"FourCC\");\n        return {\n          bitrate: bitrate ? parseInt(bitrate, 10) || 0 : 0,\n          customAttributes,\n          mimeType: fourCC !== undefined ? MIME_TYPES[fourCC] : fourCC,\n          codecPrivateData: codecPrivateData || \"\",\n        };\n      }\n\n      default:\n        log.error(\"Smooth Parser: Unrecognized StreamIndex type: \" + streamType);\n        return null;\n    }\n  }\n\n  /**\n   * Parse the adaptations (<StreamIndex>) tree containing\n   * representations (<QualityLevels>) and timestamp indexes (<c>).\n   * Indexes can be quite huge, and this function needs to\n   * to be optimized.\n   * @param {Object} args\n   * @returns {Object}\n   */\n  function parseAdaptation(args: IAdaptationParserArguments) : IParsedAdaptation|null {\n    const { root,\n            timescale,\n            rootURL,\n            protections,\n            timeShiftBufferDepth,\n            manifestReceivedTime,\n            isLive }= args;\n    const _timescale = root.hasAttribute(\"Timescale\") ?\n      +(root.getAttribute(\"Timescale\") || 0) : timescale;\n\n    const adaptationType = root.getAttribute(\"Type\");\n    if (adaptationType == null) {\n      throw new Error(\"StreamIndex without type.\");\n    }\n\n    const subType = root.getAttribute(\"Subtype\");\n    const language = root.getAttribute(\"Language\");\n    const baseURL = root.getAttribute(\"Url\") || \"\";\n    if (__DEV__) {\n      assert(baseURL !== \"\");\n    }\n\n    const {\n      qualityLevels,\n      cNodes,\n    } = reduceChildren<{\n      qualityLevels: ISmoothParsedQualityLevel[];\n      cNodes : Element[];\n    }>(root, (res, _name, node) => {\n      switch (_name) {\n        case \"QualityLevel\":\n          const qualityLevel = parseQualityLevel(node, adaptationType);\n          if (qualityLevel === null) {\n            return res;\n          }\n          if (adaptationType === \"audio\") {\n            const fourCC = node.getAttribute(\"FourCC\") || \"\";\n\n            qualityLevel.codecs = getAudioCodecs(fourCC,\n                                                 qualityLevel.codecPrivateData);\n          }\n\n          // filter out video qualityLevels with small bitrates\n          if (adaptationType !== \"video\" ||\n              qualityLevel.bitrate > MIN_REPRESENTATION_BITRATE)\n          {\n            res.qualityLevels.push(qualityLevel);\n          }\n          break;\n        case \"c\":\n          res.cNodes.push(node);\n          break;\n      }\n      return res;\n    }, { qualityLevels: [], cNodes: [] });\n\n    const index = {\n      timeline: parseCNodes(cNodes),\n      timescale: _timescale,\n    };\n\n    // we assume that all qualityLevels have the same\n    // codec and mimeType\n    assert(\n      qualityLevels.length !== 0,\n      \"adaptation should have at least one representation\"\n    );\n\n    const adaptationID = adaptationType + (language ? (\"_\" + language) : \"\");\n\n    const representations = qualityLevels.map((qualityLevel) => {\n      const path = resolveURL(rootURL, baseURL);\n      const repIndex = {\n        timeline: index.timeline,\n        timescale: index.timescale,\n        media: replaceRepresentationSmoothTokens(path,\n                                                 qualityLevel.bitrate,\n                                                 qualityLevel.customAttributes),\n        isLive,\n        timeShiftBufferDepth,\n        manifestReceivedTime,\n      };\n      const mimeType = qualityLevel.mimeType || DEFAULT_MIME_TYPES[adaptationType];\n      const codecs = qualityLevel.codecs || DEFAULT_CODECS[adaptationType];\n      const id =  adaptationID + \"_\" + adaptationType + \"-\" + mimeType + \"-\" +\n        codecs + \"-\" + qualityLevel.bitrate;\n\n      const contentProtections : IContentProtection[] = [];\n      let firstProtection : IContentProtectionSmooth|undefined;\n      if (protections.length) {\n        firstProtection = protections[0];\n        protections.forEach((protection) => {\n          const keyId = protection.keyId;\n          protection.keySystems.forEach((keySystem) => {\n            contentProtections.push({\n              keyId,\n              systemId: keySystem.systemId,\n            });\n          });\n        });\n      }\n\n      const segmentPrivateInfos = {\n        bitsPerSample: qualityLevel.bitsPerSample,\n        channels: qualityLevel.channels,\n        codecPrivateData: qualityLevel.codecPrivateData || \"\",\n        packetSize: qualityLevel.packetSize,\n        samplingRate: qualityLevel.samplingRate,\n\n        // TODO set multiple protections here instead of the first one\n        protection: firstProtection != null ? {\n          keyId: firstProtection.keyId,\n          keySystems: firstProtection.keySystems,\n        } : undefined,\n      };\n\n      const representation : IParsedRepresentation = objectAssign({}, qualityLevel, {\n        index: new RepresentationIndex(repIndex, {\n                 aggressiveMode: parserOptions.aggressiveMode == null ?\n                   DEFAULT_AGGRESSIVE_MODE : parserOptions.aggressiveMode,\n                 isLive,\n                 segmentPrivateInfos,\n               }),\n        mimeType,\n        codecs,\n        id,\n      });\n      if (contentProtections.length) {\n        representation.contentProtections = contentProtections;\n      }\n      return representation;\n    });\n\n    // TODO(pierre): real ad-insert support\n    if (subType === \"ADVT\") {\n      return null;\n    }\n\n    const parsedAdaptation : IParsedAdaptation = {\n      id: adaptationID,\n      type: adaptationType,\n      representations,\n      language: language == null ?  undefined : language,\n    };\n\n    if (adaptationType === \"text\" && subType === \"DESC\") {\n      parsedAdaptation.closedCaption = true;\n    }\n\n    return parsedAdaptation;\n  }\n\n  function parseFromDocument(\n    doc : Document,\n    url? : string,\n    manifestReceivedTime? : number\n  ) : IParsedManifest {\n    const rootURL = normalizeBaseURL(url == null ? \"\" : url);\n    const root = doc.documentElement;\n    if (!root || root.nodeName !== \"SmoothStreamingMedia\") {\n      throw new Error(\"document root should be SmoothStreamingMedia\");\n    }\n    if (!\n      /^[2]-[0-2]$/.test(\n        root.getAttribute(\"MajorVersion\") + \"-\" + root.getAttribute(\"MinorVersion\")\n      )\n    ) {\n      throw new Error(\"Version should be 2.0, 2.1 or 2.2\");\n    }\n\n    const timescale = +(root.getAttribute(\"Timescale\") || 10000000);\n\n    const {\n      protections,\n      adaptationNodes,\n    } = reduceChildren <{\n      protections: IContentProtectionSmooth[];\n      adaptationNodes: Element[];\n    }> (root, (res, name, node) => {\n      switch (name) {\n      case \"Protection\":  {\n        res.protections.push(parseProtectionNode(node, parserOptions.keySystems));\n        break;\n      }\n      case \"StreamIndex\":\n        res.adaptationNodes.push(node);\n        break;\n      }\n      return res;\n    }, {\n      adaptationNodes: [],\n      protections : [],\n    });\n\n    const initialAdaptations: IParsedAdaptations = {};\n\n    const isLive = parseBoolean(root.getAttribute(\"IsLive\"));\n\n    let timeShiftBufferDepth : number|undefined;\n    if (isLive) {\n      const dvrWindowLength = root.getAttribute(\"DVRWindowLength\");\n      if (dvrWindowLength != null &&\n          !isNaN(+dvrWindowLength) &&\n          +dvrWindowLength !== 0)\n      {\n        timeShiftBufferDepth = +dvrWindowLength / timescale;\n      }\n    }\n\n    const adaptations: IParsedAdaptations = adaptationNodes\n      .map((node: Element) => {\n        return parseAdaptation({ root: node,\n                                 rootURL,\n                                 timescale,\n                                 protections,\n                                 isLive,\n                                 timeShiftBufferDepth,\n                                 manifestReceivedTime });\n      })\n      .filter((adaptation) : adaptation is IParsedAdaptation => adaptation != null)\n      .reduce((acc: IParsedAdaptations, adaptation) => {\n        const type = adaptation.type;\n        if (acc[type] === undefined) {\n          acc[type] = [adaptation];\n        } else {\n          (acc[type] || []).push(adaptation);\n        }\n        return acc;\n      }, initialAdaptations);\n\n    let suggestedPresentationDelay : number|undefined;\n    let availabilityStartTime : number|undefined;\n    let minimumTime : { isContinuous : boolean; value : number; time : number}|undefined;\n    let maximumTime : { isContinuous : boolean; value : number; time : number}|undefined;\n\n    const firstVideoAdaptation = adaptations.video ? adaptations.video[0] : undefined;\n    const firstAudioAdaptation = adaptations.audio ? adaptations.audio[0] : undefined;\n    let firstTimeReference : number|undefined;\n    let lastTimeReference : number|undefined;\n\n    if (firstVideoAdaptation || firstAudioAdaptation) {\n      const firstTimeReferences : number[] = [];\n      const lastTimeReferences : number[] = [];\n\n      if (firstVideoAdaptation) {\n        const firstVideoRepresentation = firstVideoAdaptation.representations[0];\n        if (firstVideoRepresentation) {\n          const firstVideoTimeReference =\n            firstVideoRepresentation.index.getFirstPosition();\n          const lastVideoTimeReference =\n            firstVideoRepresentation.index.getLastPosition();\n\n          if (firstVideoTimeReference != null) {\n            firstTimeReferences.push(firstVideoTimeReference);\n          }\n\n          if (lastVideoTimeReference != null) {\n            lastTimeReferences.push(lastVideoTimeReference);\n          }\n        }\n      }\n\n      if (firstAudioAdaptation) {\n        const firstAudioRepresentation = firstAudioAdaptation.representations[0];\n        if (firstAudioRepresentation) {\n          const firstAudioTimeReference =\n            firstAudioRepresentation.index.getFirstPosition();\n          const lastAudioTimeReference =\n            firstAudioRepresentation.index.getLastPosition();\n\n          if (firstAudioTimeReference != null) {\n            firstTimeReferences.push(firstAudioTimeReference);\n          }\n\n          if (lastAudioTimeReference != null) {\n            lastTimeReferences.push(lastAudioTimeReference);\n          }\n        }\n      }\n\n      if (firstTimeReferences.length) {\n        firstTimeReference = Math.max(...firstTimeReferences);\n      }\n\n      if (lastTimeReferences.length) {\n        lastTimeReference = Math.min(...lastTimeReferences);\n      }\n    }\n\n    let periodStart : number;\n    let duration : number|undefined;\n    if (isLive) {\n      periodStart = 0;\n      suggestedPresentationDelay = SUGGESTED_PERSENTATION_DELAY;\n      availabilityStartTime = REFERENCE_DATE_TIME;\n\n      const time = performance.now();\n      maximumTime = { isContinuous: true,\n                      value: lastTimeReference != null ?\n                        lastTimeReference :\n                        (Date.now() / 1000 - availabilityStartTime),\n                      time };\n      if (timeShiftBufferDepth == null) {\n        // infinite buffer\n        minimumTime = { isContinuous: false,\n                        value: firstTimeReference != null ? firstTimeReference :\n                                                            availabilityStartTime,\n                        time };\n      } else {\n        minimumTime = { isContinuous: true,\n                        value: Math.min(maximumTime.value - timeShiftBufferDepth + 5,\n                                        maximumTime.value),\n                        time };\n      }\n      const manifestDuration = root.getAttribute(\"Duration\");\n      duration = (manifestDuration != null && +manifestDuration !== 0) ?\n        (+manifestDuration / timescale) : undefined;\n\n    } else {\n      periodStart = firstTimeReference != null ? firstTimeReference :\n                                                 0;\n      minimumTime = { isContinuous: false,\n                      value: firstTimeReference != null ? firstTimeReference :\n                                                          0,\n                      time: performance.now() };\n\n      // if non-live and first time reference different than 0. Add first time reference\n      // to duration\n      const manifestDuration = root.getAttribute(\"Duration\");\n\n      if (manifestDuration != null && +manifestDuration !== 0) {\n        duration = lastTimeReference == null ?\n          (+manifestDuration / timescale) + (firstTimeReference || 0) :\n          lastTimeReference;\n      } else {\n        duration = undefined;\n      }\n    }\n\n    const periodDuration = duration != null ? duration - periodStart :\n                                              undefined;\n    const manifest = {\n      availabilityStartTime: availabilityStartTime || 0,\n      duration,\n      id: \"gen-smooth-manifest-\" + generateManifestID(),\n      isLive,\n      isDynamic: isLive,\n      maximumTime,\n      minimumTime,\n      periods: [{ adaptations,\n                  duration: periodDuration,\n                  end: periodDuration == null ? undefined :\n                                                periodStart + periodDuration,\n                  id: \"gen-smooth-period-0\",\n                  start: periodStart }],\n      suggestedPresentationDelay,\n      transportType: \"smooth\",\n      uris: url == null ? [] : [url],\n    };\n    checkManifestIDs(manifest);\n    return manifest;\n  }\n\n  return parseFromDocument;\n}\n\nexport default createSmoothStreamingParser;\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport createSmoothStreamingParser, {\n  IHSSParserConfiguration,\n} from \"./create_parser\";\n\nexport default createSmoothStreamingParser;\nexport {\n  IHSSParserConfiguration,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createBox } from \"../../../parsers/containers/isobmff\";\nimport {\n  be2toi,\n  be4toi,\n  concat,\n  hexToBytes,\n  itobe2,\n  itobe4,\n  itobe8,\n  strToBytes,\n} from \"../../../utils/byte_parsing\";\n\n/**\n * @param {Number} width\n * @param {Number} height\n * @param {Number} hRes - horizontal resolution, eg 72\n * @param {Number} vRes - vertical resolution, eg 72\n * @param {string} encDepth\n * @param {Number} colorDepth - eg 24\n * @param {Uint8Array} avcc - Uint8Array representing the avcC atom\n * @returns {Uint8Array}\n */\nfunction createAVC1Box(\n  width : number,\n  height : number,\n  hRes : number,\n  vRes : number,\n  encName : string,\n  colorDepth : number,\n  avcc : Uint8Array\n) : Uint8Array {\n  return createBox(\"avc1\", concat(\n    6,                      // 6 bytes reserved\n    itobe2(1), 16,          // drefIdx + QuickTime reserved, zeroes\n    itobe2(width),          // size 2 w\n    itobe2(height),         // size 2 h\n    itobe2(hRes), 2,        // reso 4 h\n    itobe2(vRes), 2 + 4,    // reso 4 v + QuickTime reserved, zeroes\n    [0, 1, encName.length], // frame count (default 1)\n    strToBytes(encName),    // 1byte len + encoder name str\n    (31 - encName.length),  // + padding\n    itobe2(colorDepth),     // color depth\n    [0xFF, 0xFF],           // reserved ones\n    avcc                    // avcc atom,\n  ));\n}\n\n/**\n * @param {Number} width\n * @param {Number} height\n * @param {Number} hRes - horizontal resolution, eg 72\n * @param {Number} vRes - vertical resolution, eg 72\n * @param {string} encDepth\n * @param {Number} colorDepth - eg 24\n * @param {Uint8Array} avcc - Uint8Array representing the avcC atom\n * @param {Uint8Array} sinf - Uint8Array representing the sinf atom\n * @returns {Uint8Array}\n */\nfunction createENCVBox(\n  width : number,\n  height : number,\n  hRes : number,\n  vRes : number,\n  encName : string,\n  colorDepth : number,\n  avcc : Uint8Array,\n  sinf : Uint8Array\n) : Uint8Array {\n  return createBox(\"encv\", concat(\n    6,                      // 6 bytes reserved\n    itobe2(1), 16,          // drefIdx + QuickTime reserved, zeroes\n    itobe2(width),          // size 2 w\n    itobe2(height),         // size 2 h\n    itobe2(hRes), 2,        // reso 4 h\n    itobe2(vRes), 2 + 4,    // reso 4 v + QuickTime reserved, zeroes\n    [0, 1, encName.length], // frame count (default 1)\n    strToBytes(encName),    // 1byte len + encoder name str\n    (31 - encName.length),  // + padding\n    itobe2(colorDepth),     // color depth\n    [0xFF, 0xFF],           // reserved ones\n    avcc,                   // avcc atom,\n    sinf\n  ));\n}\n\n/**\n * @param {Number} drefIdx\n * @param {Number} channelsCount\n * @param {Number} sampleSize\n * @param {Number} packetSize\n * @param {Number} sampleRate\n * @param {Uint8Array} esds - Uint8Array representing the esds atom\n * @param {Uint8Array} [sinf] - Uint8Array representing the sinf atom,\n * only if name == \"enca\"\n * @returns {Uint8Array}\n */\nfunction createMP4ABox(\n  drefIdx : number,\n  channelsCount : number,\n  sampleSize : number,\n  packetSize : number,\n  sampleRate : number,\n  esds : Uint8Array\n) : Uint8Array {\n  return createBox(\"mp4a\", concat(\n    6,\n    itobe2(drefIdx), 8,\n    itobe2(channelsCount),\n    itobe2(sampleSize), 2,\n    itobe2(packetSize),\n    itobe2(sampleRate), 2,\n    esds\n  ));\n}\n\n/**\n * @param {Number} drefIdx\n * @param {Number} channelsCount\n * @param {Number} sampleSize\n * @param {Number} packetSize\n * @param {Number} sampleRate\n * @param {Uint8Array} esds - Uint8Array representing the esds atom\n * @param {Uint8Array} [sinf] - Uint8Array representing the sinf atom,\n * only if name == \"enca\"\n * @returns {Uint8Array}\n */\nfunction createENCABox(\n  drefIdx : number,\n  channelsCount : number,\n  sampleSize : number,\n  packetSize : number,\n  sampleRate : number,\n  esds : Uint8Array,\n  sinf : Uint8Array\n) : Uint8Array {\n  return createBox(\"enca\", concat(\n    6,\n    itobe2(drefIdx), 8,\n    itobe2(channelsCount),\n    itobe2(sampleSize), 2,\n    itobe2(packetSize),\n    itobe2(sampleRate), 2,\n    esds,\n    sinf\n  ));\n}\n\n/**\n * @param {url} Uint8Array\n * @returns {Uint8Array}\n */\nfunction createDREFBox(url : Uint8Array) : Uint8Array {\n  // only one description here... FIXME\n  return createBox(\"dref\", concat(7, [1], url));\n}\n\n/**\n * @param {string} majorBrand\n * @param {Array.<string>} brands\n * @returns {Uint8Array}\n */\nfunction createFTYPBox(majorBrand : string, brands : string[]) : Uint8Array {\n  return createBox(\"ftyp\", concat.apply(null, [\n    strToBytes(majorBrand),\n    [0, 0, 0, 1],\n  ].concat(brands.map(strToBytes))));\n}\n\n/**\n * @param {string} schemeType - four letters (eg \"cenc\" for Common Encryption)\n * @param {Number} schemeVersion - eg 65536\n * @returns {Uint8Array}\n */\nfunction createSCHMBox(schemeType : string, schemeVersion : number) : Uint8Array {\n  return createBox(\"schm\", concat(4, strToBytes(schemeType), itobe4(schemeVersion)));\n}\n\n/**\n * Create tfdt box from a decoding time.\n * @param {number} decodeTime\n * @returns {Uint8Array}\n */\nfunction createTfdtBox(decodeTime : number) : Uint8Array {\n  return createBox(\"tfdt\", concat([1, 0, 0, 0], itobe8(decodeTime)));\n}\n\n/**\n * @returns {Uint8Array}\n */\nfunction createVMHDBox() : Uint8Array {\n  const arr = new Uint8Array(12);\n  arr[3] = 1; // QuickTime...\n  return createBox(\"vmhd\", arr);\n}\n\n/**\n * @param {Number} trackId\n * @returns {Uint8Array}\n */\nfunction createTREXBox(trackId : number) : Uint8Array {\n  // default sample desc idx = 1\n  return createBox(\"trex\", concat(4, itobe4(trackId), [0, 0, 0, 1], 12));\n}\n\n/**\n * @param {Number} length\n * @returns {Uint8Array}\n */\nfunction createFreeBox(length : number) : Uint8Array {\n  return createBox(\"free\", new Uint8Array(length - 8));\n}\n\n/**\n * @param {Number} stream\n * @param {string} codecPrivateData - hex string\n * @returns {Uint8Array}\n */\nfunction createESDSBox(stream : number, codecPrivateData : string) : Uint8Array {\n  return createBox(\"esds\", concat(\n    4,\n    [0x03, 0x19],\n    itobe2(stream),\n    [0x00, 0x04, 0x11, 0x40, 0x15], 11,\n    [0x05, 0x02],\n    hexToBytes(codecPrivateData),\n    [0x06, 0x01, 0x02]\n  ));\n}\n\n/**\n * @param {string} dataFormat - four letters (eg \"avc1\")\n * @returns {Uint8Array}\n */\nfunction createFRMABox(dataFormat : string) : Uint8Array {\n  return createBox(\"frma\", strToBytes(dataFormat));\n}\n\n/**\n * @param {Uint8Array} sps\n * @param {Uint8Array} pps\n * @param {Number} nalLen - NAL Unit length: 1, 2 or 4 bytes\n * eg: avcc(0x4d, 0x40, 0x0d, 4, 0xe1, \"674d400d96560c0efcb80a70505050a0\",\n * 1, \"68ef3880\")\n * @returns {Uint8Array}\n */\n  function createAVCCBox(\n    sps : Uint8Array,\n    pps : Uint8Array,\n    nalLen : number\n  ) : Uint8Array {\n  const nal = (nalLen === 2) ? 0x1 :\n              (nalLen === 4) ? 0x3 :\n              0x0;\n\n  // Deduce AVC Profile from SPS\n  const h264Profile = sps[1];\n  const h264CompatibleProfile = sps[2];\n  const h264Level = sps[3];\n\n  return createBox(\"avcC\", concat(\n    [\n      1,\n      h264Profile,\n      h264CompatibleProfile,\n      h264Level,\n      (0x3F << 2 | nal),\n      (0xE0 | 1),\n    ],\n    itobe2(sps.length), sps, [1],\n    itobe2(pps.length), pps\n  ));\n}\n\n/**\n * @param {string} type - \"video\"/\"audio\"/\"hint\"\n * @returns {Uint8Array}\n */\nfunction createHDLRBox(type : \"audio\"|\"video\"|\"hint\") : Uint8Array {\n  let name;\n  let handlerName;\n\n  switch (type) {\n    case \"video\":\n      name = \"vide\";\n      handlerName = \"VideoHandler\";\n      break;\n    case \"audio\":\n      name = \"soun\";\n      handlerName = \"SoundHandler\";\n      break;\n    default:\n      name = \"hint\";\n      handlerName = \"\";\n      break;\n  }\n\n  return createBox(\"hdlr\", concat(\n    8,\n    strToBytes(name), 12,\n    strToBytes(handlerName),\n    1 // handler name is C-style string (0 terminated)\n  ));\n}\n\n/**\n * @param {number} timescale\n * @returns {Uint8Array}\n */\nfunction createMDHDBox(timescale : number) : Uint8Array {\n  return createBox(\"mdhd\", concat(12, itobe4(timescale), 8));\n}\n\n  /**\n   * @param {Number} timescale\n   * @param {Number} trackId\n   * @returns {Uint8Array}\n   */\nfunction createMVHDBox(timescale : number, trackId : number) : Uint8Array {\n  return createBox(\"mvhd\", concat(\n    12,\n    itobe4(timescale), 4,\n    [0, 1],  2,         // we assume rate = 1;\n    [1, 0], 10,         // we assume volume = 100%;\n    [0, 1], 14,         // default matrix\n    [0, 1], 14,         // default matrix\n    [64, 0, 0, 0], 26,\n    itobe2(trackId + 1) // next trackId (=trackId + 1);\n  ));\n}\n\n/**\n * @param {string} systemId - Hex string representing the CDM, 16 bytes.\n * @param {Uint8Array|undefined} privateData - Data associated to protection\n * specific system.\n * @param {Array.<Uint8Array>} keyIds - List of key ids contained in the PSSH\n * @returns {Uint8Array}\n */\nfunction createPSSHBox(\n  systemId : string,\n  privateData : Uint8Array = new Uint8Array(0),\n  keyIds : Uint8Array = new Uint8Array(0)\n) : Uint8Array {\n  const _systemId = systemId.replace(/-/g, \"\");\n\n  if (_systemId.length !== 32) {\n    throw new Error(\"HSS: wrong system id length\");\n  }\n\n  let version;\n  let kidList;\n  const kidCount = keyIds.length;\n  if (kidCount > 0) {\n    version = 1;\n    kidList = concat(...[itobe4(kidCount)].concat(keyIds));\n  }\n  else {\n    version = 0;\n    kidList = [];\n  }\n\n  return createBox(\"pssh\", concat(\n    [version, 0, 0, 0],\n    hexToBytes(_systemId),\n    kidList,\n    itobe4(privateData.length),\n    privateData\n  ));\n}\n\n/**\n * @param {Uint8Array} mfhd\n * @param {Uint8Array} tfhd\n * @param {Uint8Array} tfdt\n * @param {Uint8Array} trun\n * @returns {Uint8Array}\n */\nfunction createSAIOBox(\n  mfhd : Uint8Array,\n  tfhd : Uint8Array,\n  tfdt : Uint8Array,\n  trun : Uint8Array\n) : Uint8Array {\n  return createBox(\"saio\", concat(\n    4, [0, 0, 0, 1], // ??\n    itobe4(\n      mfhd.length +\n      tfhd.length +\n      tfdt.length +\n      trun.length +\n      8 + 8 + 8 + 8\n    )\n  ));\n}\n\n/**\n * @param {Uint8Array} sencContent - including 8 bytes flags and entries count\n * @returns {Uint8Array}\n */\nfunction createSAIZBox(sencContent : Uint8Array) : Uint8Array {\n  if (sencContent.length === 0) {\n    return createBox(\"saiz\", new Uint8Array(0));\n  }\n\n  const flags   = be4toi(sencContent, 0);\n  const entries = be4toi(sencContent, 4);\n\n  const arr = new Uint8Array(entries + 9);\n  arr.set(itobe4(entries), 5);\n\n  let i = 9;\n  let j = 8;\n  let pairsCnt;\n  let pairsLen;\n  while (j < sencContent.length) {\n    j += 8; // assuming IV is 8 bytes TODO handle 16 bytes IV\n            // if we have extradata for each entry\n    if ((flags & 0x2) === 0x2) {\n      pairsLen = 2;\n      pairsCnt = be2toi(sencContent, j);\n      j += (pairsCnt * 6) + 2;\n    } else {\n      pairsCnt = 0;\n      pairsLen = 0;\n    }\n    arr[i] = pairsCnt * 6 + 8 + pairsLen;\n    i++;\n  }\n\n  return createBox(\"saiz\", arr);\n}\n\n/**\n * @returns {Uint8Array}\n */\nfunction createSMHDBox() : Uint8Array {\n  return createBox(\"smhd\", new Uint8Array(8));\n}\n\n/**\n * @param {Array.<Uint8Array>} representations - arrays of Uint8Array,\n * typically [avc1] or [encv, avc1]\n * @returns {Uint8Array}\n */\nfunction createSTSDBox(reps : Uint8Array[]) : Uint8Array {\n  // only one description here... FIXME\n  const arrBase : Array<Uint8Array|number[]|number> = [7, [reps.length]];\n  return createBox(\"stsd\", concat(...arrBase.concat(reps)));\n}\n\n/**\n * @param {Number} width\n * @param {Number} height\n * @param {Number} trackId\n * @returns {Uint8Array}\n */\nfunction createTKHDBox(width : number, height : number, trackId : number) : Uint8Array {\n  return createBox(\"tkhd\", concat(\n    itobe4(1 + 2 + 4), 8, // we assume track is enabled,\n                          // in media and in preview.\n    itobe4(trackId),  20, // we assume trackId = 1;\n    [1, 0, 0, 0],         // we assume volume = 100%;\n    [0, 1, 0, 0], 12,     // default matrix\n    [0, 1, 0, 0], 12,     // default matrix\n    [64, 0, 0, 0],        // ??\n    itobe2(width),  2,    // width (TODO handle fixed)\n    itobe2(height), 2     // height (TODO handle fixed)\n  ));\n}\n\n/**\n * @param {Number} algId - eg 1\n * @param {Number} ivSize - eg 8\n * @param {string} keyId - Hex KID 93789920e8d6520098577df8f2dd5546\n * @returns {Uint8Array}\n */\nfunction createTENCBox(algId : number, ivSize : number, keyId : Uint8Array) : Uint8Array {\n  return createBox(\"tenc\", concat(6, [algId, ivSize], keyId\n  ));\n}\n\nexport {\n  createAVC1Box,\n  createAVCCBox,\n  createDREFBox,\n  createENCABox,\n  createENCVBox,\n  createESDSBox,\n  createFRMABox,\n  createFTYPBox,\n  createFreeBox,\n  createHDLRBox,\n  createMDHDBox,\n  createMP4ABox,\n  createMVHDBox,\n  createPSSHBox,\n  createSAIOBox,\n  createSAIZBox,\n  createSCHMBox,\n  createSMHDBox,\n  createSTSDBox,\n  createTENCBox,\n  createTKHDBox,\n  createTREXBox,\n  createTfdtBox,\n  createVMHDBox,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  createBox,\n  createBoxWithChildren,\n} from \"../../../parsers/containers/isobmff\";\nimport { concat } from \"../../../utils/byte_parsing\";\nimport {\n  createDREFBox,\n  createFTYPBox,\n  createHDLRBox,\n  createMDHDBox,\n  createMVHDBox,\n  createPSSHBox,\n  createTKHDBox,\n  createTREXBox,\n} from \"./create_boxes\";\n\nexport type IPSSList = Array<{\n  systemId : string;\n  privateData? : Uint8Array;\n  keyIds? : Uint8Array;\n}>;\n\n/**\n * @param {Uint8Array} mvhd\n * @param {Uint8Array} mvex\n * @param {Uint8Array} trak\n * @param {Object} pssList\n * @returns {Array.<Uint8Array>}\n */\nfunction createMOOVBox(\n  mvhd : Uint8Array,\n  mvex : Uint8Array,\n  trak : Uint8Array,\n  pssList : IPSSList\n) : Uint8Array {\n  const children = [mvhd, mvex, trak];\n  pssList.forEach((pss) => {\n    const pssh = createPSSHBox(pss.systemId, pss.privateData, pss.keyIds);\n    children.push(pssh);\n  });\n  return createBoxWithChildren(\"moov\", children);\n}\n\n/**\n * Create an initialization segment with the information given.\n * @param {Number} timescale\n * @param {string} type\n * @param {Uint8Array} stsd\n * @param {Uint8Array} mhd\n * @param {Number} width\n * @param {Number} height\n * @param {Array.<Object>} pssList - List of dict, example:\n * {systemId: \"DEADBEEF\", codecPrivateData: \"DEAFBEEF}\n * @returns {Uint8Array}\n */\nexport default function createInitSegment(\n  timescale : number,\n  type : \"audio\"|\"video\",\n  stsd : Uint8Array,\n  mhd : Uint8Array,\n  width : number,\n  height : number,\n  pssList : IPSSList\n) : Uint8Array {\n\n  const stbl = createBoxWithChildren(\"stbl\", [\n    stsd,\n    createBox(\"stts\", new Uint8Array(0x08)),\n    createBox(\"stsc\", new Uint8Array(0x08)),\n    createBox(\"stsz\", new Uint8Array(0x0c)),\n    createBox(\"stco\", new Uint8Array(0x08)),\n  ]);\n\n  const url  = createBox(\"url \", new Uint8Array([0, 0, 0, 1]));\n  const dref = createDREFBox(url);\n  const dinf = createBoxWithChildren(\"dinf\", [dref]);\n  const minf = createBoxWithChildren(\"minf\", [mhd, dinf, stbl]);\n  const hdlr = createHDLRBox(type);\n  const mdhd = createMDHDBox(timescale); // this one is really important\n  const mdia = createBoxWithChildren(\"mdia\", [mdhd, hdlr, minf]);\n  const tkhd = createTKHDBox(width, height, 1);\n  const trak = createBoxWithChildren(\"trak\", [tkhd, mdia]);\n  const trex = createTREXBox(1);\n  const mvex = createBoxWithChildren(\"mvex\", [trex]);\n  const mvhd = createMVHDBox(timescale, 1); // in fact, we don't give a sh** about\n                                            // this value :O\n\n  const moov = createMOOVBox(mvhd, mvex, trak, pssList);\n  const ftyp = createFTYPBox(\"isom\", [\"isom\", \"iso2\", \"iso6\", \"avc1\", \"dash\"]);\n\n  return concat(ftyp, moov);\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  bytesToHex,\n  itobe2,\n} from \"../../../utils/byte_parsing\";\n\n/**\n * Sampling frequencies defined in MPEG-4 Audio.\n * @type {Array.<Number>}\n */\nconst SAMPLING_FREQUENCIES : number[] = [\n  96000,\n  88200,\n  64000,\n  48000,\n  44100,\n  32000,\n  24000,\n  22050,\n  16000,\n  12000,\n  11025,\n  8000,\n  7350,\n];\n\n/**\n * Return AAC ES Header (hexstr form)\n *\n * @param {Number} type\n *          1 = AAC Main\n *          2 = AAC LC\n *          cf http://wiki.multimedia.cx/index.php?title=MPEG-4_Audio\n * @param {Number} frequency\n * @param {Number} chans (1 or 2)\n * @returns {string}\n */\nexport default function getAacesHeader(\n  type : number,\n  frequency : number,\n  chans : number\n) : string {\n  const freq = SAMPLING_FREQUENCIES.indexOf(frequency); // TODO : handle Idx = 15...\n  let val;\n  val = (type & 0x3F) << 0x4;\n  val = (val | (freq  & 0x1F)) << 0x4;\n  val = (val | (chans & 0x1F)) << 0x3;\n  return bytesToHex(itobe2(val));\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createBoxWithChildren } from \"../../../parsers/containers/isobmff\";\nimport {\n  createENCABox,\n  createESDSBox,\n  createFRMABox,\n  createMP4ABox,\n  createSCHMBox,\n  createSMHDBox,\n  createSTSDBox,\n  createTENCBox,\n} from \"./create_boxes\";\nimport createInitSegment from \"./create_init_segment\";\nimport getAacesHeader from \"./get_aaces_header\";\n\ntype IPSSList = Array<{\n  systemId : string;\n  privateData? : Uint8Array;\n  keyIds? : Uint8Array;\n}>;\n\n/**\n * Return full audio initialization segment as Uint8Array.\n * @param {Number} timescale\n * @param {Number} channelsCount\n * @param {Number} sampleSize\n * @param {Number} packetSize\n * @param {Number} sampleRate\n * @param {string} codecPrivateData\n * @param {Uint8Array} keyId - hex string representing the key Id, 32 chars.\n * eg. a800dbed49c12c4cb8e0b25643844b9b\n * @param {Array.<Object>} [pssList]\n * @returns {Uint8Array}\n */\nexport default function createAudioInitSegment(\n  timescale : number,\n  channelsCount : number,\n  sampleSize : number,\n  packetSize : number,\n  sampleRate : number,\n  codecPrivateData : string,\n  keyId? : Uint8Array,\n  pssList : IPSSList = []\n) : Uint8Array {\n  const _codecPrivateData = codecPrivateData ||\n    getAacesHeader(2, sampleRate, channelsCount);\n\n  const esds = createESDSBox(1, _codecPrivateData);\n  const stsd : Uint8Array = (() => {\n    if (!pssList.length || keyId == null) {\n      const mp4a =\n        createMP4ABox(1, channelsCount, sampleSize, packetSize, sampleRate, esds);\n      return createSTSDBox([mp4a]);\n    }\n    const tenc = createTENCBox(1, 8, keyId);\n    const schi = createBoxWithChildren(\"schi\", [tenc]);\n    const schm = createSCHMBox(\"cenc\", 65536);\n    const frma = createFRMABox(\"mp4a\");\n    const sinf = createBoxWithChildren(\"sinf\", [frma, schm, schi]);\n    const enca =\n      createENCABox(1, channelsCount, sampleSize, packetSize, sampleRate, esds, sinf);\n    return createSTSDBox([enca]);\n  })();\n\n  return createInitSegment(timescale, \"audio\", stsd, createSMHDBox(), 0, 0, pssList);\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createBoxWithChildren } from \"../../../parsers/containers/isobmff\";\nimport { hexToBytes } from \"../../../utils/byte_parsing\";\nimport {\n  createAVC1Box,\n  createAVCCBox,\n  createENCVBox,\n  createFRMABox,\n  createSCHMBox,\n  createSTSDBox,\n  createTENCBox,\n  createVMHDBox,\n} from \"./create_boxes\";\nimport createInitSegment from \"./create_init_segment\";\n\ntype IPSSList = Array<{\n  systemId : string;\n  privateData? : Uint8Array;\n  keyIds? : Uint8Array;\n}>;\n\n/**\n * Return full video Init segment as Uint8Array\n * @param {Number} timescale - lowest number, this one will be set into mdhd\n * *10000 in mvhd, e.g. 1000\n * @param {Number} width\n * @param {Number} height\n * @param {Number} hRes\n * @param {Number} vRes\n * @param {Number} nalLength (1, 2 or 4)\n * @param {string} codecPrivateData\n * @param {Uint8Array} keyId - hex string representing the key Id,\n * 32 chars. eg. a800dbed49c12c4cb8e0b25643844b9b\n * @param {Array.<Object>} [pssList] - List of dict, example:\n * {systemId: \"DEADBEEF\", codecPrivateData: \"DEAFBEEF}\n * @returns {Uint8Array}\n */\nexport default function createVideoInitSegment(\n  timescale : number,\n  width : number,\n  height : number,\n  hRes : number,\n  vRes : number,\n  nalLength : number,\n  codecPrivateData : string,\n  keyId? : Uint8Array,\n  pssList? : IPSSList\n) : Uint8Array {\n  const _pssList = pssList || [];\n  const [, spsHex, ppsHex] = codecPrivateData.split(\"00000001\");\n  const sps = hexToBytes(spsHex);\n  const pps = hexToBytes(ppsHex);\n\n  // TODO NAL length is forced to 4\n  const avcc = createAVCCBox(sps, pps, nalLength);\n  let stsd;\n  if (!_pssList.length || keyId == null) {\n    const avc1 = createAVC1Box(width, height, hRes, vRes, \"AVC Coding\", 24, avcc);\n    stsd = createSTSDBox([avc1]);\n  }\n  else {\n    const tenc = createTENCBox(1, 8, keyId);\n    const schi = createBoxWithChildren(\"schi\", [tenc]);\n    const schm = createSCHMBox(\"cenc\", 65536);\n    const frma = createFRMABox(\"avc1\");\n    const sinf = createBoxWithChildren(\"sinf\", [frma, schm, schi]);\n    const encv = createENCVBox(width, height, hRes, vRes, \"AVC Coding\", 24, avcc, sinf);\n    stsd = createSTSDBox([encv]);\n  }\n\n  return createInitSegment(\n    timescale, \"video\", stsd, createVMHDBox(), width, height, _pssList\n  );\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getUuidContent } from \"../../../parsers/containers/isobmff\";\nimport {\n  be4toi,\n  be8toi,\n} from \"../../../utils/byte_parsing\";\n\nexport interface IISOBMFFBasicSegment {\n  time : number;\n  duration : number;\n}\n\n/**\n * @param {Uint8Array} traf\n * @returns {Array.<Object>}\n */\nexport default function parseTfrf(traf : Uint8Array) : IISOBMFFBasicSegment[] {\n  const tfrf = getUuidContent(traf, 0xD4807EF2, 0XCA394695, 0X8E5426CB, 0X9E46A79F);\n  if (!tfrf) {\n    return [];\n  }\n\n  const frags : Array<{ time: number; duration: number }> = [];\n  const version = tfrf[0];\n  const fragCount = tfrf[4];\n  for (let i = 0; i < fragCount; i++) {\n    let duration;\n    let time;\n    if (version === 1) {\n      time = be8toi(tfrf, i * 16 + 5);\n      duration  = be8toi(tfrf, i * 16 + 5 + 8);\n    } else {\n      time = be4toi(tfrf, i * 8 + 5);\n      duration = be4toi(tfrf, i * 8 + 5 + 4);\n    }\n    frags.push({\n      time,\n      duration,\n    });\n  }\n  return frags;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getUuidContent } from \"../../../parsers/containers/isobmff\";\nimport { be8toi } from \"../../../utils/byte_parsing\";\n\nexport interface IISOBMFFBasicSegment {\n  time : number;\n  duration : number;\n}\n\n/**\n * @param {Uint8Array} traf\n * @returns {Object|undefined}\n */\nexport default function parseTfxd(traf : Uint8Array) : IISOBMFFBasicSegment|undefined {\n  const tfxd = getUuidContent(traf, 0x6D1D9B05, 0x42D544E6, 0x80E2141D, 0xAFF757B2);\n  if (tfxd == null) {\n    return undefined;\n  }\n  return {\n    duration:  be8toi(tfxd, 12),\n    time: be8toi(tfxd,  4),\n  };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { itobe4 } from \"../../../utils/byte_parsing\";\n\n/**\n * Update `trun` box given to add a data offset flag and the corresponding space\n * to set a data offset.\n * Do not do anything if the flag is already set.\n * @param {Uint8Array} trun\n * @returns {Uint8Array}\n */\nexport default function addDataOffsetFlagInTrun(trun : Uint8Array) : Uint8Array {\n  const lastFlags = trun[11];\n  const hasDataOffset = lastFlags & 0x01;\n  if (hasDataOffset) {\n    return trun;\n  }\n\n  // If no dataoffset is present, we add one\n  const newTrun = new Uint8Array(trun.length + 4);\n  newTrun.set(itobe4(trun.length + 4), 0); // original length + data_offset size\n  newTrun.set(trun.subarray(4, 16), 4); // name + (version + flags) + samplecount\n  newTrun[11] = newTrun[11] | 0x01; // add data_offset flag\n  newTrun.set([0, 0, 0, 0], 16); // add data offset\n  newTrun.set(trun.subarray(16, trun.length), 20);\n  return newTrun;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  createBox,\n  createBoxWithChildren,\n} from \"../../../parsers/containers/isobmff\";\nimport {\n  createSAIOBox,\n  createSAIZBox,\n} from \"./create_boxes\";\n\nexport default function createTrafBox(\n  tfhd : Uint8Array,\n  tfdt : Uint8Array,\n  trun : Uint8Array,\n  mfhd : Uint8Array,\n  senc?: Uint8Array\n) : Uint8Array {\n  const trafs = [tfhd, tfdt, trun];\n  if (senc) {\n    trafs.push(\n      createBox(\"senc\", senc),\n      createSAIZBox(senc),\n      createSAIOBox(mfhd, tfhd, tfdt, trun)\n    );\n  }\n  return createBoxWithChildren(\"traf\", trafs);\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { canPatchISOBMFFSegment } from \"../../../compat\";\nimport { getBoxOffsets } from \"../../../parsers/containers/isobmff\";\nimport { itobe4 } from \"../../../utils/byte_parsing\";\nimport { createFreeBox } from \"./create_boxes\";\n\n/**\n * Replace a moof in a segment by a new one.\n * @param {Uint8Array} segment\n * @param {Uint8Array} newMoof\n * @param {Array.<number>} moofOffsets\n * @param {number} trunOffsetInMoof\n * @returns {Uint8Array}\n */\nexport default function replaceMoofInSegment(\n  segment : Uint8Array,\n  newMoof : Uint8Array,\n  moofOffsets : [number, number],\n  trunOffsetInMoof : number\n) : Uint8Array {\n  const oldMoofLength = moofOffsets[1] - moofOffsets[0];\n  const moofDelta = newMoof.length - oldMoofLength;\n\n  const mdatOffsets = getBoxOffsets(segment, 0x6D646174 /* \"mdat\" */);\n  if (mdatOffsets == null) {\n    throw new Error(\"Smooth: Invalid ISOBMFF given\");\n  }\n  if (canPatchISOBMFFSegment() && (moofDelta === 0 || moofDelta <= -8)) {\n    // patch trun data_offset\n    newMoof.set(itobe4(mdatOffsets[0] + 8), trunOffsetInMoof + 16);\n    segment.set(newMoof, moofOffsets[0]);\n\n    if (moofDelta <= -8) {\n      segment.set(createFreeBox(-moofDelta), newMoof.length);\n    }\n    return segment;\n  }\n\n  // patch trun data_offset\n  newMoof.set(itobe4(mdatOffsets[0] + moofDelta + 8), trunOffsetInMoof + 16);\n  const newSegment = new Uint8Array(segment.length + moofDelta);\n  const beforeMoof = segment.subarray(0, moofOffsets[0]);\n  const afterMoof = segment.subarray(moofOffsets[1], segment.length);\n  newSegment.set(beforeMoof, 0);\n  newSegment.set(newMoof, beforeMoof.length);\n  newSegment.set(afterMoof, beforeMoof.length + newMoof.length);\n  return newSegment;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  createBoxWithChildren,\n  getBox,\n  getBoxContent,\n  getBoxOffsets,\n  getUuidContent,\n} from \"../../../parsers/containers/isobmff\";\nimport addDataOffsetFlagInTrun from \"./add_data_offset_flag_in_trun\";\nimport { createTfdtBox, } from \"./create_boxes\";\nimport createTrafBox from \"./create_traf_box\";\nimport replaceMoofInSegment from \"./replace_moof\";\n\n/**\n * Patch ISOBMFF Segment downloaded in Smooth Streaming.\n * @param {Uint8Array} segment\n * @param {Number} decodeTime\n * @return {Uint8Array}\n */\nexport default function patchSegment(\n  segment : Uint8Array,\n  decodeTime : number\n) : Uint8Array {\n  const moofOffsets = getBoxOffsets(segment, 0x6d6f6f66 /* moof */);\n  if (moofOffsets == null) {\n    throw new Error(\"Smooth: Invalid ISOBMFF given\");\n  }\n  const moofContent = segment.subarray(moofOffsets[0] + 8, moofOffsets[1]);\n\n  const mfhdBox = getBox(moofContent, 0x6d666864 /* mfhd */);\n  const trafContent = getBoxContent(moofContent, 0x74726166 /* traf */);\n  if (trafContent == null || mfhdBox == null) {\n    throw new Error(\"Smooth: Invalid ISOBMFF given\");\n  }\n\n  const tfhdBox = getBox(trafContent, 0x74666864 /* tfhd */);\n  const trunBox = getBox(trafContent, 0x7472756e /* trun */);\n  if (tfhdBox == null || trunBox == null) {\n    throw new Error(\"Smooth: Invalid ISOBMFF given\");\n  }\n\n  // force trackId=1 since trackIds are not always reliable...\n  tfhdBox.set([0, 0, 0, 1], 12);\n\n  const tfdtBox = createTfdtBox(decodeTime);\n  const newTrunBox = addDataOffsetFlagInTrun(trunBox);\n  const sencContent = getUuidContent(trafContent,\n    0xA2394F52, 0x5A9B4F14, 0xA2446C42, 0x7C648DF4);\n  const newTrafBox = createTrafBox(tfhdBox, tfdtBox, newTrunBox, mfhdBox, sencContent);\n  const newMoof = createBoxWithChildren(\"moof\", [mfhdBox, newTrafBox]);\n  const trunOffsetInMoof = mfhdBox.length + tfhdBox.length + tfdtBox.length +\n    8 /* moof size + name */ +\n    8 /* traf size + name */;\n\n  return replaceMoofInSegment(segment, newMoof, moofOffsets, trunOffsetInMoof);\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport createAudioInitSegment from \"./create_audio_init_segment\";\nimport createVideoInitSegment from \"./create_video_init_segment\";\nimport parseTfrf, {\n  IISOBMFFBasicSegment,\n} from \"./parse_tfrf\";\nimport parseTfxd from \"./parse_tfxd\";\nimport patchSegment from \"./patch_segment\";\n\nexport {\n  createAudioInitSegment,\n  createVideoInitSegment,\n  IISOBMFFBasicSegment,\n  parseTfrf,\n  parseTfxd,\n  patchSegment,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport log from \"../../log\";\nimport { ISegment } from \"../../manifest\";\nimport {\n  getDurationFromTrun,\n  getTRAF,\n} from \"../../parsers/containers/isobmff\";\nimport {\n  IChunkTimingInfos,\n  INextSegmentsInfos,\n} from \"../types\";\nimport {\n  IISOBMFFBasicSegment,\n  parseTfrf,\n  parseTfxd,\n} from \"./isobmff\";\n\n/**\n * Try to obtain time information from the given data.\n * @param {Uint8Array} data\n * @param {boolean} isChunked\n * @param {Object} segment\n * @param {boolean} isLive\n * @returns {Object}\n */\nexport default function extractTimingsInfos(\n  data : Uint8Array,\n  isChunked : boolean,\n  segment : ISegment,\n  isLive : boolean\n) : { nextSegments : INextSegmentsInfos[];\n      chunkInfos : IChunkTimingInfos | null; }\n{\n  const nextSegments : INextSegmentsInfos[] = [];\n  let chunkInfos : IChunkTimingInfos;\n\n  let tfxdSegment : IISOBMFFBasicSegment|undefined;\n  let tfrfSegments : IISOBMFFBasicSegment[]|undefined;\n  if (isLive) {\n    const traf = getTRAF(data);\n    if (traf) {\n      tfrfSegments = parseTfrf(traf);\n      tfxdSegment = parseTfxd(traf);\n    } else {\n      log.warn(\"smooth: could not find traf atom\");\n    }\n  }\n\n  if (tfrfSegments) {\n    for (let i = 0; i < tfrfSegments.length; i++) {\n      nextSegments.push({ time: tfrfSegments[i].time,\n                          duration: tfrfSegments[i].duration,\n                          timescale: segment.timescale });\n    }\n  }\n\n  if (tfxdSegment) {\n    chunkInfos = { time: tfxdSegment.time,\n                   duration: tfxdSegment.duration,\n                   timescale: segment.timescale };\n    return { nextSegments, chunkInfos };\n  }\n\n  if (isChunked) {\n    return { nextSegments, chunkInfos: null };\n  }\n\n  // we could always make a mistake when reading a container.\n  // If the estimate is too far from what the segment seems to imply, take\n  // the segment infos instead.\n  const maxDecodeTimeDelta = Math.min(segment.timescale * 0.9,\n                                      segment.duration / 4);\n\n  const trunDuration = getDurationFromTrun(data);\n  if (trunDuration >= 0 && (segment.duration == null ||\n      Math.abs(trunDuration - segment.duration) <= maxDecodeTimeDelta)\n  ) {\n    chunkInfos = { time: segment.time,\n                   duration: trunDuration,\n                   timescale: segment.timescale };\n  } else {\n    chunkInfos = { time: segment.time,\n                   duration: segment.duration,\n                   timescale: segment.timescale };\n  }\n  return { nextSegments, chunkInfos };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Observable,\n  Observer,\n  of as observableOf,\n} from \"rxjs\";\nimport assert from \"../../utils/assert\";\nimport request from \"../../utils/request\";\nimport {\n  CustomSegmentLoader,\n  ILoaderRegularDataEvent,\n  ISegmentLoaderArguments,\n  ISegmentLoaderObservable,\n} from \"../types\";\nimport byteRange from \"../utils/byte_range\";\nimport {\n  createAudioInitSegment,\n  createVideoInitSegment,\n} from \"./isobmff\";\n\ninterface IRegularSegmentLoaderArguments extends ISegmentLoaderArguments {\n  url : string;\n}\n\ntype ICustomSegmentLoaderObserver =\n  Observer< ILoaderRegularDataEvent< Uint8Array | ArrayBuffer > >;\n\n/**\n * Segment loader triggered if there was no custom-defined one in the API.\n * @param {Object} opt\n * @returns {Observable}\n */\nfunction regularSegmentLoader(\n  { url, segment } : IRegularSegmentLoaderArguments\n) : ISegmentLoaderObservable<ArrayBuffer> {\n  let headers;\n  const range = segment.range;\n  if (range) {\n    headers = { Range: byteRange(range) };\n  }\n\n  return request({ url,\n                   responseType: \"arraybuffer\",\n                   headers,\n                   sendProgressEvents: true });\n}\n\n/**\n * Defines the url for the request, load the right loader (custom/default\n * one).\n */\nconst generateSegmentLoader = (\n  customSegmentLoader? : CustomSegmentLoader\n) => ({\n  segment,\n  representation,\n  adaptation,\n  period,\n  manifest,\n} : ISegmentLoaderArguments) : ISegmentLoaderObservable<Uint8Array|ArrayBuffer|null> => {\n  if (segment.isInit) {\n    if (!segment.privateInfos || segment.privateInfos.smoothInit == null) {\n      throw new Error(\"Smooth: Invalid segment format\");\n    }\n    const smoothInitPrivateInfos = segment.privateInfos.smoothInit;\n    let responseData : Uint8Array;\n    const protection = smoothInitPrivateInfos.protection;\n\n    const codecPrivateData = smoothInitPrivateInfos.codecPrivateData || \"\";\n    switch (adaptation.type) {\n    case \"video\":\n      responseData = createVideoInitSegment(segment.timescale,\n                                            representation.width || 0,\n                                            representation.height || 0,\n                                            72, 72, 4, // vRes, hRes, nal\n                                            codecPrivateData,\n                                            protection && protection.keyId,\n                                            protection && protection.keySystems);\n      break;\n    case \"audio\":\n      responseData = createAudioInitSegment(segment.timescale,\n                                            smoothInitPrivateInfos.channels || 0,\n                                            smoothInitPrivateInfos.bitsPerSample || 0,\n                                            smoothInitPrivateInfos.packetSize || 0,\n                                            smoothInitPrivateInfos.samplingRate || 0,\n                                            codecPrivateData,\n                                            protection && protection.keyId,\n                                            protection && protection.keySystems);\n      break;\n    default:\n      if (__DEV__) {\n        assert(false, \"responseData should have been set\");\n      }\n      responseData = new Uint8Array(0);\n    }\n\n    return observableOf({ type: \"data-created\" as const,\n                          value: { responseData } });\n  }\n  else if (segment.mediaURL == null) {\n    return observableOf({ type: \"data-created\" as const,\n                          value: { responseData: null } });\n  }\n  else {\n    const url = segment.mediaURL;\n    const args = { adaptation,\n                   manifest,\n                   period,\n                   representation,\n                   segment,\n                   transport: \"smooth\",\n                   url };\n\n    if (!customSegmentLoader) {\n      return regularSegmentLoader(args);\n    }\n\n    return new Observable((obs : ICustomSegmentLoaderObserver) => {\n      let hasFinished = false;\n      let hasFallbacked = false;\n\n      /**\n       * Callback triggered when the custom segment loader has a response.\n       * @param {Object} args\n       */\n      const resolve = (_args : {\n        data : ArrayBuffer|Uint8Array;\n        size? : number;\n        duration? : number;\n      }) => {\n        if (!hasFallbacked) {\n          hasFinished = true;\n          obs.next({ type: \"data-loaded\",\n                     value: { responseData: _args.data,\n                              size: _args.size,\n                              duration: _args.duration } });\n          obs.complete();\n        }\n      };\n\n      /**\n       * Callback triggered when the custom segment loader fails\n       * @param {*} err - The corresponding error encountered\n       */\n      const reject = (err = {}) => {\n        if (!hasFallbacked) {\n          hasFinished = true;\n          obs.error(err);\n        }\n      };\n\n      const fallback = () => {\n        hasFallbacked = true;\n\n        // HACK What is TypeScript/RxJS doing here??????\n        /* tslint:disable deprecation */\n        // @ts-ignore\n        regularSegmentLoader(args).subscribe(obs);\n        /* tslint:enable deprecation */\n      };\n\n      const callbacks = { reject, resolve, fallback };\n      const abort = customSegmentLoader(args, callbacks);\n\n      return () => {\n        if (!hasFinished && !hasFallbacked && typeof abort === \"function\") {\n          abort();\n        }\n      };\n    });\n  }\n};\n\nexport default generateSegmentLoader;\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport warnOnce from \"../../utils/warn_once\";\n\nconst ISM_REG = /(\\.isml?)(\\?token=\\S+)?$/;\nconst TOKEN_REG = /\\?token=(\\S+)/;\n\n/**\n * TODO Remove this logic completely from the player\n * @param {Document} doc\n * @returns {string|null}\n */\nfunction extractISML(doc : Document) : string|null {\n  return doc.getElementsByTagName(\"media\")[0].getAttribute(\"src\");\n}\n\n/**\n * Returns string corresponding to the token contained in the url's querystring.\n * Empty string if no token is found.\n * @param {string} url\n * @returns {string}\n */\nfunction extractToken(url : string) : string {\n  const tokenMatch = url.match(TOKEN_REG);\n  return (tokenMatch && tokenMatch[1]) || \"\";\n}\n\n/**\n * Replace/Remove token from the url's querystring\n * @param {string} url\n * @param {string} [token]\n * @returns {string}\n */\nfunction replaceToken(url : string, token? : string) : string {\n  if (token) {\n    return url.replace(TOKEN_REG, \"?token=\" + token);\n  } else {\n    return url.replace(TOKEN_REG, \"\");\n  }\n}\n\n/**\n * @param {string} url\n * @returns {string}\n */\nfunction resolveManifest(url : string) : string {\n  if (ISM_REG.test(url)) {\n    warnOnce(\"Giving a isml URL to loadVideo is deprecated.\" +\n      \" Please give the Manifest URL directly\");\n    return url.replace(ISM_REG, \"$1/manifest$2\");\n  }\n  return url;\n}\n\nexport {\n  extractISML,\n  extractToken,\n  replaceToken,\n  resolveManifest,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Observable,\n  of as observableOf,\n} from \"rxjs\";\nimport {\n  map,\n  tap,\n} from \"rxjs/operators\";\nimport features from \"../../features\";\nimport log from \"../../log\";\nimport Manifest, {\n  Adaptation,\n  Representation,\n} from \"../../manifest\";\nimport { getMDAT } from \"../../parsers/containers/isobmff\";\nimport createSmoothManifestParser from \"../../parsers/manifest/smooth\";\nimport {\n  bytesToStr,\n  strToBytes,\n} from \"../../utils/byte_parsing\";\nimport request from \"../../utils/request\";\nimport stringFromUTF8 from \"../../utils/string_from_utf8\";\nimport warnOnce from \"../../utils/warn_once\";\nimport {\n  IChunkTimingInfos,\n  IImageParserObservable,\n  IManifestLoaderArguments,\n  IManifestParserArguments,\n  IManifestParserObservable,\n  INextSegmentsInfos,\n  ISegmentLoaderArguments,\n  ISegmentLoaderObservable,\n  ISegmentParserArguments,\n  ISegmentParserObservable,\n  ITextParserObservable,\n  ITransportOptions,\n  ITransportPipelines,\n} from \"../types\";\nimport checkISOBMFFIntegrity from \"../utils/check_isobmff_integrity\";\nimport generateManifestLoader from \"../utils/document_manifest_loader\";\nimport extractTimingsInfos from \"./extract_timings_infos\";\nimport { patchSegment } from \"./isobmff\";\nimport generateSegmentLoader from \"./segment_loader\";\nimport {\n  extractISML,\n  extractToken,\n  replaceToken,\n  resolveManifest,\n} from \"./utils\";\n\nconst WSX_REG = /\\.wsx?(\\?token=\\S+)?/;\n\n/**\n * @param {Object} adaptation\n * @param {Object} dlSegment\n * @param {Object} nextSegments\n */\nfunction addNextSegments(\n  adaptation : Adaptation,\n  nextSegments : INextSegmentsInfos[],\n  dlSegment? : IChunkTimingInfos\n) : void {\n  log.debug(\"Smooth Parser: update segments information.\");\n  const representations = adaptation.representations;\n  for (let i = 0; i < representations.length; i++) {\n    const representation = representations[i];\n    representation.index._addSegments(nextSegments, dlSegment);\n  }\n}\n\nexport default function(options : ITransportOptions) : ITransportPipelines {\n  const smoothManifestParser = createSmoothManifestParser(options);\n  const segmentLoader = generateSegmentLoader(options.segmentLoader);\n\n  const manifestLoaderOptions = { customManifestLoader: options.manifestLoader };\n  const manifestLoader = generateManifestLoader(manifestLoaderOptions);\n\n  const manifestPipeline = {\n    resolver(\n      { url } : IManifestLoaderArguments\n    ) : Observable<IManifestLoaderArguments> {\n      if (url == null) {\n        return observableOf({ url : undefined });\n      }\n\n      // TODO Remove WSX logic\n      let resolving;\n      if (WSX_REG.test(url)) {\n        warnOnce(\"Giving WSX URL to loadVideo is deprecated.\" +\n          \" You should only give Manifest URLs.\");\n        resolving = request({ url: replaceToken(url, \"\"),\n                              responseType: \"document\" })\n          .pipe(map(({ value }) : string => {\n            const extractedURL = extractISML(value.responseData);\n            if (!extractedURL) {\n              throw new Error(\"Invalid ISML\");\n            }\n            return extractedURL;\n          }));\n      } else {\n        resolving = observableOf(url);\n      }\n\n      const token = extractToken(url);\n      return resolving.pipe(map((_url) => ({\n        url: replaceToken(resolveManifest(_url), token),\n      })));\n    },\n\n    loader: manifestLoader,\n\n    parser(\n      { response, url: reqURL } : IManifestParserArguments\n    ) : IManifestParserObservable {\n      const url = response.url == null ? reqURL :\n                                         response.url;\n      const data = typeof response.responseData === \"string\" ?\n        new DOMParser().parseFromString(response.responseData, \"text/xml\") :\n        response.responseData as Document; // TODO find a way to check if Document?\n      const {receivedTime: manifestReceivedTime } = response;\n      const parserResult = smoothManifestParser(data, url, manifestReceivedTime);\n      const manifest = new Manifest(parserResult, {\n        representationFilter: options.representationFilter,\n        supplementaryImageTracks: options.supplementaryImageTracks,\n        supplementaryTextTracks: options.supplementaryTextTracks,\n      });\n      return observableOf({ manifest, url });\n    },\n  };\n\n  const segmentPipeline = {\n    loader(\n      content : ISegmentLoaderArguments\n    ) : ISegmentLoaderObservable<ArrayBuffer|Uint8Array|null> {\n      if (content.segment.isInit || options.checkMediaSegmentIntegrity !== true) {\n        return segmentLoader(content);\n      }\n      return segmentLoader(content).pipe(tap(res => {\n        if ((res.type === \"data-loaded\" || res.type === \"data-chunk\") &&\n            res.value.responseData !== null)\n        {\n          checkISOBMFFIntegrity(new Uint8Array(res.value.responseData),\n                                content.segment.isInit);\n        }\n      }));\n    },\n\n    parser({\n      content,\n      response,\n    } : ISegmentParserArguments< ArrayBuffer | Uint8Array | null >\n    ) : ISegmentParserObservable< ArrayBuffer | Uint8Array > {\n      const { segment, adaptation, manifest } = content;\n      const { data, isChunked } = response;\n      if (data == null) {\n        return observableOf({ chunkData: null,\n                              chunkInfos: null,\n                              chunkOffset: 0,\n                              appendWindow: [undefined, undefined] });\n      }\n\n      if (segment.isInit) {\n        // smooth init segments are crafted by hand. Their timescale is the one\n        // from the manifest.\n        const initSegmentInfos = { timescale: segment.timescale,\n                                   time: 0,\n                                   duration: 0 };\n        return observableOf({ chunkData: data,\n                              chunkInfos: initSegmentInfos,\n                              chunkOffset: 0,\n                              appendWindow: [undefined, undefined] });\n      }\n\n      const responseBuffer = data instanceof Uint8Array ? data :\n                                                          new Uint8Array(data);\n\n      const { nextSegments, chunkInfos } = extractTimingsInfos(responseBuffer,\n                                                               isChunked,\n                                                               segment,\n                                                               manifest.isLive);\n      if (chunkInfos == null) {\n        throw new Error(\"Smooth Segment without time information\");\n      }\n      const chunkData = patchSegment(responseBuffer, chunkInfos.time);\n      if (nextSegments) {\n        addNextSegments(adaptation, nextSegments, chunkInfos);\n      }\n      return observableOf({ chunkData,\n                            chunkInfos,\n                            chunkOffset: 0,\n                            appendWindow: [undefined, undefined] });\n    },\n  };\n\n  const textTrackPipeline = {\n    loader({\n      segment,\n      representation,\n    } : ISegmentLoaderArguments\n    ) : ISegmentLoaderObservable<string|ArrayBuffer|null> {\n      if (segment.isInit || segment.mediaURL == null) {\n        return observableOf({ type: \"data-created\" as const,\n                              value: { responseData: null } });\n      }\n      const isMP4 = isMP4EmbeddedTrack(representation);\n      if (!isMP4 || options.checkMediaSegmentIntegrity !== true) {\n        return request({ url: segment.mediaURL,\n                         responseType: isMP4 ? \"arraybuffer\" : \"text\",\n                         sendProgressEvents: true });\n      }\n      return request({ url: segment.mediaURL,\n                       responseType: \"arraybuffer\",\n                       sendProgressEvents: true })\n        .pipe(tap(res => {\n          if (res.type === \"data-loaded\") {\n            checkISOBMFFIntegrity(new Uint8Array(res.value.responseData),\n                                  segment.isInit);\n          }\n        }));\n    },\n\n    parser({\n      content,\n      response,\n    } : ISegmentParserArguments<string|ArrayBuffer|Uint8Array|null>\n    ) : ITextParserObservable {\n      const { manifest, adaptation, representation, segment } = content;\n      const { language } = adaptation;\n      const { mimeType = \"\", codec = \"\" } = representation;\n      const { data, isChunked } = response;\n      if (segment.isInit || data == null) {\n        return observableOf({ chunkData: null,\n                              chunkInfos: null,\n                              chunkOffset: 0,\n                              appendWindow: [undefined, undefined] });\n      }\n\n      let nextSegments;\n      let chunkInfos : IChunkTimingInfos|null = null;\n      const isMP4 = mimeType.indexOf(\"mp4\") >= 0;\n\n      let _sdStart : number|undefined;\n      let _sdEnd : number|undefined;\n      let _sdTimescale : number = 1;\n      let _sdData : string;\n      let _sdType : string|undefined;\n\n      if (isMP4) {\n        let chunkBytes : Uint8Array;\n        if (typeof data === \"string\") {\n          chunkBytes = strToBytes(data);\n        } else {\n          chunkBytes = data instanceof Uint8Array ? data :\n            new Uint8Array(data);\n        }\n        const timings = extractTimingsInfos(chunkBytes,\n                                            isChunked,\n                                            segment,\n                                            manifest.isLive);\n\n        nextSegments = timings.nextSegments;\n        chunkInfos = timings.chunkInfos;\n        if (chunkInfos == null) {\n          if (isChunked) {\n            log.warn(\"Smooth: Unavailable time data for current text track.\");\n          } else {\n            _sdStart = segment.time;\n            _sdEnd = _sdStart + segment.duration;\n            _sdTimescale = segment.timescale;\n          }\n        } else {\n          _sdStart = chunkInfos.time;\n          _sdEnd = chunkInfos.duration != null ? chunkInfos.time + chunkInfos.duration :\n                                                 undefined;\n          _sdTimescale = chunkInfos.timescale;\n        }\n\n        const lcCodec = codec.toLowerCase();\n        if (mimeType === \"application/ttml+xml+mp4\" ||\n            lcCodec === \"stpp\" ||\n            lcCodec === \"stpp.ttml.im1t\"\n        ) {\n          _sdType = \"ttml\";\n        } else if (lcCodec === \"wvtt\") {\n          _sdType = \"vtt\";\n        } else {\n          throw new Error(\n            `could not find a text-track parser for the type ${mimeType}`);\n        }\n        const mdat = getMDAT(chunkBytes);\n        _sdData = stringFromUTF8(mdat);\n      } else {\n        let chunkString : string;\n        if (typeof data !== \"string\") {\n          const bytesData = data instanceof Uint8Array ? data :\n                                                         new Uint8Array(data);\n          chunkString = bytesToStr(bytesData);\n        } else {\n          chunkString = data;\n        }\n\n        const segmentTime = segment.time || 0;\n\n        // vod is simple WebVTT or TTML text\n        _sdStart = segmentTime;\n        _sdEnd = segmentTime + segment.duration;\n        _sdTimescale = segment.timescale;\n\n        switch (mimeType) {\n          case \"application/x-sami\":\n          case \"application/smil\": // TODO SMIL should be its own format, no?\n            _sdType = \"sami\";\n            break;\n          case \"application/ttml+xml\":\n            _sdType = \"ttml\";\n            break;\n          case \"text/vtt\":\n            _sdType = \"vtt\";\n            break;\n        }\n\n        if (!_sdType) {\n          const lcCodec = codec.toLowerCase();\n          if (lcCodec === \"srt\") {\n            _sdType = \"srt\";\n          } else {\n            throw new Error(\n              `could not find a text-track parser for the type ${mimeType}`);\n          }\n        }\n        _sdData = chunkString;\n      }\n\n      if (chunkInfos != null && nextSegments) {\n        addNextSegments(adaptation, nextSegments, chunkInfos);\n      }\n\n      return observableOf({ chunkData: { type: _sdType,\n                                         data: _sdData,\n                                         language,\n                                         timescale: _sdTimescale,\n                                         start: _sdStart,\n                                         end: _sdEnd },\n                            chunkInfos,\n                            chunkOffset: _sdStart == null ? 0 :\n                                                            _sdStart / _sdTimescale,\n                            appendWindow: [undefined, undefined] });\n    },\n  };\n\n  const imageTrackPipeline = {\n    loader(\n      { segment } : ISegmentLoaderArguments\n    ) : ISegmentLoaderObservable<ArrayBuffer|null> {\n      if (segment.isInit || segment.mediaURL == null) {\n        // image do not need an init segment. Passthrough directly to the parser\n        return observableOf({ type: \"data-created\" as const,\n                              value: { responseData: null } });\n      }\n\n      return request({ url: segment.mediaURL,\n                       responseType: \"arraybuffer\",\n                       sendProgressEvents: true });\n    },\n\n    parser(\n      { response, content } : ISegmentParserArguments<Uint8Array|ArrayBuffer|null>\n    ) : IImageParserObservable {\n      const { segment } = content;\n      const { data, isChunked } = response;\n\n      if (isChunked) {\n        throw new Error(\"Image data should not be downloaded in chunks\");\n      }\n\n      // TODO image Parsing should be more on the sourceBuffer side, no?\n      if (data === null || features.imageParser == null) {\n        return observableOf({ chunkData: null,\n                              chunkInfos: segment.timescale > 0 ?\n                                { duration: segment.isInit ? 0 : segment.duration,\n                                  time: segment.isInit ? 0 : segment.time,\n                                  timescale: segment.timescale } :\n                                null,\n                              chunkOffset: 0,\n                              appendWindow: [undefined, undefined] });\n      }\n\n      const bifObject = features.imageParser(new Uint8Array(data));\n      const thumbsData = bifObject.thumbs;\n      return observableOf({ chunkData: { data: thumbsData,\n                                           start: 0,\n                                           end: Number.MAX_VALUE,\n                                           timescale: 1,\n                                           type: \"bif\" },\n                            chunkInfos: { time: 0,\n                                            duration: Number.MAX_VALUE,\n                                            timescale: bifObject.timescale },\n                            chunkOffset: 0,\n                            appendWindow: [undefined, undefined] });\n    },\n  };\n\n  return { manifest: manifestPipeline,\n           audio: segmentPipeline,\n           video: segmentPipeline,\n           text: textTrackPipeline,\n           image: imageTrackPipeline };\n}\n\n/**\n * Returns true if the given texttrack segment represents a textrack embedded\n * in a mp4 file.\n * @param {Representation} representation\n * @returns {Boolean}\n */\nfunction isMP4EmbeddedTrack(representation : Representation) : boolean {\n  return !!representation.mimeType &&\n         representation.mimeType.indexOf(\"mp4\") >= 0;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * /!\\ This file is feature-switchable.\n * It always should be imported through the `features` object.\n */\n\nimport SmoothPipelines from \"./pipelines\";\nexport default SmoothPipelines;\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst FUZZ_FACTOR = 0.3;\n\n/**\n * Perform \"fuzzing\" on the delay given.\n * @param {Number} retryDelay\n * @returns {Number}\n */\nexport default function getFuzzedDelay(retryDelay : number) : number {\n  const fuzzingFactor = ((Math.random() * 2) - 1) * FUZZ_FACTOR;\n  return retryDelay * (fuzzingFactor + 1.0); // Max 1.3 Min 0.7\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Observable,\n  timer as observableTimer,\n} from \"rxjs\";\nimport {\n  catchError,\n  map,\n  mergeMap,\n  startWith,\n} from \"rxjs/operators\";\nimport { isOffline } from \"../../../compat\";\nimport {\n  isKnownError,\n  NetworkErrorTypes,\n  RequestError,\n} from \"../../../errors\";\nimport getFuzzedDelay from \"../../../utils/get_fuzzed_delay\";\n\n/**\n * Called on a pipeline's loader error.\n * Returns whether the loader request should be retried.\n * @param {Error} error\n * @returns {Boolean} - If true, the request can be retried.\n */\nfunction shouldRetry(error : unknown) : boolean {\n  if (error instanceof RequestError) {\n    if (error.type === NetworkErrorTypes.ERROR_HTTP_CODE) {\n      return error.status >= 500 ||\n             error.status === 404 ||\n             error.status === 415 || // some CDN seems to use that code when\n                                     // requesting low-latency segments too much\n                                     // in advance\n             error.status === 412;\n    }\n    return error.type === NetworkErrorTypes.TIMEOUT ||\n           error.type === NetworkErrorTypes.ERROR_EVENT;\n  }\n  return isKnownError(error) && error.code === \"INTEGRITY_ERROR\";\n}\n\n/**\n * Returns true if we're pretty sure that the current error is due to the\n * user being offline.\n * @param {Error} error\n * @returns {Boolean}\n */\nfunction isOfflineRequestError(error : RequestError) : boolean {\n  return error.type === NetworkErrorTypes.ERROR_EVENT &&\n         isOffline();\n}\n\nexport interface IBackoffOptions { baseDelay : number;\n                                   maxDelay : number;\n                                   maxRetryRegular : number;\n                                   maxRetryOffline : number; }\n\nexport interface IBackoffRetry {\n  type : \"retry\";\n  value : unknown; // The error that made us retry\n}\n\nexport interface IBackoffResponse<T> {\n  type : \"response\";\n  value : T;\n}\n\nexport type IBackoffEvent<T> = IBackoffRetry |\n                               IBackoffResponse<T>;\n\n/**\n * Specific exponential backoff algorithm used for segments/manifest\n * downloading.\n *\n * The specificty here in comparaison to a \"regular\" backoff algorithm is\n * the separation between type of errors:\n *   - \"offline\" errors\n *   - other xhr errors\n * Both have their own counters which are resetted if the error type changes.\n * @param {Observable} obs$\n * @param {Object} options - Configuration options.\n * @returns {Observable}\n */\nexport default function backoff<T>(\n  obs$ : Observable<T>,\n  options : IBackoffOptions\n) : Observable<IBackoffEvent<T>> {\n  const { baseDelay,\n          maxDelay,\n          maxRetryRegular,\n          maxRetryOffline } = options;\n\n  let retryCount = 0;\n\n  const ERROR_TYPES = { NONE: 0,\n                        REGULAR: 1,\n                        OFFLINE: 2 };\n\n  let lastError = ERROR_TYPES.NONE;\n\n  return obs$.pipe(\n    map(res => ({ type : \"response\" as const, value: res })),\n    catchError((error : unknown, source) => {\n      if (!shouldRetry(error)) {\n        throw error;\n      }\n      const currentError = error instanceof RequestError &&\n                           isOfflineRequestError(error) ? ERROR_TYPES.OFFLINE :\n                                                          ERROR_TYPES.REGULAR;\n\n      const maxRetry = currentError === ERROR_TYPES.OFFLINE ? maxRetryOffline :\n                                                              maxRetryRegular;\n\n      if (currentError !== lastError) {\n        retryCount = 0;\n        lastError = currentError;\n      }\n\n      if (++retryCount > maxRetry) {\n        throw error;\n      }\n\n      const delay = Math.min(baseDelay * Math.pow(2, retryCount - 1),\n                             maxDelay);\n\n      const fuzzedDelay = getFuzzedDelay(delay);\n      return observableTimer(fuzzedDelay).pipe(\n        mergeMap(() => source),\n        startWith({ type: \"retry\" as const, value: error })\n      );\n    })\n  );\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  formatError,\n  ICustomError,\n  NetworkError,\n  RequestError,\n} from \"../../../errors\";\n\n/**\n * Generate a new error from the infos given.\n * @param {string} code\n * @param {Error} error\n * @returns {Error}\n */\nexport default function errorSelector(error : unknown) : ICustomError {\n  if (error instanceof RequestError) {\n    return new NetworkError(\"PIPELINE_LOAD_ERROR\", error);\n  }\n  return formatError(error, {\n    defaultCode: \"PIPELINE_LOAD_ERROR\",\n    defaultReason: \"Unknown error when fetching the Manifest\",\n  });\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Observable,\n  of as observableOf,\n} from \"rxjs\";\nimport {\n  catchError,\n  map,\n  mergeMap,\n} from \"rxjs/operators\";\nimport { ICustomError } from \"../../../errors\";\nimport {\n  ILoadedManifest,\n  IManifestLoaderArguments,\n  IManifestLoaderEvent,\n  IManifestLoaderFunction,\n  IManifestResolverFunction,\n  ITransportManifestPipeline,\n} from \"../../../transports\";\nimport tryCatch from \"../../../utils/rx-try_catch\";\nimport backoff from \"../utils/backoff\";\nimport errorSelector from \"../utils/error_selector\";\n\n// An Error happened while loading (usually a request error)\nexport interface IPipelineLoaderWarning { type : \"warning\";\n                                          value : ICustomError; }\n\nexport interface IPipelineLoaderResponseValue<T> { responseData : T;\n                                                   url? : string;\n                                                   sendingTime? : number;\n                                                   receivedTime? : number; }\n\n// A response is available\nexport interface IPipelineLoaderResponse<T> { type : \"response\";\n                                              value : IPipelineLoaderResponseValue<T>; }\n\nexport type IManifestPipelineLoaderResponse =\n  IPipelineLoaderResponse<ILoadedManifest>;\n\n// Events a loader emits\n// Type parameters: T: Argument given to the loader\n//                  U: ResponseType of the request\nexport type IManifestPipelineLoaderEvent = IManifestPipelineLoaderResponse |\n                                           IPipelineLoaderWarning;\n\n// Options you can pass on to the loader\nexport interface IManifestPipelineLoaderOptions {\n  maxRetry : number; // Maximum number of time a request on error will be retried\n  maxRetryOffline : number; // Maximum number of time a request be retried when\n                            // the user is offline\n  baseDelay : number; // initial delay when retrying a request\n  maxDelay : number; // maximum delay when retrying a request\n}\n\n/**\n * Returns function allowing to download the Manifest through a resolver ->\n * loader pipeline.\n *\n * The function returned takes the loader's data in arguments and returns an\n * Observable which will emit:\n *\n *   - each time a minor request error is encountered (type \"warning\").\n *     With the error as a value.\n *\n *   - The fetched data (type \"response\").\n *\n * This observable will throw if, following the options given, the request and\n * possible retry all failed.\n *\n * This observable will complete after emitting the data.\n *\n * @param {Object} manifestPipeline\n * @param {Object} options\n * @returns {Function}\n */\nexport default function createManifestLoader(\n  manifestPipeline : ITransportManifestPipeline,\n  options : IManifestPipelineLoaderOptions\n) : (x : IManifestLoaderArguments) => Observable<IManifestPipelineLoaderEvent> {\n  const { maxRetry, maxRetryOffline } = options;\n  const loader : IManifestLoaderFunction = manifestPipeline.loader;\n\n  // TODO Remove the resolver completely\n  const resolver : IManifestResolverFunction =\n    manifestPipeline.resolver != null ? manifestPipeline.resolver :\n                                        /* tslint:disable deprecation */\n                                        observableOf;\n                                        /* tslint:enable deprecation */\n\n  // Backoff options given to the backoff retry done with the loader function.\n  const backoffOptions = { baseDelay: options.baseDelay,\n                           maxDelay: options.maxDelay,\n                           maxRetryRegular: maxRetry,\n                           maxRetryOffline };\n  /**\n   * Call the transport's resolver - if it exists - with the given data.\n   *\n   * Throws with the right error if it fails.\n   * @param {Object} resolverArgument\n   * @returns {Observable}\n   */\n  function callResolver(\n    resolverArgument : IManifestLoaderArguments\n  ) : Observable<IManifestLoaderArguments> {\n    return tryCatch(resolver, resolverArgument)\n      .pipe() // Weird TypeScript/RxJS behavior\n      .pipe(catchError((error : Error) : Observable<never> => {\n        throw errorSelector(error);\n      }));\n  }\n\n  /**\n   * Load wanted data:\n   *   - get it from cache if present\n   *   - call the transport loader - with an exponential backoff - if not\n   *\n   * @param {Object} loaderArgument - Input given to the loader\n   * @returns {Observable}\n   */\n  function loadData(\n    loaderArgument : IManifestLoaderArguments\n  ) : Observable< IManifestLoaderEvent |\n                  IPipelineLoaderWarning >\n  {\n    return backoff(tryCatch(loader, loaderArgument), backoffOptions).pipe(\n      catchError((error : unknown) : Observable<never> => {\n        throw errorSelector(error);\n      }),\n      map((evt) : IManifestLoaderEvent |\n                  IPipelineLoaderWarning =>\n      {\n        return evt.type === \"response\" ? evt.value :\n                                         ({ type: \"warning\" as const,\n                                            value: errorSelector(evt.value) });\n      }));\n  }\n\n  /**\n   * Load the corresponding data.\n   * @param {Object} pipelineInputData\n   * @returns {Observable}\n   */\n  return function startPipeline(\n    loaderArgs : IManifestLoaderArguments\n  ) : Observable<IManifestPipelineLoaderEvent> {\n    return callResolver(loaderArgs).pipe(\n      mergeMap((resolverResponse : IManifestLoaderArguments) => {\n        return loadData(resolverResponse).pipe(\n          mergeMap((arg) => {\n            if (arg.type === \"warning\") {\n              return observableOf(arg);\n            }\n            const value = arg.value;\n            return observableOf({ type: \"response\" as const,\n                                  value: { responseData: value.responseData,\n                                           url: value.url,\n                                           sendingTime: value.sendingTime,\n                                           receivedTime: value.receivedTime } });\n          }));\n      }));\n  };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport config from \"../../../config\";\n\nconst { DEFAULT_MAX_MANIFEST_REQUEST_RETRY,\n        DEFAULT_MAX_PIPELINES_RETRY_ON_ERROR,\n        INITIAL_BACKOFF_DELAY_BASE,\n        MAX_BACKOFF_DELAY_BASE } = config;\n\n/**\n * Parse config to replace missing manifest pipeline options.\n * @param {Object} manifestPipelineOptions\n * @returns {Object}\n */\nexport default function parseManifestPipelineOptions(\n  { manifestRetry,\n    offlineRetry,\n    lowLatencyMode }: { manifestRetry? : number;\n                        offlineRetry? : number;\n                        lowLatencyMode : boolean; }\n) : { baseDelay : number;\n      lowLatencyMode : boolean;\n      maxDelay : number;\n      maxRetry : number;\n      maxRetryOffline : number; } {\n  const baseDelay = lowLatencyMode ? INITIAL_BACKOFF_DELAY_BASE.LOW_LATENCY :\n                                     INITIAL_BACKOFF_DELAY_BASE.REGULAR;\n  const maxDelay = lowLatencyMode ? MAX_BACKOFF_DELAY_BASE.LOW_LATENCY :\n                                    MAX_BACKOFF_DELAY_BASE.REGULAR;\n  return {\n    baseDelay,\n    maxDelay,\n    maxRetry: manifestRetry != null ? manifestRetry :\n                                      DEFAULT_MAX_MANIFEST_REQUEST_RETRY,\n    maxRetryOffline: offlineRetry != null ? offlineRetry :\n                                            DEFAULT_MAX_PIPELINES_RETRY_ON_ERROR,\n    lowLatencyMode,\n  };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  EMPTY,\n  Observable,\n  of as observableOf,\n  Subject,\n} from \"rxjs\";\nimport {\n  catchError,\n  filter,\n  map,\n  mergeMap,\n  tap,\n} from \"rxjs/operators\";\nimport {\n  formatError,\n  ICustomError,\n} from \"../../../errors\";\nimport Manifest from \"../../../manifest\";\nimport {\n  ILoadedManifest,\n  ITransportPipelines,\n} from \"../../../transports\";\nimport tryCatch from \"../../../utils/rx-try_catch\";\nimport backoff from \"../utils/backoff\";\nimport errorSelector from \"../utils/error_selector\";\nimport createManifestLoader, {\n  IPipelineLoaderResponse,\n  IPipelineLoaderResponseValue,\n} from \"./create_manifest_loader\";\nimport parseManifestPipelineOptions from \"./parse_manifest_pipeline_options\";\n\n// What will be sent once parsed\nexport interface IFetchManifestResult { manifest : Manifest;\n                                        sendingTime? : number; }\n\n// The Manifest Pipeline generated here\nexport interface ICoreManifestPipeline {\n  fetch(url? : string) : Observable<IPipelineLoaderResponse<ILoadedManifest>>;\n  parse(response : IPipelineLoaderResponseValue<ILoadedManifest>,\n        url? : string,\n        externalClockOffset? : number) : Observable<IFetchManifestResult>;\n}\n\nexport interface IManifestPipelineOptions {\n  lowLatencyMode : boolean; // Whether the content is a low-latency content\n                            // This has an impact on default backoff delays\n  manifestRetry? : number; // Maximum number of time a request on error will be retried\n  offlineRetry? : number; // Maximum number of time a request be retried when\n                          // the user is offline\n}\n\n/**\n * Create function allowing to easily fetch and parse the manifest from its URL.\n *\n * @example\n * ```js\n * const manifestPipeline = createManifestPipeline(pipelines, options, warning$);\n * manifestPipeline.fetch(manifestURL)\n *  .mergeMap((evt) => {\n *    if (evt.type !== \"response\") { // Might also receive warning events\n *      return EMPTY;\n *    }\n *    return manifestPipeline.parse(evt.value);\n *  }).subscribe(({ manifest }) => console.log(\"Manifest:\", manifest));\n * ```\n *\n * @param {Object} pipelines\n * @param {Subject} pipelineOptions\n * @param {Subject} warning$\n * @returns {Function}\n */\nexport default function createManifestPipeline(\n  pipelines : ITransportPipelines,\n  pipelineOptions : IManifestPipelineOptions,\n  warning$ : Subject<ICustomError>\n) : ICoreManifestPipeline {\n  const parsedOptions = parseManifestPipelineOptions(pipelineOptions);\n  const loader = createManifestLoader(pipelines.manifest, parsedOptions);\n  const { parser } = pipelines.manifest;\n\n  /**\n   * Allow the parser to schedule a new request.\n   * @param {Object} transportPipeline\n   * @param {Object} options\n   * @returns {Function}\n   */\n  function scheduleRequest<T>(request : () => Observable<T>) : Observable<T> {\n    const backoffOptions = { baseDelay: parsedOptions.baseDelay,\n                             maxDelay: parsedOptions.maxDelay,\n                             maxRetryRegular: parsedOptions.maxRetry,\n                             maxRetryOffline: parsedOptions.maxRetryOffline };\n    return backoff(tryCatch(request, undefined), backoffOptions).pipe(\n      mergeMap(evt => {\n        if (evt.type === \"retry\") {\n          warning$.next(errorSelector(evt.value));\n          return EMPTY;\n        }\n        return observableOf(evt.value);\n      }),\n      catchError((error : unknown) : Observable<never> => {\n        throw errorSelector(error);\n      }));\n  }\n\n  return {\n    /**\n     * Fetch the manifest corresponding to the URL given.\n     * @param {string} url - URL of the manifest\n     * @returns {Observable}\n     */\n    fetch(url : string) : Observable<IPipelineLoaderResponse<ILoadedManifest>> {\n      return loader({ url }).pipe(\n        tap((arg) => {\n          if (arg.type === \"warning\") {\n            warning$.next(arg.value); // TODO not through warning$\n          }\n        }),\n        filter((arg) : arg is IPipelineLoaderResponse<ILoadedManifest> =>\n          arg.type === \"response\"\n        )\n      );\n    },\n\n    /**\n     * Fetch the manifest corresponding to the URL given.\n     * @param {Object} value - The Manifest document to parse.\n     * @param {string} [url] - URL of the manifest\n     * @param {number} [externalClockOffset]\n     * @returns {Observable}\n     */\n    parse(\n      value : IPipelineLoaderResponseValue<ILoadedManifest>,\n      fetchedURL? : string,\n      externalClockOffset? : number\n    ) : Observable<IFetchManifestResult> {\n      const { sendingTime } = value;\n      return parser({ response: value,\n                      url: fetchedURL,\n                      externalClockOffset,\n                      scheduleRequest,\n      }).pipe(\n        catchError((error: unknown) => {\n          throw formatError(error, {\n            defaultCode: \"PIPELINE_PARSE_ERROR\",\n            defaultReason: \"Unknown error when parsing the Manifest\",\n          });\n        }),\n        map(({ manifest }) => {\n          const warnings = manifest.parsingErrors;\n          for (let i = 0; i < warnings.length; i++) {\n            warning$.next(warnings[i]); // TODO not through warning$\n          }\n          return { manifest, sendingTime };\n        })\n      );\n    },\n  };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport createManifestPipeline, {\n  IFetchManifestResult,\n} from \"./create_manifest_pipeline\";\n\nexport default createManifestPipeline;\nexport { IFetchManifestResult };\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Observable } from \"rxjs\";\nimport { ISegmentLoaderArguments } from \"../../../transports\";\nimport ObservablePrioritizer from \"./prioritizer\";\nimport {\n  ISegmentFetcher,\n  ISegmentFetcherEvent,\n} from \"./segment_fetcher\";\n\n// Defines what is returned by the SegmentPipeline\n// See the function definition for documentation\nexport interface IPrioritizedSegmentFetcher<T> {\n  createRequest : (content : ISegmentLoaderArguments,\n                   priority? : number) => Observable<ISegmentFetcherEvent<T>>;\n\n  updatePriority : (observable : Observable<ISegmentFetcherEvent<T>>,\n                    priority : number) => void;\n}\n\n/**\n * This function basically put in relation:\n *   - a SegmentFetcher, which will be used to perform the segment request\n *   - a prioritizer, which will handle the priority of a segment request\n *\n * and returns functions to fetch segments with a given priority.\n * @param {Object} prioritizer\n * @param {Object} fetcher\n * @returns {Object}\n */\nexport default function applyPrioritizerToSegmentFetcher<T>(\n  prioritizer : ObservablePrioritizer<ISegmentFetcherEvent<T>>,\n  fetcher : ISegmentFetcher<T>\n) : IPrioritizedSegmentFetcher<T> {\n  return {\n    /**\n     * Create a Segment request with a given priority.\n     * @param {Object} content - content to request\n     * @param {Number} priority - priority at which the content should be\n     * requested.\n     * @returns {Observable}\n     */\n    createRequest(\n      content : ISegmentLoaderArguments,\n      priority : number = 0\n    ) : Observable<ISegmentFetcherEvent<T>> {\n      return prioritizer.create(fetcher(content), priority);\n    },\n\n    /**\n     * Update the priority of a pending request, created through createRequest.\n     * @param {Observable} observable - the corresponding request\n     * @param {Number} priority\n     */\n    updatePriority(\n      observable : Observable<ISegmentFetcherEvent<T>>,\n      priority : number\n    ) : void {\n      prioritizer.updatePriority(observable, priority);\n    },\n\n  };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { AssertionError } from \"../errors\";\n\nexport default function assertUnreachable(_: never): never {\n    throw new AssertionError(\"Unreachable path taken\");\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport objectAssign from \"object-assign\";\nimport {\n  concat as observableConcat,\n  EMPTY,\n  Observable,\n  of as observableOf,\n} from \"rxjs\";\nimport {\n  catchError,\n  map,\n  mergeMap,\n} from \"rxjs/operators\";\nimport { ICustomError } from \"../../../errors\";\nimport {\n  ILoaderDataLoadedValue,\n  ILoaderProgress,\n  ISegmentLoaderArguments,\n  ISegmentLoaderEvent,\n  ISegmentLoaderObservable,\n} from \"../../../transports\";\nimport assertUnreachable from \"../../../utils/assert_unreachable\";\nimport castToObservable from \"../../../utils/cast_to_observable\";\nimport tryCatch from \"../../../utils/rx-try_catch\";\nimport backoff from \"../utils/backoff\";\nimport errorSelector from \"../utils/error_selector\";\n\n// Data comes from a local cache (no request was done)\ninterface IPipelineLoaderCache<T> { type : \"cache\";\n                                    value : ILoaderDataLoadedValue<T>; }\nexport type IPipelineLoaderProgress = ILoaderProgress;\n\n// An Error happened while loading (usually a request error)\nexport interface IPipelineLoaderWarning { type : \"warning\";\n                                          value : ICustomError; }\n\n// Request metrics are available\nexport interface IPipelineLoaderMetrics { type : \"metrics\";\n                                          value : { size? : number;\n                                                    duration? : number; }; }\n\n// The request begins to be done\nexport interface IPipelineLoaderRequest { type : \"request\";\n                                          value : ISegmentLoaderArguments; }\n\n// The whole data is available\nexport interface IPipelineLoaderData<T> { type : \"data\";\n                                          value : { responseData : T }; }\n\n// A chunk of the data is available\nexport interface IPipelineLoaderChunk { type : \"chunk\";\n                                        value : { responseData : null |\n                                                                 ArrayBuffer |\n                                                                 Uint8Array; }; }\n// The data has been entirely sent through \"chunk\" events\nexport interface IPipelineLoaderChunkComplete { type : \"chunk-complete\";\n                                                value : null; }\n\n// Events a loader emits\n// Type parameters: T: Argument given to the loader\n//                  U: ResponseType of the request\nexport type IPipelineLoaderEvent<T> = IPipelineLoaderData<T> |\n                                      IPipelineLoaderRequest |\n                                      IPipelineLoaderProgress |\n                                      IPipelineLoaderWarning |\n                                      IPipelineLoaderChunk |\n                                      IPipelineLoaderChunkComplete |\n                                      IPipelineLoaderMetrics;\n\n// Options you can pass on to the loader\nexport interface ISegmentPipelineLoaderOptions<T> {\n  cache? : { add : (obj : ISegmentLoaderArguments,\n                    arg : ILoaderDataLoadedValue<T>) => void;\n             get : (obj : ISegmentLoaderArguments)\n                     => ILoaderDataLoadedValue<T>; }; // Caching logic\n  maxRetry : number; // Maximum number of time a request on error will be retried\n  maxRetryOffline : number; // Maximum number of time a request be retried when\n                            // the user is offline\n  initialBackoffDelay : number;\n  maximumBackoffDelay : number;\n}\n\nexport type ISegmentPipelineLoader<T> =\n  (x : ISegmentLoaderArguments) => ISegmentLoaderObservable<T>;\n\n/**\n * Returns function allowing to download the wanted data through the loader.\n *\n * (The data can be for example: audio and video segments, text,\n * images...)\n *\n * The function returned takes the initial data in arguments and returns an\n * Observable which will emit:\n *\n *   - each time a request begins (type \"request\").\n *     This is not emitted if the value is retrieved from a local js cache.\n *     This event emits the payload as a value.\n *\n *   - as the request progresses (type \"progress\").\n *\n *   - each time a request ends (type \"metrics\").\n *     This event contains information about the metrics of the request.\n *\n *   - each time a minor request error is encountered (type \"warning\").\n *     With the error as a value.\n *\n *   - Lastly, with the fetched data (type \"response\").\n *\n *\n * Each of these but \"warning\" can be emitted at most one time.\n *\n * This observable will throw if, following the options given, the request and\n * possible retry all failed.\n *\n * This observable will complete after emitting the data.\n *\n * Type parameters:\n *   - T: type of the data emitted\n *\n * @param {Object} segmentPipeline\n * @param {Object} options\n * @returns {Function}\n */\nexport default function createSegmentLoader<T>(\n  loader : ISegmentPipelineLoader<T>,\n  options : ISegmentPipelineLoaderOptions<T>\n) : (x : ISegmentLoaderArguments) => Observable<IPipelineLoaderEvent<T>> {\n  const { cache, maxRetry, maxRetryOffline } = options;\n\n  // Backoff options given to the backoff retry done with the loader function.\n  const backoffOptions = { baseDelay: options.initialBackoffDelay,\n                           maxDelay: options.maximumBackoffDelay,\n                           maxRetryRegular: maxRetry,\n                           maxRetryOffline };\n\n  /**\n   * Load wanted data:\n   *   - get it from cache if present\n   *   - call the transport loader - with an exponential backoff - if not\n   *\n   * @param {Object} loaderArgument - Input given to the loader\n   * @returns {Observable}\n   */\n  function loadData(\n    loaderArgument : ISegmentLoaderArguments\n  ) : Observable< ISegmentLoaderEvent<T> |\n                  IPipelineLoaderRequest |\n                  IPipelineLoaderWarning |\n                  IPipelineLoaderCache<T>>\n  {\n\n    /**\n     * Call the Pipeline's loader with an exponential Backoff.\n     * @returns {Observable}\n     */\n    function startLoaderWithBackoff(\n    ) : Observable< ISegmentLoaderEvent<T> |\n                    IPipelineLoaderRequest |\n                    IPipelineLoaderWarning >\n    {\n      const request$ = backoff<ISegmentLoaderEvent<T>>(\n        tryCatch<ISegmentLoaderArguments,\n                 ISegmentLoaderEvent<T>>(loader, loaderArgument),\n        backoffOptions\n      ).pipe(\n        catchError((error : unknown) : Observable<never> => {\n          throw errorSelector(error);\n        }),\n\n        map((evt) : ISegmentLoaderEvent<T> | IPipelineLoaderWarning => {\n          if (evt.type === \"retry\") {\n            return { type: \"warning\" as const,\n                     value: errorSelector(evt.value) };\n          }\n\n          const response = evt.value;\n          if (response.type === \"data-loaded\" && cache != null) {\n            cache.add(loaderArgument, response.value);\n          }\n          return evt.value;\n        }));\n\n      return observableConcat(\n        observableOf({ type: \"request\" as const, value: loaderArgument }),\n        request$\n      );\n    }\n\n    const dataFromCache = cache != null ? cache.get(loaderArgument) :\n                                          null;\n\n    if (dataFromCache != null) {\n      return castToObservable(dataFromCache).pipe(\n        map(response => {\n          return { type: \"cache\" as const,\n                   value: response };\n        }),\n        catchError(startLoaderWithBackoff)\n      );\n    }\n\n    return startLoaderWithBackoff();\n  }\n\n  /**\n   * Load the corresponding data.\n   * @param {Object} pipelineInputData\n   * @returns {Observable}\n   */\n  return function startPipeline(\n    pipelineInputData : ISegmentLoaderArguments\n  ) : Observable<IPipelineLoaderEvent<T>> {\n    return loadData(pipelineInputData).pipe(\n      mergeMap((arg) : Observable<IPipelineLoaderEvent<T>> => {\n        const metrics$ =\n          arg.type === \"data-chunk-complete\" ||\n          arg.type === \"data-loaded\" ? observableOf({\n                                           type: \"metrics\" as const,\n                                           value: { size: arg.value.size,\n                                                    duration: arg.value.duration } }) :\n                                       EMPTY;\n\n        // \"cache\": data taken from cache by the pipeline\n        // \"data-created\": the data is available but no request has been done\n        // \"data-loaded\": data received through a request\n        switch (arg.type) {\n          case \"warning\":\n            return observableOf(arg);\n          case \"cache\":\n          case \"data-created\":\n          case \"data-loaded\":\n            const chunck$ = observableOf({\n              type: \"data\" as const,\n              value: objectAssign({},\n                                  pipelineInputData,\n                                  { responseData: arg.value.responseData }),\n            });\n            return observableConcat(chunck$, metrics$);\n          case \"request\":\n          case \"progress\":\n            return observableOf(arg);\n\n          case \"data-chunk\":\n            return observableOf({ type: \"chunk\" as const,\n                                  value: objectAssign({}, pipelineInputData, {\n                                    responseData: arg.value.responseData }),\n            });\n          case \"data-chunk-complete\":\n            const _complete$ = observableOf({ type: \"chunk-complete\" as const,\n                                              value: null });\n            return observableConcat(_complete$, metrics$);\n        }\n        return assertUnreachable(arg);\n      }));\n  };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  concat as observableConcat,\n  Observable,\n  of as observableOf,\n  Subject,\n} from \"rxjs\";\nimport {\n  catchError,\n  filter,\n  finalize,\n  mergeMap,\n  share,\n  tap,\n} from \"rxjs/operators\";\nimport { formatError } from \"../../../errors\";\nimport { ISegment } from \"../../../manifest\";\nimport {\n  IChunkTimingInfos,\n  ISegmentLoaderArguments,\n  ISegmentParserResponse,\n  ITransportPipelines,\n} from \"../../../transports\";\nimport idGenerator from \"../../../utils/id_generator\";\nimport {\n  IABRMetric,\n  IABRRequest,\n} from \"../../abr\";\nimport { IBufferType } from \"../../source_buffers\";\nimport createSegmentLoader, {\n  IPipelineLoaderChunk,\n  IPipelineLoaderChunkComplete,\n  IPipelineLoaderData,\n  IPipelineLoaderWarning,\n  ISegmentPipelineLoaderOptions,\n} from \"./create_segment_loader\";\n\nexport type ISegmentFetcherWarning = IPipelineLoaderWarning;\n\nexport interface ISegmentFetcherChunkEvent<T> {\n  type : \"chunk\";\n  parse : (init? : IChunkTimingInfos) => Observable<ISegmentParserResponse<T>>;\n}\n\nexport interface ISegmentFetcherChunkCompleteEvent { type: \"chunk-complete\"; }\n\nexport type ISegmentFetcherEvent<T> = ISegmentFetcherChunkCompleteEvent |\n                                      ISegmentFetcherChunkEvent<T> |\n                                      ISegmentFetcherWarning;\n\nexport type ISegmentFetcher<T> = (content : ISegmentLoaderArguments) =>\n                                   Observable<ISegmentFetcherEvent<T>>;\n\nconst generateRequestID = idGenerator();\n\n/**\n * Create a function which will fetch segments.\n *\n * @param {string} bufferType\n * @param {Object} transport\n * @param {Subject} requests$\n * @param {Object} options\n * @returns {Function}\n */\nexport default function createSegmentFetcher<T>(\n  bufferType : IBufferType,\n  transport : ITransportPipelines,\n  requests$ : Subject<IABRMetric | IABRRequest>,\n  options : ISegmentPipelineLoaderOptions<any>\n) : ISegmentFetcher<T> {\n  const segmentLoader = createSegmentLoader(transport[bufferType].loader, options);\n  const segmentParser = transport[bufferType].parser as any; // deal with it\n\n  /**\n   * Process a pipeline observable to adapt it to the the rest of the code:\n   *   - use the requests subject for network requests and their progress\n   *   - use the warning$ subject for retries' error messages\n   *   - only emit the data\n   * @param {string} pipelineType\n   * @param {Observable} pipeline$\n   * @returns {Observable}\n   */\n  return function fetchSegment(\n    content : ISegmentLoaderArguments\n  ) : Observable<ISegmentFetcherEvent<T>> {\n    const id = generateRequestID();\n    let requestBeginSent = false;\n    return segmentLoader(content).pipe(\n      tap((arg) => {\n        switch (arg.type) {\n          case \"metrics\": {\n            const { value } = arg;\n            const { size, duration } = value; // unwrapping for TS\n\n            // format it for ABR Handling\n            if (size != null && duration != null) {\n              requests$.next({ type: \"metrics\",\n                              value: { size, duration, content } });\n            }\n            break;\n          }\n\n          case \"request\": {\n            const { value } = arg;\n\n            // format it for ABR Handling\n            const segment : ISegment|undefined = value && value.segment;\n            if (segment == null || segment.duration == null) {\n              return;\n            }\n            requestBeginSent = true;\n            const duration = segment.duration / segment.timescale;\n            const time = segment.time / segment.timescale;\n            requests$.next({ type: \"requestBegin\",\n                             value: { duration,\n                                      time,\n                                      requestTimestamp: performance.now(),\n                                      id } });\n            break;\n          }\n\n          case \"progress\": {\n            const { value } = arg;\n            if (value.totalSize != null && value.size < value.totalSize) {\n              requests$.next({ type: \"progress\",\n                               value: { duration: value.duration,\n                                        size: value.size,\n                                        totalSize: value.totalSize,\n                                        timestamp: performance.now(),\n                                        id } });\n            }\n            break;\n          }\n        }\n      }),\n\n      finalize(() => {\n        if (requestBeginSent) {\n          requests$.next({ type: \"requestEnd\", value: { id } });\n        }\n      }),\n\n      filter((e) : e is IPipelineLoaderChunk |\n                        IPipelineLoaderChunkComplete |\n                        IPipelineLoaderData<T> |\n                        ISegmentFetcherWarning => e.type === \"warning\" ||\n                                                  e.type === \"chunk\" ||\n                                                  e.type === \"chunk-complete\" ||\n                                                  e.type === \"data\"),\n\n      mergeMap((evt) => {\n        if (evt.type === \"warning\") {\n          return observableOf(evt);\n        }\n        if (evt.type === \"chunk-complete\") {\n          return observableOf({ type: \"chunk-complete\" as const });\n        }\n\n        const isChunked = evt.type === \"chunk\";\n        const data = {\n          type: \"chunk\" as const,\n          /**\n           * Parse the loaded data.\n           * @param {Object} [init]\n           * @returns {Observable}\n           */\n          parse(init? : IChunkTimingInfos) : Observable<ISegmentParserResponse<T>> {\n            const response = { data: evt.value.responseData, isChunked };\n            return segmentParser({ response, init, content })\n              .pipe(catchError((error: unknown) => {\n                throw formatError(error, { defaultCode: \"PIPELINE_PARSE_ERROR\",\n                                           defaultReason: \"Unknown parsing error\" });\n              }));\n          },\n        };\n\n        if (isChunked) {\n          return observableOf(data);\n        }\n        return observableConcat(observableOf(data),\n                                observableOf({ type: \"chunk-complete\" as const }));\n      }),\n      share() // avoid multiple side effects if multiple subs\n    );\n  };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ISegment,\n  Representation,\n} from \"../manifest\";\n\n/**\n * Caching object used to cache initialization segments.\n * This allow to have a faster representation switch and faster seeking.\n * @class InitializationSegmentCache\n */\nclass InitializationSegmentCache<T> {\n  private _cache : WeakMap<Representation, T>;\n\n  constructor() {\n    this._cache = new WeakMap();\n  }\n\n  /**\n   * @param {Object} obj\n   * @param {*} response\n   */\n  public add(\n    { representation,\n      segment } : { representation : Representation;\n                    segment : ISegment; },\n    response : T\n  ) : void {\n    if (segment.isInit) {\n      this._cache.set(representation, response);\n    }\n  }\n\n  /**\n   * @param {Object} obj\n   * @returns {*} response\n   */\n  public get(\n    { representation,\n      segment } : { representation : Representation;\n                    segment : ISegment; }\n  ) : T|null {\n    if (segment.isInit) {\n      const value = this._cache.get(representation);\n      if (value != null) {\n        return value;\n      }\n    }\n    return null;\n  }\n}\n\nexport default InitializationSegmentCache;\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport config from \"../../../config\";\nimport {\n  ILoaderDataLoadedValue,\n  ISegmentLoaderArguments,\n} from \"../../../transports\";\nimport arrayIncludes from \"../../../utils/array_includes\";\nimport InitializationSegmentCache from \"../../../utils/initialization_segment_cache\";\n\nconst { DEFAULT_MAX_PIPELINES_RETRY_ON_ERROR,\n        DEFAULT_MAX_PIPELINES_RETRY_ON_OFFLINE,\n        INITIAL_BACKOFF_DELAY_BASE,\n        MAX_BACKOFF_DELAY_BASE } = config;\n\nexport interface ISegmentPipelineLoaderOptions<T> {\n  cache? : { add : (obj : ISegmentLoaderArguments,\n                    arg : ILoaderDataLoadedValue<T>) => void;\n             get : (obj : ISegmentLoaderArguments)\n                     => ILoaderDataLoadedValue<T>; }; // Caching logic\n  maxRetry : number; // Maximum number of time a request on error will be retried\n  maxRetryOffline : number; // Maximum number of time a request be retried when\n                            // the user is offline\n  initialBackoffDelay : number; // initial delay when retrying a request\n  maximumBackoffDelay : number; // maximum delay when retrying a request\n}\n\n/**\n * @param {string} bufferType\n * @param {Object}\n * @returns {Object}\n */\nexport default function parseSegmentPipelineOptions(\n  bufferType : string,\n  { segmentRetry,\n    offlineRetry,\n    lowLatencyMode } : { segmentRetry? : number;\n                         offlineRetry? : number;\n                         lowLatencyMode : boolean; }\n) : ISegmentPipelineLoaderOptions<any> {\n  const cache = arrayIncludes([\"audio\", \"video\"], bufferType) ?\n    new InitializationSegmentCache<any>() :\n    undefined;\n\n  let maxRetry : number;\n  if (bufferType === \"image\") {\n    maxRetry = 0; // Deactivate BIF fetching if it fails\n  } else {\n    maxRetry = segmentRetry != null ? segmentRetry :\n                                      DEFAULT_MAX_PIPELINES_RETRY_ON_ERROR;\n  }\n  const maxRetryOffline = offlineRetry != null ? offlineRetry :\n                                                 DEFAULT_MAX_PIPELINES_RETRY_ON_OFFLINE;\n\n  const initialBackoffDelay = lowLatencyMode ?\n    INITIAL_BACKOFF_DELAY_BASE.LOW_LATENCY :\n    INITIAL_BACKOFF_DELAY_BASE.REGULAR;\n\n  const maximumBackoffDelay = lowLatencyMode ?\n    MAX_BACKOFF_DELAY_BASE.LOW_LATENCY :\n    MAX_BACKOFF_DELAY_BASE.REGULAR;\n\n  return { cache,\n           maxRetry,\n           maxRetryOffline,\n           initialBackoffDelay,\n           maximumBackoffDelay };\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Array.prototype.find ponyfill.\n * @param {Array} arr\n * @param {Function} predicate\n * @param {*} context\n * @returns {boolean}\n */\nexport default function arrayFindIndex<T>(\n    arr : T[],\n    predicate : (arg: T, index : number, arr : T[]) => boolean,\n    thisArg? : any\n) : number {\n  if (typeof (Array.prototype as any).findIndex === \"function\") {\n    /* tslint:disable ban */\n    return (arr as any).findIndex(predicate, thisArg);\n    /* tslint:enable ban */\n  }\n\n  const len = arr.length >>> 0;\n  for (let i = 0; i < len; i++) {\n    if (predicate.call(thisArg, arr[i], i, arr)) {\n      return i;\n    }\n  }\n  return -1;\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  defer as observableDefer,\n  Observable,\n  Subject,\n} from \"rxjs\";\nimport {\n  finalize,\n  mergeMap,\n} from \"rxjs/operators\";\nimport arrayFindIndex from \"../../../utils/array_find_index\";\n\n/**\n * Create Observables which can be priorized between one another.\n *\n * With this class, you can create Observables with linked priority numbers.\n * The lower this number is, the more priority the resulting Observable will\n * have.\n *\n * Such Observable will then basically wait for pending Observables with more\n * priority to finish before \"starting\".\n *\n * You can also update the priority of an already-created Observable.\n * This will only have an effect if the Observable is currently \"waiting\" for\n * its turn (started observable won't be canceled if their priority were\n * lowered).\n *\n * ```js\n * const prioritizer = new ObservablePrioritizer();\n *\n * const observable1 = Observable.of(1);\n * const observable2 = Observable.of(2);\n * const observable3 = Observable.of(3);\n * const observable4 = Observable.of(4);\n * const observable5 = Observable.of(5);\n *\n * const pObservable1 = prioritizer.create(observable1, 4);\n * const pObservable2 = prioritizer.create(observable2, 2);\n * const pObservable3 = prioritizer.create(observable3, 1);\n * const pObservable4 = prioritizer.create(observable4, 3);\n * const pObservable5 = prioritizer.create(observable5, 2);\n *\n * // start every Observables at the same time\n * observableMerge(\n *   pObservable1,\n *   pObservable2,\n *   pObservable3,\n *   pObservable4,\n *   pObservable5\n * ).subscribe((i) => {\n *   // To spice things up, update pObservable1 priority to go before\n *   // pObservable4\n *   if (i === 5) { // if pObservable5 is currently emitting\n *     prioritizer.updatePriority(pObservable1, 1);\n *   }\n *   console.log(i);\n * });\n *\n * // Result:\n * // 3\n * // 2\n * // 5\n * // 1\n * // 4\n *\n * // Note: here \"1\" goes before \"4\" only because the former's priority has been\n * // updated before the latter was started.\n * // It would be the other way around if not.\n * ```\n *\n * @class ObservablePrioritizer\n */\nexport default class ObservablePrioritizer<T> {\n  /**\n   * Priority of the Observables currently running.\n   * Null if no Observable is currently running.\n   * @type {Number|null}\n   * @private\n   */\n  private _pendingPriority : number | null;\n\n  /**\n   * Number of Observables currently running.\n   * @type {Number|null}\n   * @private\n   */\n  private _numberOfPendingObservables : number;\n\n  /**\n   * Queue of Observables currently waiting for more prioritary Observables\n   * to finish.\n   * @type {Array.<Object>}\n   * @private\n   */\n  private _queue : Array<{ observable : Observable<T>;\n                           trigger : Subject<void>;\n                           priority : number; }>;\n\n  constructor() {\n    this._pendingPriority = null;\n    this._numberOfPendingObservables = 0;\n    this._queue = [];\n  }\n\n  /**\n   * Create a priorized Observable from a base Observable.\n   *\n   * When subscribed to, this Observable will have its priority compared to\n   * all the already-running Observables created from this class.\n   * Only if this number is inferior or equal to the priority of the\n   * currently-running Observables will it be immediately started.\n   * In the opposite case, we will wait for higher-priority Observables to\n   * finish before starting it.\n   *\n   * Note that while this Observable is waiting for its turn, it is possible\n   * to update its property through the updatePriority method, by providing\n   * the Observable returned by this function and its new priority number.\n   *\n   * @param {Observable} obs\n   * @param {number} priority\n   * @returns {Observable}\n   */\n  public create(obs : Observable<T>, priority : number) : Observable<T> {\n    const pObs$ = observableDefer(() => {\n      if (this._pendingPriority == null || this._pendingPriority >= priority) {\n        // Update the priority and start immediately the Observable\n        this._pendingPriority = priority;\n        return this._startObservable(obs);\n      } else {\n        const trigger = new Subject<void>();\n        this._queue.push({ observable: pObs$, priority, trigger });\n        return trigger\n          .pipe(mergeMap(() => this._startObservable(obs)));\n      }\n    });\n    return pObs$;\n  }\n\n  /**\n   * Update the priority of an Observable created through the create method.\n   *\n   * Note that this will only have an effect on Observable which are not yet\n   * started.\n   * This means it will only have an effect on:\n   *   - unsubscribed Observables\n   *   - Observables waiting for Observables with an higher priority to\n   *     finish\n   *\n   * @param {Observable} obs\n   * @param {number} priority\n   */\n  public updatePriority(obs : Observable<T>, priority : number) : void {\n    const index = arrayFindIndex(this._queue,\n                                 (elt) => elt.observable === obs);\n\n    if (index < 0) {\n      return;\n    }\n\n    const queueElement = this._queue[index];\n    queueElement.priority = priority;\n\n    if (this._pendingPriority == null || this._pendingPriority >= priority) {\n      this._queue.splice(index, 1);\n      queueElement.trigger.next();\n      queueElement.trigger.complete();\n    }\n  }\n\n  private _startObservable(obs : Observable<T>) : Observable<T> {\n    const onObservableFinish = () : void => {\n      this._numberOfPendingObservables--;\n\n      if (this._numberOfPendingObservables > 0) {\n        // still waiting for Observables to finish\n        return;\n      }\n\n      this._pendingPriority = null;\n\n      if (this._queue.length === 0) {\n        return;\n      }\n\n      this._pendingPriority = this._queue\n        .reduce((acc : number | null, elt) => {\n          return acc == null || acc > elt.priority ? elt.priority :\n                                                     acc;\n        }, null);\n\n      for (let i = 0; i < this._queue.length; i++) {\n        const elt = this._queue[i];\n        if (elt.priority === this._pendingPriority) {\n          this._queue.splice(i, 1);\n          i--;\n          elt.trigger.next();\n          elt.trigger.complete();\n        }\n      }\n    };\n\n    this._numberOfPendingObservables++;\n    return obs\n             .pipe(finalize(onObservableFinish));\n  }\n}\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Subject } from \"rxjs\";\nimport { ITransportPipelines } from \"../../../transports\";\nimport {\n  IABRMetric,\n  IABRRequest,\n} from \"../../abr\";\nimport { IBufferType } from \"../../source_buffers\";\nimport { ISegmentPipelineLoaderOptions } from \"./create_segment_loader\";\nimport getSegmentPipelineOptions from \"./get_segment_pipeline_options\";\nimport applyPrioritizerToSegmentFetcher, {\n  IPrioritizedSegmentFetcher,\n} from \"./prioritized_segment_fetcher\";\nimport ObservablePrioritizer from \"./prioritizer\";\nimport createSegmentFetcher, {\n  ISegmentFetcherEvent,\n} from \"./segment_fetcher\";\n\nexport interface ISegmentPipelineManagerOptions {\n  lowLatencyMode : boolean; // Whether the content is a low-latency content\n                            // This has an impact on default backoff delays\n  offlineRetry? : number; // Configuration for the maximum number of retries\n                          // the pipeline will do when the user is offline\n  segmentRetry? : number; // Configuration for the maximum number of retries\n                          // the pipeline will do when the request failed on\n                          // a retryable error\n}\n\n/**\n * Interact with the networking pipelines to download segments with the right\n * priority.\n *\n * @class SegmentPipelinesManager\n *\n * @example\n * ```js\n * // 1 - create the manager\n * const segmentPipelinesManager = new SegmentPipelinesManager(transport);\n *\n * // 2 - create a new pipeline with its own options\n * const pipeline = segmentPipelinesManager.createPipeline(\"audio\", {\n *   maxRetry: Infinity,\n *   maxRetryOffline: Infinity,\n * });\n *\n * // 3 - load a segment with a given priority\n * pipeline.createRequest(myContent, 1)\n *\n *   // 4 - parse it\n *   .pipe(\n *     filter(evt => evt.type === \"response\"),\n *     mergeMap(response => response.parse());\n *   )\n *\n *   // 5 - use it\n *   .subscribe((res) => console.log(\"audio segment downloaded:\", res));\n * ```\n */\nexport default class SegmentPipelinesManager<T> {\n  private readonly _transport : ITransportPipelines;\n  private readonly _prioritizer : ObservablePrioritizer<ISegmentFetcherEvent<T>>;\n  private readonly _pipelineOptions : ISegmentPipelineManagerOptions;\n\n  /**\n   * @param {Object} transport\n   */\n  constructor(\n    transport : ITransportPipelines,\n    options : ISegmentPipelineManagerOptions\n  ) {\n    this._transport = transport;\n    this._prioritizer = new ObservablePrioritizer();\n    this._pipelineOptions = options;\n  }\n\n  /**\n   * Create a segment pipeline, allowing to easily perform segment requests.\n   * @param {string} bufferType\n   * @param {Object} options\n   * @returns {Object}\n   */\n  createPipeline(\n    bufferType : IBufferType,\n    requests$ : Subject<IABRRequest | IABRMetric>\n  ) : IPrioritizedSegmentFetcher<T> {\n    const options = getSegmentPipelineOptions(bufferType, this._pipelineOptions);\n    const segmentFetcher = createSegmentFetcher<T>(bufferType,\n                                                   this._transport,\n                                                   requests$,\n                                                   options);\n    return applyPrioritizerToSegmentFetcher<T>(this._prioritizer, segmentFetcher);\n  }\n}\n\nexport { ISegmentPipelineLoaderOptions as ISegmentPipelineOptions };\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IPrioritizedSegmentFetcher } from \"./prioritized_segment_fetcher\";\nimport {\n  ISegmentFetcherChunkCompleteEvent,\n  ISegmentFetcherChunkEvent,\n  ISegmentFetcherEvent,\n  ISegmentFetcherWarning,\n} from \"./segment_fetcher\";\nimport SegmentPipelinesManager, {\n  ISegmentPipelineManagerOptions,\n} from \"./segment_pipelines_manager\";\n\nexport default SegmentPipelinesManager;\nexport {\n  IPrioritizedSegmentFetcher,\n  ISegmentFetcherChunkCompleteEvent,\n  ISegmentFetcherChunkEvent,\n  ISegmentFetcherEvent,\n  ISegmentFetcherWarning,\n  ISegmentPipelineManagerOptions,\n};\n","/**\n * Copyright 2015 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport createManifestPipeline, {\n  IFetchManifestResult,\n} from \"./manifest\";\nimport SegmentPipelinesManager, {\n  IPrioritizedSegmentFetcher,\n  ISegmentFetcherChunkCompleteEvent,\n  ISegmentFetcherChunkEvent,\n  ISegmentFetcherEvent,\n  ISegmentFetcherWarning,\n  ISegmentPipelineManagerOptions,\n} from \"./segment\";\n\nexport {\n  createManifestPipeline,\n  SegmentPipelinesManager,\n\n  IFetchManifestResult,\n\n  IPrioritizedSegmentFetcher,\n  ISegmentFetcherEvent,\n\n  ISegmentPipelineManagerOptions,\n\n  ISegmentFetcherChunkEvent,\n  ISegmentFetcherChunkCompleteEvent,\n  ISegmentFetcherWarning,\n};\n","/**\n * Copyright 2019 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Observable, Subject } from \"rxjs\";\nimport { mergeMap, map } from \"rxjs/operators\";\n\nimport DASHFeature from \"../../../../../transports/dash\";\nimport SMOOTHFeature from \"../../../../../transports/smooth\";\n\nimport { createManifestPipeline } from \"../../../../../core/pipelines\";\nimport Manifest from \"../../../../../manifest\";\nimport { ITransportPipelines } from \"../../../../../transports\";\nimport { IDBPDatabase } from \"idb\";\nimport { ILocalManifest } from \"../../../../../parsers/manifest/local\";\n\n/**\n * Get the TransportPipeline for current transport.\n *\n * @param transport - Transport option for current manifest.\n * @returns A instance of TransportPipelines for the current url.\n *\n */\nexport function getTransportPipelineByTransport(transport: \"smooth\" | \"dash\") {\n  const pipelineTypes = {\n    smooth: SMOOTHFeature,\n    dash: DASHFeature,\n  };\n  return pipelineTypes[transport]({\n    lowLatencyMode: false,\n  });\n}\n\n/**\n * Get the manifest from an url.\n *\n * @param manifestURL - Manifest url on the web.\n * @param transport - Transport that need to be use.\n * @returns A instance of Manifest for the current url and the transportPipeline associated to it.\n *\n */\nexport function manifestLoader(\n  manifestURL: string,\n  transport: \"smooth\" | \"dash\" = \"dash\",\n): Observable<{ manifest: Manifest; transportPipelines: ITransportPipelines }> {\n  const transportPipelines = getTransportPipelineByTransport(transport);\n  const manifestPipeline = createManifestPipeline(\n    transportPipelines,\n    {\n      lowLatencyMode: false,\n      manifestRetry: 5,\n      offlineRetry: 5,\n    },\n    new Subject(),\n  );\n  return manifestPipeline\n    .fetch(manifestURL)\n    .pipe(\n      mergeMap(response =>\n        manifestPipeline\n          .parse(response.value, manifestURL)\n          .pipe(map(({ manifest }) => ({ manifest, transportPipelines }))),\n      ),\n    );\n}\n\n/**\n * Returns the structure of the manifest needed by the rxPlayer transport local.\n *\n * @remarks\n * It's mandatory to construct again the rxpManifest\n * when the user want it because we can't insert function type in IndexDB\n *\n * @param ILocalManifestOnline - The rxpManifest we downloaded when online\n * @returns The manifest that the rxPlayer expect\n *\n */\nexport function offlineManifestLoader(\n  manifest: Manifest,\n  db: IDBPDatabase<unknown>,\n): ILocalManifest {}\n","/**\n * Copyright 2019 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { merge, Observable, Subject, from, EMPTY } from \"rxjs\";\nimport { mergeMap, tap, map, reduce, scan, takeUntil } from \"rxjs/operators\";\nimport { concat, strToBytes } from \"../../../../../utils/byte_parsing\";\nimport {\n  IUtils,\n  IManifestDBState,\n  ICustomSegment,\n  IGlobalContext,\n  IContext,\n  IContextRicher,\n} from \"./types\";\nimport { SegmentPipelinesManager } from \"../../../../../core/pipelines\";\nimport { createBox } from \"../../../../../parsers/containers/isobmff\";\nimport { ISegment } from \"../../../../../manifest\";\nimport { IInitGroupedSegments } from \"./types\";\nimport { IProgressBuilder } from \"../../types\";\n\nexport function handleSegmentPipelineFromContexts<\n  KeyContextType extends keyof Omit<IGlobalContext, \"manifest\">\n>(\n  ctxs: IContext[],\n  contentType: KeyContextType,\n  {\n    segmentPipelinesManager,\n    isInitData,\n    nextSegments,\n    progress,\n    type,\n  }: {\n    type: \"start\" | \"resume\";\n    progress?: IProgressBuilder;\n    isInitData: boolean;\n    segmentPipelinesManager: SegmentPipelinesManager<any>;\n    nextSegments?: ISegment[];\n  },\n): Observable<ICustomSegment> {\n  const segmentFetcherForCurrentContentType = segmentPipelinesManager.createPipeline(\n    contentType,\n    new Subject(),\n  );\n  return from(ctxs).pipe(\n    mergeMap(\n      (ctx, index) =>\n        segmentFetcherForCurrentContentType.createRequest(ctx).pipe(\n          mergeMap(evt => {\n            switch (evt.type) {\n              case \"chunk-complete\":\n                return EMPTY;\n              case \"chunk\":\n                return evt.parse();\n              default:\n                return EMPTY;\n            }\n          }),\n          reduce(\n            (acc, { chunkData, chunkInfos }) => {\n              if (chunkData === null) {\n                return acc;\n              }\n              const durationForCurrentChunk =\n                chunkInfos !== null && chunkInfos.duration != undefined\n                  ? chunkInfos.duration + acc.duration\n                  : acc.duration;\n              if (\n                contentType === \"text\" &&\n                ctx.representation.mimeType &&\n                ctx.representation.mimeType === \"application/mp4\"\n              ) {\n                return {\n                  chunkData: concat(\n                    createBox(\"moof\", acc.chunkData),\n                    createBox(\"moof\", strToBytes(chunkData.data)),\n                  ),\n                  duration: durationForCurrentChunk,\n                };\n              }\n              return {\n                chunkData: concat(acc.chunkData, chunkData),\n                duration: durationForCurrentChunk,\n              };\n            },\n            { chunkData: new Uint8Array(0), duration: 0 },\n          ),\n          map(infoData => {\n            if (nextSegments && !isInitData) {\n              delete nextSegments[index];\n            }\n            return {\n              ...infoData,\n              progress,\n              type,\n              contentType,\n              ctx,\n              index,\n              isInitData,\n              nextSegments,\n              representationID: ctx.representation.id as string,\n            };\n          }),\n        ),\n      3,\n    ),\n  );\n}\n\nexport function segmentPipelineDownloader$(\n  builderObs$: Observable<IInitGroupedSegments>,\n  { contentID, emitter, pause$, db }: IUtils,\n): Observable<IManifestDBState> {\n  return builderObs$.pipe(\n    mergeMap(({ text, segmentPipelinesManager, manifest, progress, type }) => {\n      if (manifest == null || segmentPipelinesManager == null) {\n        return EMPTY;\n      }\n      return merge(\n        // TODO: add video/audio here\n        from(text).pipe(\n          mergeMap<IContextRicher, Observable<ICustomSegment>>(\n            contextRicher => {\n              const { nextSegments, id, ...ctx } = contextRicher;\n              return handleSegmentPipelineFromContexts(\n                nextSegments.map(segment => ({ ...ctx, segment, manifest })),\n                \"text\",\n                {\n                  type,\n                  progress,\n                  nextSegments,\n                  segmentPipelinesManager,\n                  isInitData: false,\n                },\n              );\n            },\n          ),\n        ),\n      );\n    }),\n    tap(async ({ chunkData, duration, index, representationID }) => {\n      await db.put(\"segments\", {\n        contentID,\n        data: chunkData,\n        duration,\n        segmentKey: `${representationID}--${contentID}--${index}`,\n        size: chunkData.byteLength,\n      });\n    }),\n    scan<\n      {\n        chunkData: Uint8Array;\n        duration: number;\n        ctx: IContext;\n        index: number;\n        contentType: \"video\" | \"audio\" | \"text\";\n        representationID: string;\n        isInitData: boolean;\n        nextSegments?: ISegment[];\n        progress?: IProgressBuilder;\n        type: \"start\" | \"resume\";\n      },\n      IManifestDBState\n    >(\n      (\n        acc,\n        {\n          progress,\n          ctx,\n          contentType,\n          nextSegments,\n          representationID,\n          chunkData,\n          type,\n        },\n      ) => {\n        if (progress) {\n          acc.progress.overall = progress.overall;\n          if (type === \"resume\") {\n            acc.progress.current = progress.current;\n          }\n          acc.progress.current += 1;\n          acc.progress.percentage =\n            (acc.progress.current / acc.progress.overall) * 100;\n        }\n        acc.size += chunkData.byteLength;\n        if (!nextSegments) {\n          return acc;\n        }\n        const indexRepresentation = acc[contentType].findIndex(\n          ({ representation }) => representation.id === representationID,\n        );\n        if (indexRepresentation === -1) {\n          acc[contentType].push({\n            nextSegments,\n            period: ctx.period,\n            adaptation: ctx.adaptation,\n            representation: ctx.representation,\n            id: representationID,\n          });\n          return { ...acc, manifest: ctx.manifest };\n        }\n        acc[contentType][indexRepresentation] = {\n          nextSegments,\n          period: ctx.period,\n          adaptation: ctx.adaptation,\n          representation: ctx.representation,\n          id: representationID,\n        };\n        return { ...acc, manifest: ctx.manifest };\n      },\n      {\n        progress: { percentage: 0, current: 0, overall: 0 },\n        manifest: null,\n        video: [],\n        audio: [],\n        text: [],\n        size: 0,\n      },\n    ),\n    tap(({ size, progress }) => {\n      emitter.trigger(\"progress\", {\n        contentID,\n        progress: progress.percentage,\n        size,\n        status: \"downloading\",\n      });\n    }),\n    takeUntil(pause$),\n  );\n}\n","import Manifest, { Adaptation, Representation } from \"../../../../../manifest\";\nimport { IGlobalContext, IContextUniq, IContext } from \"../downloader/types\";\nimport { IVideoSettingsQualityInputType } from \"../../types\";\n\nclass ContentManager {\n  readonly manifest: Manifest;\n  readonly quality?: IVideoSettingsQualityInputType;\n\n  constructor(manifest: Manifest, quality?: IVideoSettingsQualityInputType) {\n    this.manifest = manifest;\n    this.quality = quality;\n  }\n\n  getContextsForCurrentSession(): IGlobalContext {\n    return this.manifest.periods.reduce(\n      (acc: IGlobalContext, period) => {\n        const videoContexts = this.decideUniqContext(\n          period.getAdaptationsForType(\"video\"),\n          \"video\",\n        );\n        acc.video.push({ period, contexts: videoContexts });\n        const audioContexts = this.decideUniqContext(\n          period.getAdaptationsForType(\"audio\"),\n          \"audio\",\n        );\n        acc.audio.push({ period, contexts: audioContexts });\n        const textContexts = this.decideUniqContext(\n          period.getAdaptationsForType(\"text\"),\n          \"text\",\n        );\n        acc.text.push({ period, contexts: textContexts });\n        return acc;\n      },\n      { video: [], audio: [], text: [], manifest: this.manifest },\n    );\n  }\n\n  getContextsFormatted(\n    globalCtx: IGlobalContext,\n  ): { video: IContext[]; audio: IContext[]; text: IContext[] } {\n    const video = globalCtx.video.reduce(\n      (_: IContext[], currVideo): IContext[] => {\n        return currVideo.contexts.map(\n          (videoContext): IContext => ({\n            manifest: globalCtx.manifest,\n            period: currVideo.period,\n            ...videoContext,\n          }),\n        );\n      },\n      [],\n    );\n    const audio = globalCtx.audio.reduce(\n      (_: IContext[], currAudio): IContext[] => {\n        return currAudio.contexts.map(\n          (audioContext): IContext => ({\n            manifest: globalCtx.manifest,\n            period: currAudio.period,\n            ...audioContext,\n          }),\n        );\n      },\n      [],\n    );\n    const text = globalCtx.text.reduce(\n      (_: IContext[], currText): IContext[] => {\n        return currText.contexts.map(\n          (textContext): IContext => ({\n            manifest: globalCtx.manifest,\n            period: currText.period,\n            ...textContext,\n          }),\n        );\n      },\n      [],\n    );\n    return { video, audio, text };\n  }\n\n  private decideRepresentation(\n    representations: Representation[],\n    contentType: \"video\" | \"audio\" | \"text\",\n  ): Representation {\n    switch (contentType) {\n      case \"video\": {\n        return representations.sort((a, b) =>\n          b.height && a.height ? b.height - a.height : 0,\n        )[representations.length - 1];\n      }\n      case \"audio\": {\n        return representations[0];\n      }\n      case \"text\": {\n        return representations[0];\n      }\n      default:\n        return representations[0];\n    }\n  }\n\n  private decideUniqContext(\n    adaptations: Adaptation[],\n    contentType: \"video\" | \"audio\" | \"text\",\n  ): IContextUniq[] {\n    return adaptations.reduce((acc: IContextUniq[], adaptation) => {\n      const representation = this.decideRepresentation(\n        adaptation.representations,\n        contentType,\n      );\n      const segment = representation.index.getInitSegment();\n      if (!segment) {\n        throw new Error(\"Error while constructing the init segment\");\n      }\n      acc.push({\n        adaptation,\n        representation,\n        segment,\n      });\n      return acc;\n    }, []);\n  }\n}\n\nexport default ContentManager;\n","/**\n * Copyright 2019 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { of, merge } from \"rxjs\";\nimport { map, mergeMap, tap, reduce } from \"rxjs/operators\";\nimport { IInitSettings } from \"../../types\";\nimport { manifestLoader } from \"./manifest\";\nimport { handleSegmentPipelineFromContexts } from \"./segment\";\nimport { SegmentPipelinesManager } from \"../../../../../core/pipelines\";\nimport ContentManager from \"../transports/ContentsManager\";\nimport { IInitSegment, IInitGroupedSegments } from \"./types\";\nimport { IDBPDatabase } from \"idb\";\n\n/**\n * A subscription manager that take care to choose between a start and a resume download\n *\n * @param IDownloaderManagerAbstract - Download manager need\n * @param IUtils- Some variables we need to emit and insert in DB\n * @returns The Subscription\n *\n */\nexport function initDownloader$(\n  { contentID, url, adv, transport }: IInitSettings,\n  db: IDBPDatabase<unknown>,\n) {\n  return manifestLoader(url, transport).pipe(\n    mergeMap(({ manifest, transportPipelines }) => {\n      const segmentPipelinesManager = new SegmentPipelinesManager<any>(\n        transportPipelines,\n        {\n          lowLatencyMode: false,\n        },\n      );\n      const contentManager = new ContentManager(\n        manifest,\n        adv && adv.quality ? adv.quality : \"MEDIUM\",\n      );\n      return of(contentManager.getContextsForCurrentSession()).pipe(\n        mergeMap(globalCtx => {\n          const { video, audio, text } = contentManager.getContextsFormatted(\n            globalCtx,\n          );\n          return merge(\n            // handleSegmentPipelineFromContexts(video, \"video\", {\n            //   segmentPipelinesManager,\n            //   isInitData: true,\n            // }).pipe(\n            //   tap(async values => {\n            //     await db.put(\"segments\", {\n            //       contentID,\n            //       data: values.chunkData,\n            //       duration: values.duration,\n            //       segmentKey: `${values.ctx.representation.id}--${contentID}--init`,\n            //       size: values.chunkData.byteLength,\n            //     });\n            //   }),\n            //   map(({ ctx }) => {\n            //     const durationForCurrentPeriod = ctx.period.duration;\n            //     if (durationForCurrentPeriod === undefined) {\n            //       throw new Error(\"Impossible to get future video segments\");\n            //     }\n            //     const nextSegments = ctx.representation.index.getSegments(\n            //       0,\n            //       10, // TODO: Remove this, its only for dev purpose\n            //     );\n            //     return {\n            //       nextSegments,\n            //       ctx,\n            //       segmentPipelinesManager,\n            //       contentType: \"video\" as \"video\" | \"audio\" | \"text\",\n            //     };\n            //   }),\n            // ),\n            // handleSegmentPipelineFromContexts(audio, \"audio\", {\n            //   segmentPipelinesManager,\n            //   isInitData: true,\n            // }).pipe(\n            //   tap(async values => {\n            //     await db.put(\"segments\", {\n            //       contentID,\n            //       data: values.chunkData,\n            //       duration: values.duration,\n            //       segmentKey: `${values.ctx.representation.id}--${contentID}--init`,\n            //       size: values.chunkData.byteLength,\n            //     });\n            //   }),\n            //   map(({ ctx }) => {\n            //     const durationForCurrentPeriod = ctx.period.duration;\n            //     if (durationForCurrentPeriod === undefined) {\n            //       throw new Error(\"Impossible to get future video segments\");\n            //     }\n            //     const nextSegments = ctx.representation.index.getSegments(\n            //       0,\n            //       10, // TODO: Remove this, its only for dev purpose\n            //     );\n            //     return {\n            //       nextSegments,\n            //       ctx,\n            //       segmentPipelinesManager,\n            //       contentType: \"audio\" as \"video\" | \"audio\" | \"text\",\n            //     };\n            //   }),\n            // ),\n            handleSegmentPipelineFromContexts(text, \"text\", {\n              segmentPipelinesManager,\n              isInitData: true,\n              type: \"start\",\n            }).pipe(\n              tap(async values => {\n                await db.put(\"segments\", {\n                  contentID,\n                  data: values.chunkData,\n                  duration: values.duration,\n                  segmentKey: `${values.ctx.representation.id}--${contentID}--init`,\n                  size: values.chunkData.byteLength,\n                });\n              }),\n              map(({ ctx }) => {\n                const durationForCurrentPeriod = ctx.period.duration;\n                if (durationForCurrentPeriod === undefined) {\n                  throw new Error(\"Impossible to get future video segments\");\n                }\n                const nextSegments = ctx.representation.index.getSegments(\n                  0,\n                  10, // TODO: Remove this, its only for dev purpose\n                );\n                return {\n                  nextSegments,\n                  ctx,\n                  segmentPipelinesManager,\n                  contentType: \"text\" as \"video\" | \"audio\" | \"text\",\n                };\n              }),\n            ),\n          );\n        }),\n      );\n    }),\n    reduce<IInitSegment, IInitGroupedSegments>(\n      (\n        acc,\n        {\n          nextSegments,\n          ctx: { period, adaptation, representation, manifest },\n          contentType,\n          segmentPipelinesManager,\n        },\n      ) => {\n        acc.progress.overall += nextSegments.length;\n        acc[contentType].push({\n          nextSegments,\n          period,\n          adaptation,\n          representation,\n          id: representation.id as string,\n        });\n        return { ...acc, segmentPipelinesManager, manifest };\n      },\n      {\n        progress: { percentage: 0, current: 0, overall: 0 },\n        video: [],\n        audio: [],\n        text: [],\n        segmentPipelinesManager: null,\n        manifest: null,\n        type: \"start\",\n      },\n    ),\n  );\n}\n","/**\n * Copyright 2019 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { combineLatest, AsyncSubject, of } from \"rxjs\";\n\nimport { initDownloader$ } from \"./initSegment\";\nimport {\n  IInitSettings,\n  IStoredManifest,\n  IStoreManifestEveryFn,\n} from \"../../types\";\nimport { IUtilsNotification } from \"./types\";\nimport { filter, startWith } from \"rxjs/operators\";\nimport { segmentPipelineDownloader$ } from \"./segment\";\nimport { SegmentPipelinesManager } from \"../../../../../core/pipelines\";\nimport { getTransportPipelineByTransport } from \"./manifest\";\n\nclass DownloadManager {\n  readonly utils: IUtilsNotification;\n\n  constructor(utils: IUtilsNotification) {\n    this.utils = utils;\n  }\n\n  initDownload(initSettings: IInitSettings, pause$: AsyncSubject<void>) {\n    const { contentID, adv } = initSettings;\n    const pipelineSegmentDownloader$ = segmentPipelineDownloader$(\n      initDownloader$(initSettings, this.utils.db),\n      { contentID, db: this.utils.db, pause$, emitter: this.utils.emitter },\n    );\n    return combineLatest([\n      pipelineSegmentDownloader$.pipe(\n        filter(({ progress: { percentage } }) =>\n          adv &&\n          adv.storeManifestEvery &&\n          typeof adv.storeManifestEvery === \"function\"\n            ? adv.storeManifestEvery(percentage) || percentage === 100\n            : percentage % 10 === 0,\n        ),\n        startWith(null),\n      ),\n      pause$.pipe(startWith(null)),\n    ]);\n  }\n\n  resumeDownload(\n    resumeSettings: IStoredManifest,\n    pause$: AsyncSubject<void>,\n    resumeOptions: {\n      transport: \"smooth\" | \"dash\";\n      storeManifestEvery?: IStoreManifestEveryFn;\n    },\n  ) {\n    const { transport, storeManifestEvery } = resumeOptions;\n    const segmentPipelinesManager = new SegmentPipelinesManager<any>(\n      getTransportPipelineByTransport(transport),\n      {\n        lowLatencyMode: false,\n      },\n    );\n    const {\n      progress,\n      manifest,\n      builder: { video, audio, text },\n      contentID,\n    } = resumeSettings;\n    const pipelineSegmentDownloader$ = segmentPipelineDownloader$(\n      of({\n        progress,\n        video,\n        audio,\n        text,\n        manifest,\n        segmentPipelinesManager,\n        type: \"resume\",\n      }),\n      { contentID, db: this.utils.db, pause$, emitter: this.utils.emitter },\n    );\n    return combineLatest([\n      pipelineSegmentDownloader$.pipe(\n        filter(({ progress: { percentage } }) =>\n          storeManifestEvery && typeof storeManifestEvery === \"function\"\n            ? storeManifestEvery(percentage) || percentage === 100\n            : percentage % 10 === 0,\n        ),\n        startWith(null),\n      ),\n      pause$.pipe(startWith(null)),\n    ]);\n  }\n}\n\nexport default DownloadManager;\n","const instanceOfAny = (object, constructors) => constructors.some(c => object instanceof c);\n\nlet idbProxyableTypes;\r\nlet cursorAdvanceMethods;\r\n// This is a function to prevent it throwing up in node environments.\r\nfunction getIdbProxyableTypes() {\r\n    return idbProxyableTypes ||\r\n        (idbProxyableTypes = [IDBDatabase, IDBObjectStore, IDBIndex, IDBCursor, IDBTransaction]);\r\n}\r\n// This is a function to prevent it throwing up in node environments.\r\nfunction getCursorAdvanceMethods() {\r\n    return cursorAdvanceMethods || (cursorAdvanceMethods = [\r\n        IDBCursor.prototype.advance,\r\n        IDBCursor.prototype.continue,\r\n        IDBCursor.prototype.continuePrimaryKey,\r\n    ]);\r\n}\r\nconst cursorRequestMap = new WeakMap();\r\nconst transactionDoneMap = new WeakMap();\r\nconst transactionStoreNamesMap = new WeakMap();\r\nconst transformCache = new WeakMap();\r\nconst reverseTransformCache = new WeakMap();\r\nfunction promisifyRequest(request) {\r\n    const promise = new Promise((resolve, reject) => {\r\n        const unlisten = () => {\r\n            request.removeEventListener('success', success);\r\n            request.removeEventListener('error', error);\r\n        };\r\n        const success = () => {\r\n            resolve(wrap(request.result));\r\n            unlisten();\r\n        };\r\n        const error = () => {\r\n            reject(request.error);\r\n            unlisten();\r\n        };\r\n        request.addEventListener('success', success);\r\n        request.addEventListener('error', error);\r\n    });\r\n    promise.then((value) => {\r\n        // Since cursoring reuses the IDBRequest (*sigh*), we cache it for later retrieval\r\n        // (see wrapFunction).\r\n        if (value instanceof IDBCursor) {\r\n            cursorRequestMap.set(value, request);\r\n        }\r\n    });\r\n    // This mapping exists in reverseTransformCache but doesn't doesn't exist in transformCache. This\r\n    // is because we create many promises from a single IDBRequest.\r\n    reverseTransformCache.set(promise, request);\r\n    return promise;\r\n}\r\nfunction cacheDonePromiseForTransaction(tx) {\r\n    // Early bail if we've already created a done promise for this transaction.\r\n    if (transactionDoneMap.has(tx))\r\n        return;\r\n    const done = new Promise((resolve, reject) => {\r\n        const unlisten = () => {\r\n            tx.removeEventListener('complete', complete);\r\n            tx.removeEventListener('error', error);\r\n            tx.removeEventListener('abort', error);\r\n        };\r\n        const complete = () => {\r\n            resolve();\r\n            unlisten();\r\n        };\r\n        const error = () => {\r\n            reject(tx.error);\r\n            unlisten();\r\n        };\r\n        tx.addEventListener('complete', complete);\r\n        tx.addEventListener('error', error);\r\n        tx.addEventListener('abort', error);\r\n    });\r\n    // Cache it for later retrieval.\r\n    transactionDoneMap.set(tx, done);\r\n}\r\nlet idbProxyTraps = {\r\n    get(target, prop, receiver) {\r\n        if (target instanceof IDBTransaction) {\r\n            // Special handling for transaction.done.\r\n            if (prop === 'done')\r\n                return transactionDoneMap.get(target);\r\n            // Polyfill for objectStoreNames because of Edge.\r\n            if (prop === 'objectStoreNames') {\r\n                return target.objectStoreNames || transactionStoreNamesMap.get(target);\r\n            }\r\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\r\n            if (prop === 'store') {\r\n                return receiver.objectStoreNames[1] ?\r\n                    undefined : receiver.objectStore(receiver.objectStoreNames[0]);\r\n            }\r\n        }\r\n        // Else transform whatever we get back.\r\n        return wrap(target[prop]);\r\n    },\r\n    has(target, prop) {\r\n        if (target instanceof IDBTransaction && (prop === 'done' || prop === 'store'))\r\n            return true;\r\n        return prop in target;\r\n    },\r\n};\r\nfunction addTraps(callback) {\r\n    idbProxyTraps = callback(idbProxyTraps);\r\n}\r\nfunction wrapFunction(func) {\r\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\r\n    // only create one new func per func.\r\n    // Edge doesn't support objectStoreNames (booo), so we polyfill it here.\r\n    if (func === IDBDatabase.prototype.transaction &&\r\n        !('objectStoreNames' in IDBTransaction.prototype)) {\r\n        return function (storeNames, ...args) {\r\n            const tx = func.call(unwrap(this), storeNames, ...args);\r\n            transactionStoreNamesMap.set(tx, storeNames.sort ? storeNames.sort() : [storeNames]);\r\n            return wrap(tx);\r\n        };\r\n    }\r\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\r\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\r\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\r\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\r\n    // undefined if the end of the cursor has been reached.\r\n    if (getCursorAdvanceMethods().includes(func)) {\r\n        return function (...args) {\r\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\r\n            // the original object.\r\n            func.apply(unwrap(this), args);\r\n            return wrap(cursorRequestMap.get(this));\r\n        };\r\n    }\r\n    return function (...args) {\r\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\r\n        // the original object.\r\n        return wrap(func.apply(unwrap(this), args));\r\n    };\r\n}\r\nfunction transformCachableValue(value) {\r\n    if (typeof value === 'function')\r\n        return wrapFunction(value);\r\n    // This doesn't return, it just creates a 'done' promise for the transaction,\r\n    // which is later returned for transaction.done (see idbObjectHandler).\r\n    if (value instanceof IDBTransaction)\r\n        cacheDonePromiseForTransaction(value);\r\n    if (instanceOfAny(value, getIdbProxyableTypes()))\r\n        return new Proxy(value, idbProxyTraps);\r\n    // Return the same value back if we're not going to transform it.\r\n    return value;\r\n}\r\nfunction wrap(value) {\r\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\r\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\r\n    if (value instanceof IDBRequest)\r\n        return promisifyRequest(value);\r\n    // If we've already transformed this value before, reuse the transformed value.\r\n    // This is faster, but it also provides object equality.\r\n    if (transformCache.has(value))\r\n        return transformCache.get(value);\r\n    const newValue = transformCachableValue(value);\r\n    // Not all types are transformed.\r\n    // These may be primitive types, so they can't be WeakMap keys.\r\n    if (newValue !== value) {\r\n        transformCache.set(value, newValue);\r\n        reverseTransformCache.set(newValue, value);\r\n    }\r\n    return newValue;\r\n}\r\nconst unwrap = (value) => reverseTransformCache.get(value);\n\nexport { wrap as a, addTraps as b, instanceOfAny as c, reverseTransformCache as d, unwrap as e };\n","import { a as wrap, b as addTraps } from './chunk.js';\nexport { e as unwrap, a as wrap } from './chunk.js';\n\n/**\r\n * Open a database.\r\n *\r\n * @param name Name of the database.\r\n * @param version Schema version.\r\n * @param callbacks Additional callbacks.\r\n */\r\nfunction openDB(name, version, { blocked, upgrade, blocking } = {}) {\r\n    const request = indexedDB.open(name, version);\r\n    const openPromise = wrap(request);\r\n    if (upgrade) {\r\n        request.addEventListener('upgradeneeded', (event) => {\r\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction));\r\n        });\r\n    }\r\n    if (blocked)\r\n        request.addEventListener('blocked', () => blocked());\r\n    if (blocking)\r\n        openPromise.then(db => db.addEventListener('versionchange', blocking));\r\n    return openPromise;\r\n}\r\n/**\r\n * Delete a database.\r\n *\r\n * @param name Name of the database.\r\n */\r\nfunction deleteDB(name, { blocked } = {}) {\r\n    const request = indexedDB.deleteDatabase(name);\r\n    if (blocked)\r\n        request.addEventListener('blocked', () => blocked());\r\n    return wrap(request).then(() => undefined);\r\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\r\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\r\nconst cachedMethods = new Map();\r\nfunction getMethod(target, prop) {\r\n    if (!(target instanceof IDBDatabase &&\r\n        !(prop in target) &&\r\n        typeof prop === 'string'))\r\n        return;\r\n    if (cachedMethods.get(prop))\r\n        return cachedMethods.get(prop);\r\n    const targetFuncName = prop.replace(/FromIndex$/, '');\r\n    const useIndex = prop !== targetFuncName;\r\n    const isWrite = writeMethods.includes(targetFuncName);\r\n    if (\r\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\r\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\r\n        !(isWrite || readMethods.includes(targetFuncName)))\r\n        return;\r\n    const method = async function (storeName, ...args) {\r\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\r\n        let target = tx.store;\r\n        if (useIndex)\r\n            target = target.index(args.shift());\r\n        const returnVal = target[targetFuncName](...args);\r\n        if (isWrite)\r\n            await tx.done;\r\n        return returnVal;\r\n    };\r\n    cachedMethods.set(prop, method);\r\n    return method;\r\n}\r\naddTraps(oldTraps => ({\r\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\r\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\r\n}));\n\nexport { openDB, deleteDB };\n","/**\n * Copyright 2019 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IDBPDatabase } from \"idb\";\nimport { IStoredManifest, IInitSettings } from \"./types\";\nimport { IActiveDownload } from \"./apis/transports/types\";\n\n/* tslint:disable */\n\n/**\n * A utils class that extends Error object to have custom class errors\n */\nexport class SegmentConstuctionError extends Error {\n  constructor(message: string) {\n    super(message);\n    Object.setPrototypeOf(this, SegmentConstuctionError.prototype);\n    this.name = \"SegmentConstructionError\";\n  }\n}\n\nexport class ValidationArgsError extends Error {\n  constructor(message: string) {\n    super(message);\n    Object.setPrototypeOf(this, ValidationArgsError.prototype);\n    this.name = \"ValidationArgsError\";\n  }\n}\n\nexport class RxPlayerError extends Error {\n  constructor(message: string) {\n    super(message);\n    Object.setPrototypeOf(this, RxPlayerError.prototype);\n    this.name = \"RxPlayerError\";\n  }\n}\n\nexport class IndexDBError extends Error {\n  constructor(message: string) {\n    super(message);\n    Object.setPrototypeOf(this, IndexDBError.prototype);\n    this.name = \"IndexDBError\";\n  }\n}\n/* tslint:enable */\n\n/**\n * Check the presence and validity of ISettingsDownloader arguments\n *\n * @param ISettingsDownloader - The arguments that the user of the lib provided\n * @returns void\n *\n */\nexport async function checkInitDownloaderOptions(\n  options: Omit<IInitSettings, \"type\">,\n  db: IDBPDatabase,\n  activeDownloads: IActiveDownload,\n): Promise<void> {\n  if (\n    !options ||\n    typeof options !== \"object\" ||\n    Object.keys(options).length < 0\n  ) {\n    throw new ValidationArgsError(\n      \"You must at least specify these arguments: { url, contentID, transport }\",\n    );\n  }\n\n  const { url, contentID, transport } = options;\n  if (!url) {\n    throw new ValidationArgsError(\"You must specify the url of the manifest\");\n  }\n\n  if (!contentID) {\n    throw new ValidationArgsError(\n      \"You must specify a contentID of the content you want to download\",\n    );\n  }\n\n  if (!transport) {\n    throw new ValidationArgsError(\"You must specify a transport protocol.\");\n  }\n\n  if (activeDownloads[contentID]) {\n    throw new ValidationArgsError(\n      \"The content must be resume instead of starting a new download\",\n    );\n  }\n\n  const contentMovie: IStoredManifest | null | undefined = await db.get(\n    \"manifests\",\n    contentID,\n  );\n  if (contentMovie) {\n    throw new ValidationArgsError(\n      \"An entry with the same contentID is already present, contentID must be unique\",\n    );\n  }\n}\n\nexport function checkForResumeAPausedMovie(\n  manifest: IStoredManifest,\n  activeDownloads: IActiveDownload,\n) {\n  if (!manifest) {\n    throw new ValidationArgsError(\n      \"No content has been found with the given contentID\",\n    );\n  }\n\n  if (activeDownloads[manifest.contentID]) {\n    throw new ValidationArgsError(\"The content is already downloading\");\n  }\n\n  if (manifest.progress.percentage === 100) {\n    throw new ValidationArgsError(\n      \"You can't resume a content that is already fully downloaded\",\n    );\n  }\n}\n\nexport function checkForPauseAMovie(contentID: string) {\n  if (!contentID) {\n    throw new ValidationArgsError(\n      \"A valid contentID is mandatory when pausing\",\n    );\n  }\n}\n","/**\n * Copyright 2019 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IDBPDatabase, openDB } from \"idb\";\nimport { IndexDBError } from \"../../utils\";\n\n/**\n * A very short function to know if IndexDB is supported by the current browser.\n *\n * @returns Wether or not IndexDB is supported\n *\n */\nexport const isIndexDBSupported = (): boolean => \"indexedDB\" in window;\n\n/**\n * Set up IndexDB with few checks and creating table\n *\n * @returns The IndexDB object\n *\n */\nexport function setUpDb(nameDB: string): Promise<IDBPDatabase> {\n  if (!isIndexDBSupported()) {\n    throw new IndexDBError(\"IndexDB is not supported in your browser\");\n  }\n\n  try {\n    return openDB(nameDB, 1, {\n      upgrade(db) {\n        db.createObjectStore(\"manifests\", {\n          keyPath: \"contentID\",\n        });\n        const segmentObjectStore = db.createObjectStore(\"segments\", {\n          keyPath: \"segmentKey\",\n        });\n        db.createObjectStore(\"drm\", {\n          keyPath: \"contentID\",\n        });\n        segmentObjectStore.createIndex(\"contentID\", \"contentID\", {\n          unique: false,\n        });\n      },\n    });\n  } catch (e) {\n    throw new IndexDBError(e.message);\n  }\n}\n","/**\n * Copyright 2019 CANAL+ Group\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"@babel/polyfill\";\nimport { IDBPDatabase } from \"idb\";\nimport { AsyncSubject } from \"rxjs\";\n\nimport DownloadManager from \"./apis/downloader/downloadManager\";\nimport { offlineManifestLoader } from \"./apis/downloader/manifest\";\nimport { setUpDb } from \"./apis/transactionDB/dbSetUp\";\nimport {\n  checkForPauseAMovie,\n  checkForResumeAPausedMovie,\n  IndexDBError,\n  checkInitDownloaderOptions,\n  ValidationArgsError,\n} from \"./utils\";\n\nimport EventEmitter from \"../../../utils/event_emitter\";\nimport PPromise from \"../../../utils/promise\";\nimport { IActivePauses, IActiveDownload } from \"./apis/transports/types\";\nimport {\n  IDownload2GoEvents,\n  IEmitterTrigger,\n  IStoredManifest,\n  IGlobalSettings,\n  IInitSettings,\n} from \"./types\";\nimport noop from \"../../../utils/noop\";\n\n/**\n * Instanciate a D2G downloader.\n * @param {Object<{nameDB, storeManifestEvery}>} IOptionsStarter\n * @return {IPublicAPI} IPublicAPI\n */\nclass D2G extends EventEmitter<IDownload2GoEvents> {\n  public readonly nameDB: string;\n  private db: IDBPDatabase | null;\n  private emitter: IEmitterTrigger<IDownload2GoEvents>;\n  private activeDownloads: IActiveDownload;\n  private activePauses: IActivePauses;\n\n  constructor(options: IGlobalSettings = {}) {\n    super();\n    this.nameDB = options.nameDB || \"d2g-canalplus\";\n    this.activeDownloads = {};\n    this.activePauses = {};\n    this.db = null;\n    this.emitter = {\n      trigger: (eventName, payload) => this.trigger(eventName, payload),\n    };\n  }\n\n  /**\n   * Initialize an IndexDB instance.\n   * @returns {Promise<void>}\n   */\n  async initDB(): Promise<IDBPDatabase> {\n    return new Promise((resolve, reject) => {\n      setUpDb(this.nameDB)\n        .then(db => {\n          this.db = db;\n          resolve(db);\n        })\n        .catch(error => {\n          this.trigger(\"error\", { action: \"initDB\", error });\n          reject(error);\n        });\n    });\n  }\n\n  /**\n   * Start a download from scratch.\n   * @param {Object<ISettingsDownloader>} settings\n   * @returns {Promise.<void>}\n   */\n  async download(options: IInitSettings): Promise<void> {\n    try {\n      const db = this.db;\n      if (db === null) {\n        throw new Error(\"The IndexDB database has not been created!\");\n      }\n      await checkInitDownloaderOptions(options, db, this.activeDownloads);\n      const { metaData, contentID } = options;\n      const pause$ = new AsyncSubject<void>();\n      this.activePauses[contentID] = pause$;\n      const downloadManager = new DownloadManager({\n        emitter: this.emitter,\n        db,\n      });\n      const initDownloadSub = downloadManager\n        .initDownload(options, pause$)\n        .subscribe(\n          ([download]) => {\n            if (download === null) {\n              return;\n            }\n            const { progress, manifest, audio, video, text, size } = download;\n            if (manifest === null) {\n              return;\n            }\n            db.put(\"manifests\", {\n              contentID,\n              manifest,\n              builder: { video, audio, text },\n              progress,\n              size,\n              ...(metaData && { metaData }),\n            }).then(noop);\n          },\n          error => this.trigger(\"error\", { action: \"init-downloader\", error }),\n          () => console.warn(`DOWNLOAD INIT COMPLETE: ${options.contentID}`),\n        );\n      this.activeDownloads[contentID] = {\n        sub: initDownloadSub,\n        transport: options.transport,\n        storeManifestEvery: options.adv\n          ? options.adv.storeManifestEvery\n          : undefined,\n      };\n    } catch (error) {\n      this.trigger(\"error\", {\n        action: \"init-downloader\",\n        error,\n        contentID: options.contentID,\n      });\n    }\n  }\n\n  /**\n   * Resume a download already started earlier.\n   * @param {string} contentID\n   * @returns {Promise.<void>}\n   */\n  async resume(contentID: string): Promise<void> {\n    try {\n      const db = this.db;\n      if (db === null) {\n        throw new Error(\"The IndexDB database has not been created!\");\n      }\n      if (!contentID) {\n        throw new Error(\"You must specify a valid contentID for resuming.\");\n      }\n      const manifest: IStoredManifest = await db.get(\"manifests\", contentID);\n      checkForResumeAPausedMovie(manifest, this.activeDownloads);\n      const pause$ = new AsyncSubject<void>();\n      this.activePauses[contentID] = pause$;\n      const downloadManager = new DownloadManager({\n        emitter: this.emitter,\n        db,\n      });\n      const { metaData } = manifest;\n      const { transport, storeManifestEvery } = this.activeDownloads[contentID];\n      const resumeDownloadSub = downloadManager\n        .resumeDownload(manifest, pause$, { transport, storeManifestEvery })\n        .subscribe(\n          ([download]) => {\n            if (download === null) {\n              return;\n            }\n            const { progress, manifest, audio, video, text, size } = download;\n            if (manifest === null) {\n              return;\n            }\n            db.put(\"manifests\", {\n              contentID,\n              manifest,\n              builder: { video, audio, text },\n              progress,\n              size,\n              ...(metaData && { metaData }),\n            }).then(noop);\n          },\n          error =>\n            this.trigger(\"error\", { action: \"resume-downloader\", error }),\n          () => console.warn(`DOWNLOAD INIT COMPLETE: ${contentID}`),\n        );\n      this.activeDownloads[contentID] = {\n        sub: resumeDownloadSub,\n        transport,\n        storeManifestEvery: storeManifestEvery ? storeManifestEvery : undefined,\n      };\n    } catch (error) {\n      this.trigger(\"error\", { action: \"resume-downloader\", error, contentID });\n    }\n  }\n\n  /**\n   * Pause a download already started earlier.\n   * @param {string} contentID\n   * @returns {void}\n   */\n  pause(contentID: string): void {\n    try {\n      checkForPauseAMovie(contentID);\n      const activeDownloads = this.activeDownloads;\n      const activePauses = this.activePauses;\n      if (!activeDownloads[contentID] && !activePauses[contentID]) {\n        throw new ValidationArgsError(`Invalid contentID given: ${contentID}`);\n      }\n      activePauses[contentID].next();\n      activePauses[contentID].complete();\n      activeDownloads[contentID].sub.unsubscribe();\n      delete activeDownloads[contentID];\n      delete activePauses[contentID];\n    } catch (e) {\n      this.trigger(\"error\", {\n        action: \"pause\",\n        contentID,\n        error: e || new Error(\"A Unexpected error happened\"),\n      });\n    }\n  }\n\n  /**\n   * Get all the downloaded entry (manifest) partially or fully downloaded.\n   * @returns {Promise.<T[]|void>}\n   */\n  getAllDownloadedMovies<T>(): Promise<T[]> | void {\n    try {\n      if (!this.db) {\n        throw new Error(\"The IndexDB database has not been created!\");\n      }\n      return this.db.getAll(\"manifests\");\n    } catch (e) {\n      this.trigger(\"error\", {\n        action: \"getAllDownloadedMovies\",\n        error: new IndexDBError(e.message),\n      });\n    }\n  }\n\n  /**\n   * Get a singleMovie ready to be played by the rx-player,\n   * could be fully or partially downloaded.\n   * @param {string} contentID\n   * @returns {Promise.<T|void>}\n   */\n  async getSingleMovie<T>(contentID: string): Promise<T | void> {\n    try {\n      if (!this.db) {\n        throw new Error(\"The IndexDB database has not been created!\");\n      }\n      const [movie, encryption] = await PPromise.all([\n        this.db.get(\"manifests\", contentID),\n        this.db.get(\"drm\", contentID),\n      ]);\n      if (!movie) {\n        throw new Error(\n          \"A content doesnt exist with the given contentID: \" + contentID,\n        );\n      }\n      return {\n        ...movie,\n        ...encryption,\n        rxpManifest: offlineManifestLoader(movie.rxpManifest, this.db),\n      };\n    } catch (e) {\n      this.trigger(\"error\", {\n        action: \"getSingleMovie\",\n        contentID,\n        error: e || new Error(\"A Unexpected error happened\"),\n      });\n    }\n  }\n\n  async getAvailableSpaceOnDevice() {\n    if (!navigator.storage || !navigator.storage.estimate) {\n      return null;\n    }\n    const { quota, usage } = await navigator.storage.estimate();\n    if (!quota || !usage) {\n      return null;\n    }\n    return {\n      total: quota / 1e6,\n      used: usage / 1e6,\n    };\n  }\n\n  /**\n   * Delete an entry partially or fully downloaded and stop the download\n   * if the content is downloading, then delete.\n   * @param {string} contentID\n   * @returns {Promise.<void>}\n   */\n  async deleteDownloadedMovie(contentID: string): Promise<void> {\n    try {\n      const activeDownloads = this.activeDownloads;\n      const activePauses = this.activePauses;\n      const db = this.db;\n      if (!db) {\n        throw new Error(\"The IndexDB database has not been created!\");\n      }\n      if (activeDownloads[contentID] && activePauses[contentID]) {\n        activePauses[contentID].next();\n        activePauses[contentID].complete();\n        activeDownloads[contentID].sub.unsubscribe();\n        delete activeDownloads[contentID];\n        delete activePauses[contentID];\n      }\n      const indexTx = db\n        .transaction(\"segments\", \"readwrite\")\n        .objectStore(\"segments\")\n        .index(\"contentID\");\n      let cursor = await indexTx.openCursor(IDBKeyRange.only(contentID));\n      while (cursor) {\n        await cursor.delete();\n        cursor = await cursor.continue();\n      }\n      await PPromise.all([\n        db.delete(\"drm\", contentID),\n        db.delete(\"manifests\", contentID),\n      ]);\n    } catch (e) {\n      this.trigger(\"error\", {\n        action: \"delete-download\",\n        contentID,\n        error: e || new Error(\"A Unexpected error happened\"),\n      });\n    }\n  }\n}\n\nwindow.__DEV__ = true;\nwindow.d2g = D2G;\n\nexport default D2G;\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else {\n        window.location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}